#include "itri_injpro.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>
#include <time.h>
#include <math.h>
#include <unistd.h>
#include "open62541.h"
#include "config.h"

//[SYS]

unsigned int SYS_InsertSysErrMsg(MYSQL mysqlCon, unsigned int intErrClass, unsigned int intMOSN, unsigned int intIMMSN, int intErrCode, const char *charErrMsg)
//[System]Insert System Error Message
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charDisplayErrMsg[MEDIUM_STRING_SIZE];
	char *charLogSN;
	unsigned int intLogSN;
	char charMOSN[TINY_STRING_SIZE];
	char charIMMSN[TINY_STRING_SIZE];
	char charErrCode[LONG_STRING_SIZE];

	fprintf(stderr, "%s\n", charErrMsg);

	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s.SysLog", SYS_NAME, LOG_DATABASE_NAME);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "LogSN", &charLogSN);
	
	
	
	if (intRetval == EXIT_FAILURE)
		return EXIT_FAILURE;
	intLogSN = atoi(charLogSN) + 1;

	if (intMOSN == 0)
		snprintf(charMOSN, TINY_STRING_SIZE, "NULL");
	else
		snprintf(charMOSN, TINY_STRING_SIZE, "%d", intMOSN);
	
	if (intIMMSN == 0)
		snprintf(charIMMSN, TINY_STRING_SIZE, "NULL");
	else
		snprintf(charIMMSN, TINY_STRING_SIZE, "%d", intIMMSN);
	
	if (intErrCode == 0)
		snprintf(charErrCode, TINY_STRING_SIZE, "NULL");
	else
		snprintf(charErrCode, TINY_STRING_SIZE, "%d", intErrCode);
	
	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s.SysLog (LogSN,Time,ErrClass,ErrMOSN,ErrIMMSN,ErrCode,ErrMsg) VALUE (%d,NOW(),%d,%s,%s,%s,'%s')",
			 SYS_NAME, LOG_DATABASE_NAME, intLogSN, intErrClass, charMOSN, charIMMSN, charErrCode, charErrMsg);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charDisplayErrMsg, MEDIUM_STRING_SIZE, "[SYS_InsertSysErrMsg]Fail to Insert Error Log to %s_%s.SysLog (%d):%s",
				 SYS_NAME, LOG_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
	}
	return intLogSN;
}

int SYS_CreateSysDB(MYSQL mysqlCon)
//[System]Create System Database
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intInsertAcceptCriteriaSN;
	unsigned int intLogSN;

	// Create Database INJPRO_Sys_Log
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, LOG_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create database %s_%s (%d):%s",
				 SYS_NAME, LOG_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
#ifdef DEBUG_MODE
		fprintf(stderr, "%s\n", charErrMsg);
#endif
		return EXIT_FAILURE;
	}

	// Create Table INJPRO_Sys_Log.SysLog
	snprintf(charStatement, MAX_STRING_SIZE,
			 "CREATE TABLE IF NOT EXISTS %s_%s.SysLog ("
			 "LogSN		BIGINT UNSIGNED NOT NULL,"
			 "Time 		DATETIME NOT NULL,"
			 "ErrClass	INT UNSIGNED NOT NULL,"
			 "ErrMOSN	INT UNSIGNED DEFAULT NULL,"
			 "ErrIMMSN	INT UNSIGNED DEFAULT NULL,"
			 "ErrCode	INT DEFAULT NULL,"
			 "ErrMsg	VARCHAR(%d) NOT NULL,"
			 "PRIMARY KEY (LogSN),"
			 "INDEX(ErrClass,ErrMOSN,ErrIMMSN,ErrCode))"
			 "ENGINE=InnoDB",
			 SYS_NAME, LOG_DATABASE_NAME, LONG_STRING_SIZE);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create database %s_%s.SysLog (%d):%s",
				 SYS_NAME, LOG_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
#ifdef DEBUG_MODE
		fprintf(stderr, "%s\n", charErrMsg);
#endif
		return EXIT_FAILURE;
	}

	/*********************************************************************************************************

	 unsigned SYS_InsertSysErrMsg() Is Aviable From Here.

	*********************************************************************************************************/

	// Create Table INJPRO_Sys_Log.UserLog
	/*
	snprintf(charStatement,MAX_STRING_SIZE,"CREATE TABLE IF NOT EXISTS %s_%s.%s ("-
	 "LogSN		BIGINT UNSIGNED NOT NULL,"
	 "Time		DATETIME NOT NULL,"
	 "UserID	INT UNSIGNED NOT NULL,"
	 "LoginIP	VARCHAR(15) NOT NULL,"
	 "UserLogMsg	VARCHAR(250) NOT NULL,"
	 "PRIMARY KEY (LogSN),"
	 "INDEX(UserID,LoginIP)) "
	 "ENGINE=InnoDB",
	SYS_NAME,LOG_DATABASE_NAME,USER_LOG_TABLE_NAME);
	intRetval=mysql_query(&mysqlCon,charStatement);
	if(intRetval!=EXIT_SUCCESS){
		snprintf(charErrMsg,LONG_STRING_SIZE,"[SYS_CreateSysDB]Fail to create table %s_%s.%s (%d):%s",
		 SYS_NAME,LOG_DATABASE_NAME,USER_LOG_TABLE_NAME,mysql_errno(&mysqlCon),mysql_error(&mysqlCon));
		intLogSN=SYS_InsertSysErrMsg(mysqlCon,ERRCLASS_MYSQL,0,0,mysql_errno(&mysqlCon),charErrMsg);
		return EXIT_FAILURE;
	}
	*/

	// Create Database INJPRO_Sys_Info
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, INFO_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create database %s_%s (%d):%s",
				 SYS_NAME, INFO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Sys_Log.SystemInfo
	snprintf(charStatement, MAX_STRING_SIZE,
			 "CREATE TABLE IF NOT EXISTS %s_%s.SystemInfo ("
			 "DiskUsage		DOUBLE DEFAULT NULL)"
			 "ENGINE=InnoDB",
			 SYS_NAME, INFO_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create database %s_%s.SystemInfo (%d):%s",
				 SYS_NAME, LOG_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
#ifdef DEBUG_MODE
		fprintf(stderr, "%s\n", charErrMsg);
#endif
		return EXIT_FAILURE;
	}

	// Create Database INJPRO_Sys_Config
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, CONFIG_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create database %s_%s (%d):%s",
				 SYS_NAME, CONFIG_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Database INJPRO_Sys_Index
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create database %s_%s (%d):%s",
				 SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Sys_Index.OPCUAVersionIndex
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s.OPCUAVersionIndex ("
											 "OPCUAVersionSN							INT UNSIGNED NOT NULL,"
											 "OPCUAVersionMask							TINYINT(1) DEFAULT 0,"
											 "OPCUAVersionID							VARCHAR(20) NOT NULL,"
											 "DOMoldClampedName							VARCHAR(30) NOT NULL DEFAULT 'MoldClamped'," // 1
											 "DOMoldClampedType							VARCHAR(1),"
											 "DOMoldClampedNS							varchar(10),"
											 "DOMoldClampedID							VARCHAR(100),"
											 "DOMoldClampedRatio						DOUBLE DEFAULT 1.0,"
											 "DOMoldReleasedName						VARCHAR(30) NOT NULL DEFAULT 'MoldReleased'," // 2
											 "DOMoldReleasedType						VARCHAR(1),"
											 "DOMoldReleasedNS							varchar(10),"
											 "DOMoldReleasedID							VARCHAR(100),"
											 "DOMoldReleasedRatio						DOUBLE DEFAULT 1.0,"
											 "DOAlarmLampName							VARCHAR(30) NOT NULL DEFAULT 'AlarmLamp'," // 3
											 "DOAlarmLampType							VARCHAR(1),"
											 "DOAlarmLampNS								varchar(10),"
											 "DOAlarmLampID								VARCHAR(100),"
											 "DOAlarmLampRatio							DOUBLE DEFAULT 1.0,"
											 "DOStoppedLampName							VARCHAR(30) NOT NULL DEFAULT 'StoppedLamp'," // 4
											 "DOStoppedLampType							VARCHAR(1),"
											 "DOStoppedLampNS							varchar(10),"
											 "DOStoppedLampID							VARCHAR(100),"
											 "DOStoppedLampRatio						DOUBLE DEFAULT 1.0,"
											 "DORunningLampName							VARCHAR(30) NOT NULL DEFAULT 'RunningLamp'," // 5
											 "DORunningLampType							VARCHAR(1),"
											 "DORunningLampNS							varchar(10),"
											 "DORunningLampID							VARCHAR(100),"
											 "DORunningLampRatio						DOUBLE DEFAULT 1.0,"
											 "DOMotorStartName							VARCHAR(30) NOT NULL DEFAULT 'MotorStart'," // 6
											 "DOMotorStartType							VARCHAR(1),"
											 "DOMotorStartNS							varchar(10),"
											 "DOMotorStartID							VARCHAR(100),"
											 "DOMotorStartRatio							DOUBLE DEFAULT 1.0,"
											 "DOOperationModeName						VARCHAR(30) NOT NULL DEFAULT 'OperationMode'," // 7
											 "DOOperationModeType						VARCHAR(1),"
											 "DOOperationModeNS							varchar(10),"
											 "DOOperationModeID							VARCHAR(100),"
											 "DOOperationModeRatio						DOUBLE DEFAULT 1.0,"
											 "DOShotCompleteName						VARCHAR(30) NOT NULL DEFAULT 'ShotComplete'," // 8
											 "DOShotCompleteType						VARCHAR(1),"
											 "DOShotCompleteNS							varchar(10),"
											 "DOShotCompleteID							VARCHAR(100),"
											 "DOShotCompleteRatio						DOUBLE DEFAULT 1.0,"
											 "IMMParaInjectStageName					VARCHAR(30) NOT NULL DEFAULT 'InjectStage'," // 9
											 "IMMParaInjectStageType					VARCHAR(1),"
											 "IMMParaInjectStageNS						varchar(10),"
											 "IMMParaInjectStageID						VARCHAR(100),"
											 "IMMParaInjectStageRatio					DOUBLE DEFAULT 1.0,"
											 "IMMParaHoldStageName						VARCHAR(30) NOT NULL DEFAULT 'HoldStage'," // 10
											 "IMMParaHoldStageType						VARCHAR(1),"
											 "IMMParaHoldStageNS						varchar(10),"
											 "IMMParaHoldStageID						VARCHAR(100),"
											 "IMMParaHoldStageRatio						DOUBLE DEFAULT 1.0,"
											 "IMMParaPlasStageName						VARCHAR(30) NOT NULL DEFAULT 'PlasStage'," // 11
											 "IMMParaPlasStageType						VARCHAR(1),"
											 "IMMParaPlasStageNS						varchar(10),"
											 "IMMParaPlasStageID						VARCHAR(100),"
											 "IMMParaPlasStageRatio						DOUBLE DEFAULT 1.0,"
											 "IMMParaMeltTemperatureName				VARCHAR(30) NOT NULL DEFAULT 'MeltTemperature'," // 12
											 "IMMParaMeltTemperatureType				VARCHAR(1),"
											 "IMMParaMeltTemperatureNS					varchar(10),"
											 "IMMParaMeltTemperatureID					VARCHAR(100),"
											 "IMMParaMeltTemperatureRatio				DOUBLE DEFAULT 1.0,"
											 "IMMParaPlastificationVolume1Name			VARCHAR(30) NOT NULL DEFAULT 'PlastificationVolume1'," // 13
											 "IMMParaPlastificationVolume1Type			VARCHAR(1),"
											 "IMMParaPlastificationVolume1NS			varchar(10),"
											 "IMMParaPlastificationVolume1ID			VARCHAR(100),"
											 "IMMParaPlastificationVolume1Ratio			DOUBLE DEFAULT 1.0,"
											 "IMMParaPlastificationVolume2Name			VARCHAR(30) NOT NULL DEFAULT 'PlastificationVolume2'," // 14
											 "IMMParaPlastificationVolume2Type			VARCHAR(1),"
											 "IMMParaPlastificationVolume2NS			varchar(10),"
											 "IMMParaPlastificationVolume2ID			VARCHAR(100),"
											 "IMMParaPlastificationVolume2Ratio			DOUBLE DEFAULT 1.0,"
											 "IMMParaPlastificationVolume3Name			VARCHAR(30) NOT NULL DEFAULT 'PlastificationVolume3'," // 15
											 "IMMParaPlastificationVolume3Type			VARCHAR(1),"
											 "IMMParaPlastificationVolume3NS			varchar(10),"
											 "IMMParaPlastificationVolume3ID			VARCHAR(100),"
											 "IMMParaPlastificationVolume3Ratio			DOUBLE DEFAULT 1.0,"
											 "IMMParaPlastificationVolume4Name			VARCHAR(30) NOT NULL DEFAULT 'PlastificationVolume4'," // 16
											 "IMMParaPlastificationVolume4Type			VARCHAR(1),"
											 "IMMParaPlastificationVolume4NS			varchar(10),"
											 "IMMParaPlastificationVolume4ID			VARCHAR(100),"
											 "IMMParaPlastificationVolume4Ratio			DOUBLE DEFAULT 1.0,"
											 "IMMParaPlastificationVolume5Name			VARCHAR(30) NOT NULL DEFAULT 'PlastificationVolume5'," // 17
											 "IMMParaPlastificationVolume5Type			VARCHAR(1),"
											 "IMMParaPlastificationVolume5NS			varchar(10),"
											 "IMMParaPlastificationVolume5ID			VARCHAR(100),"
											 "IMMParaPlastificationVolume5Ratio			DOUBLE DEFAULT 1.0,"
											 "IMMParaInjectionPressure1Name				VARCHAR(30) NOT NULL DEFAULT 'InjectionPressure1'," // 18
											 "IMMParaInjectionPressure1Type				VARCHAR(1),"
											 "IMMParaInjectionPressure1NS				varchar(10),"
											 "IMMParaInjectionPressure1ID				VARCHAR(100),"
											 "IMMParaInjectionPressure1Ratio			DOUBLE DEFAULT 1.0,"
											 "IMMParaInjectionPressure2Name				VARCHAR(30) NOT NULL DEFAULT 'InjectionPressure2'," // 19
											 "IMMParaInjectionPressure2Type				VARCHAR(1),"
											 "IMMParaInjectionPressure2NS				varchar(10),"
											 "IMMParaInjectionPressure2ID				VARCHAR(100),"
											 "IMMParaInjectionPressure2Ratio			DOUBLE DEFAULT 1.0,"
											 "IMMParaInjectionPressure3Name				VARCHAR(30) NOT NULL DEFAULT 'InjectionPressure3'," // 20
											 "IMMParaInjectionPressure3Type				VARCHAR(1),"
											 "IMMParaInjectionPressure3NS				varchar(10),"
											 "IMMParaInjectionPressure3ID				VARCHAR(100),"
											 "IMMParaInjectionPressure3Ratio			DOUBLE DEFAULT 1.0,"
											 "IMMParaInjectionPressure4Name				VARCHAR(30) NOT NULL DEFAULT 'InjectionPressure4'," // 21
											 "IMMParaInjectionPressure4Type				VARCHAR(1),"
											 "IMMParaInjectionPressure4NS				varchar(10),"
											 "IMMParaInjectionPressure4ID				VARCHAR(100),"
											 "IMMParaInjectionPressure4Ratio			DOUBLE DEFAULT 1.0,"
											 "IMMParaInjectionPressure5Name				VARCHAR(30) NOT NULL DEFAULT 'InjectionPressure5'," // 22
											 "IMMParaInjectionPressure5Type				VARCHAR(1),"
											 "IMMParaInjectionPressure5NS				varchar(10),"
											 "IMMParaInjectionPressure5ID				VARCHAR(100),"
											 "IMMParaInjectionPressure5Ratio			DOUBLE DEFAULT 1.0,"
											 "IMMParaInjectionSpeed1Name				VARCHAR(30) NOT NULL DEFAULT 'InjectionSpeed1'," // 23
											 "IMMParaInjectionSpeed1Type				VARCHAR(1),"
											 "IMMParaInjectionSpeed1NS					varchar(10),"
											 "IMMParaInjectionSpeed1ID					VARCHAR(100),"
											 "IMMParaInjectionSpeed1Ratio				DOUBLE DEFAULT 1.0,"
											 "IMMParaInjectionSpeed2Name				VARCHAR(30) NOT NULL DEFAULT 'InjectionSpeed2'," // 24
											 "IMMParaInjectionSpeed2Type				VARCHAR(1),"
											 "IMMParaInjectionSpeed2NS					varchar(10),"
											 "IMMParaInjectionSpeed2ID					VARCHAR(100),"
											 "IMMParaInjectionSpeed2Ratio				DOUBLE DEFAULT 1.0,"
											 "IMMParaInjectionSpeed3Name				VARCHAR(30) NOT NULL DEFAULT 'InjectionSpeed3'," // 25
											 "IMMParaInjectionSpeed3Type				VARCHAR(1),"
											 "IMMParaInjectionSpeed3NS					varchar(10),"
											 "IMMParaInjectionSpeed3ID					VARCHAR(100),"
											 "IMMParaInjectionSpeed3Ratio				DOUBLE DEFAULT 1.0,"
											 "IMMParaInjectionSpeed4Name				VARCHAR(30) NOT NULL DEFAULT 'InjectionSpeed4'," // 26
											 "IMMParaInjectionSpeed4Type				VARCHAR(1),"
											 "IMMParaInjectionSpeed4NS					varchar(10),"
											 "IMMParaInjectionSpeed4ID					VARCHAR(100),"
											 "IMMParaInjectionSpeed4Ratio				DOUBLE DEFAULT 1.0,"
											 "IMMParaInjectionSpeed5Name				VARCHAR(30) NOT NULL DEFAULT 'InjectionSpeed5'," // 27
											 "IMMParaInjectionSpeed5Type				VARCHAR(1),"
											 "IMMParaInjectionSpeed5NS					varchar(10),"
											 "IMMParaInjectionSpeed5ID					VARCHAR(100),"
											 "IMMParaInjectionSpeed5Ratio				DOUBLE DEFAULT 1.0,"
											 "IMMParaVPChangeOverPositionName			VARCHAR(30) NOT NULL DEFAULT 'VPChangeOverPosition'," // 28
											 "IMMParaVPChangeOverPositionType			VARCHAR(1),"
											 "IMMParaVPChangeOverPositionNS				varchar(10),"
											 "IMMParaVPChangeOverPositionID				VARCHAR(100),"
											 "IMMParaVPChangeOverPositionRatio			DOUBLE DEFAULT 1.0,"
											 "IMMParaVPChangeOverTimeName				VARCHAR(30) NOT NULL DEFAULT 'VPChangeOverTime'," // 29
											 "IMMParaVPChangeOverTimeType				VARCHAR(1),"
											 "IMMParaVPChangeOverTimeNS					varchar(10),"
											 "IMMParaVPChangeOverTimeID					VARCHAR(100),"
											 "IMMParaVPChangeOverTimeRatio				DOUBLE DEFAULT 1.0,"
											 "IMMParaPackingPressureName				VARCHAR(30) NOT NULL DEFAULT 'PackingPressure'," // 30
											 "IMMParaPackingPressureType				VARCHAR(1),"
											 "IMMParaPackingPressureNS					varchar(10),"
											 "IMMParaPackingPressureID					VARCHAR(100),"
											 "IMMParaPackingPressureRatio				DOUBLE DEFAULT 1.0,"
											 "IMMParaHoldingPressure1Name				VARCHAR(30) NOT NULL DEFAULT 'HoldingPressure1'," // 31
											 "IMMParaHoldingPressure1Type				VARCHAR(1),"
											 "IMMParaHoldingPressure1NS					varchar(10),"
											 "IMMParaHoldingPressure1ID					VARCHAR(100),"
											 "IMMParaHoldingPressure1Ratio				DOUBLE DEFAULT 1.0,"
											 "IMMParaHoldingPressure2Name				VARCHAR(30) NOT NULL DEFAULT 'HoldingPressure2'," // 32
											 "IMMParaHoldingPressure2Type				VARCHAR(1),"
											 "IMMParaHoldingPressure2NS					varchar(10),"
											 "IMMParaHoldingPressure2ID					VARCHAR(100),"
											 "IMMParaHoldingPressure2Ratio				DOUBLE DEFAULT 1.0,"
											 "IMMParaHoldingPressure3Name				VARCHAR(30) NOT NULL DEFAULT 'HoldingPressure3'," // 33
											 "IMMParaHoldingPressure3Type				VARCHAR(1),"
											 "IMMParaHoldingPressure3NS					varchar(10),"
											 "IMMParaHoldingPressure3ID					VARCHAR(100),"
											 "IMMParaHoldingPressure3Ratio				DOUBLE DEFAULT 1.0,"
											 "IMMParaHoldingPressure4Name				VARCHAR(30) NOT NULL DEFAULT 'HoldingPressure4'," // 34
											 "IMMParaHoldingPressure4Type				VARCHAR(1),"
											 "IMMParaHoldingPressure4NS					varchar(10),"
											 "IMMParaHoldingPressure4ID					VARCHAR(100),"
											 "IMMParaHoldingPressure4Ratio				DOUBLE DEFAULT 1.0,"
											 "IMMParaHoldingPressure5Name				VARCHAR(30) NOT NULL DEFAULT 'HoldingPressure5'," // 35
											 "IMMParaHoldingPressure5Type				VARCHAR(1),"
											 "IMMParaHoldingPressure5NS					varchar(10),"
											 "IMMParaHoldingPressure5ID					VARCHAR(100),"
											 "IMMParaHoldingPressure5Ratio				DOUBLE DEFAULT 1.0,"
											 "IMMParaPackingTimeName					VARCHAR(30) NOT NULL DEFAULT 'PackingTime'," // 36
											 "IMMParaPackingTimeType					VARCHAR(1),"
											 "IMMParaPackingTimeNS						varchar(10),"
											 "IMMParaPackingTimeID						VARCHAR(100),"
											 "IMMParaPackingTimeRatio					DOUBLE DEFAULT 1.0,"
											 "IMMParaHoldingTime1Name					VARCHAR(30) NOT NULL DEFAULT 'HoldingTime1'," // 37
											 "IMMParaHoldingTime1Type					VARCHAR(1),"
											 "IMMParaHoldingTime1NS						varchar(10),"
											 "IMMParaHoldingTime1ID						VARCHAR(100),"
											 "IMMParaHoldingTime1Ratio					DOUBLE DEFAULT 1.0,"
											 "IMMParaHoldingTime2Name					VARCHAR(30) NOT NULL DEFAULT 'HoldingTime2'," // 38
											 "IMMParaHoldingTime2Type					VARCHAR(1),"
											 "IMMParaHoldingTime2NS						varchar(10),"
											 "IMMParaHoldingTime2ID						VARCHAR(100),"
											 "IMMParaHoldingTime2Ratio					DOUBLE DEFAULT 1.0,"
											 "IMMParaHoldingTime3Name					VARCHAR(30) NOT NULL DEFAULT 'HoldingTime3'," // 39
											 "IMMParaHoldingTime3Type					VARCHAR(1),"
											 "IMMParaHoldingTime3NS						varchar(10),"
											 "IMMParaHoldingTime3ID						VARCHAR(100),"
											 "IMMParaHoldingTime3Ratio					DOUBLE DEFAULT 1.0,"
											 "IMMParaHoldingTime4Name					VARCHAR(30) NOT NULL DEFAULT 'HoldingTime4'," // 40
											 "IMMParaHoldingTime4Type					VARCHAR(1),"
											 "IMMParaHoldingTime4NS						varchar(10),"
											 "IMMParaHoldingTime4ID						VARCHAR(100),"
											 "IMMParaHoldingTime4Ratio					DOUBLE DEFAULT 1.0,"
											 "IMMParaHoldingTime5Name					VARCHAR(30) NOT NULL DEFAULT 'HoldingTime5'," // 41
											 "IMMParaHoldingTime5Type					VARCHAR(1),"
											 "IMMParaHoldingTime5NS						varchar(10),"
											 "IMMParaHoldingTime5ID						VARCHAR(100),"
											 "IMMParaHoldingTime5Ratio					DOUBLE DEFAULT 1.0,"
											 "IMMParaCoolingTimeName					VARCHAR(30) NOT NULL DEFAULT 'CoolingTime'," // 42
											 "IMMParaCoolingTimeType					VARCHAR(1),"
											 "IMMParaCoolingTimeNS						varchar(10),"
											 "IMMParaCoolingTimeID						VARCHAR(100),"
											 "IMMParaCoolingTimeRatio					DOUBLE DEFAULT 1.0,"
											 "IMMParaScrewRPM1Name						VARCHAR(30) NOT NULL DEFAULT 'ScrewRPM1'," // 43
											 "IMMParaScrewRPM1Type						VARCHAR(1),"
											 "IMMParaScrewRPM1NS						varchar(10),"
											 "IMMParaScrewRPM1ID						VARCHAR(100),"
											 "IMMParaScrewRPM1Ratio						DOUBLE DEFAULT 1.0,"
											 "IMMParaScrewRPM2Name						VARCHAR(30) NOT NULL DEFAULT 'ScrewRPM2'," // 44
											 "IMMParaScrewRPM2Type						VARCHAR(1),"
											 "IMMParaScrewRPM2NS						varchar(10),"
											 "IMMParaScrewRPM2ID						VARCHAR(100),"
											 "IMMParaScrewRPM2Ratio						DOUBLE DEFAULT 1.0,"
											 "IMMParaScrewRPM3Name						VARCHAR(30) NOT NULL DEFAULT 'ScrewRPM3'," // 45
											 "IMMParaScrewRPM3Type						VARCHAR(1),"
											 "IMMParaScrewRPM3NS						varchar(10),"
											 "IMMParaScrewRPM3ID						VARCHAR(100),"
											 "IMMParaScrewRPM3Ratio						DOUBLE DEFAULT 1.0,"
											 "IMMParaScrewRPM4Name						VARCHAR(30) NOT NULL DEFAULT 'ScrewRPM4'," // 46
											 "IMMParaScrewRPM4Type						VARCHAR(1),"
											 "IMMParaScrewRPM4NS						varchar(10),"
											 "IMMParaScrewRPM4ID						VARCHAR(100),"
											 "IMMParaScrewRPM4Ratio						DOUBLE DEFAULT 1.0,"
											 "IMMParaScrewRPM5Name						VARCHAR(30) NOT NULL DEFAULT 'ScrewRPM5'," // 47
											 "IMMParaScrewRPM5Type						VARCHAR(1),"
											 "IMMParaScrewRPM5NS						varchar(10),"
											 "IMMParaScrewRPM5ID						VARCHAR(100),"
											 "IMMParaScrewRPM5Ratio						DOUBLE DEFAULT 1.0,"
											 "IMMParaBackPressure1Name					VARCHAR(30) NOT NULL DEFAULT 'BackPressure1'," // 48
											 "IMMParaBackPressure1Type					VARCHAR(1),"
											 "IMMParaBackPressure1NS					varchar(10),"
											 "IMMParaBackPressure1ID					VARCHAR(100),"
											 "IMMParaBackPressure1Ratio					DOUBLE DEFAULT 1.0,"
											 "IMMParaBackPressure2Name					VARCHAR(30) NOT NULL DEFAULT 'BackPressure2'," // 49
											 "IMMParaBackPressure2Type					VARCHAR(1),"
											 "IMMParaBackPressure2NS					varchar(10),"
											 "IMMParaBackPressure2ID					VARCHAR(100),"
											 "IMMParaBackPressure2Ratio					DOUBLE DEFAULT 1.0,"
											 "IMMParaBackPressure3Name					VARCHAR(30) NOT NULL DEFAULT 'BackPressure3'," // 50
											 "IMMParaBackPressure3Type					VARCHAR(1),"
											 "IMMParaBackPressure3NS					varchar(10),"
											 "IMMParaBackPressure3ID					VARCHAR(100),"
											 "IMMParaBackPressure3Ratio					DOUBLE DEFAULT 1.0,"
											 "IMMParaBackPressure4Name					VARCHAR(30) NOT NULL DEFAULT 'BackPressure4'," // 51
											 "IMMParaBackPressure4Type					VARCHAR(1),"
											 "IMMParaBackPressure4NS					varchar(10),"
											 "IMMParaBackPressure4ID					VARCHAR(100),"
											 "IMMParaBackPressure4Ratio					DOUBLE DEFAULT 1.0,"
											 "IMMParaBackPressure5Name					VARCHAR(30) NOT NULL DEFAULT 'BackPressure5'," // 52
											 "IMMParaBackPressure5Type					VARCHAR(1),"
											 "IMMParaBackPressure5NS					varchar(10),"
											 "IMMParaBackPressure5ID					VARCHAR(100),"
											 "IMMParaBackPressure5Ratio					DOUBLE DEFAULT 1.0,"
											 "IMMParaMoldTemperatureName				VARCHAR(30) NOT NULL DEFAULT 'MoldTemperature'," // 53
											 "IMMParaMoldTemperatureType				VARCHAR(1),"
											 "IMMParaMoldTemperatureNS					varchar(10),"
											 "IMMParaMoldTemperatureID					VARCHAR(100),"
											 "IMMParaMoldTemperatureRatio				DOUBLE DEFAULT 1.0,"
											 "IMMSensorCycleTimeName					VARCHAR(30) NOT NULL DEFAULT 'CycleTime'," // 54
											 "IMMSensorCycleTimeType					VARCHAR(1),"
											 "IMMSensorCycleTimeNS						varchar(10),"
											 "IMMSensorCycleTimeID						VARCHAR(100),"
											 "IMMSensorCycleTimeRatio					DOUBLE DEFAULT 1.0,"
											 "IMMSensorMoldClampingTimeName				VARCHAR(30) NOT NULL DEFAULT 'MoldClampingTime'," // 55
											 "IMMSensorMoldClampingTimeType				VARCHAR(1),"
											 "IMMSensorMoldClampingTimeNS				varchar(10),"
											 "IMMSensorMoldClampingTimeID				VARCHAR(100),"
											 "IMMSensorMoldClampingTimeRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorMoldReleasingTimeName			VARCHAR(30) NOT NULL DEFAULT 'MoldReleasingTime'," // 56
											 "IMMSensorMoldReleasingTimeType			VARCHAR(1),"
											 "IMMSensorMoldReleasingTimeNS				varchar(10),"
											 "IMMSensorMoldReleasingTimeID				VARCHAR(100),"
											 "IMMSensorMoldReleasingTimeRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorInjectionTimeName				VARCHAR(30) NOT NULL DEFAULT 'InjectionTime'," // 57
											 "IMMSensorInjectionTimeType				VARCHAR(1),"
											 "IMMSensorInjectionTimeNS					varchar(10),"
											 "IMMSensorInjectionTimeID					VARCHAR(100),"
											 "IMMSensorInjectionTimeRatio				DOUBLE DEFAULT 1.0,"
											 "IMMSensorVPChangeOverDelayTimeName		VARCHAR(30) NOT NULL DEFAULT 'VPChangeDelayTime'," // 58
											 "IMMSensorVPChangeOverDelayTimeType		VARCHAR(1),"
											 "IMMSensorVPChangeOverDelayTimeNS			varchar(10),"
											 "IMMSensorVPChangeOverDelayTimeID			VARCHAR(100),"
											 "IMMSensorVPChangeOverDelayTimeRatio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorHoldingTimeName					VARCHAR(30) NOT NULL DEFAULT 'HoldingTime'," // 59
											 "IMMSensorHoldingTimeType					VARCHAR(1),"
											 "IMMSensorHoldingTimeNS					varchar(10),"
											 "IMMSensorHoldingTimeID					VARCHAR(100),"
											 "IMMSensorHoldingTimeRatio					DOUBLE DEFAULT 1.0,"
											 "IMMSensorPlastificationTimeName			VARCHAR(30) NOT NULL DEFAULT 'PlastificationTime'," // 60
											 "IMMSensorPlastificationTimeType			VARCHAR(1),"
											 "IMMSensorPlastificationTimeNS				varchar(10),"
											 "IMMSensorPlastificationTimeID				VARCHAR(100),"
											 "IMMSensorPlastificationTimeRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorVPChangeOverPositionName			VARCHAR(30) NOT NULL DEFAULT 'VPChangeOverPosition'," // 61
											 "IMMSensorVPChangeOverPositionType			VARCHAR(1),"
											 "IMMSensorVPChangeOverPositionNS			varchar(10),"
											 "IMMSensorVPChangeOverPositionID			VARCHAR(100),"
											 "IMMSensorVPChangeOverPositionRatio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorCusionVolumeName					VARCHAR(30) NOT NULL DEFAULT 'CusionVolume'," // 62
											 "IMMSensorCusionVolumeType					VARCHAR(1),"
											 "IMMSensorCusionVolumeNS					varchar(10),"
											 "IMMSensorCusionVolumeID					VARCHAR(100),"
											 "IMMSensorCusionVolumeRatio				DOUBLE DEFAULT 1.0,"
											 "IMMSensorEndHoldingPositionName			VARCHAR(30) NOT NULL DEFAULT 'EndHoldingPosition'," // 63
											 "IMMSensorEndHoldingPositionType			VARCHAR(1),"
											 "IMMSensorEndHoldingPositionNS				varchar(10),"
											 "IMMSensorEndHoldingPositionID				VARCHAR(100),"
											 "IMMSensorEndHoldingPositionRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorEndPlastificationPositionName	VARCHAR(30) NOT NULL DEFAULT 'EndPlastificationPosition'," // 64
											 "IMMSensorEndPlastificationPositionType	VARCHAR(1),"
											 "IMMSensorEndPlastificationPositionNS		varchar(10),"
											 "IMMSensorEndPlastificationPositionID		VARCHAR(100),"
											 "IMMSensorEndPlastificationPositionRatio	DOUBLE DEFAULT 1.0,"
											 "IMMSensorNozzle1TemperatureName			VARCHAR(30) NOT NULL DEFAULT 'Nozzle1Temperature'," // 65
											 "IMMSensorNozzle1TemperatureType			VARCHAR(1),"
											 "IMMSensorNozzle1TemperatureNS				varchar(10),"
											 "IMMSensorNozzle1TemperatureID				VARCHAR(100),"
											 "IMMSensorNozzle1TemperatureRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorNozzle2TemperatureName			VARCHAR(30) NOT NULL DEFAULT 'Nozzle2Temperature'," // 66
											 "IMMSensorNozzle2TemperatureType			VARCHAR(1),"
											 "IMMSensorNozzle2TemperatureNS				varchar(10),"
											 "IMMSensorNozzle2TemperatureID				VARCHAR(100),"
											 "IMMSensorNozzle2TemperatureRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorNozzle3TemperatureName			VARCHAR(30) NOT NULL DEFAULT 'Nozzle3Temperature'," // 67
											 "IMMSensorNozzle3TemperatureType			VARCHAR(1),"
											 "IMMSensorNozzle3TemperatureNS				varchar(10),"
											 "IMMSensorNozzle3TemperatureID				VARCHAR(100),"
											 "IMMSensorNozzle3TemperatureRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorNozzle4TemperatureName			VARCHAR(30) NOT NULL DEFAULT 'Nozzle4Temperature'," // 68
											 "IMMSensorNozzle4TemperatureType			VARCHAR(1),"
											 "IMMSensorNozzle4TemperatureNS				varchar(10),"
											 "IMMSensorNozzle4TemperatureID				VARCHAR(100),"
											 "IMMSensorNozzle4TemperatureRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorNozzle5TemperatureName			VARCHAR(30) NOT NULL DEFAULT 'Nozzle5Temperature'," // 69
											 "IMMSensorNozzle5TemperatureType			VARCHAR(1),"
											 "IMMSensorNozzle5TemperatureNS				varchar(10),"
											 "IMMSensorNozzle5TemperatureID				VARCHAR(100),"
											 "IMMSensorNozzle5TemperatureRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorIMMOilTemperatureName			VARCHAR(30) NOT NULL DEFAULT 'IMMOilTemperature'," // 70
											 "IMMSensorIMMOilTemperatureType			VARCHAR(1),"
											 "IMMSensorIMMOilTemperatureNS				varchar(10),"
											 "IMMSensorIMMOilTemperatureID				VARCHAR(100),"
											 "IMMSensorIMMOilTemperatureRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorFallMaterialTemperatureName		VARCHAR(30) NOT NULL DEFAULT 'FallMaterialTemperature'," // 71
											 "IMMSensorFallMaterialTemperatureType		VARCHAR(1),"
											 "IMMSensorFallMaterialTemperatureNS		varchar(10),"
											 "IMMSensorFallMaterialTemperatureID		VARCHAR(100),"
											 "IMMSensorFallMaterialTemperatureRatio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorMaxInjectionPressureName			VARCHAR(30) NOT NULL DEFAULT 'MaxInjectionPressure'," // 72
											 "IMMSensorMaxInjectionPressureType			VARCHAR(1),"
											 "IMMSensorMaxInjectionPressureNS			varchar(10),"
											 "IMMSensorMaxInjectionPressureID			VARCHAR(100),"
											 "IMMSensorMaxInjectionPressureRatio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorVPChangeOverPressureName			VARCHAR(30) NOT NULL DEFAULT 'VPChangeOverPressure'," // 73
											 "IMMSensorVPChangeOverPressureType			VARCHAR(1),"
											 "IMMSensorVPChangeOverPressureNS			varchar(10),"
											 "IMMSensorVPChangeOverPressureID			VARCHAR(100),"
											 "IMMSensorVPChangeOverPressureRatio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorSumInjectionPressureName			VARCHAR(30) NOT NULL DEFAULT 'SumInjectionPressure'," // 74
											 "IMMSensorSumInjectionPressureType			VARCHAR(1),"
											 "IMMSensorSumInjectionPressureNS			varchar(10),"
											 "IMMSensorSumInjectionPressureID			VARCHAR(100),"
											 "IMMSensorSumInjectionPressureRatio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorSumHoldingPressureName			VARCHAR(30) NOT NULL DEFAULT 'SumHoldingPressure'," // 75
											 "IMMSensorSumHoldingPressureType			VARCHAR(1),"
											 "IMMSensorSumHoldingPressureNS				varchar(10),"
											 "IMMSensorSumHoldingPressureID				VARCHAR(100),"
											 "IMMSensorSumHoldingPressureRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorMaxCavityNearGatePressureName	VARCHAR(30) NOT NULL DEFAULT 'MaxCavityNearGatePressure'," // 76
											 "IMMSensorMaxCavityNearGatePressureType	VARCHAR(1),"
											 "IMMSensorMaxCavityNearGatePressureNS		varchar(10),"
											 "IMMSensorMaxCavityNearGatePressureID		VARCHAR(100),"
											 "IMMSensorMaxCavityNearGatePressureRatio	DOUBLE DEFAULT 1.0,"
											 "IMMSensorMaxCavityFarGatePressureName		VARCHAR(30) NOT NULL DEFAULT 'MaxCavityFarGatePressure'," // 77
											 "IMMSensorMaxCavityFarGatePressureType		VARCHAR(1),"
											 "IMMSensorMaxCavityFarGatePressureNS 		varchar(10),"
											 "IMMSensorMaxCavityFarGatePressureID		VARCHAR(100),"
											 "IMMSensorMaxCavityFarGatePressureRatio	DOUBLE DEFAULT 1.0,"
											 "IMMSensorSumCavityPressureName			VARCHAR(30) NOT NULL DEFAULT 'SumCavityPressure'," // 78
											 "IMMSensorSumCavityPressureType			VARCHAR(1),"
											 "IMMSensorSumCavityPressureNS				varchar(10),"
											 "IMMSensorSumCavityPressureID				VARCHAR(100),"
											 "IMMSensorSumCavityPressureRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorSumMoldClampingForceName			VARCHAR(30) NOT NULL DEFAULT 'SumMoldClampingForce'," // 79
											 "IMMSensorSumMoldClampingForceType			VARCHAR(1),"
											 "IMMSensorSumMoldClampingForceNS			varchar(10),"
											 "IMMSensorSumMoldClampingForceID			VARCHAR(100),"
											 "IMMSensorSumMoldClampingForceRatio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorMaxMoldClampingForceName			VARCHAR(30) NOT NULL DEFAULT 'MaxMoldClampingForce'," // 80
											 "IMMSensorMaxMoldClampingForceType			VARCHAR(1),"
											 "IMMSensorMaxMoldClampingForceNS			varchar(10),"
											 "IMMSensorMaxMoldClampingForceID			VARCHAR(100),"
											 "IMMSensorMaxMoldClampingForceRatio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorMaxBackPressureName				VARCHAR(30) NOT NULL DEFAULT 'BackPressure'," // 81
											 "IMMSensorMaxBackPressureType				VARCHAR(1),"
											 "IMMSensorMaxBackPressureNS				varchar(10),"
											 "IMMSensorMaxBackPressureID				VARCHAR(100),"
											 "IMMSensorMaxBackPressureRatio				DOUBLE DEFAULT 1.0,"
											 "IMMSensorDelayPlastificationTimeName		VARCHAR(30) NOT NULL DEFAULT 'DelayPlastificationTime'," // 82
											 "IMMSensorDelayPlastificationTimeType		VARCHAR(1),"
											 "IMMSensorDelayPlastificationTimeNS		varchar(10),"
											 "IMMSensorDelayPlastificationTimeID		VARCHAR(100),"
											 "IMMSensorDelayPlastificationTimeRatio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorInMoldCoolingTemperatureName		VARCHAR(30) NOT NULL DEFAULT 'InMoldCoolingTemperature'," // 83
											 "IMMSensorInMoldCoolingTemperatureType		VARCHAR(1),"
											 "IMMSensorInMoldCoolingTemperatureNS		varchar(10),"
											 "IMMSensorInMoldCoolingTemperatureID		VARCHAR(100),"
											 "IMMSensorInMoldCoolingTemperatureRatio	DOUBLE DEFAULT 1.0,"
											 "IMMSensorOutMoldCoolingTemperatureName	VARCHAR(30) NOT NULL DEFAULT 'OutMoldCoolingTemperature'," // 84
											 "IMMSensorOutMoldCoolingTemperatureType	VARCHAR(1),"
											 "IMMSensorOutMoldCoolingTemperatureNS		varchar(10),"
											 "IMMSensorOutMoldCoolingTemperatureID		VARCHAR(100),"
											 "IMMSensorOutMoldCoolingTemperatureRatio	DOUBLE DEFAULT 1.0,"
											 "IMMSensorMoldCoolingVolumeName			VARCHAR(30) NOT NULL DEFAULT 'MoldCoolingVolume'," // 85
											 "IMMSensorMoldCoolingVolumeType			VARCHAR(1),"
											 "IMMSensorMoldCoolingVolumeNS				varchar(10),"
											 "IMMSensorMoldCoolingVolumeID				VARCHAR(100),"
											 "IMMSensorMoldCoolingVolumeRatio			DOUBLE DEFAULT 1.0,"
											 "IMMSensorMoldReleasingPosition2Name		VARCHAR(30) NOT NULL DEFAULT 'MoldReleasingPosition2'," // 86
											 "IMMSensorMoldReleasingPosition2Type		VARCHAR(1),"
											 "IMMSensorMoldReleasingPosition2NS			varchar(10),"
											 "IMMSensorMoldReleasingPosition2ID			VARCHAR(100),"
											 "IMMSensorMoldReleasingPosition2Ratio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorMoldReleasingPosition3Name		VARCHAR(30) NOT NULL DEFAULT 'MoldReleasingPosition3'," // 87
											 "IMMSensorMoldReleasingPosition3Type		VARCHAR(1),"
											 "IMMSensorMoldReleasingPosition3NS			varchar(10),"
											 "IMMSensorMoldReleasingPosition3ID			VARCHAR(100),"
											 "IMMSensorMoldReleasingPosition3Ratio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorMoldReleasingPosition4Name		VARCHAR(30) NOT NULL DEFAULT 'MoldReleasingPosition4'," // 88
											 "IMMSensorMoldReleasingPosition4Type		VARCHAR(1),"
											 "IMMSensorMoldReleasingPosition4NS			varchar(10),"
											 "IMMSensorMoldReleasingPosition4ID			VARCHAR(100),"
											 "IMMSensorMoldReleasingPosition4Ratio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorMoldReleasingPosition5Name		VARCHAR(30) NOT NULL DEFAULT 'MoldReleasingPosition5'," // 89
											 "IMMSensorMoldReleasingPosition5Type		VARCHAR(1),"
											 "IMMSensorMoldReleasingPosition5NS			varchar(10),"
											 "IMMSensorMoldReleasingPosition5ID			VARCHAR(100),"
											 "IMMSensorMoldReleasingPosition5Ratio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorScrewSuckBackPositionName		VARCHAR(30) NOT NULL DEFAULT 'ScrewSuckBackPosition'," // 90
											 "IMMSensorScrewSuckBackPositionType		VARCHAR(1),"
											 "IMMSensorScrewSuckBackPositionNS			varchar(10),"
											 "IMMSensorScrewSuckBackPositionID			VARCHAR(100),"
											 "IMMSensorScrewSuckBackPositionRatio		DOUBLE DEFAULT 1.0,"
											 "IMMSensorScrewRPMName						VARCHAR(30) NOT NULL DEFAULT 'ScrewRPM'," // 91
											 "IMMSensorScrewRPMType						VARCHAR(1),"
											 "IMMSensorScrewRPMNS						varchar(10),"
											 "IMMSensorScrewRPMID						VARCHAR(100),"
											 "IMMSensorScrewRPMRatio					DOUBLE DEFAULT 1.0,"
											 "IMMSensorPartWeightName					VARCHAR(30) NOT NULL DEFAULT 'PartWeight'," // 92
											 "IMMSensorPartWeightType					VARCHAR(1),"
											 "IMMSensorPartWeightNS						varchar(10),"
											 "IMMSensorPartWeightID						VARCHAR(100),"
											 "IMMSensorPartWeightRatio					DOUBLE DEFAULT 1.0,"
											 "IMMSensorGateClosingTimeName				VARCHAR(30) NOT NULL DEFAULT 'GateClosingTime'," // 93
											 "IMMSensorGateClosingTimeType				VARCHAR(1),"
											 "IMMSensorGateClosingTimeNS				varchar(10),"
											 "IMMSensorGateClosingTimeID				VARCHAR(100),"
											 "IMMSensorGateClosingTimeRatio				DOUBLE DEFAULT 1.0,"
											 "IMMSensorMeltTemperatureName				VARCHAR(30) NOT NULL DEFAULT 'MeltTemperature'," // 94
											 "IMMSensorMeltTemperatureType				VARCHAR(1),"
											 "IMMSensorMeltTemperatureNS				varchar(10),"
											 "IMMSensorMeltTemperatureID				VARCHAR(100),"
											 "IMMSensorMeltTemperatureRatio				DOUBLE DEFAULT 1.0,"
											 "IMMSensorMoldTemperatureName				VARCHAR(30) NOT NULL DEFAULT 'MoldTemperature'," // 95
											 "IMMSensorMoldTemperatureType				VARCHAR(1),"
											 "IMMSensorMoldTemperatureNS				varchar(10),"
											 "IMMSensorMoldTemperatureID				VARCHAR(100),"
											 "IMMSensorMoldTemperatureRatio				DOUBLE DEFAULT 1.0,"
											 "PRIMARY KEY (OPCUAVersionSN),"
											 "UNIQUE KEY (OPCUAVersionID))"
											 "ENGINE=MyISAM",
			 SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create table %s_%s.OPCUAVersionIndex (%d):%s",
				 SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Sys_Index.IMMModelIndex
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s.IMMModelIndex ("
											 "IMMModelSN	INT UNSIGNED NOT NULL,"
											 "IMMModelMask	TINYINT(1) DEFAULT 0,"
											 "IMMVendor 	VARCHAR(20) NOT NULL,"
											 "IMMModel		VARCHAR(20) NOT NULL,"
											 "IMMModelMeta	VARCHAR(250) DEFAULT NULL,"
											 "PRIMARY KEY 	(IMMModelSN),"
											 "UNIQUE KEY	(IMMVendor,IMMModel))"
											 "ENGINE=InnoDB",
			 SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create table %s_%s.IMMModelIndex (%d):%s",
				 SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Sys_Index.MaterialIndex
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s.MaterialIndex ("
											 "MaterialSN	INT UNSIGNED NOT NULL,"
											 "MaterialMask	TINYINT(1) DEFAULT 0,"
											 "MaterialID	VARCHAR(50) NOT NULL,"
											 "MaterialMeta	VARCHAR(250) DEFAULT NULL,"
											 "PRIMARY KEY (MaterialSN),"
											 "UNIQUE KEY(MaterialID))"
											 "ENGINE=InnoDB",
			 SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create table %s_%s.MaterialIndex (%d):%s",
				 SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Sys_Index.SensorIndex
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s.CustomSensorModelIndex ("
											 "CustomSensorModelSN		INT UNSIGNED NOT NULL,"
											 "CustomSensorModelMask		TINYINT(1) DEFAULT 0,"
											 "CustomSensorClass			INT UNSIGNED NOT NULL,"
											 "CustomSensorCategory		INT UNSIGNED NOT NULL,"
											 "CustomSensorVendor		VARCHAR(50) NOT NULL,"
											 "CustomSensorModel			VARCHAR(50) NOT NULL,"
											 "CustomSensorModelMeta		VARCHAR(250) DEFAULT NULL,"
											 "PRIMARY KEY (CustomSensorModelSN),"
											 "UNIQUE KEY(CustomSensorClass,CustomSensorVendor,CustomSensorCategory,CustomSensorModel))"
											 "ENGINE=InnoDB",
			 SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create table %s_%s.CustomSensorModelIndex (%d):%s",
				 SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Sys_Index.MoldIndex
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s.MoldIndex ("
											 "MoldSN		INT UNSIGNED NOT NULL,"
											 "MoldMask		TINYINT(1) DEFAULT 0,"
											 "MoldVendor 	VARCHAR(50) NOT NULL,"
											 "MoldID		VARCHAR(50) NOT NULL,"
											 "MoldMeta		VARCHAR(250) DEFAULT NULL,"
											 "PRIMARY KEY (MoldSN),"
											 "UNIQUE KEY(MoldVendor,MoldID))"
											 "ENGINE=InnoDB",
			 SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create table %s_%s.MoldIndex (%d):%s",
				 SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Sys_Index.ProdIndex
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s.ProdIndex ("
											 "ProdSN	INT UNSIGNED NOT NULL,"
											 "ProdMask	TINYINT(1) DEFAULT 0,"
											 "ProdID 	VARCHAR(50) NOT NULL,"
											 "ProdMeta	VARCHAR(250) DEFAULT NULL,"
											 "PRIMARY KEY (ProdSN),"
											 "UNIQUE KEY(ProdID))"
											 "ENGINE=InnoDB",
			 SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create table %s_%s.ProdIndex (%d):%s",
				 SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Sys_Index.AcceptCriteriaIndex
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s.AcceptCriteriaIndex ("
											 "AcceptCriteriaSN			INT UNSIGNED NOT NULL,"
											 "AcceptCriteriaMask		TINYINT(1) DEFAULT 0,"
											 "AcceptCriteriaID 			VARCHAR(50) NOT NULL,"
											 "PRIMARY KEY (AcceptCriteriaSN),"
											 "UNIQUE KEY(AcceptCriteriaID))"
											 "ENGINE=InnoDB",
			 SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create table %s_%s.AcceptCriteriaIndex (%d):%s",
				 SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Sys_Index.SPCIndex
	/*
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s.SPCIndex ("
											 "MoldSN						INT UNSIGNED NOT NULL,"
											 "ProdSN						INT UNSIGNED NOT NULL,"
											 "SPCMasked						TINYINT(1) DEFAULT 0,"
											 "XUCL3NGMaxPressure			DOUBLE DEFAULT NULL,"
											 "XUCL2NGMaxPressure			DOUBLE DEFAULT NULL,"
											 "XUCL1NGMaxPressure			DOUBLE DEFAULT NULL,"
											 "XCLNGMaxPressure				DOUBLE DEFAULT NULL,"
											 "XLCL1NGMaxPressure			DOUBLE DEFAULT NULL,"
											 "XLCL2NGMaxPressure			DOUBLE DEFAULT NULL,"
											 "XLCL3NGMaxPressure			DOUBLE DEFAULT NULL,"

											 "XUCL3NGSumStage1Pressure		DOUBLE DEFAULT NULL,"
											 "XUCL2NGSumStage1Pressure		DOUBLE DEFAULT NULL,"
											 "XUCL1NGSumStage1Pressure		DOUBLE DEFAULT NULL,"
											 "XCLNGSumStage1Pressure		DOUBLE DEFAULT NULL,"
											 "XLCL1NGSumStage1Pressure		DOUBLE DEFAULT NULL,"
											 "XLCL2NGSumStage1Pressure		DOUBLE DEFAULT NULL,"
											 "XLCL3NGSumStage1Pressure		DOUBLE DEFAULT NULL,"

											 "XUCL3NGMaxPressureTime		DOUBLE DEFAULT NULL,"
											 "XUCL2NGMaxPressureTime		DOUBLE DEFAULT NULL,"
											 "XUCL1NGMaxPressureTime		DOUBLE DEFAULT NULL,"
											 "XCLNGMaxPressureTime			DOUBLE DEFAULT NULL,"
											 "XLCL1NGMaxPressureTime		DOUBLE DEFAULT NULL,"
											 "XLCL2NGMaxPressureTime		DOUBLE DEFAULT NULL,"
											 "XLCL3NGMaxPressureTime		DOUBLE DEFAULT NULL,"

											 "XUCL3NGAvgStage1Slope			DOUBLE DEFAULT NULL,"
											 "XUCL2NGAvgStage1Slope			DOUBLE DEFAULT NULL,"
											 "XUCL1NGAvgStage1Slope			DOUBLE DEFAULT NULL,"
											 "XCLNGAvgStage1Slope			DOUBLE DEFAULT NULL,"
											 "XLCL1NGAvgStage1Slope			DOUBLE DEFAULT NULL,"
											 "XLCL2NGAvgStage1Slope			DOUBLE DEFAULT NULL,"
											 "XLCL3NGAvgStage1Slope			DOUBLE DEFAULT NULL,"

											 "XUCL3NGAvgStage2Slope			DOUBLE DEFAULT NULL,"
											 "XUCL2NGAvgStage2Slope			DOUBLE DEFAULT NULL,"
											 "XUCL1NGAvgStage2Slope			DOUBLE DEFAULT NULL,"
											 "XCLNGAvgStage2Slope			DOUBLE DEFAULT NULL,"
											 "XLCL1NGAvgStage2Slope			DOUBLE DEFAULT NULL,"
											 "XLCL2NGAvgStage2Slope			DOUBLE DEFAULT NULL,"
											 "XLCL3NGAvgStage2Slope			DOUBLE DEFAULT NULL,"

											 "XUCL3NGMoldReleasePressure	DOUBLE DEFAULT NULL,"
											 "XUCL2NGMoldReleasePressure	DOUBLE DEFAULT NULL,"
											 "XUCL1NGMoldReleasePressure	DOUBLE DEFAULT NULL,"
											 "XCLNGMoldReleasePressure		DOUBLE DEFAULT NULL,"
											 "XLCL1NGMoldReleasePressure	DOUBLE DEFAULT NULL,"
											 "XLCL2NGMoldReleasePressure	DOUBLE DEFAULT NULL,"
											 "XLCL3NGMoldReleasePressure	DOUBLE DEFAULT NULL,"

											 "XUCL3DiffMaxPressure			DOUBLE DEFAULT NULL,"
											 "XUCL2DiffMaxPressure			DOUBLE DEFAULT NULL,"
											 "XUCL1DiffMaxPressure			DOUBLE DEFAULT NULL,"
											 "XCLDiffMaxPressure			DOUBLE DEFAULT NULL,"
											 "XLCL1DiffMaxPressure			DOUBLE DEFAULT NULL,"
											 "XLCL2DiffMaxPressure			DOUBLE DEFAULT NULL,"
											 "XLCL3DiffMaxPressure			DOUBLE DEFAULT NULL,"

											 "XUCL3DiffIncreasePressureTime	DOUBLE DEFAULT NULL,"
											 "XUCL2DiffIncreasePressureTime	DOUBLE DEFAULT NULL,"
											 "XUCL1DiffIncreasePressureTime	DOUBLE DEFAULT NULL,"
											 "XCLDiffIncreasePressureTime	DOUBLE DEFAULT NULL,"
											 "XLCL1DiffIncreasePressureTime	DOUBLE DEFAULT NULL,"
											 "XLCL2DiffIncreasePressureTime	DOUBLE DEFAULT NULL,"
											 "XLCL3DiffIncreasePressureTime	DOUBLE DEFAULT NULL,"

											 "XUCL3DiffMoldReleasePressure	DOUBLE DEFAULT NULL,"
											 "XUCL2DiffMoldReleasePressure	DOUBLE DEFAULT NULL,"
											 "XUCL1DiffMoldReleasePressure	DOUBLE DEFAULT NULL,"
											 "XCLDiffMoldReleasePressure	DOUBLE DEFAULT NULL,"
											 "XLCL1DiffMoldReleasePressure	DOUBLE DEFAULT NULL,"
											 "XLCL2DiffMoldReleasePressure	DOUBLE DEFAULT NULL,"
											 "XLCL3DiffMoldReleasePressure	DOUBLE DEFAULT NULL,"

											 "CONSTRAINT SPCIndex_MoldSN FOREIGN KEY (MoldSN) REFERENCES %s_%s.MoldIndex (MoldSN) ON DELETE CASCADE ON UPDATE CASCADE,"
											 "CONSTRAINT SPCIndex_ProdSN FOREIGN KEY (ProdSN) REFERENCES %s_%s.ProdIndex (ProdSN) ON DELETE CASCADE ON UPDATE CASCADE,"
											 "UNIQUE KEY (MoldSN,ProdSN))"
											 "ENGINE=InnoDB",
			 SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create table %s_%s.SPCIndex (%d):%s",
				 SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	*/

	// Insert Default Accept Criteria
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, &intInsertAcceptCriteriaSN, "Quality");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, &intInsertAcceptCriteriaSN, "Weight");
	/*
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "Flash");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "Warpage");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "Shrinkage");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "Short");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "StickinginCavity");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "StickingonCore");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "Discoloration");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "Brittleness");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "Jetting");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "BlackSpecks");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "SilverStreak");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "SplayMarks");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "SinkMark");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "Voids");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "BurnMarks");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "WeldingLine");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "Thick");
	intRetval = INDEX_InsertAcceptCriteria(mysqlCon, "Length");
	*/

	// Create Database INJPRO_Data
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create database %s_%s (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Data.IMMSNList
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s.IMMSNList ("
											 "IMMSN						INT UNSIGNED NOT NULL,"
											 "PrimaryIMM				TINYINT(1) DEFAULT 0,"
											 "IMMID						VARCHAR(20) NOT NULL,"
											 "IMMMask					TINYINT(1) DEFAULT 0,"
											 "IMMModelSN				INT UNSIGNED DEFAULT NULL,"
											 "IMMStationID				INT UNSIGNED DEFAULT NULL,"

											 "MOSN						INT UNSIGNED DEFAULT NULL,"
											 "RoundSN					INT UNSIGNED DEFAULT NULL,"
											 "MoldStatus				INT UNSIGNED DEFAULT NULL,"
											 "ShotSN					BIGINT UNSIGNED DEFAULT NULL,"

											 "OPCUAVersionSN			INT UNSIGNED DEFAULT NULL,"
											 "OPCUAIP					VARCHAR(15) DEFAULT NULL,"
											 "OPCUAPort					VARCHAR(5) DEFAULT NULL,"
											 "OPCUAUserName				VARCHAR(20) DEFAULT NULL,"
											 "OPCUAPassword				VARCHAR(20) DEFAULT NULL,"

											 "ModbusIP					VARCHAR(15) DEFAULT NULL,"
											 "ModbusPort				VARCHAR(5) DEFAULT NULL,"
											 "ModbusMoldSignalSource	INT UNSIGNED NOT NULL,"
											 "ModbusMoldSignalType		INT UNSIGNED DEFAULT NULL,"

											 "TechnicianUserSN			INT UNSIGNED DEFAULT NULL,"
											 "OperatorUserSN			INT UNSIGNED DEFAULT NULL,"

											 "IMMStatus					INT UNSIGNED DEFAULT %d,"
											 "OPCUAClientStatus			INT UNSIGNED DEFAULT %d,"
											 "OPCUAClientPID			INT UNSIGNED DEFAULT NULL,"
											 "ModbusClientStatus		INT UNSIGNED DEFAULT %d,"
											 "ModbusClientPID			INT UNSIGNED DEFAULT NULL,"
											 "SPCRuleStatus				INT UNSIGNED DEFAULT %d,"
											 "AIStatus					INT UNSIGNED DEFAULT %d,"
											 "AIEnginePID				INT UNSIGNED DEFAULT NULL,"

											 "WebServiceIP				VARCHAR(15) DEFAULT NULL,"
											 "AutoOPCUAControl			TINYINT(1) DEFAULT 0,"

											 "IMMSyncFail				TINYINT(1) DEFAULT %d,"

											 "IMMInsertTime				DATETIME NOT NULL,"
											 "IMMLastUpdateTime			DATETIME,"
											 "PRIMARY KEY (IMMSN),"
											 "CONSTRAINT IMMSNList_IMMModelSN FOREIGN KEY (IMMModelSN) REFERENCES %s_%s.IMMModelIndex (IMMModelSN) ON UPDATE CASCADE,"
											 "UNIQUE KEY (IMMStationID),"
											 "UNIQUE KEY (IMMStationID,MOSN),"
											 "UNIQUE KEY (WebServiceIP),"
											 "INDEX(IMMID,IMMModelSN,OPCUAVersionSN,MOSN,OPCUAIP))"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME,
			 IMM_LIGHT_STATUS_UNKNOW, OPCUA_CLIENT_STATUS_UNKNOW, MODBUS_CLIENT_STATUS_UNKNOW, SPC_RULE_STATUS_UNKNOW, AI_STATUS_UNKNOW, IMM_SYNC_FAIL_TRUE,
			 SYS_NAME, INDEX_DATABASE_NAME);
	// fprintf(stderr,"Q:%s\n",charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create table %s_%s.IMMSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Database INJPRO_Data_MO
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s_%s DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create database %s_%s_%s (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Data_MO.MOSNList
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s.MOSNList ("
											 "MOSN						INT UNSIGNED NOT NULL,"
											 "MOID						VARCHAR(50) NOT NULL,"
											 "ReferenceMOSN				INT UNSIGNED DEFAULT NULL,"
											 "MOMask					TINYINT(1) DEFAULT 0,"
											 "IMMSN						INT UNSIGNED NOT NULL,"
											 "OPCUAVersionSN			INT UNSIGNED DEFAULT NULL,"
											 "ProdSN					INT UNSIGNED NOT NULL,"
											 "MoldSN					INT UNSIGNED NOT NULL,"
											 "MaterialSN				INT UNSIGNED NOT NULL,"
											 "PiecePerShot				INT UNSIGNED NOT NULL,"
											 "ExpectedStartTime			DATETIME NOT NULL,"
											 "ExpectedEndTime			DATETIME NOT NULL,"
											 "ExpectedProdShot			BIGINT UNSIGNED NOT NULL,"
											 "ExpectedProdVolume		BIGINT UNSIGNED NOT NULL,"

											 "MOStatus					INT UNSIGNED DEFAULT %d,"
											 "MOYieldRateStatus			INT UNSIGNED DEFAULT %d,"
											 "MOProgressStatus			INT UNSIGNED DEFAULT %d,"

											 "CompletedShot				BIGINT UNSIGNED DEFAULT 0,"
											 "ProdShot 					BIGINT UNSIGNED DEFAULT 0,"
											 "ProdVolume				BIGINT UNSIGNED DEFAULT 0,"
											 "YieldRate					DOUBLE UNSIGNED DEFAULT 0,"
											 "MOProgress				DOUBLE UNSIGNED DEFAULT 0,"

											 "AcceptProdShot 			BIGINT UNSIGNED DEFAULT 0,"
											 "RejectProdShot 			BIGINT UNSIGNED DEFAULT 0,"

											 "StartNonOPEmptyShot		BIGINT UNSIGNED DEFAULT 0,"
											 "StartNonOPProdShot		BIGINT UNSIGNED DEFAULT 0,"
											 "OPEmptyShot 				BIGINT UNSIGNED DEFAULT 0,"
											 "OPProdShot	 			BIGINT UNSIGNED DEFAULT 0,"
											 "NonOPEmptyShot			BIGINT UNSIGNED DEFAULT 0,"
											 "NonOPProdShot	 			BIGINT UNSIGNED DEFAULT 0,"

											 "CumulativeRealTimeCarbonEmission				DOUBLE DEFAULT NULL,"
											 "CumulativeIndirectCarbonEmissionPropotion		DOUBLE DEFAULT NULL,"
											 "CumulativeDirectCarbonEmissionPropotion		DOUBLE DEFAULT NULL,"
											 "EstimatedCumulativePowerConsumption			DOUBLE DEFAULT NULL,"
											 "EstimatedCumulativeCarbonEmission				DOUBLE DEFAULT NULL,"

											 "OPPeriod  				DOUBLE UNSIGNED DEFAULT 0,"
											 "ActualStartTime 			DATETIME,"
											 "EstimatedEndTime			DATETIME DEFAULT NULL,"
											 "ActualEndTime 			DATETIME,"
											 "MOLastUpdateTime			DATETIME,"
											 "PRIMARY KEY (MOSN),"
											 "UNIQUE KEY (MOID),"
											 "CONSTRAINT MOSNList_IMMSN FOREIGN KEY (IMMSN) REFERENCES %s_%s.IMMSNList (IMMSN) ON UPDATE CASCADE,"
											 "CONSTRAINT MOSNList_ProdSN FOREIGN KEY (ProdSN) REFERENCES %s_%s.ProdIndex (ProdSN) ON UPDATE CASCADE,"
											 "CONSTRAINT MOSNList_MoldSN FOREIGN KEY (MoldSN) REFERENCES %s_%s.MoldIndex (MoldSN) ON UPDATE CASCADE,"
											 "CONSTRAINT MOSNList_MaterialSN FOREIGN KEY (MaterialSN) REFERENCES %s_%s.MaterialIndex (MaterialSN) ON UPDATE CASCADE)"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME,
			 MO_STATUS_REGISTERED, MO_YIELDRATE_STATUS_UNKNOW, MO_PROGRESS_STATUS_UNKNOW,
			 SYS_NAME, DATA_DATABASE_NAME,
			 SYS_NAME, INDEX_DATABASE_NAME,
			 SYS_NAME, INDEX_DATABASE_NAME,
			 SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to create table %s_%s_%s.MOSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	/*
	//Create Database INJPRO_Data_NN
	snprintf(charStatement,MAX_STRING_SIZE,"CREATE DATABASE IF NOT EXISTS %s_%s_%s DEFAULT CHARACTER SET UTF8",
	 SYS_NAME,DATA_DATABASE_NAME,NN_DATABASE_NAME);
	intRetval=mysql_query(&mysqlCon,charStatement);
	if(intRetval!=EXIT_SUCCESS){
		snprintf(charErrMsg,LONG_STRING_SIZE,"[SYS_CreateSysDB]Fail to create database %s_%s_%s (%d):%s",
		 SYS_NAME,DATA_DATABASE_NAME,NN_DATABASE_NAME,mysql_errno(&mysqlCon),mysql_error(&mysqlCon));
		intLogSN=SYS_InsertSysErrMsg(mysqlCon,ERRCLASS_MYSQL,0,0,mysql_errno(&mysqlCon),charErrMsg);
		return intLogSN;
	}*/

	// Add Constraint For INJPRO_Data.IMMSNList(MOSN) to INJPRO_Data_MO.MOSNList(MOSN)
	snprintf(charStatement, MAX_STRING_SIZE,
			 "ALTER TABLE %s_%s.IMMSNList ADD CONSTRAINT IMMSNList_MOSN FOREIGN KEY (MOSN) REFERENCES %s_%s_%s.MOSNList (MOSN) ON DELETE CASCADE ON UPDATE CASCADE",
			 SYS_NAME, DATA_DATABASE_NAME,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_CreateSysDB]Fail to add constraint %s_%s.IMMSNList(MOSN) to %s_%s_%s.MOSNList(MOSN) (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int SYS_DropSysDB(MYSQL mysqlCon)
//[System]Drop All System Database
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	int intExitStatus = EXIT_SUCCESS;
	unsigned int intLogSN;

	// Drop Database INJPRO_Sys_Log
	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s", SYS_NAME, LOG_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
#ifdef DEBUG_MODE
		fprintf(stderr, "[SYS_DropSysDB]Fail to drop database %s_%s (%d):%s\n",
				SYS_NAME, LOG_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
#endif
		intExitStatus = EXIT_FAILURE;
	}

	// Drop Foreign Key IMMSNList_MOSN Reference to INJPRO_MO.MOSNList(MOSN)
	snprintf(charStatement, MAX_STRING_SIZE, "ALTER TABLE %s_%s.IMMSNList DROP FOREIGN KEY IMMSNList_MOSN", SYS_NAME, DATA_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
#ifdef DEBUG_MODE
		fprintf(stderr, "[SYS_DropSysDB]Fail to Drop Foreign Key IMMSNList_MOSN in Table %s_%s.IMMSNList (%d):%s\n",
				SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
#endif
		intExitStatus = EXIT_FAILURE;
	}

	// Drop Database INJPRO_Data_MO
	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
#ifdef DEBUG_MODE
		fprintf(stderr, "[SYS_DropSysDB]Fail to drop database %s_%s_%s (%d):%s\n",
				SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
#endif
		intExitStatus = EXIT_FAILURE;
	}

	// Drop Database INJPRO_Data
	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s", SYS_NAME, DATA_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
#ifdef DEBUG_MODE
		fprintf(stderr, "[SYS_DropSysDB]Fail to drop database %s_%s (%d):%s\n",
				SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
#endif
		intExitStatus = EXIT_FAILURE;
	}

	// Drop Database INJPRO_NN
	/*
	snprintf(charStatement,MAX_STRING_SIZE,"DROP DATABASE %s_%s_%s",SYS_NAME,DATA_DATABASE_NAME,NN_DATABASE_NAME);
	intRetval=mysql_query(&mysqlCon,charStatement);
	if(intRetval!=EXIT_SUCCESS){
		#ifdef DEBUG_MODE
		fprintf(stderr,"[SYS_DropSysDB]Fail to drop database %s_%s_%s (%d):%s\n",
		 SYS_NAME,DATA_DATABASE_NAME,NN_DATABASE_NAME,mysql_errno(&mysqlCon),mysql_error(&mysqlCon));
		#endif
		intExitStatus=EXIT_FAILURE;
	}*/

	// Drop Database INJPRO_Sys_Info
	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s", SYS_NAME, INFO_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
#ifdef DEBUG_MODE
		fprintf(stderr, "[SYS_DropSysDB]Fail to drop database %s_%s (%d):%s\n",
				SYS_NAME, INFO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
#endif
		intExitStatus = EXIT_FAILURE;
	}

	// Drop Database INJPRO_Sys_Index
	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s", SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
#ifdef DEBUG_MODE
		fprintf(stderr, "[SYS_DropSysDB]Fail to drop database %s_%s (%d):%s\n",
				SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
#endif
		intExitStatus = EXIT_FAILURE;
	}

	// Drop Database INJPRO_Sys_Config
	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s", SYS_NAME, CONFIG_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
#ifdef DEBUG_MODE
		fprintf(stderr, "[SYS_DropSysDB]Fail to drop database %s_%s (%d):%s\n",
				SYS_NAME, CONFIG_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
#endif
		intExitStatus = EXIT_FAILURE;
	}

	return intExitStatus;
}

int SYS_DeleteAllMO(MYSQL mysqlCon)
//[System]Delete All MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT MOSN FROM %s_%s_%s.MOSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SYS_DeleteAllMO]Fail to select all MOSN from %s_%s_%s.MOSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	MYSQL_RES *mysqlResult = mysql_store_result(&mysqlCon);
	MYSQL_ROW mysqlRow;
	unsigned int intMOSN;
	while ((mysqlRow = mysql_fetch_row(mysqlResult)) != NULL)
	{
		intMOSN = atoi(mysqlRow[0]);
		intRetval = MO_DeleteMO(mysqlCon, intMOSN);
		if (intRetval != EXIT_SUCCESS)
			return EXIT_FAILURE;
	}
	mysql_free_result(mysqlResult);
	return EXIT_SUCCESS;
}

//[DATA BASE]

int DB_DatabaseConnect(MYSQL *mysqlCon)
//[DB]Connect to Database (Database IP, user name and password are defined in config.h)
{
	// Connect to MYSQL Server
	mysql_init(mysqlCon);
	mysql_options(mysqlCon, MYSQL_SET_CHARSET_NAME, "utf8");
	mysql_options(mysqlCon, MYSQL_INIT_COMMAND, "SET NAMES utf8");

	if (!mysql_real_connect(mysqlCon, MYSQL_SERVER_IP, MYSQL_USER_NAME, MYSQL_PASSWORD, NULL, 0, NULL, CLIENT_FOUND_ROWS))
	{
		fprintf(stderr, "MYSQL connection failed.\n");
		if (mysql_errno(mysqlCon))
		{
			fprintf(stderr, "MYSQL connection error %d: %s\n", mysql_errno(mysqlCon), mysql_error(mysqlCon));
		}
		return EXIT_FAILURE;
	}
	return EXIT_SUCCESS;
}

int DB_SelectColumnMax(MYSQL mysqlCon, char charTableName[MEDIUM_STRING_SIZE], char charColumnName[SMALL_STRING_SIZE], char **charMaxValue)
//[DB]Select Max Value of A Specified Column and Table
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Check If Exist System Log Table
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='%s_%s' AND TABLE_NAME='SysLog'",
			 SYS_NAME, LOG_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		fprintf(stderr, "[DB_SelectColumnMax]Fail to check the existence of system log table %s_%s.SysLog in information_schema.tables %d:%s\n",
				SYS_NAME, LOG_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		return EXIT_FAILURE;
	}

	mysqlResult = mysql_use_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		fprintf(stderr, "[DB_SelectColumnMax]The system log table %s_%s.SysLog is empty\n",
				SYS_NAME, LOG_DATABASE_NAME);
		mysql_free_result(mysqlResult);
		return EXIT_FAILURE;
	}
	mysql_free_result(mysqlResult);

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT MAX(%s) FROM %s", charColumnName, charTableName);

	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectColumnMax]Fail to select max value of column %s from %s (%d):%s",
				 charColumnName, charTableName, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_use_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectColumnMax]Fail to select max value of column %s from %s due to empty result",
				 charColumnName, charTableName);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	if (mysqlRow[0] != NULL)
	{
		*charMaxValue = (char *)malloc(sizeof(char) * strlen(mysqlRow[0]) + 1);
		strcpy(*charMaxValue, mysqlRow[0]);
	}
	else
	{
		*charMaxValue = (char *)malloc(2);
		strcpy(*charMaxValue, "0");
	}
	mysql_free_result(mysqlResult);
	return EXIT_SUCCESS;
}

int DB_SelectTableRowCount(MYSQL mysqlCon, char charTableName[MEDIUM_STRING_SIZE], int *intTableCount)
//[DB]Select Row Count of A Specified Table
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	// Check If Exist System Log Table
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='%s_%s' AND TABLE_NAME='SysLog'",
			 SYS_NAME, LOG_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		fprintf(stderr, "[DB_SelectTableRowCount]Fail to select system log table %s_%s.SysLog in information_schema.tables\n",
				SYS_NAME, LOG_DATABASE_NAME);
		return EXIT_FAILURE;
	}

	MYSQL_RES *mysqlResult = mysql_use_result(&mysqlCon);
	MYSQL_ROW mysqlRow = mysql_fetch_row(mysqlResult);
	mysql_free_result(mysqlResult);
	if (mysqlRow == NULL)
	{
		fprintf(stderr, "The system log table %s_%s.SysLog doen't exist\n",
				SYS_NAME, LOG_DATABASE_NAME);
		return EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT COUNT(*) FROM %s", charTableName);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectTableRowCount]Fail to select count(*) from %s (%d):%s",
				 charTableName, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_use_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow[0] != NULL)
	{
		*intTableCount = atoi(mysqlRow[0]);
	}
	else
	{
		*intTableCount = 0;
	}
	mysql_free_result(mysqlResult);
	return EXIT_SUCCESS;
}

int DB_SelectIMMSNofPrimaryIMM(MYSQL mysqlCon, unsigned int *intIMMSN)
//[DB]Select IMMSN of Primary IMM
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT IMMSN FROM %s_%s.IMMSNList WHERE PrimaryIMM = 1", SYS_NAME, DATA_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectIMMSNofPrimaryIMM]Fail to select PrimaryIMM (%d):%s",
				 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_use_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		*intIMMSN = -1;
		mysql_free_result(mysqlResult);
		return EXIT_FAILURE;
	}
	else if (mysqlRow[0] != NULL)
	{
		*intIMMSN = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		*intIMMSN = 0;
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
}

int DB_SelectMOSNbyIMMSN(MYSQL mysqlCon, unsigned int intIMMSN, unsigned int *intMOSN)
//[DB]Select MOSN of A Specified IMMSN
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT MOSN FROM %s_%s.IMMSNList WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectMOSNbyIMMSN]Fail to select MOSN for IMMSN:%d (%d):%s",
				 intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_use_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		*intMOSN = 0;
		mysql_free_result(mysqlResult);
		return EXIT_FAILURE;
	}
	else if (mysqlRow[0] != NULL)
	{
		*intMOSN = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		*intMOSN = 0;
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
}

int DB_SelectShotSNbyIMMSN(MYSQL mysqlCon, unsigned int intIMMSN, unsigned int *intShotSN)
//[DB]Select ShotSN of A Specified IMMSN
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT ShotSN FROM %s_%s.IMMSNList WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectMOSNbyIMMSN]Fail to select MOSN for IMMSN:%d (%d):%s",
				 intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_use_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		*intShotSN = 0;
		mysql_free_result(mysqlResult);
		return EXIT_FAILURE;
	}
	else if (mysqlRow[0] != NULL)
	{
		*intShotSN = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		*intShotSN = 0;
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
}

int DB_SelectOPCUAVersionSNbyIMMSN(MYSQL mysqlCon, unsigned int intIMMSN, unsigned int *intOPCUAVersionSN)
//[DB]Select OPC UA Version of A Specified IMMSN
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	int intExitStatus = EXIT_SUCCESS;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Get OPCUAVersionSN According to The Given IMMSN - bermuda
	snprintf(charStatement, MAX_STRING_SIZE, "SELECT OPCUAVersionSN FROM %s_%s.IMMSNList WHERE IMMSN=%d", SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectOPCUAVersionSNbyIMMSN]Fail to select OPC UA version where IMMSN=%d from %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return EXIT_FAILURE;
	}
	mysqlResult = mysql_use_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		mysql_free_result(mysqlResult);
		return EXIT_FAILURE;
	}
	else if (mysqlRow[0] == NULL)
	{
		*intOPCUAVersionSN = 0;
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else if (mysqlRow[0] != NULL)
	{
		*intOPCUAVersionSN = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
}

int DB_SelectPIDbyIMMSN(MYSQL mysqlCon, unsigned int intIMMSN, unsigned int *intOPCUAClientPID, unsigned int *intModbusClientPID)
//[DB]Select OPCUAClientPID and ModbusClientPID of A Specified IMMSN
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT OPCUAClientPID, ModbusClientPID FROM %s_%s.IMMSNList WHERE IMMSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectPIDbyIMMSN]Fail to select OPCUAClientPID and ModbusClientPID for IMMSN:%d (%d):%s",
				 intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// fprintf(stderr,"Q:%s\n",charStatement);
	mysqlResult = mysql_use_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	*intOPCUAClientPID = 0;
	*intModbusClientPID = 0;

	if (mysqlRow == NULL)
	{
		*intOPCUAClientPID = -1;
		*intModbusClientPID = -1;
		mysql_free_result(mysqlResult);
		return EXIT_FAILURE;
	}

	if (mysqlRow[0] != NULL)
		*intOPCUAClientPID = atoi(mysqlRow[0]);

	if (mysqlRow[1] != NULL)
		*intModbusClientPID = atoi(mysqlRow[1]);

	mysql_free_result(mysqlResult);
	return EXIT_SUCCESS;
}

int DB_CheckIsomorphismbyMOSN(MYSQL mysqlCon, unsigned int intMOSN1, unsigned int intMOSN2, bool *boolIsomorphism)
//[DB]Check If Two Specified MOSNs Are Isomorphic
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	unsigned int intIMMSN1, intIMMSN2;
	unsigned int intMoldSN1, intMoldSN2;
	unsigned int intProdSN1, intProdSN2;
	char *charMOSN1CustomSensorCount, *charMOSN2CustomSensorCount;
	unsigned int intMOSN1CustomSensorCount, intMOSN2CustomSensorCount;
	unsigned int intCustomSensorModelSN1, intCustomSensorModelSN2;

	*boolIsomorphism = true;

	// Check if IMMSN of MOSN1 == IMMSN of MOSN2
	intRetval = DB_SelectIMMSNbyMOSN(mysqlCon, intMOSN1, &intIMMSN1);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_CheckIsomorphismbyMOSN]Fail to select IMMSN for existing MOSN1:%d", intMOSN1);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN1, 0, 0, charErrMsg);
		return intLogSN;
	}
	intRetval = DB_SelectIMMSNbyMOSN(mysqlCon, intMOSN2, &intIMMSN2);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_CheckIsomorphismbyMOSN]Fail to select IMMSN for existing MOSN2:%d", intMOSN2);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN1, 0, 0, charErrMsg);
		return intLogSN;
	}
	if (intIMMSN1 != intIMMSN2)
	{
		*boolIsomorphism = false;
		fprintf(stderr, "[DB_CheckIsomorphismbyMOSN]MOSN1:%d and MOSN2:%d are not isomorphy due to IMMSN are not equal\n", intMOSN1, intMOSN2);
		return EXIT_SUCCESS;
	}

	// Check if MoldSN of MOSN1 == MoldSN of MOSN2
	intRetval = DB_SelectMoldSNbyMOSN(mysqlCon, intMOSN1, &intMoldSN1);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_CheckIsomorphismbyMOSN]Fail to select MoldSN for existing MOSN1:%d", intMOSN1);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN1, 0, 0, charErrMsg);
		return intLogSN;
	}

	intRetval = DB_SelectMoldSNbyMOSN(mysqlCon, intMOSN2, &intMoldSN2);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_CheckIsomorphismbyMOSN]Fail to select MoldSN for existing MOSN2:%d", intMOSN2);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN1, 0, 0, charErrMsg);
		return intLogSN;
	}
	if (intMoldSN1 != intMoldSN2)
	{
		*boolIsomorphism = false;
		fprintf(stderr, "[DB_CheckIsomorphismbyMOSN]MOSN1:%d and MOSN2:%d are not isomorphy due to MoldSN are not equal\n", intMOSN1, intMOSN2);
		return EXIT_SUCCESS;
	}

	// Check if ProdSN of MOSN1 == ProdSN of MOSN2
	intRetval = DB_SelectProdSNbyMOSN(mysqlCon, intMOSN1, &intProdSN1);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_CheckIsomorphismbyMOSN]Fail to select ProdSN for existing MOSN1:%d", intMOSN1);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN1, 0, 0, charErrMsg);
		return intLogSN;
	}
	intRetval = DB_SelectProdSNbyMOSN(mysqlCon, intMOSN2, &intProdSN2);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_CheckIsomorphismbyMOSN]Fail to select ProdSN for existing MOSN2:%d", intMOSN2);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN1, 0, 0, charErrMsg);
		return intLogSN;
	}
	if (intProdSN1 != intProdSN2)
	{
		*boolIsomorphism = false;
		fprintf(stderr, "[DB_CheckIsomorphismbyMOSN]MOSN1:%d and MOSN2:%d are not isomorphy due to ProdSN are not equal\n", intMOSN1, intMOSN2);
		return EXIT_SUCCESS;
	}

	// Select The CustomerSensor Count for The MOSN1
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s_%s_%d_Info_Meta.MOCustomSensorSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN1);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "MOCustomSensorSN", &charMOSN1CustomSensorCount);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_CheckIsomorphismbyMOSN]Fail to get the count of MOCustomSensorSN from table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN1, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN1, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	intMOSN1CustomSensorCount = atoi(charMOSN1CustomSensorCount);

	// Select The CustomerSensor Count for The MOSN2
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s_%s_%d_Info_Meta.MOCustomSensorSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN2);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "MOCustomSensorSN", &charMOSN2CustomSensorCount);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_CheckIsomorphismbyMOSN]Fail to get the count of MOCustomSensorSN from table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN1, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN2, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	intMOSN2CustomSensorCount = atoi(charMOSN2CustomSensorCount);

	if (intMOSN1CustomSensorCount != intMOSN2CustomSensorCount)
	{
		*boolIsomorphism = false;
		fprintf(stderr, "[DB_CheckIsomorphismbyMOSN]MOSN1:%d(Count:%d) and MOSN2:%d(Count:%d) are not isomorphy due to CustomSensorCount are not equal\n",
				intMOSN1, intMOSN1CustomSensorCount, intMOSN2, intMOSN2CustomSensorCount);
		return EXIT_SUCCESS;
	}

	for (int i = 1; i <= intMOSN1CustomSensorCount && *boolIsomorphism == true; i++)
	{
		intRetval = DB_SelectCustomSensorModelSNbyMOCustomSensorSN(mysqlCon, intMOSN1, i, &intCustomSensorModelSN1);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[DB_CheckIsomorphismbyMOSN]Fail to select the ModelSN of MOSN from table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN1);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN1, 0, 0, charErrMsg);
			return intLogSN;
		}

		intRetval = DB_SelectCustomSensorModelSNbyMOCustomSensorSN(mysqlCon, intMOSN2, i, &intCustomSensorModelSN2);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[DB_CheckIsomorphismbyMOSN]Fail to select the ModelSN of MOSN from table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN1);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN1, 0, 0, charErrMsg);
			return intLogSN;
		}

		if (intCustomSensorModelSN1 != intCustomSensorModelSN2)
		{
			*boolIsomorphism = false;
			fprintf(stderr,
					"[DB_CheckIsomorphismbyMOSN]MOSN1:%d and MOSN2:%d are not isomorphy due to ModelSN of CustomSensorCount:%d are not equal\n", intMOSN1, intMOSN2, i);
			return EXIT_SUCCESS;
		}
	}

	return EXIT_SUCCESS;
}

int DB_SelectMOStatusbyMOSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int *intMOStatus)
//[DB]Select MO Status of A Specified MOSN
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	int intExitStatus = EXIT_SUCCESS;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT MOStatus FROM %s_%s_%s.MOSNList WHERE MOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectMOStatusbyMOSN]Fail to select MOStatus from %s_%s.MOSNList where MOSN:%d (%d):%s",
				 SYS_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		mysql_free_result(mysqlResult);
		return EXIT_FAILURE;
	}
	else if (mysqlRow[0] != NULL)
	{
		*intMOStatus = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		*intMOStatus = 0;
		return EXIT_SUCCESS;
	}
}

int DB_SelectOPCUAVersionSNbyMOSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int *intOPCUAVersionSN)
//[DB]Select OPCUAVersionSN of A Specified MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT OPCUAVersionSN FROM %s_%s_%s.MOSNList WHERE MOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectOPCUAVersionSNbyMOSN]Fail to select OPCUAVersionSN from %s_%s.MOSNList where MOSN:%d (%d):%s",
				 SYS_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		mysql_free_result(mysqlResult);
		return EXIT_FAILURE;
	}
	else if (mysqlRow[0] != NULL)
	{
		*intOPCUAVersionSN = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		*intOPCUAVersionSN = 0;
		return EXIT_SUCCESS;
	}
}

int DB_SelectReferenceMOSNbyMOSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int *intReferenceMOSN)
//[DB]Select Reference MO of A Specified MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT ReferenceMOSN FROM %s_%s_%s.MOSNList WHERE MOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectReferenceMOSNbyMOSN]Fail to select ReferenceMOSN from %s_%s.MOSNList where MOSN:%d (%d):%s",
				 SYS_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		mysql_free_result(mysqlResult);
		return EXIT_FAILURE;
	}
	else if (mysqlRow[0] != NULL)
	{
		*intReferenceMOSN = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		*intReferenceMOSN = 0;
		return EXIT_SUCCESS;
	}
}

int DB_SelectIMMSNbyMOSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int *intIMMSN)
//[DB]Select IMMSN of A Specified MOSN
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	int intExitStatus = EXIT_SUCCESS;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT IMMSN FROM %s_%s_%s.MOSNList WHERE MOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectIMMSNbyMOSN]Fail to select IMMSN for MOSN:%d (%d):%s",
				 intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_use_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow != NULL)
	{
		*intIMMSN = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		*intIMMSN = 0;
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
}

int DB_SelectMOIDbyMOSN(MYSQL mysqlCon, unsigned int intMOSN, char *charMOID)
//[DB]Select MOID of A Specified MOSN
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	int intExitStatus = EXIT_SUCCESS;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT MOID FROM %s_%s_%s.MOSNList WHERE MOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectIMMSNbyMOSN]Fail to select IMMSN for MOSN:%d (%d):%s",
				 intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_use_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow != NULL)
	{
		strcpy(charMOID, mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		memset(charMOID, 0, sizeof(charMOID));
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
}

int DB_SelectMoldSNbyMOSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int *intMoldSN)
//[DB]Select MoldSN of A Specified MOSN
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	int intExitStatus = EXIT_SUCCESS;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT MoldSN FROM %s_%s_%s.MOSNList WHERE MOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectMoldSNbyMOSN]Fail to select MoldSN from %s_%s.MOSNList where MOSN:%d (%d):%s",
				 SYS_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow[0] != NULL)
	{
		*intMoldSN = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		*intMoldSN = 0;
		return EXIT_SUCCESS;
	}
}

int DB_SelectProdSNbyMOSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int *intProdSN)
//[DB]Select ProdSN of A Specified MO
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	int intExitStatus = EXIT_SUCCESS;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT ProdSN FROM %s_%s_%s.MOSNList WHERE MOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectProdSNbyMOSN]Fail to select ProdSN from %s_%s.MOSNList where MOSN:%d (%d):%s",
				 SYS_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow[0] != NULL)
	{
		*intProdSN = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		*intProdSN = 0;
		return EXIT_SUCCESS;
	}
}

int DB_SelectShotSNbyMOSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int *intShotSN)
//[DB]Select ShotSN of A Specified MOSN
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	char charTableName[MEDIUM_STRING_SIZE];
	char *charShotSN;

	// Select MAX IMMParaSN in INJPRO_DATA_MO_[MOSN]_RawData_IMMPara.IMMParaSNList
	snprintf(charTableName, MEDIUM_STRING_SIZE, "%s_%s_%s_%d_RawData.ShotSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = DB_SelectColumnMax(mysqlCon, charTableName, "ShotSN", &charShotSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectShotSNbyMOSN]Fail to select ShotSN for MOSN:%d (%d):%s",
				 intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		return intLogSN;
	}
	*intShotSN = atoi(charShotSN) + 1;

	return EXIT_SUCCESS;
}

int DB_SelectIMMShotSNbyMOSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int *intIMMShotSN)
//[DB]Select IMMShotSN of A Specified MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	char charTableName[MEDIUM_STRING_SIZE];
	char *charIMMShotSN;

	// Select MAX IMMParaSN in INJPRO_DATA_MO_[MOSN]_RawData_IMMPara.IMMParaSNList
	snprintf(charTableName, MEDIUM_STRING_SIZE, "%s_%s_%s_%d_RawData.ShotSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = DB_SelectColumnMax(mysqlCon, charTableName, "IMMShotSN", &charIMMShotSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectIMMShotSNbyMOSN]Fail to select IMMShotSN for MOSN:%d (%d):%s",
				 intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		return intLogSN;
	}
	*intIMMShotSN = atoi(charIMMShotSN) + 1;

	return EXIT_SUCCESS;
}

int DB_SelectCurrentRoundSN(MYSQL mysqlCon, unsigned int intIMMSN, unsigned int *intRoundSN)
//[DB]Select Current RoundSN of A Specified MO
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT RoundSN FROM %s_%s.IMMSNList WHERE IMMSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[IMM_SelectRoundSN]Fail to select RoundSN for IMMSN:%d from %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[IMM_SelectRoundSN]Fail to select RoundSN for IMMSN:%d from %s_%s.IMMSNList (Empty)",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}
	*intRoundSN = atoi(mysqlRow[0]);
	return EXIT_SUCCESS;
}

int DB_SelectFirstShotSNbyRoundSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intRoundSN, unsigned int *intShotSN)
//[DB]Select First ShotSN of A Specified RoundSN in An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MIN(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList WHERE RoundSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intRoundSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectFirstShotSNbyRoundSN]Fail to select first ShotSN for RoundSN:%d MOSN:%d from %s_%s_%s_%d_RawData.ShotSNList (%d):%s",
				 intRoundSN, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectFirstShotSNbyRoundSN]Fail to select first ShotSN for RoundSN:%d MOSN:%d from %s_%s_%s_%d_RawData.ShotSNList (Result EMpty)",
				 intRoundSN, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, 0, charErrMsg);
		return intLogSN;
	}
	*intShotSN = atoi(mysqlRow[0]);
	return EXIT_SUCCESS;
}

int DB_SelectRoundSNbyShotSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int *intRoundSN)
//[DB]Select RoundSN of A Specified ShotSN in A Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT RoundSN FROM %s_%s_%s_%d_RawData.ShotSNList WHERE ShotSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectRoundSNbyShotSN]Fail to select RoundSN for ShotSN:%d MOSN:%d from %s_%s_%s_%d_RawData.ShotSNList (%d):%s",
				 intShotSN, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectRoundSNbyShotSN]Fail to select RoundSN for ShotSN:%d MOSN:%d from %s_%s_%s_%d_RawData.ShotSNList (Result EMpty):%s",
				 intShotSN, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, charStatement);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, 0, charErrMsg);
		return intLogSN;
	}
	*intRoundSN = atoi(mysqlRow[0]);
	return EXIT_SUCCESS;
}

int DB_SelectCustomSensorModelSNbyMOCustomSensorSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMOCustomSensorSN, unsigned int *intCustomSensorModelSN)
//[DB]Select Custom Sensor Model of A Specified MOCustomSensorSN in An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT CustomSensorModelSN FROM %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList WHERE MOCustomSensorSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectCustomSensorModelSNbyMOCustomSensorSN]Fail to select CustomSensorModelSN of MOSN:%d MOCustomSensorSN:%d from %s_%s.CustomSensorModelIndex and %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList (%d):%s",
				 intMOSN, intMOCustomSensorSN, SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	// Get CustomSensorClass
	if (mysqlRow[0] != NULL)
	{
		*intCustomSensorModelSN = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectCustomSensorModelSNbyMOCustomSensorSN]No sensor model for MOSN:%d MOCustomSensorSN:%d from %s_%s.CustomSensorModelIndex and %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList (%d):%s",
				 intMOSN, intMOCustomSensorSN, SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
}

int DB_SelectMOCustomSensorClassAndCategorybyMOCustomSensorSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMOCustomSensorSN, unsigned int *intCustomSensorClass, unsigned int *intCustomSensorCategory)
//[DB]Select Custom Sensor Class and Category of A Specified MOCustomSensorSN in An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT CustomSensorClass, CustomSensorCategory FROM %s_%s.CustomSensorModelIndex LEFT JOIN %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList ON CustomSensorModelIndex.CustomSensorModelSN=MOCustomSensorSNList.CustomSensorModelSN WHERE MOCustomSensorSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectMOCustomSensorClassAndCategorybyMOCustomSensorSN]Fail to select custom sensor category of MOSN:%d MOCustomSensorSN:%d from %s_%s.CustomSensorModelIndex and %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList (%d):%s",
				 intMOSN, intMOCustomSensorSN, SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	// Get CustomSensorClass
	if (mysqlRow[0] != NULL && mysqlRow[1] != NULL)
	{
		*intCustomSensorClass = atoi(mysqlRow[0]);
		*intCustomSensorCategory = atoi(mysqlRow[1]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectMOCustomSensorClassAndCategorybyMOCustomSensorSN]No sensor class and category for MOSN:%d MOCustomSensorSN:%d from %s_%s.CustomSensorModelIndex and %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList (%d):%s",
				 intMOSN, intMOCustomSensorSN, SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
}

int DB_SelectMOCustomSensorClassAndCategorybyCustomSensorModelSN(MYSQL mysqlCon, unsigned int intCustomSensorModelSN, unsigned int *intCustomSensorClass, unsigned int *intCustomSensorCategory)
//[DB]Select Custom Sensor Class and Category of A Specified Custom Sensor Model
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT CustomSensorClass, CustomSensorCategory FROM %s_%s.CustomSensorModelIndex WHERE CustomSensorModelSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, intCustomSensorModelSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectMOCustomSensorClassAndCategorybyCustomSensorModelSN]Fail to select custom sensor category of CustomSensorModelSN:%d from %s_%s.CustomSensorModelIndex(%d):%s",
				 intCustomSensorModelSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	// Get CustomSensorClass
	if (mysqlRow[0] != NULL && mysqlRow[1] != NULL)
	{
		*intCustomSensorClass = atoi(mysqlRow[0]);
		*intCustomSensorCategory = atoi(mysqlRow[1]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectMOCustomSensorClassAndCategorybyCustomSensorModelSN]No sensor class and category for CustomSensorModelSN:%d from %s_%s.CustomSensorModelIndex (%d):%s",
				 intCustomSensorModelSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
}

int DB_SelectMOCustomSensorRawData(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int intMOCustomSensorSN, double **doubleSensorData, unsigned int *intSensorDataSize)
//[DB]Select MO Custom Sensor Raw Data of A Specified Shot in An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intTableSN;
	unsigned int *intIMMSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	if (*doubleSensorData != NULL)
		free(*doubleSensorData);

	// Caculate Table for ShotSN : Default is 10000 shots per Table
	intTableSN = (intShotSN - 1) / SHOT_NUM_PER_TABLE + 1;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT ElapsedTime,SensorValue FROM %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN%d WHERE ShotSN=%d ORDER BY ElapsedTime ASC",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, intTableSN, intShotSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_SelectMOCustomSensorRawData]Fail to select custom sensor rawdata of ShotSN:%d from "
				 "table %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_Table%d (%d):%s",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, intTableSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	*intSensorDataSize = (unsigned int)mysql_num_rows(mysqlResult);
	// fprintf(stderr,"total row:%d\n",*intSensorDataSize);
	*doubleSensorData = (double *)malloc(sizeof(double) * 2 * (*intSensorDataSize));
	for (int i = 0; i < *intSensorDataSize; i++)
	{
		mysqlRow = mysql_fetch_row(mysqlResult);
		// fprintf(stderr,"i:%d O [%s][%s] ",i,mysqlRow[0],mysqlRow[1]);
		*(*doubleSensorData + i * 2) = atof(mysqlRow[0]);
		*(*doubleSensorData + i * 2 + 1) = atof(mysqlRow[1]);
		// *(*doubleSensorData+i*2+1)=*(*doubleSensorData+i*2+1)+*(*doubleSensorData+1);
		// fprintf(stderr,"[%lf][%lf]\n",*(*doubleSensorData+i*2),*(*doubleSensorData+i*2+1));
	}
	mysql_free_result(mysqlResult);
	if (*intSensorDataSize != 0)
		return EXIT_SUCCESS;
	else
		return EXIT_FAILURE;
}

int DB_SelectMonitorItemDBName(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMonitorItemSN, char *charMonitorItemDBName)
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intIMMSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intSPCSensorMonitorIndex;
	unsigned int intCustomSensorClass;
	unsigned int intCustomSensorCategory;

	// Select SPC Meta Information According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		// printf(stderr, "Q:%s\n", charStatement);
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_SelectMonitorItemDBName]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_SelectMonitorItemDBName]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList. (No Such MonitorItemSN)",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	intMonitorItemClass = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
	// fprintf(stderr, "intMonitorItemClass:%d\n", intMonitorItemClass);
	intMonitorItemSensorSN = mysqlRow[1] != NULL ? atoi(mysqlRow[1]) : 0;
	// fprintf(stderr, "intMonitorItemSensorSN:%d\n", intMonitorItemSensorSN);
	intSPCSensorMonitorIndex = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
	// fprintf(stderr, "intSPCSensorMonitorIndex:%d\n", intSPCSensorMonitorIndex);
	mysql_free_result(mysqlResult);

	strcpy(charMonitorItemDBName, "NULL");
	if (intMonitorItemClass == MONITOR_ITEM_CLASS_QUALITY)
	{
		strcpy(charMonitorItemDBName, "NULL");
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_OPCUA) // Select IMM Sensor Data from ShotSNStart to ShotSNEnd
	{
		if (intMonitorItemSensorSN == IMMSENSOR_CYCLE_TIME)
		{
			strcpy(charMonitorItemDBName, "CycleTime");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_CLAMPING_TIME)
		{
			strcpy(charMonitorItemDBName, "MoldClampingTime");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_RELEASING_TIME)
		{
			strcpy(charMonitorItemDBName, "MoldReleasingTime");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_INJECTION_TIME)
		{
			strcpy(charMonitorItemDBName, "InjectionTime");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_VPCHANGEOVER_DELAY_TIME)
		{
			strcpy(charMonitorItemDBName, "VPChangeOverDelayTime");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_HOLDING_TIME)
		{
			strcpy(charMonitorItemDBName, "HoldingTime");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_PLASTIFICATION_TIME)
		{
			strcpy(charMonitorItemDBName, "PlastificationTime");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_VPCHANGEOVER_POSITION)
		{
			strcpy(charMonitorItemDBName, "VPChangeOverPosition");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_CUSION_VOLUME)
		{
			strcpy(charMonitorItemDBName, "CusionVolume");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_END_HOLDING_POSITION)
		{
			strcpy(charMonitorItemDBName, "EndHoldingPosition");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_END_PLASTIFICATION_POSITION)
		{
			strcpy(charMonitorItemDBName, "EndPlastificationPosition");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_NOZZLE1_TEMPERATURE)
		{
			strcpy(charMonitorItemDBName, "Nozzle1Temperature");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_NOZZLE2_TEMPERATURE)
		{
			strcpy(charMonitorItemDBName, "Nozzle2Temperature");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_NOZZLE3_TEMPERATURE)
		{
			strcpy(charMonitorItemDBName, "Nozzle3Temperature");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_NOZZLE4_TEMPERATURE)
		{
			strcpy(charMonitorItemDBName, "Nozzle4Temperature");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_NOZZLE5_TEMPERATURE)
		{
			strcpy(charMonitorItemDBName, "Nozzle5Temperature");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_IMM_OIL_TEMPERATURE)
		{
			strcpy(charMonitorItemDBName, "IMMOilTemperature");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_FALL_MATERIAL_TEMPERATURE)
		{
			strcpy(charMonitorItemDBName, "FallMaterialTemperature");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_INJECTION_PRESSURE)
		{
			strcpy(charMonitorItemDBName, "MaxInjectionPressure");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE)
		{
			strcpy(charMonitorItemDBName, "VPChangeOverPressure");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SUM_INJECTION_PRESSURE)
		{
			strcpy(charMonitorItemDBName, "SumInjectionPressure");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SUM_HOLDING_PRESSURE)
		{
			strcpy(charMonitorItemDBName, "SumHoldingPressure");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE)
		{
			strcpy(charMonitorItemDBName, "MaxCavityNearGatePressure");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE)
		{
			strcpy(charMonitorItemDBName, "MaxCavityFarGatePressure");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SUM_CAVITY_PRESSURE)
		{
			strcpy(charMonitorItemDBName, "SumCavityPressure");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SUM_MOLD_CLAMPING_FORCE)
		{
			strcpy(charMonitorItemDBName, "SumMoldClampingForce");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_MOLD_CLAMPING_FORCE)
		{
			strcpy(charMonitorItemDBName, "MaxMoldClampingForce");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_BACK_PRESSURE)
		{
			strcpy(charMonitorItemDBName, "MaxBackPressure");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_DELAY_PLASTIFICATION_TIME)
		{
			strcpy(charMonitorItemDBName, "DelayPlastificationTime");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE)
		{
			strcpy(charMonitorItemDBName, "InMoldCoolingTemperature");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE)
		{
			strcpy(charMonitorItemDBName, "OutMoldCoolingTemperature");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_COOLING_VOLUME)
		{
			strcpy(charMonitorItemDBName, "MoldCoolingVolume");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_RELEASING_POSITION_2)
		{
			strcpy(charMonitorItemDBName, "MoldReleasingPosition2");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_RELEASING_POSITION_3)
		{
			strcpy(charMonitorItemDBName, "MoldReleasingPosition3");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_RELEASING_POSITION_4)
		{
			strcpy(charMonitorItemDBName, "MoldReleasingPosition4");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_RELEASING_POSITION_5)
		{
			strcpy(charMonitorItemDBName, "MoldReleasingPosition5");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SCREW_SUCK_BACK_POSITION)
		{
			strcpy(charMonitorItemDBName, "ScrewSuckBackPosition");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SCREW_RPM)
		{
			strcpy(charMonitorItemDBName, "ScrewRPM");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_PART_WEIGHT)
		{
			strcpy(charMonitorItemDBName, "PartWeight");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_GATE_CLOSING_TIME)
		{
			strcpy(charMonitorItemDBName, "GateClosingTime");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MELT_TEMPERATURE)
		{
			strcpy(charMonitorItemDBName, "MeltTemperature");
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_TEMPERATURE)
		{
			strcpy(charMonitorItemDBName, "MoldTemperature");
		}
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS)
	{
		// Select MOCustomSensor Category When intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS (The SPC Monitor Item Is From custom sensor)
		intRetval = DB_SelectMOCustomSensorClassAndCategorybyMOCustomSensorSN(mysqlCon, intMOSN, intMonitorItemSensorSN, &intCustomSensorClass, &intCustomSensorCategory);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectMonitorItemDBName]Fail to select custom sensor category of MOSN:%d MOCustomSensorSN:%d from %s_%s.CustomSensorModelIndex and %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList (%d):%s",
					 intMOSN, intMonitorItemSensorSN, SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		if (intCustomSensorClass == CUSTOM_SENSOR_CLASS_IMM)
		{
			// Identify The Name of SCP Attribute
			if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_START_TIME)
			{
				sprintf(charMonitorItemDBName, "Stage1StartTime");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME)
			{
				sprintf(charMonitorItemDBName, "Stage1EndTime");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_PERIOD)
			{
				sprintf(charMonitorItemDBName, "Stage1Period");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE)
			{
				strcpy(charMonitorItemDBName, "AvgStage1PressureSlope");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE1_PRESSURE)
			{
				strcpy(charMonitorItemDBName, "SumStage1Pressure");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE)
			{
				sprintf(charMonitorItemDBName, "Stage1EndPressure");
			}
			if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_START_TIME)
			{
				sprintf(charMonitorItemDBName, "Stage2StartTime");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_END_TIME)
			{
				sprintf(charMonitorItemDBName, "Stage2EndTime");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_PERIOD)
			{
				sprintf(charMonitorItemDBName, "Stage2Period");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE)
			{
				sprintf(charMonitorItemDBName, "AvgStage2PressureSlope");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE2_PRESSURE)
			{
				sprintf(charMonitorItemDBName, "SumStage2Pressure");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_START_TIME)
			{
				sprintf(charMonitorItemDBName, "Stage3StartTime");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_END_TIME)
			{
				sprintf(charMonitorItemDBName, "Stage3EndTime");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_PERIOD)
			{
				sprintf(charMonitorItemDBName, "Stage3Period");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE)
			{
				sprintf(charMonitorItemDBName, "MaxStage3Pressure");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE_TIME)
			{
				sprintf(charMonitorItemDBName, "MaxStage3PressureTime");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE3_PRESSURE)
			{
				sprintf(charMonitorItemDBName, "SumStage3Pressure");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_CYCLE_TIME)
			{
				strcpy(charMonitorItemDBName, "CycleTime");
			}
			else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_PRESSURE)
			{
				strcpy(charMonitorItemDBName, "SumPressure");
			}
		}
		else if (intCustomSensorClass == CUSTOM_SENSOR_CLASS_CAVITY)
		{
			if (intCustomSensorCategory == CUSTOM_SENSOR_CATEGORY_PRESSURE)
			{
				// Identify The Name of SCP Attribute
				if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE)
				{
					strcpy(charMonitorItemDBName, "MaxPressure");
				}
				else if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_STAGE1_PRESSURE_SUM)
				{
					strcpy(charMonitorItemDBName, "SumStage1Pressure");
				}
				else if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE_TIME)
				{
					strcpy(charMonitorItemDBName, "MaxPressureTime");
				}
				else if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE)
				{
					strcpy(charMonitorItemDBName, "AvgStage1PressureSlope");
				}
				else if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE)
				{
					strcpy(charMonitorItemDBName, "AvgStage2PressureSlope");
				}
				else if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_RELEASED_PRESSURE)
				{
					strcpy(charMonitorItemDBName, "MoldReleasePressure");
				}
			}
			else if (intCustomSensorCategory == CUSTOM_SENSOR_CATEGORY_TEMPERATURE)
			{
				// Identify The Name of SCP Attribute
				if (intSPCSensorMonitorIndex == CAVITY_TEMPERATURE_SENSOR_FEATURE_START_TEMPERATURE)
				{
					strcpy(charMonitorItemDBName, "StartTemperature");
				}
				else if (intSPCSensorMonitorIndex == CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE)
				{
					strcpy(charMonitorItemDBName, "MaxTemperature");
				}
				else if (intSPCSensorMonitorIndex == CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE_TIME)
				{
					strcpy(charMonitorItemDBName, "MaxTemperatureTime");
				}
				else if (intSPCSensorMonitorIndex == CAVITY_TEMPERATURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE)
				{
					strcpy(charMonitorItemDBName, "AvgStage2TemperatureSlope");
				}
				else if (intSPCSensorMonitorIndex == CAVITY_TEMPERATURE_SENSOR_FEATURE_RELEASED_TEMPERATURE)
				{
					strcpy(charMonitorItemDBName, "MoldReleaseTemperature");
				}
			}
		}
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_SOFT)
	{
		// Identify The Name of SCP Attribute
		if (intSPCSensorMonitorIndex == SOFT_MOLD_CLAMPED_CYCLETIME)
		{
			strcpy(charMonitorItemDBName, "MoldClampedCycleTime");
		}
		else if (intSPCSensorMonitorIndex == SOFT_MOLD_BASED_CYCLETIME)
		{
			strcpy(charMonitorItemDBName, "MoldBasedCycleTime");
		}
		else if (intSPCSensorMonitorIndex == SOFT_MOLD_SHOT_INTERVAL)
		{
			strcpy(charMonitorItemDBName, "MoldShotInterval");
		}
		else if (intSPCSensorMonitorIndex == SOFT_MOLD_COMPLETE_CYCLETIME)
		{
			strcpy(charMonitorItemDBName, "MoldCompleteCycleTime");
		}
		else if (intSPCSensorMonitorIndex == SOFT_PRESSURE_SENSOR_FEATURE_DIFF_MAX_PRESSURE)
		{
			strcpy(charMonitorItemDBName, "DiffMaxPressure");
		}
		else if (intSPCSensorMonitorIndex == SOFT_PRESSURE_SENSOR_FEATURE_DIFF_INCREASE_PRESSURE_TIME)
		{
			strcpy(charMonitorItemDBName, "DiffIncreasePressureTime");
		}
		else if (intSPCSensorMonitorIndex == SOFT_PRESSURE_SENSOR_FEATURE_DIFF_MOLD_RELEASEPRESSURE)
		{
			strcpy(charMonitorItemDBName, "DiffMoldReleasePressure");
		}
	}
	return EXIT_SUCCESS;
}

int DB_SelectMonitorItemDisplayName(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMonitorItemSN, char *charMonitorItemDisplayName)
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intIMMSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intSPCSensorMonitorIndex;
	unsigned int intCustomSensorClass;
	unsigned int intCustomSensorCategory;

	// Select SPC Meta Information According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		// printf(stderr, "Q:%s\n", charStatement);
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_SelectMonitorItemDisplayName]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_SelectMonitorItemDisplayName]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList. (No Such MonitorItemSN)",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	intMonitorItemClass = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
	// fprintf(stderr, "intMonitorItemClass:%d\n", intMonitorItemClass);
	intMonitorItemSensorSN = mysqlRow[1] != NULL ? atoi(mysqlRow[1]) : 0;
	// fprintf(stderr, "intMonitorItemSensorSN:%d\n", intMonitorItemSensorSN);
	intSPCSensorMonitorIndex = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
	// fprintf(stderr, "intSPCSensorMonitorIndex:%d\n", intSPCSensorMonitorIndex);
	mysql_free_result(mysqlResult);

	strcpy(charMonitorItemDisplayName, "NULL");
	if (intMonitorItemClass == MONITOR_ITEM_CLASS_QUALITY)
	{
		strcpy(charMonitorItemDisplayName, "NULL");
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_OPCUA) // Select IMM Sensor Data from ShotSNStart to ShotSNEnd
	{
		if (intMonitorItemSensorSN == IMMSENSOR_CYCLE_TIME)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-CycleTime", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_CLAMPING_TIME)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MoldClampingTime", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_RELEASING_TIME)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MoldReleasingTime", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_INJECTION_TIME)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-InjectionTime", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_VPCHANGEOVER_DELAY_TIME)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-VPChangeOverDelayTime", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_HOLDING_TIME)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-HoldingTime", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_PLASTIFICATION_TIME)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-PlastificationTime", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_VPCHANGEOVER_POSITION)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-VPChangeOverPosition", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_CUSION_VOLUME)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-CusionVolume", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_END_HOLDING_POSITION)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-EndHoldingPosition", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_END_PLASTIFICATION_POSITION)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-EndPlastificationPosition", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_NOZZLE1_TEMPERATURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-Nozzle1Temperature", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_NOZZLE2_TEMPERATURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-Nozzle2Temperature", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_NOZZLE3_TEMPERATURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-Nozzle3Temperature", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_NOZZLE4_TEMPERATURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-Nozzle4Temperature", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_NOZZLE5_TEMPERATURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-Nozzle5Temperature", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_IMM_OIL_TEMPERATURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-IMMOilTemperature", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_FALL_MATERIAL_TEMPERATURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-FallMaterialTemperature", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_INJECTION_PRESSURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MaxInjectionPressure", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-VPChangeOverPressure", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SUM_INJECTION_PRESSURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-SumInjectionPressure", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SUM_HOLDING_PRESSURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-SumHoldingPressure", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MaxCavityNearGatePressure", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MaxCavityFarGatePressure", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SUM_CAVITY_PRESSURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-SumCavityPressure", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SUM_MOLD_CLAMPING_FORCE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-SumMoldClampingForce", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_MOLD_CLAMPING_FORCE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MaxMoldClampingForce", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MAX_BACK_PRESSURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MaxBackPressure", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_DELAY_PLASTIFICATION_TIME)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-DelayPlastificationTime", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-InMoldCoolingTemperature", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-OutMoldCoolingTemperature", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_COOLING_VOLUME)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MoldCoolingVolume", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_RELEASING_POSITION_2)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MoldReleasingPosition2", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_RELEASING_POSITION_3)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MoldReleasingPosition3", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_RELEASING_POSITION_4)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MoldReleasingPosition4", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_RELEASING_POSITION_5)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MoldReleasingPosition5", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SCREW_SUCK_BACK_POSITION)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-ScrewSuckBackPosition", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_SCREW_RPM)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-ScrewRPM", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_PART_WEIGHT)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-PartWeight", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_GATE_CLOSING_TIME)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-GateClosingTime", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MELT_TEMPERATURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MeltTemperature", intMonitorItemSensorSN);
		}
		else if (intMonitorItemSensorSN == IMMSENSOR_MOLD_TEMPERATURE)
		{
			sprintf(charMonitorItemDisplayName, "OPCUA%d-MoldTemperature", intMonitorItemSensorSN);
		}
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS)
	{
		// Select MOCustomSensor Category When intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS (The SPC Monitor Item Is From custom sensor)
		intRetval = DB_SelectMOCustomSensorClassAndCategorybyMOCustomSensorSN(mysqlCon, intMOSN, intMonitorItemSensorSN, &intCustomSensorClass, &intCustomSensorCategory);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectMonitorItemDisplayName]Fail to select custom sensor category of MOSN:%d MOCustomSensorSN:%d from %s_%s.CustomSensorModelIndex and %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList (%d):%s",
					 intMOSN, intMonitorItemSensorSN, SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		if (intCustomSensorClass == CUSTOM_SENSOR_CLASS_IMM)
		{
			if (intCustomSensorCategory == CUSTOM_SENSOR_CATEGORY_PRESSURE)
			{
				// Identify The Name of SCP Attribute
				if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_START_TIME)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-Stage1StartTime", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-Stage1EndTime", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_PERIOD)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-Stage1Period", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-AvgStage1PressureSlope", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE1_PRESSURE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-SumStage1Pressure", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-Stage1EndPressure", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_START_TIME)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-Stage2StartTime", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_END_TIME)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-Stage2EndTime", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_PERIOD)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-Stage2Period", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-AvgStage2PressureSlope", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE2_PRESSURE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-SumStage2Pressure", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_START_TIME)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-Stage3StartTime", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_END_TIME)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-Stage3EndTime", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_PERIOD)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-Stage3Period", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-MaxStage3Pressure", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE_TIME)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-MaxStage3PressureTime", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE3_PRESSURE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-SumStage3Pressure", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_CYCLE_TIME)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-CycleTime", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_PRESSURE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-SumPressure", intMonitorItemSensorSN);
				}
			}
		}
		else if (intCustomSensorClass == CUSTOM_SENSOR_CLASS_CAVITY)
		{
			if (intCustomSensorCategory == CUSTOM_SENSOR_CATEGORY_PRESSURE)
			{
				// Identify The Name of SCP Attribute
				if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-MaxPressure", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_STAGE1_PRESSURE_SUM)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-SumStage1Pressure", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE_TIME)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-MaxPressureTime", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-AvgStage1PressureSlope", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-AvgStage2PressureSlope", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == CAVITY_PRESSURE_SENSOR_FEATURE_RELEASED_PRESSURE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-MoldReleasePressure", intMonitorItemSensorSN);
				}
			}
			else if (intCustomSensorCategory == CUSTOM_SENSOR_CATEGORY_TEMPERATURE)
			{
				// Identify The Name of SCP Attribute
				if (intSPCSensorMonitorIndex == CAVITY_TEMPERATURE_SENSOR_FEATURE_START_TEMPERATURE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-StartTemperature", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-MaxTemperature", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE_TIME)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-MaxTemperatureTime", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == CAVITY_TEMPERATURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-AvgStage2TemperatureSlope", intMonitorItemSensorSN);
				}
				else if (intSPCSensorMonitorIndex == CAVITY_TEMPERATURE_SENSOR_FEATURE_RELEASED_TEMPERATURE)
				{
					sprintf(charMonitorItemDisplayName, "Sensor%d-MoldReleaseTemperature", intMonitorItemSensorSN);
				}
			}
		}
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_SOFT)
	{
		// Identify The Name of SCP Attribute
		if (intSPCSensorMonitorIndex == SOFT_MOLD_CLAMPED_CYCLETIME)
		{
			strcpy(charMonitorItemDisplayName, "Soft-MoldClampedCycleTime");
		}
		else if (intSPCSensorMonitorIndex == SOFT_MOLD_BASED_CYCLETIME)
		{
			strcpy(charMonitorItemDisplayName, "Soft-MoldBasedCycleTime");
		}
		else if (intSPCSensorMonitorIndex == SOFT_MOLD_SHOT_INTERVAL)
		{
			strcpy(charMonitorItemDisplayName, "Soft-MoldShotInterval");
		}
		else if (intSPCSensorMonitorIndex == SOFT_MOLD_COMPLETE_CYCLETIME)
		{
			strcpy(charMonitorItemDisplayName, "Soft-MoldCompleteCycleTime");
		}
		else if (intSPCSensorMonitorIndex == SOFT_PRESSURE_SENSOR_FEATURE_DIFF_MAX_PRESSURE)
		{
			strcpy(charMonitorItemDisplayName, "Soft-DiffMaxPressure");
		}
		else if (intSPCSensorMonitorIndex == SOFT_PRESSURE_SENSOR_FEATURE_DIFF_INCREASE_PRESSURE_TIME)
		{
			strcpy(charMonitorItemDisplayName, "Soft-DiffIncreasePressureTime");
		}
		else if (intSPCSensorMonitorIndex == SOFT_PRESSURE_SENSOR_FEATURE_DIFF_MOLD_RELEASEPRESSURE)
		{
			strcpy(charMonitorItemDisplayName, "Soft-DiffMoldReleasePressure");
		}
	}
	return EXIT_SUCCESS;
}

int DB_InsertMOCustomSensorData(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int intMOCustomSensorSN, double doubleElapsedTime, double doubleValue, double doubleMOCustomSensorConvertRatio)
//[DB]Insert Single Point Data (SensorValue,ElapsedTime) for A Specified ShotSN and Custom Sensor in An Existing MO
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	int intTableSN;

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Caculate Table for ShotSN : Default is 10000 shots per Table
	intTableSN = (intShotSN - 1) / SHOT_NUM_PER_TABLE + 1;

	// Insert MO Sensor Data Into INJPRO_Data_MO_[MOSN]_RawData_CustomSensor.MOCustomSensorSN[SN]_TableSN[SN]
	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN%d (ShotSN,ElapsedTime,SensorValue,DisplayValue) VALUE (%d,%lf,%.2lf,%.2lf*%lf)",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, intTableSN, intShotSN, doubleElapsedTime, doubleValue, doubleValue, doubleMOCustomSensorConvertRatio);

	return EXIT_FAILURE;

	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		// fprintf(stderr,"[DB_InsertMOCustomSensorData]:%s\n",charStatement);
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_InsertMOCustomSensorData]Fail to insert custom sensor data for "
											   "MOSN:%d MOSensroSN:%d TableSN:%d ShotSN:%d ElapasedTime:%lf Value:%.2lf (%d):%s\n",
				 intMOSN, intMOCustomSensorSN, intTableSN, intShotSN, doubleElapsedTime, doubleValue, mysql_errno(&mysqlCon), charErrMsg);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int DB_InsertMOCustomSensorDataBatch(MYSQL mysqlCon, unsigned int intMOSN, unsigned int *intShotSN, unsigned int intMOCustomSensorSN, double *doubleElapsedTime, double *doubleValue, double doubleMOCustomSensorConvertRatio, unsigned int intTail, unsigned int intHead)
//[DB]Insert Multiple Point Data (SensorValue,ElapsedTime) for A Specified ShotSN and Custom Sensor in An Existing MO
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	int intTableSN;

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Initial Value of MOCustomSensorTableSN ShotSN : Default is 10000 shots per Table
	intTableSN = (intShotSN[intTail] - 1) / SHOT_NUM_PER_TABLE + 1;

	// Create Table INJPRO_Data_MO_[MOSN]_RawData_CustomSensor.[MOCustomSensorSN]_[TableSN]
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN%d ("
											 "ShotSN	BIGINT UNSIGNED NOT NULL,"
											 "ElapsedTime	DOUBLE UNSIGNED,"
											 "SensorValue	DOUBLE,"
											 "DisplayValue	DOUBLE,"
											 "INDEX (ShotSN))"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, intTableSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_InsertMOCustomSensorDataBatch]Fail to create table %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, intTableSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Set Header for Insert Statement
	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN%d (ShotSN,ElapsedTime,SensorValue,DisplayValue) VALUES ",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, intTableSN);

	for (int i = intTail; i <= intHead; i++)
	{
#ifdef DEBUG_MODE_MODBUS
		fprintf(stderr, "[DB_InsertMOCustomSensorDataBatch]ShotSN:%d MOCustomSensorSN:%d ElapsedTime:%lf Voltage:%lf Converted Ratio:%lf Converted Value:%lf\n",
				intShotSN[i],										// ShotSN
				intMOCustomSensorSN,								// MOCustomSensorSN
				doubleElapsedTime[i],								// ElapsedTime
				doubleValue[i],										// Voltage
				doubleMOCustomSensorConvertRatio,					// Convertev Ratio
				doubleValue[i] * doubleMOCustomSensorConvertRatio); // Converted Value
#endif

		// If this Shot Should Insert into Next Table
		if (intTableSN != (intShotSN[i] - 1) / SHOT_NUM_PER_TABLE + 1)
		{

			// Change the last character ',' to '\0'
			charStatement[strlen(charStatement) - 1] = '\0';

			// fprintf(stderr, "Q:%s\n",charStatement);

			// Insert All Previous Rawdata
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				// fprintf(stderr,"[DB_InsertMOCustomSensorData]:%s\n",charStatement);
				snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_InsertMOCustomSensorDataBatch]Fail to insert batch rawdata for ShotSN:%d~%d MOSN:%d (%d):%s\n",
						 intShotSN[intTail], intShotSN[intHead], intMOSN, mysql_errno(&mysqlCon), charErrMsg);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}

			// Caculate Table for ShotSN : Default is 10000 shots per Table
			intTableSN = (intShotSN[i] - 1) / SHOT_NUM_PER_TABLE + 1;

			// Create Table INJPRO_Data_MO_[MOSN]_RawData_CustomSensor.[MOCustomSensorSN]_[TableSN]
			snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN%d ("
													 "ShotSN	BIGINT UNSIGNED NOT NULL,"
													 "ElapsedTime	DOUBLE UNSIGNED,"
													 "SensorValue	DOUBLE,"
													 "DisplayValue	DOUBLE,"
													 "INDEX (ShotSN))"
													 "ENGINE=InnoDB",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, intTableSN);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_InsertMOCustomSensorDataBatch]Fail to create table %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN%d (%d):%s",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, intTableSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}

			// Set Header for Insert Statement
			snprintf(charStatement, MAX_STRING_SIZE,
					 "INSERT INTO %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN%d (ShotSN,ElapsedTime,SensorValue,DisplayValue) VALUES ",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, intTableSN);
		}

		// Not the last one
		if (i != intHead)
		{
			snprintf(charStatement + strlen(charStatement), MAX_STRING_SIZE, "(%d,%lf,%lf,%lf),",
					 intShotSN[i], doubleElapsedTime[i], doubleValue[i], doubleValue[i] * doubleMOCustomSensorConvertRatio);
		}
		else
		{ // Last one
			snprintf(charStatement + strlen(charStatement), MAX_STRING_SIZE, "(%d,%lf,%lf,%lf)",
					 intShotSN[i], doubleElapsedTime[i], doubleValue[i], doubleValue[i] * doubleMOCustomSensorConvertRatio);
		}
	}

	// fprintf(stderr, "Q:%s\n",charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		// fprintf(stderr,"[DB_InsertMOCustomSensorData]:%s\n",charStatement);
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_InsertMOCustomSensorDataBatch]Fail to insert custom sensor data for ShotSN:%d~%d MOSN:%d (%d):%s\n",
				 intShotSN[intTail], intShotSN[intHead], intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	return EXIT_SUCCESS;
}

int DB_InsertMoldActionFeatureValue(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN)
//[DB]Insert Mold Action Feature Values (1)MoldClampedCycleTime (2)MoldBasedCycleTime (3)MoldShotInterval (4)MoldCompleteCycleTime
{

	int intIMMSN;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	int intTableSN;

	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemIndex;
	unsigned int intSPCSampleSize;

	double *doubleXBarValue;
	double *doubleRValue;

	double doubleMoldClampedCycleTime = 0;
	double doubleMoldBasedCycleTime = 0;
	double doubleMoldShotInterval = 0;
	double doubleMoldCompleteCycleTime = 0;
	double doubleMoldActionFeatureValue[4] = {0};

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT ShotSN,MoldClampedCycleTime,MoldBasedCycleTime,MoldShotInterval,MoldCompleteCycleTime FROM %s_%s_%s_%d_RawData.ShotSNList WHERE ShotSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN);
	//fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertMoldActionFeatureValue]Fail to select 4 mold related feature values of ShotSN:%d from table %s_%s_%s_%d_RawData.ShotSNList to SoftSensor(%d): %s",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		mysql_free_result(mysqlResult);
		return intLogSN;
	}
	else
	{
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow[0] == NULL || mysqlRow[1] == NULL || mysqlRow[2] == NULL || mysqlRow[3] == NULL || mysqlRow[4] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[DB_InsertMoldActionFeatureValue]Fail to select 4 mold related feature values of ShotSN:%d (one or more is NULL) from table %s_%s_%s_%d_RawData.ShotSNList",
					 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, 0, charErrMsg);
			mysql_free_result(mysqlResult);
			return intLogSN;
		}

		doubleMoldClampedCycleTime = atof(mysqlRow[1]);
		doubleMoldBasedCycleTime = atof(mysqlRow[2]);
		doubleMoldShotInterval = atof(mysqlRow[3]);
		doubleMoldCompleteCycleTime = atof(mysqlRow[4]);

		doubleMoldActionFeatureValue[1] = doubleMoldClampedCycleTime;
		doubleMoldActionFeatureValue[2] = doubleMoldBasedCycleTime;
		doubleMoldActionFeatureValue[3] = doubleMoldShotInterval;
		doubleMoldActionFeatureValue[4] = doubleMoldCompleteCycleTime;

		//fprintf(stderr, "ShotSN:%d MoldClampedCycleTime:%lf MoldBasedCycleTime:%lf MoldShotInterval:%lf MoldCompleteCycleTime:%lf\n",
		//intShotSN,doubleMoldClampedCycleTime, doubleMoldBasedCycleTime, doubleMoldShotInterval, doubleMoldCompleteCycleTime);
		mysql_free_result(mysqlResult);
	}

	/*
	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s_%s_%d_RawData_FeatureValue.SoftSensor(ShotSN, MoldClampedCycleTime,MoldBasedCycleTime,MoldShotInterval,MoldCompleteCycleTime) "
			 "SELECT ShotSN,MoldClampedCycleTime,MoldBasedCycleTime,MoldShotInterval,MoldCompleteCycleTime FROM %s_%s_%s_%d_RawData.ShotSNList WHERE ShotSN = %d "
			 "ON DUPLICATE KEY UPDATE "
			 "MoldClampedCycleTime=%s_%s_%s_%d_RawData.ShotSNList.MoldClampedCycleTime,"
			 "MoldBasedCycleTime=%s_%s_%s_%d_RawData.ShotSNList.MoldBasedCycleTime,"
			 "MoldShotInterval=%s_%s_%s_%d_RawData.ShotSNList.MoldShotInterval,"
			 "MoldCompleteCycleTime=%s_%s_%s_%d_RawData.ShotSNList.MoldCompleteCycleTime",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	*/

	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (ShotSN, MoldClampedCycleTime,MoldBasedCycleTime,MoldShotInterval,MoldCompleteCycleTime) VALUES (%d, %lf, %lf, %lf, %lf) "
			 "ON DUPLICATE KEY UPDATE "
			 "MoldClampedCycleTime = %lf, MoldBasedCycleTime = %lf, MoldShotInterval = %lf, MoldCompleteCycleTime = %lf",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 intShotSN, doubleMoldClampedCycleTime, doubleMoldBasedCycleTime, doubleMoldShotInterval, doubleMoldCompleteCycleTime,
			 doubleMoldClampedCycleTime, doubleMoldBasedCycleTime, doubleMoldShotInterval, doubleMoldCompleteCycleTime);
	//fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{

		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertMoldActionFeatureValue]Fail to copy 4 mold related feature values of ShotSN:%d from table %s_%s_%s_%d_RawData.ShotSNList to SoftSensor(%d): %s",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select MonitorItemSN for Each Feature Value
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN,MonitorItemIndex,SPCSampleSize FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList "
			 "WHERE MonitorItemClass = %d AND MonitorItemSensorSN IS NULL AND MonitorItemIndex >= %d AND MonitorItemIndex <= %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, MONITOR_ITEM_CLASS_SOFT, SOFT_MOLD_CLAMPED_CYCLETIME, SOFT_MOLD_COMPLETE_CYCLETIME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertMoldActionFeatureValue]Fail to select MonitorItemSN,MonitorItemIndex and SPCSampleSize for MonitorItemClass = SOFT (%d) and MonitorItemIndex %d to %d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 MONITOR_ITEM_CLASS_SOFT, SOFT_MOLD_CLAMPED_CYCLETIME, SOFT_MOLD_COMPLETE_CYCLETIME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	if (mysqlResult == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertMoldActionFeatureValue]No result of MonitorItemSN, MonitorItemIndex and SPCSampleSize for MonitorItemClass = SOFT(%d) and and MonitorItemIndex %d to %d from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
				 MONITOR_ITEM_CLASS_MODBUS, SOFT_MOLD_CLAMPED_CYCLETIME, SOFT_MOLD_COMPLETE_CYCLETIME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// For All MonitorItemSN Monitor Item
	while ((mysqlRow = mysql_fetch_row(mysqlResult)) != NULL)
	{
		if (mysqlRow[0] != NULL && mysqlRow[1] != NULL && mysqlRow[2] != NULL)
		{
			intMonitorItemSN = atoi(mysqlRow[0]);
			intMonitorItemIndex = atoi(mysqlRow[1]);
			intSPCSampleSize = atoi(mysqlRow[2]);

			//fprintf(stderr, "ShotSN:%d MonitorItemSN:%d MonitorItemIndex:%d SPCSampleSize:%d\n",
			//intShotSN, intMonitorItemSN, intMonitorItemIndex, intSPCSampleSize);

			// If A Group IS Completed
			if (intShotSN % intSPCSampleSize == 0)
			{
				// Fetch XBar Value
				intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleXBarValue);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[DB_InsertMoldActionFeatureValue]Fail to select XBar Value for MOSN:%d ShotSN:%d PointSize:%d MonitorItemSN:%d",
							 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE, intMonitorItemSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
					mysql_free_result(mysqlResult);
					return intLogSN;
				}

				// Fetch R Value
				intRetval = SPC_SelectRValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleRValue);
				if (intRetval != EXIT_SUCCESS)
				{
					//"[DB_InsertMoldActionFeatureValue]Fail to select R Value for MOSN:%d ShotSN:%d PointSize:%d",
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[DB_InsertMoldActionFeatureValue]Fail to select R Value for MOSN:%d ShotSN:%d PointSize:%d MonitorItemSN:%d",
							 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE, intMonitorItemSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
					mysql_free_result(mysqlResult);
					return intLogSN;
				}
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d"
						 "(ShotSN, GroupSN, XValue, XBarValue, RValue) VALUE (%d, %d, %lf, %lf, %lf)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN,
						 intShotSN, intShotSN / intSPCSampleSize,
						 doubleMoldActionFeatureValue[intMonitorItemIndex],
						 *doubleXBarValue, *doubleRValue);
				//fprintf(stderr, "Q:%s\n", charStatement);
			}
			else
			{
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d"
						 "(ShotSN, GroupSN, XValue, XBarValue, RValue) VALUE (%d, NULL, %lf, NULL, NULL)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN,
						 intShotSN, doubleMoldActionFeatureValue[intMonitorItemIndex]);
			}
			//fprintf(stderr, "Q:%s\n", charStatement);
			intRetval = mysql_query(&mysqlCon, charStatement);

			if (intRetval != EXIT_SUCCESS)
			{
				// fprintf(stderr,"Q:%s\n",charStatement);
				snprintf(charErrMsg, MAX_STRING_SIZE,
						 "[DB_InsertMoldActionFeatureValue]Fail to insert mold action feature values of "
						 "ShotSN:%d into table %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d (%d):%s",
						 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				mysql_free_result(mysqlResult);
				return intLogSN;
			}
		}
	}
	return EXIT_SUCCESS;
}

int DB_GetIMMSysPressureSensorFeatureValue(MYSQL mysqlCon, unsigned int intMOSN, double *doubleSensorData, unsigned int intSensorDataSize, char charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_SINGLE_FEATURE_NUM + 1][TINY_STRING_SIZE])
{
	double doubleSkpiElapsedTime = 0;
	double doubleInitialDefaultVoltage = 0;			 // Default Voltage without Foreign Force
	double doubleMinIdealStage1EndPressure = 4;		 // >= doubleMinIdealStage1StartPressure ==> Allow Stage 1 End
	double doubleMinIdealStage2EndTime = 3;			 // >= doubleMinIdealStage2EndTime ==> Allow Stage 2 End
	double doubleMinIdealStage2EndPressure = 0.2;	 // <= doubleMinIdealStage2EndPressure ==> Allow Stage 2 End
	double doubleMinIdealStage3StartPressure = 0.2;	 // <= doubleMinIdealStage3StartPressure ==> Allow STage 3 Start
	double doubleMinIdealStage3PeriodPressure = 0.4; // >= doubleMinIdealStage3PeriodPressure ==> Allow STage 3 End
	double doubleMinIdealStage3EndPressure = 0.2;	 // <= doubleMinIdealStage3EndPressure ==> Allow STage 3 End

	unsigned int intStage1StartIndex = -1;
	unsigned int intStage1EndIndex = -1;
	unsigned int intStage2StartIndex = -1;
	unsigned int intStage2EndIndex = -1;
	unsigned int intStage3StartIndex = -1;
	unsigned int intStage3EndIndex = -1;

	unsigned int intTempStage1StartIndex = -1;
	unsigned int intTempStage1EndIndex = -1;
	unsigned int intTempSTage3StartIndex = -1;
	unsigned int intTempStage3EndIndex = -1;

	double doubleStage1StartTime = 0;		 // 1
	double doubleStage1EndTime = 0;			 // 2
	double doubleStage1Period = 0;			 // 3
	double doubleAvgStage1PressureSlope = 0; // 4
	double doubleSumStage1Pressure = 0;		 // 5
	double doubleStage1EndPressure = 0;		 // 6

	double doubleStage2StartTime = 0;		 // 7
	double doubleStage2EndTime = 0;			 // 8
	double doubleStage2Period = 0;			 // 9
	double doubleAvgStage2PressureSlope = 0; // 10
	double doubleSumStage2Pressure = 0;		 // 11

	double doubleStage3StartTime = 0;		// 12
	double doubleStage3EndTime = 0;			// 13
	double doubleStage3Period = 0;			// 14
	double doubleMaxStage3Pressure = 0;		// 15
	double doubleMaxStage3PressureTime = 0; // 16
	double doubleSumStage3Pressure = 0;		// 17

	double doubleCycleTime = 0;	  // 18
	double doubleSumPressure = 0; // 19

	if (IGNORE_SYS_PRESSURE_STAGE3 == 1)
	{
		doubleMinIdealStage3PeriodPressure = 0.01; // >= doubleMinIdealStage3PeriodPressure ==> Allow STage 3 End
		doubleMinIdealStage3EndPressure = 0.12;	   // <= doubleMinIdealStage3EndPressure ==> Allow STage 3 End
	}

	/*
		//YongChan
		doubleSkpiElapsedTime = 0;
		doubleInitialDefaultVoltage = 0;		  // Default Voltage without Foreign Force
		doubleMinIdealStage1EndPressure = 3;	  // >= doubleMinIdealStage1StartPressure ==> Allow Stage 1 End
		doubleMinIdealStage2EndTime = 1.5;		  // >= doubleMinIdealStage2EndTime ==> Allow Stage 2 End
		doubleMinIdealStage2EndPressure = 2.6;	  // <= doubleMinIdealStage2EndPressure ==> Allow Stage 2 End
		doubleMinIdealStage3StartPressure = 2.6;  // <= doubleMinIdealStage3StartPressure ==> Allow STage 3 Start
		doubleMinIdealStage3PeriodPressure = 0.5; // >= doubleMinIdealStage3PeriodPressure ==> Allow STage 3 End
		doubleMinIdealStage3EndPressure = 2.6;	  // <= doubleMinIdealStage3EndPressure ==> Allow STage 3 End
	*/

	double doubleTempSTage1StartPressure = doubleMinIdealStage1EndPressure;
	double doubleTempStage1EndPressure;
	double doubleTempStage3EndPressure = doubleMinIdealStage3EndPressure;
	bool boolIsReadyForStage1StartIndex = false;
	bool boolIsReadyForStage3EndIndex = false;

	// doubleSensorData[X][0]: The ElapsedTime of the X-th row
	// doubleSensorData[X][1]: The SensorValue of the X-th row

	for (int i = 1; i <= IMM_SYSPRESSURE_SENSOR_SINGLE_FEATURE_NUM; i++)
	{
		snprintf(charIMMSysPressureSensorFeatureValue[i], TINY_STRING_SIZE, "NULL");
		// fprintf(stderr,"%d:%s\n",i,charIMMSysPressureSensorFeatureValue[i]);
	}

	if (intSensorDataSize == 0)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Empty IMM system presure sensor Data\n");
		return EXIT_FAILURE;
	}

	for (int i = 1; i < intSensorDataSize; i++)
	{
		if (*(doubleSensorData + i * 2) < doubleSkpiElapsedTime)
			continue;
		*(doubleSensorData + i * 2 + 1) -= doubleInitialDefaultVoltage; // Decrease Voltage to Escalate the Sensor Value

		if (intStage1StartIndex == -1 &&										  // If Stage1StartIndex Hasn't Found
			*(doubleSensorData + i * 2 + 1) <= doubleMinIdealStage1EndPressure && // SensorValue < Minimal Ideal Stage1 End Sensor Value
			*(doubleSensorData + i * 2 + 1) <= doubleTempSTage1StartPressure)	  // Find Minimal Pressure Index As Stage1StartIndex
		{
			doubleTempSTage1StartPressure = *(doubleSensorData + i * 2 + 1);
			intTempStage1StartIndex = i;
			// fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]TempStage1StartIndex:%d ElapsedTime:%lf SensorValue:%lf\n", i, *(doubleSensorData + i * 2), *(doubleSensorData + i * 2 + 1));
		}
		else if (intTempStage1StartIndex != -1 &&									// If At Least One Temp Stage 1 Index Has Found
				 intStage1StartIndex == -1 &&										// If Stage1StartIndex Hasn't Found
				 *(doubleSensorData + i * 2 + 1) > doubleMinIdealStage1EndPressure) // SensorValue > Minimal Ideal Stage1 End Sensor Value
		{
			intStage1StartIndex = intTempStage1StartIndex;
			doubleStage1StartTime = *(doubleSensorData + intStage1StartIndex * 2);
			doubleTempStage1EndPressure = *(doubleSensorData + i * 2 + 1); // Initial Minimal Stage 1 End Pressure As Stage 1 Start Pressure
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage1StartIndex:%d ElapsedTime:%lf SensorValue:%lf\n", intStage1StartIndex, doubleStage1StartTime, *(doubleSensorData + intStage1StartIndex * 2 + 1));

			// After Stage1StartIndex has Found, Assume Stage1EndIndex As the Same Index
			if (intTempStage1EndIndex == -1)
			{
				intTempStage1EndIndex = i;
				doubleTempStage1EndPressure = *(doubleSensorData + i * 2 + 1);
			}
		}

		if (intStage1StartIndex != -1 &&										// Stage1StartIndex Found
			intStage2EndIndex == -1 &&											// If Stage2EndIndex Hasn't Found
			*(doubleSensorData + i * 2) >= doubleMinIdealStage2EndTime &&		// ElapsedTime > Minimal Stage 2 End
			*(doubleSensorData + i * 2 + 1) <= doubleMinIdealStage2EndPressure) // SensorValue < Minimal Ideal Stage 2 End Pressure
		{
			intStage1EndIndex = intTempStage1EndIndex;							   // Set The Stage 1 End Index From Temp
			doubleStage1EndTime = *(doubleSensorData + intStage1EndIndex * 2);	   // Set The Stage 1 End Time
			doubleStage1EndPressure = doubleTempStage1EndPressure;				   // Set The Stage 1 End Pressure From Temp
			intStage2StartIndex = intTempStage1EndIndex;						   // Set The Stage 2 Start Index From Temp
			doubleStage2StartTime = *(doubleSensorData + intStage2StartIndex * 2); // Set The Stage 2 Start Time

			intStage2EndIndex = i;											   // Set The Stage 2 Start Index
			doubleStage2EndTime = *(doubleSensorData + intStage2EndIndex * 2); // Set The Stage 2 End Time
			doubleStage2Period = doubleStage2EndTime - doubleStage2StartTime;  // Set The Stage 2 Period
			// Once The Stage2 End Is Found, Stage1End and Stage2Start Can Be Confirmed As Well.
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage1EndIndex:%d ElapsedTime:%lf SensorValue:%lf\n", intStage1EndIndex, *(doubleSensorData + intStage1EndIndex * 2), *(doubleSensorData + intStage1EndIndex * 2 + 1));
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage2StartIndex:%d ElapsedTime:%lf SensorValue:%lf\n", intStage2StartIndex, *(doubleSensorData + intStage1EndIndex * 2), *(doubleSensorData + intStage1EndIndex * 2 + 1));
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage2EndIndex:%d ElapsedTime:%lf SensorValue:%lf\n", i, *(doubleSensorData + i * 2), *(doubleSensorData + i * 2 + 1));
		}

		// Before Stage2 End Find The Max Sensor Value As Stage 1 End Index (Also Stage 2 Start Index)
		if (intStage1StartIndex != -1 &&
			intStage2EndIndex == -1 &&
			*(doubleSensorData + i * 2 + 1) > doubleTempStage1EndPressure)
		{
			intTempStage1EndIndex = i;
			doubleTempStage1EndPressure = *(doubleSensorData + i * 2 + 1);
			// fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]TempStage1EndIndex:%d TempSensorValue:%lf\n", intTempStage1EndIndex, doubleTempStage1EndPressure);
		}

		if (intStage3StartIndex == -1 &&										 // If Stage3StartIndex Hasn't Found
			intStage2EndIndex != -1 &&											 // If Stage2EndIndex Has Found
			*(doubleSensorData + i * 2 + 1) > doubleMinIdealStage3StartPressure) // SensorValue >= Minimal Ideal Stage 3 Start Pressure
		{
			intStage3StartIndex = i - 1;
			doubleStage3StartTime = *(doubleSensorData + intStage3StartIndex * 2);
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage3StartIndex:%d ElapsedTime:%lf SensorValue:%lf\n", i, *(doubleSensorData + i * 2), *(doubleSensorData + i * 2 + 1));
		}

		if (boolIsReadyForStage3EndIndex == false &&							   // If Stage 3 End Ready Flag Is False
			intStage3EndIndex == -1 &&											   // If Stage 3 End Index Hasn't Found
			intStage3StartIndex != -1 &&										   // If Stage 3 Start Index Has Found
			*(doubleSensorData + i * 2 + 1) >= doubleMinIdealStage3PeriodPressure) // SensorValue >= Minimal Ideal Stage 3 Period Pressure
		{
			boolIsReadyForStage3EndIndex = true;
		}

		if (boolIsReadyForStage3EndIndex == true &&								  // If Stage3 Pressure Has Exceed THreshold(doubleMinIdealStage3MaxPressure)
			intStage3EndIndex == -1 &&											  // If Stage3EndIndex Hasn't Found
			intStage3StartIndex != -1 &&										  // If Stage2StartIndex Has Found
			*(doubleSensorData + i * 2 + 1) <= doubleMinIdealStage3EndPressure && // SensorValue < Ideal Minimal Sensor Value
			*(doubleSensorData + i * 2 + 1) <= doubleTempStage3EndPressure)		  // Find Minimal Pressure Index As Stage3 End Index
		{
			intTempStage3EndIndex = i;
			doubleTempStage3EndPressure = *(doubleSensorData + i * 2 + 1);
		}
		else if (boolIsReadyForStage3EndIndex == true &&							   // If Stage3 Pressure Has Exceed THreshold(doubleMinIdealStage3MaxPressure)
				 intStage3EndIndex == -1 &&											   // If Stage3EndIndex Hasn't Found
				 intStage3StartIndex != -1 &&										   // If Stage2StartIndex Has Found
				 *(doubleSensorData + i * 2 + 1) <= doubleMinIdealStage3EndPressure && // SensorValue < Ideal Minimal Sensor Value
				 *(doubleSensorData + i * 2 + 1) > doubleTempStage3EndPressure)		   // Find Minimal Pressure Index As Stage3 End Index
		{
			intStage3EndIndex = intTempStage3EndIndex;
			doubleStage3EndTime = *(doubleSensorData + intStage3EndIndex * 2);
			doubleStage3Period = doubleStage3EndTime - doubleStage3StartTime;
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage3EndIndex:%d ElapsedTime:%lf SensorValue:%lf\n", i, *(doubleSensorData + i * 2), *(doubleSensorData + i * 2 + 1));
		}

		if (boolIsReadyForStage3EndIndex == true &&								  // If Stage3 Pressure Has Exceed THreshold(doubleMinIdealStage3MaxPressure)
			intStage3EndIndex == -1 &&											  // If Stage3EndIndex Hasn't Found
			intStage3StartIndex != -1 &&										  // If Stage2StartIndex Has Found
			*(doubleSensorData + i * 2 + 1) <= doubleMinIdealStage3EndPressure && // SensorValue < Ideal Minimal Sensor Value
			i == intSensorDataSize - 1)											  // If This Is The Last Data Point
		{
			intStage3EndIndex = intTempStage3EndIndex;
			doubleStage3EndTime = *(doubleSensorData + intStage3EndIndex * 2);
			doubleStage3Period = doubleStage3EndTime - doubleStage3StartTime;
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage3EndIndex:%d ElapsedTime:%lf SensorValue:%lf\n", i, *(doubleSensorData + i * 2), *(doubleSensorData + i * 2 + 1));
		}
		doubleSumPressure += *(doubleSensorData + i * 2 + 1);
	}
	doubleCycleTime = *(doubleSensorData + (intSensorDataSize - 1) * 2) - *(doubleSensorData + 0 * 2);

	// Check If Stage1, Stage2, Stage 3
	if (intStage1StartIndex == -1)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage1StartIndex!\n");
		return EXIT_FAILURE;
	}
	else if (intStage1EndIndex == -1)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage1EndIndex!\n");
		return EXIT_FAILURE;
	}
	else if (intStage2StartIndex == -1)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage2StartIndex!\n");
		return EXIT_FAILURE;
	}
	else if (intStage2EndIndex == -1)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage2EndIndex!\n");
		return EXIT_FAILURE;
	}
	else if (intStage3StartIndex == -1)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage3StartIndex!\n");
		return EXIT_FAILURE;
	}
	else if (intStage3EndIndex == -1)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage3EndIndex!\n");
		return EXIT_FAILURE;
	}

	if (intStage1StartIndex != -1 && intStage1EndIndex != -1)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage1StartTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_START_TIME, doubleStage1StartTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_START_TIME], TINY_STRING_SIZE, "%lf", doubleStage1StartTime);

		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage1EndTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME, doubleStage1EndTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME], TINY_STRING_SIZE, "%lf", doubleStage1EndTime);

		doubleStage1Period = doubleStage1EndTime - doubleStage1StartTime;
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage1Period:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_PERIOD, doubleStage1Period);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_PERIOD], TINY_STRING_SIZE, "%lf", doubleStage1Period);
		if (intStage1StartIndex != intStage1EndIndex)
		{
			doubleAvgStage1PressureSlope =
				(*(doubleSensorData + intStage1EndIndex * 2 + 1) - *(doubleSensorData + intStage1StartIndex * 2 + 1)) /
				(*(doubleSensorData + intStage1EndIndex * 2) - *(doubleSensorData + intStage1StartIndex * 2));
		}
		else
			doubleAvgStage1PressureSlope = 0;
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:AvgStage1PressureSlope:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE, doubleAvgStage1PressureSlope);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE], TINY_STRING_SIZE, "%lf", doubleAvgStage1PressureSlope);
		for (int i = intStage1StartIndex; i <= intStage1EndIndex; i++)
			doubleSumStage1Pressure += *(doubleSensorData + i * 2 + 1);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:SumStage1Pressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE1_PRESSURE, doubleSumStage1Pressure);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE1_PRESSURE], TINY_STRING_SIZE, "%lf", doubleSumStage1Pressure);
		doubleStage1EndPressure = *(doubleSensorData + intStage1EndIndex * 2 + 1);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage1EndPressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE, doubleStage1EndPressure);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE], TINY_STRING_SIZE, "%lf", doubleStage1EndPressure);
	}

	if (intStage2StartIndex != -1 && intStage2EndIndex != -1)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage2StartTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_START_TIME, doubleStage2StartTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_START_TIME], TINY_STRING_SIZE, "%lf", doubleStage2StartTime);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage2EndTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_END_TIME, doubleStage2EndTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_END_TIME], TINY_STRING_SIZE, "%lf", doubleStage2EndTime);
		doubleStage2Period = doubleStage2EndTime - doubleStage2StartTime;
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage2Period:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_PERIOD, doubleStage2Period);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_PERIOD], TINY_STRING_SIZE, "%lf", doubleStage2Period);
		if (intStage2StartIndex != intStage2EndIndex)
		{
			doubleAvgStage2PressureSlope =
				(*(doubleSensorData + intStage2EndIndex * 2 + 1) - *(doubleSensorData + intStage2StartIndex * 2 + 1)) /
				(*(doubleSensorData + intStage2EndIndex * 2) - *(doubleSensorData + intStage2StartIndex * 2));
		}
		else
			doubleAvgStage2PressureSlope = 0;
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:AvgStage2PressureSlope:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE, doubleAvgStage2PressureSlope);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE], TINY_STRING_SIZE, "%lf", doubleAvgStage2PressureSlope);
		for (int i = intStage2StartIndex; i <= intStage2EndIndex; i++)
			doubleSumStage2Pressure += *(doubleSensorData + i * 2 + 1);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:SumStage2Pressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE2_PRESSURE, doubleSumStage2Pressure);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE2_PRESSURE], TINY_STRING_SIZE, "%lf", doubleSumStage2Pressure);
	}

	if (intStage3StartIndex != -1 && intStage3EndIndex != -1)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage3StartTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_START_TIME, doubleStage3StartTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_START_TIME], TINY_STRING_SIZE, "%lf", doubleStage3StartTime);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage3EndTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_END_TIME, doubleStage3EndTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_END_TIME], TINY_STRING_SIZE, "%lf", doubleStage3EndTime);
		doubleStage3Period = doubleStage3EndTime - doubleStage3StartTime;
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage3Period:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_PERIOD, doubleStage3Period);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_PERIOD], TINY_STRING_SIZE, "%lf", doubleStage3Period);
		for (int i = intStage3StartIndex; i <= intStage3EndIndex; i++)
		{

			if (*(doubleSensorData + i * 2 + 1) > doubleMaxStage3Pressure)
			{
				doubleMaxStage3Pressure = *(doubleSensorData + i * 2 + 1);
				doubleMaxStage3PressureTime = *(doubleSensorData + i * 2);
			}
			doubleSumStage3Pressure += *(doubleSensorData + i * 2 + 1);
		}
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:MaxStage3Pressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE, doubleMaxStage3Pressure);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE], TINY_STRING_SIZE, "%lf", doubleMaxStage3Pressure);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:MaxStage3PressureTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE_TIME, doubleMaxStage3PressureTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE_TIME], TINY_STRING_SIZE, "%lf", doubleMaxStage3PressureTime);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:SumStage3Pressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE3_PRESSURE, doubleSumStage3Pressure);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE3_PRESSURE], TINY_STRING_SIZE, "%lf", doubleSumStage3Pressure);
	}

	fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:CycleTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_CYCLE_TIME, doubleCycleTime);
	snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_CYCLE_TIME], TINY_STRING_SIZE, "%lf", doubleCycleTime);
	fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:SumPressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_PRESSURE, doubleSumPressure);
	snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_PRESSURE], TINY_STRING_SIZE, "%lf", doubleSumPressure);

	// for (int i = 1; i <= IMM_SYSPRESSURE_SENSOR_SINGLE_FEATURE_NUM; i++)
	//	fprintf(stderr, "Index:%d Value:%s\n", i, charIMMSysPressureSensorFeatureValue[i]);
	return EXIT_SUCCESS;
}

int DB_InsertIMMSysPressureSensorFeatureValue(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int intMOCustomSensorSN, char charIMMSysPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_SINGLE_FEATURE_NUM + 1][TINY_STRING_SIZE])
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemIndex;
	unsigned int intSPCSampleSize;
	double *doubleXBarValue;
	double *doubleRValue;

	// Mac
	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d "
			 "(	ShotSN,"
			 "	Stage1StartTime,		Stage1EndTime,		Stage1Period,		AvgStage1PressureSlope,		SumStage1Pressure,		Stage1EndPressure,"
			 "	Stage2StartTime,		Stage2EndTime,		Stage2Period,		AvgStage2PressureSlope,		SumStage2Pressure,"
			 "	Stage3StartTime,		Stage3EndTime,		Stage3Period,		MaxStage3Pressure,			MaxStage3PressureTime,	SumStage3Pressure,"
			 "	CycleTime,				SumPressure"
			 ") VALUE"
			 "(	%d,"
			 "	%s,						%s,					%s,					%s,							%s,						%s,"
			 "	%s,						%s,					%s,					%s,							%s,"
			 "	%s,						%s,					%s,					%s,							%s,						%s,"
			 "	%s,						%s)",
			 SYS_NAME,
			 DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN,
			 intShotSN,
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_START_TIME],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_PERIOD],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE1_PRESSURE],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_START_TIME],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_END_TIME],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_PERIOD],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE2_PRESSURE],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_START_TIME],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_END_TIME],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_PERIOD],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE_TIME],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE3_PRESSURE],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_CYCLE_TIME],
			 charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_PRESSURE]);
	intRetval = mysql_query(&mysqlCon, charStatement);

	// fprintf(stderr, "Q:%s\n", charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		// fprintf(stderr,"Q:%s\n",charStatement);
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_InsertIMMSysPressureSensorFeatureValue]Fail to insert IMM system pressure sensor feature value of ShotSN:%d MOCustomSensorSN:%d into "
				 "table %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
				 intShotSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select MonitorItemSN for Each Feature Value
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN,MonitorItemIndex,SPCSampleSize FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemClass = %d AND MonitorItemSensorSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertIMMSysPressureSensorFeatureValue]Fail to select MonitorItemSN,MonitorItemIndex and SPCSampleSize for MonitorItemClass = MODBUS(%d) and MonitorItemSensorSN = %d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	if (mysqlResult == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertIMMSysPressureSensorFeatureValue]No result of MonitorItemSN, MonitorItemIndex and SPCSampleSize for MonitorItemClass = MODBUS(%d) and MonitorItemSensorSN = %d from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
				 MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// For All MonitorItemSN Monitor Item
	while ((mysqlRow = mysql_fetch_row(mysqlResult)) != NULL)
	{
		if (mysqlRow[0] != NULL && mysqlRow[1] != NULL && mysqlRow[2] != NULL)
		{
			intMonitorItemSN = atoi(mysqlRow[0]);
			intMonitorItemIndex = atoi(mysqlRow[1]);
			intSPCSampleSize = atoi(mysqlRow[2]);

			// fprintf(stderr, "ShotSN:%d MonitorItemSN:%d MonitorItemIndex:%d SPCSampleSize:%d\n",
			//		intShotSN, intMonitorItemSN, intMonitorItemIndex, intSPCSampleSize);

			// If A Group IS Completed
			if (intShotSN % intSPCSampleSize == 0)
			{
				// Fetch XBar Value
				intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleXBarValue);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[DB_InsertIMMSysPressureSensorFeatureValue]Fail to select XBar Value for MOSN:%d ShotSN:%d PointSize:%d MonitorItemSN:%d",
							 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE, intMonitorItemSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
					// mysql_free_result(mysqlResult);
					return intLogSN;
				}

				// Fetch R Value
				intRetval = SPC_SelectRValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleRValue);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[DB_InsertIMMSysPressureSensorFeatureValue]Fail to select R Value for MOSN:%d ShotSN:%d PointSize:%d MonitorItemSN:%d",
							 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE, intMonitorItemSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
					// mysql_free_result(mysqlResult);
					return intLogSN;
				}
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d"
						 "(ShotSN, GroupSN, XValue, XBarValue, RValue) VALUE (%d, %d, %s, %lf, %lf)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN,
						 intShotSN, intShotSN / intSPCSampleSize,
						 charIMMSysPressureSensorFeatureValue[intMonitorItemIndex],
						 *doubleXBarValue, *doubleRValue);
				// fprintf(stderr, "Q:%s\n", charStatement);
			}
			else
			{
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d"
						 "(ShotSN, GroupSN, XValue, XBarValue, RValue) VALUE (%d, NULL, %s, NULL, NULL)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN,
						 intShotSN, charIMMSysPressureSensorFeatureValue[intMonitorItemIndex]);
			}

			intRetval = mysql_query(&mysqlCon, charStatement);
			// fprintf(stderr, "Q:%s\n", charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				// fprintf(stderr,"Q:%s\n",charStatement);
				snprintf(charErrMsg, MAX_STRING_SIZE,
						 "[DB_InsertIMMSysPressureSensorFeatureValue]Fail to insert IMM system pressure sensor feature value of "
						 "ShotSN:%d MOCustomSensorSN:%d into table %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d (%d):%s",
						 intShotSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				// mysql_free_result(mysqlResult);
				return intLogSN;
			}
		}
	}
	mysql_free_result(mysqlResult);

	return EXIT_SUCCESS;
}

int DB_InsertCavityPressureSensorFeatureValue(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int intMOCustomSensorSN, char charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_SINGLE_FEATURE_NUM + 1][TINY_STRING_SIZE])
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemIndex;
	unsigned int intSPCSampleSize;
	double *doubleXBarValue;
	double *doubleRValue;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d "
			 "(	ShotSN,"
			 "	MaxPressure,				SumStage1Pressure,			MaxPressureTime,"
			 "	AvgStage1PressureSlope,		AvgStage2PressureSlope,		MoldReleasePressure) VALUES "
			 "(	%d,"
			 "	%s,							%s,							%s,"
			 "	%s,							%s,							%s)",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN,
			 intShotSN,
			 charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE],
			 charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_STAGE1_PRESSURE_SUM],
			 charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE_TIME],
			 charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE],
			 charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE],
			 charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_RELEASED_PRESSURE]);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		// fprintf(stderr,"Q:%s\n",charStatement);
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_InsertCavityPressureSensorFeatureValue]Fail to insert mold pressure sensor feature value of ShotSN:%d MOCustomSensorSN:%d into "
				 "table %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
				 intShotSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select MonitorItemSN for Each Feature Value
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN,MonitorItemIndex,SPCSampleSize FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemClass = %d AND MonitorItemSensorSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertCavityPressureSensorFeatureValue]Fail to select MonitorItemSN,MonitorItemIndex and SPCSampleSize for MonitorItemClass = MODBUS(%d) and MonitorItemSensorSN = %d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	if (mysqlResult == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertCavityPressureSensorFeatureValue]No result of MonitorItemSN, MonitorItemIndex and SPCSampleSize for MonitorItemClass = MODBUS(%d) and MonitorItemSensorSN = %d from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
				 MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// For All MonitorItemSN Monitor Item
	while ((mysqlRow = mysql_fetch_row(mysqlResult)) != NULL)
	{
		if (mysqlRow[0] != NULL && mysqlRow[1] != NULL && mysqlRow[2] != NULL)
		{
			intMonitorItemSN = atoi(mysqlRow[0]);
			intMonitorItemIndex = atoi(mysqlRow[1]);
			intSPCSampleSize = atoi(mysqlRow[2]);

			// fprintf(stderr, "ShotSN:%d MonitorItemSN:%d MonitorItemIndex:%d SPCSampleSize:%d\n",
			//		intShotSN, intMonitorItemSN, intMonitorItemIndex, intSPCSampleSize);

			// If A Group IS Completed
			if (intShotSN % intSPCSampleSize == 0)
			{
				// Fetch XBar Value
				intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleXBarValue);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[DB_InsertCavityPressureSensorFeatureValue]Fail to select XBar Value for MOSN:%d ShotSN:%d PointSize:%d MonitorItemSN:%d",
							 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE, intMonitorItemSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
					mysql_free_result(mysqlResult);
					return intLogSN;
				}

				// Fetch R Value
				intRetval = SPC_SelectRValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleRValue);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[DB_InsertCavityPressureSensorFeatureValue]Fail to select R Value for MOSN:%d ShotSN:%d PointSize:%d MonitorItemSN:%d",
							 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE, intMonitorItemSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
					mysql_free_result(mysqlResult);
					return intLogSN;
				}
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d"
						 "(ShotSN, GroupSN, XValue, XBarValue, RValue) VALUE (%d, %d, %s, %lf, %lf)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN,
						 intShotSN, intShotSN / intSPCSampleSize,
						 charCavityPressureSensorFeatureValue[intMonitorItemIndex],
						 *doubleXBarValue, *doubleRValue);
			}
			else
			{
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d"
						 "(ShotSN, GroupSN, XValue, XBarValue, RValue) VALUE (%d, NULL, %s, NULL, NULL)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN,
						 intShotSN, charCavityPressureSensorFeatureValue[intMonitorItemIndex]);
			}

			intRetval = mysql_query(&mysqlCon, charStatement);
			// fprintf(stderr,"Q:%s\n",charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				// fprintf(stderr,"Q:%s\n",charStatement);
				snprintf(charErrMsg, MAX_STRING_SIZE,
						 "[DB_InsertCavityPressureSensorFeatureValue]Fail to insert cavity pressure sensor feature value of "
						 "ShotSN:%d MOCustomSensorSN:%d into table %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d (%d):%s",
						 intShotSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				mysql_free_result(mysqlResult);
				return intLogSN;
			}
		}
	}

	mysql_free_result(mysqlResult);
	return EXIT_SUCCESS;
}

int DB_GetCavityPressureSensorFeatureValue(MYSQL mysqlCon, unsigned int intMOSN, double *doubleSensorData, unsigned int intSensorDataSize, char charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_SINGLE_FEATURE_NUM + 1][TINY_STRING_SIZE])
{

	unsigned int intMaxPressureIndex = 0;
	double doubleMaxPressure = 0;
	double doubleMaxPressureTime = 0;
	double doubleSumStage1Pressure = 0;
	double doubleAvgStage1Slope = 0;
	double doubleAvgStage2Slope = 0;
	double doubleMoldReleasePressure = 0;

	// doubleSensorData[X][0]: The ElapsedTime of the X-th row
	// doubleSensorData[X][1]: The SensorValue of the X-th row

	if (intSensorDataSize == 0)
	{
		fprintf(stderr, "[DB_GetCavityPressureSensorFeatureValue]Empty Sensor Data\n");
		return EXIT_SUCCESS;
	}

	// Caculate MaxPressure, MaxPressureTime, MaxPressureIndex
	for (int i = 0; i < intSensorDataSize; i++)
	{
		// fprintf(stderr,"A[%lf][%lf]\n",*(doubleSensorData+i*2),*(doubleSensorData+i*2+1));
		if (*(doubleSensorData + i * 2 + 1) > doubleMaxPressure)
		{
			doubleMaxPressureTime = *(doubleSensorData + i * 2);
			doubleMaxPressure = *(doubleSensorData + i * 2 + 1);
			intMaxPressureIndex = i;
		}
	}

	// Caculate SumStage1Pressure
	for (int i = 0; i < intMaxPressureIndex; i++)
	{
		doubleSumStage1Pressure += (*(doubleSensorData + i * 2 + 1) + *(doubleSensorData + (i + 1) * 2 + 1)) * (*(doubleSensorData + (i + 1) * 2) - *(doubleSensorData + i * 2)) / 2.0;
	}

	// Caculate AvgStage1Slope
	if (doubleMaxPressureTime - *(doubleSensorData) != 0)
	{
		doubleAvgStage1Slope = (doubleMaxPressure - *(doubleSensorData + 1)) / (doubleMaxPressureTime - *(doubleSensorData));
	}
	else
	{
		fprintf(stderr, "[DB_GetCavityPressureSensorFeatureValue]Caculate doubleAvgStage1Slope fail\n");
		// return EXIT_FAILURE;
	}

	// Caculate MoldReleasePressure
	doubleMoldReleasePressure = *(doubleSensorData + (intSensorDataSize - 1) * 2 + 1);

	// Caculate AvgStage2Slope
	if (*(doubleSensorData + (intSensorDataSize - 1) * 2) - doubleMaxPressureTime != 0)
	{
		doubleAvgStage2Slope = (doubleMoldReleasePressure - doubleMaxPressure) / (*(doubleSensorData + (intSensorDataSize - 1) * 2) - doubleMaxPressureTime);
	}
	else
	{
		fprintf(stderr, "[DB_GetCavityPressureSensorFeatureValue]Caculate doubleAvgStage2Slope fail\n");
		// return EXIT_FAILURE;
	}

	snprintf(charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE], TINY_STRING_SIZE, "%lf", doubleMaxPressure);
	snprintf(charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE_TIME], TINY_STRING_SIZE, "%lf", doubleMaxPressureTime);
	snprintf(charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_STAGE1_PRESSURE_SUM], TINY_STRING_SIZE, "%lf", doubleSumStage1Pressure);
	snprintf(charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE], TINY_STRING_SIZE, "%lf", doubleAvgStage1Slope);
	snprintf(charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE], TINY_STRING_SIZE, "%lf", doubleAvgStage2Slope);
	snprintf(charCavityPressureSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_RELEASED_PRESSURE], TINY_STRING_SIZE, "%lf", doubleMoldReleasePressure);

	return EXIT_SUCCESS;
}

int DB_InsertCavityPressureSensorSoftSensorFeatureValue(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, char charNGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_SINGLE_FEATURE_NUM + 1][TINY_STRING_SIZE], char charFGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_SINGLE_FEATURE_NUM + 1][TINY_STRING_SIZE])
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intMoldSN;
	unsigned int intProdSN;
	unsigned int intFlagSPCAlarm[CAVITY_PRESSURE_SENSOR_SINGLE_FEATURE_NUM + CAVITY_PRESSURE_SOFT_SENSOR_FEATURE_NUM + 1] = {0};
	unsigned int boolFlagSPCReject = 0;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemIndex;
	unsigned int intSPCSampleSize;
	double *doubleXBarValue;
	double *doubleRValue;

	// Insert Mold Pressure SPC Feature Value
	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s_%s_%d_RawData_FeatureValue.SoftSensor ("
			 "ShotSN,	DiffMaxPressure,	DiffIncreasePressureTime,	DiffMoldReleasePressure) VALUES ("
			 "%d,		%s-%s,				%s-%s,						%s-%s) "
			 "ON DUPLICATE KEY UPDATE "
			 "DiffMaxPressure=%s-%s,"
			 "DiffIncreasePressureTime=%s-%s,"
			 "DiffMoldReleasePressure=%s-%s",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN,
			 charNGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE], charFGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE],
			 charNGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE_TIME], charFGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE_TIME],
			 charNGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_RELEASED_PRESSURE], charFGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_RELEASED_PRESSURE],
			 charNGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE], charFGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE],
			 charNGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE_TIME], charFGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE_TIME],
			 charNGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_RELEASED_PRESSURE], charFGMOCustomSensorFeatureValue[CAVITY_PRESSURE_SENSOR_FEATURE_RELEASED_PRESSURE]);
	// fprintf(stderr,"Q:%s\n",charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_InsertCavityPressureSensorSoftSensorFeatureValue]Fail to insert mold pressure sensor SoftSensor feature value of ShotSN:%d "
				 "into table %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select MonitorItemSN for Each Feature Value
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN,MonitorItemIndex,SPCSampleSize FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemClass = %d AND MonitorItemSensorSN IS NULL AND MonitorItemIndex >=%d AND MonitorItemIndex<=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, MONITOR_ITEM_CLASS_SOFT, SOFT_PRESSURE_SENSOR_FEATURE_DIFF_MAX_PRESSURE, SOFT_PRESSURE_SENSOR_FEATURE_DIFF_MOLD_RELEASEPRESSURE);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertCavityPressureSensorSoftSensorFeatureValue]Fail to select MonitorItemSN,MonitorItemIndex and SPCSampleSize for MonitorItemClass = SOFT(%d) from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 MONITOR_ITEM_CLASS_SOFT, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	if (mysqlResult == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertCavityPressureSensorSoftSensorFeatureValue]No result of MonitorItemSN, MonitorItemIndex and SPCSampleSize for MonitorItemClass = SOFT(%d) from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
				 MONITOR_ITEM_CLASS_SOFT, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// For All MonitorItemSN Monitor Item
	while ((mysqlRow = mysql_fetch_row(mysqlResult)) != NULL)
	{
		if (mysqlRow[0] != NULL && mysqlRow[1] != NULL && mysqlRow[2] != NULL)
		{
			intMonitorItemSN = atoi(mysqlRow[0]);
			intMonitorItemIndex = atoi(mysqlRow[1]);
			intSPCSampleSize = atoi(mysqlRow[2]);

			// fprintf(stderr, "ShotSN:%d MonitorItemSN:%d MonitorItemIndex:%d SPCSampleSize:%d\n",
			//	intShotSN, intMonitorItemSN, intMonitorItemIndex, intSPCSampleSize);

			// If A Group IS Completed
			if (intShotSN % intSPCSampleSize == 0)
			{
				// Fetch XBar Value
				intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleXBarValue);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[DB_InsertCavityPressureSensorSoftSensorFeatureValue]Fail to select XBar Value for MOSN:%d ShotSN:%d PointSize:%d MonitorItemSN:%d",
							 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE, intMonitorItemSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
					mysql_free_result(mysqlResult);
					return intLogSN;
				}

				// Fetch R Value
				intRetval = SPC_SelectRValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleRValue);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[DB_InsertCavityPressureSensorSoftSensorFeatureValue]Fail to select R Value for MOSN:%d ShotSN:%d PointSize:%d MonitorItemSN:%d",
							 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE, intMonitorItemSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
					mysql_free_result(mysqlResult);
					return intLogSN;
				}
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d"
						 "(ShotSN, GroupSN, XValue, XBarValue, RValue) VALUE (%d, %d, %s, %lf, %lf)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN,
						 intShotSN, intShotSN / intSPCSampleSize,
						 charNGMOCustomSensorFeatureValue[intMonitorItemIndex - MOLD_RELATED_SOFT_SENSOR_FEATURE_NUM],
						 *doubleXBarValue, *doubleRValue);
			}
			else
			{
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d"
						 "(ShotSN, GroupSN, XValue, XBarValue, RValue) VALUE (%d, NULL, %s, NULL, NULL)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN,
						 intShotSN, charNGMOCustomSensorFeatureValue[intMonitorItemIndex - MOLD_RELATED_SOFT_SENSOR_FEATURE_NUM]);
			}

			intRetval = mysql_query(&mysqlCon, charStatement);
			// fprintf(stderr,"Q:%s\n",charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				// fprintf(stderr,"Q:%s\n",charStatement);
				snprintf(charErrMsg, MAX_STRING_SIZE,
						 "[DB_InsertCavityPressureSensorSoftSensorFeatureValue]Fail to insert soft sensor feature value of "
						 "ShotSN:%d into table %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d (%d):%s",
						 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				mysql_free_result(mysqlResult);
				return intLogSN;
			}
		}
	}
	mysql_free_result(mysqlResult);

	/*
	intRetval = DB_InsertCavityPressureSensorCpk(mysqlCon, intMOSN, intShotSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_InsertCavityPressureSensorSoftSensorFeatureValue]Fail to insert Cpk ShotSN:%d into "
				 "table %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		//return intLogSN;
	}*/

	return EXIT_SUCCESS;
}

int DB_GetCavityTemperatureSensorFeatureValue(MYSQL mysqlCon, unsigned int intMOSN, double *doubleSensorData, unsigned int intSensorDataSize, char charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_SINGLE_FEATURE_NUM + 1][TINY_STRING_SIZE])
{

	double doubleStartTemperature = 0;

	unsigned int intMaxTemperatureIndex = 0;
	double doubleMaxTemperature = 0;
	double doubleMaxTemperatureTime = 0;

	double doubleSumStage1Temperature = 0;
	double doubleAvgStage1Slope = 0;
	double doubleAvgStage2Slope = 0;
	double doubleMoldReleaseTemperature = 0;

	int intStartTemperatureIndex;

	// doubleSensorData[X][0]: The ElapsedTime of the X-th row
	// doubleSensorData[X][1]: The SensorValue of the X-th row

	if (intSensorDataSize == 0)
	{
		fprintf(stderr, "[DB_GetCavityTemperatureSensorFeatureValue]Empty Sensor Data\n");
		return EXIT_SUCCESS;
	}

	// Caculate StartTemperature
	doubleStartTemperature = *(doubleSensorData + 1);

	// Caculate MoldReleaseTemperature
	doubleMoldReleaseTemperature = *(doubleSensorData + (intSensorDataSize - 1) * 2 + 1);

	// Caculate MaxTemperature, MaxTemperatureTime, MaxTemperatureIndex
	for (int i = 0; i < intSensorDataSize; i++)
	{
		// fprintf(stderr,"A[%lf][%lf]\n",*(doubleSensorData+i*2),*(doubleSensorData+i*2+1));
		if (*(doubleSensorData + i * 2 + 1) > doubleMaxTemperature)
		{
			doubleMaxTemperatureTime = *(doubleSensorData + i * 2);
			doubleMaxTemperature = *(doubleSensorData + i * 2 + 1);
			intMaxTemperatureIndex = i;
		}
	}

	// Caculate AvgStage2Slope
	doubleAvgStage2Slope = (doubleMoldReleaseTemperature - doubleMaxTemperature) / (*(doubleSensorData + (intSensorDataSize - 1) * 2) - doubleMaxTemperatureTime);

	snprintf(charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_FEATURE_START_TEMPERATURE], TINY_STRING_SIZE, "%lf", doubleStartTemperature);
	snprintf(charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE], TINY_STRING_SIZE, "%lf", doubleMaxTemperature);
	snprintf(charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE_TIME], TINY_STRING_SIZE, "%lf", doubleMaxTemperatureTime);
	snprintf(charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE], TINY_STRING_SIZE, "%lf", doubleAvgStage2Slope);
	snprintf(charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_FEATURE_RELEASED_TEMPERATURE], TINY_STRING_SIZE, "%lf", doubleMoldReleaseTemperature);

	/*
	for(int i=1;i<=CAVITY_TEMPERATURE_SENSOR_SINGLE_FEATURE_NUM;i++){
		fprintf(stderr,"[%d]:%s ",i,charCavityTemperatureSensorFeatureValue[i]);
	}*/
	// fprintf(stderr,"\n");

	return EXIT_SUCCESS;
}

int DB_InsertCavityTemperatureSensorFeatureValue(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int intMOCustomSensorSN, char charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_SINGLE_FEATURE_NUM + 1][TINY_STRING_SIZE])
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemIndex;
	unsigned int intSPCSampleSize;
	double *doubleXBarValue;
	double *doubleRValue;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d "
			 "(	ShotSN,							"
			 "	StartTemperature,				MaxTemperature,				MaxTemperatureTime,	"
			 "	AvgStage2TemperatureSlope,		MoldReleaseTemperature					)"
			 " VALUES "
			 "(	%d,"
			 "	%s,								%s,							%s,"
			 "	%s,								%s)",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN,
			 intShotSN,
			 charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_FEATURE_START_TEMPERATURE],
			 charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE],
			 charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE_TIME],
			 charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE],
			 charCavityTemperatureSensorFeatureValue[CAVITY_TEMPERATURE_SENSOR_FEATURE_RELEASED_TEMPERATURE]);
	intRetval = mysql_query(&mysqlCon, charStatement);

	// fprintf(stderr,"Q:%s\n",charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[DB_InsertMoldTemperatureSensorValue]Fail to insert mold temperature sensor feature value of ShotSN:%d MOCustomSensorSN:%d into "
				 "table %s_%s_%s_%d_RawData_FeatureValue.MoldTemperatureFeatureValueList (%d):%s",
				 intShotSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select MonitorItemSN for Each Feature Value
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN,MonitorItemIndex,SPCSampleSize FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemClass = %d AND MonitorItemSensorSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertCavityTemperatureSensorFeatureValue]Fail to select MonitorItemSN,MonitorItemIndex and SPCSampleSize for MonitorItemClass = MODBUS(%d) and MonitorItemSensorSN = %d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	if (mysqlResult == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertCavityTemperatureSensorFeatureValue]No result of MonitorItemSN, MonitorItemIndex and SPCSampleSize for MonitorItemClass = MODBUS(%d) and MonitorItemSensorSN = %d from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
				 MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// For All MonitorItemSN Monitor Item
	while ((mysqlRow = mysql_fetch_row(mysqlResult)) != NULL)
	{
		if (mysqlRow[0] != NULL && mysqlRow[1] != NULL && mysqlRow[2] != NULL)
		{
			intMonitorItemSN = atoi(mysqlRow[0]);
			intMonitorItemIndex = atoi(mysqlRow[1]);
			intSPCSampleSize = atoi(mysqlRow[2]);

			// fprintf(stderr, "ShotSN:%d MonitorItemSN:%d MonitorItemIndex:%d SPCSampleSize:%d\n",
			//		intShotSN, intMonitorItemSN, intMonitorItemIndex, intSPCSampleSize);

			// If A Group IS Completed
			if (intShotSN % intSPCSampleSize == 0)
			{
				// Fetch XBar Value
				intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleXBarValue);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[DB_InsertCavityTemperatureSensorFeatureValue]Fail to select XBar Value for MOSN:%d ShotSN:%d PointSize:%d MonitorItemSN:%d",
							 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE, intMonitorItemSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
					mysql_free_result(mysqlResult);
					return intLogSN;
				}

				// Fetch R Value
				intRetval = SPC_SelectRValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleRValue);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[DB_InsertCavityTemperatureSensorFeatureValue]Fail to select R Value for MOSN:%d ShotSN:%d PointSize:%d MonitorItemSN:%d",
							 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE, intMonitorItemSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
					mysql_free_result(mysqlResult);
					return intLogSN;
				}
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d"
						 "(ShotSN, GroupSN, XValue, XBarValue, RValue) VALUE (%d, %d, %s, %lf, %lf)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN,
						 intShotSN, intShotSN / intSPCSampleSize,
						 charCavityTemperatureSensorFeatureValue[intMonitorItemIndex],
						 *doubleXBarValue, *doubleRValue);
			}
			else
			{
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d"
						 "(ShotSN, GroupSN, XValue, XBarValue, RValue) VALUE (%d, NULL, %s, NULL, NULL)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN,
						 intShotSN, charCavityTemperatureSensorFeatureValue[intMonitorItemIndex]);
			}

			intRetval = mysql_query(&mysqlCon, charStatement);
			// fprintf(stderr,"Q:%s\n",charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				// fprintf(stderr,"Q:%s\n",charStatement);
				snprintf(charErrMsg, MAX_STRING_SIZE,
						 "[DB_InsertCavityTemperatureSensorFeatureValue]Fail to insert cavity temperature sensor feature value of "
						 "ShotSN:%d MOCustomSensorSN:%d into table %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d (%d):%s",
						 intShotSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				mysql_free_result(mysqlResult);
				return intLogSN;
			}
		}
	}
	mysql_free_result(mysqlResult);
	return EXIT_SUCCESS;
}

int DB_InsertAllCaCpCpkPpk(MYSQL mysqlCon, int intMOSN, int intShotSNStart, int intShotSNEnd)
//[DB]Insert Ca,Cp,Cpk and Ppk for All Monitor Items of An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intRowSize;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	MYSQL_RES *mysqlResultSPC;
	MYSQL_ROW mysqlRowSPC;
	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intSPCSensorMonitorIndex;
	char charMonitorItemDBName[SMALL_STRING_SIZE];
	double doubleQCUCL, doubleQCCL, doubleQCLCL;
	double doubleAVG, doubleSTD;
	double doubleCa, doubleCp, doubleCpk, doublePpk;
	int intExitStatus = EXIT_SUCCESS;

	// Select All Enable SPC Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT %s_%s_%s_%d_Info_Config.MonitorItemSNList.MonitorItemSN,MonitorItemName,MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex,"
			 "%s_%s_%s_%d_Info_Meta.MOControlLineList.XUCL,XCL,XLCL "
			 "FROM %s_%s_%s_%d_Info_Meta.MOControlLineList, %s_%s_%s_%d_Info_Config.MonitorItemSNList "
			 "WHERE %s_%s_%s_%d_Info_Meta.MOControlLineList.MonitorItemSN = %s_%s_%s_%d_Info_Config.MonitorItemSNList.MonitorItemSN "
			 "AND %s_%s_%s_%d_Info_Config.MonitorItemSNList.SPCEnable = 1",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_InsertAllCaCpCpkPpk]Fail to select all MonitorItemSN control line where SPCEnable = 1 from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	// intRowSize = (unsigned int)mysql_num_rows(mysqlResult);

	for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
	{
		// Get MonitorItemSN and Its QCUCL, QCCL,QCLCL
		intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
		if (mysqlRow[1] != NULL)
		{
			intRetval = DB_SelectMonitorItemDBName(mysqlCon, intMOSN, intMonitorItemSN, charMonitorItemDBName);
		}
		intMonitorItemClass = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
		// fprintf(stderr, "intMonitorItemClass:%d\n", intMonitorItemClass);
		intMonitorItemSensorSN = mysqlRow[3] != NULL ? atoi(mysqlRow[3]) : 0;
		// fprintf(stderr, "intMonitorItemSensorSN:%d\n", intMonitorItemSensorSN);
		intSPCSensorMonitorIndex = mysqlRow[4] != NULL ? atoi(mysqlRow[4]) : 0;
		// fprintf(stderr, "intSPCSensorMonitorIndex:%d\n", intSPCSensorMonitorIndex);
		doubleQCUCL = mysqlRow[5] != NULL ? atof(mysqlRow[5]) : 0;
		doubleQCCL = mysqlRow[6] != NULL ? atof(mysqlRow[6]) : 0;
		doubleQCLCL = mysqlRow[7] != NULL ? atof(mysqlRow[7]) : 0;
		fprintf(stderr, "MonitorItemSN:%d MonitorItemName:%s QCUCL:%lf QCCL:%lf QCLCL:%lf\n", intMonitorItemSN, charMonitorItemDBName, doubleQCUCL, doubleQCCL, doubleQCLCL);

		// Handle Various Categories of SPC Monitor Item
		if (intMonitorItemClass == MONITOR_ITEM_CLASS_QUALITY)
		{
			return EXIT_SUCCESS;
		}
		else if (intMonitorItemClass == MONITOR_ITEM_CLASS_OPCUA) // Select IMM Sensor Data from ShotSNStart to ShotSNEnd
		{
			// Select XBar Value
			snprintf(charStatement, MAX_STRING_SIZE,
					 "SELECT AVG(%s),STD(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList WHERE ShotSN >= %d AND ShotSN <= %d",
					 charMonitorItemDBName, charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSNStart, intShotSNEnd);

			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[DB_InsertAllCaCpCpkPpk]Fail to select AVG and STD value of IMMSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
						 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
			mysqlResultSPC = mysql_store_result(&mysqlCon);
		}
		else if (intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS)
		{
			// Select XBar Value
			snprintf(charStatement, MAX_STRING_SIZE,
					 "SELECT AVG(%s),STD(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN >= %d AND ShotSN <= %d",
					 charMonitorItemDBName, charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN, intShotSNStart, intShotSNEnd);

			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[DB_InsertAllCaCpCpkPpk]Fail to select AVG and STD value of IMMSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
						 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
			mysqlResultSPC = mysql_store_result(&mysqlCon);
		}
		else if (intMonitorItemClass == MONITOR_ITEM_CLASS_SOFT)
		{
			// Select XBar Valuep
			snprintf(charStatement, MAX_STRING_SIZE,
					 "SELECT AVG(%s),STD(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d",
					 charMonitorItemDBName, charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSNStart, intShotSNEnd);

			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[DB_InsertAllCaCpCpkPpk]Fail to select AVG and STD value of IMMSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
						 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
			mysqlResultSPC = mysql_store_result(&mysqlCon);
		}
		mysqlRowSPC = mysql_fetch_row(mysqlResultSPC);
		doubleAVG = mysqlRowSPC[0] != NULL ? atof(mysqlRowSPC[0]) : 0;
		doubleSTD = mysqlRowSPC[1] != NULL ? atof(mysqlRowSPC[1]) : 0;
		mysql_free_result(mysqlResultSPC);
		fprintf(stderr, "MonitorItemSN:%d MonitorItemName:%s ShotSN:%d-%d AVG:%lf STD:%lf ", intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd, doubleAVG, doubleSTD);

		doubleCa = fabs((doubleQCCL - doubleAVG) / ((doubleQCUCL - doubleQCLCL) / 2.0));
		doubleCp = (doubleQCUCL - doubleQCLCL) / (6.0 * doubleSTD);
		doubleCpk = (1.0 - fabs(doubleCa)) * doubleCp;
		doublePpk = (1 - doubleCa) * ((doubleQCUCL - doubleQCLCL) / (6.0 * doubleSTD));
		fprintf(stderr, "Ca:%lf Cp:%lf Cpk:%lf Ppk:%lf\n", doubleCa, doubleCp, doubleCpk, doublePpk);

		snprintf(charStatement, MAX_STRING_SIZE,
				 "INSERT INTO %s_%s_%s_%d_RawData_FeatureValue.SPCStatisticsList (MonitorItemSN,ShotSNStart,ShotSNEnd,Ca,Cp,Cpk,Ppk) VALUE (%d,%d,%d,%lf,%lf,%lf,%lf)",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intMonitorItemSN, intShotSNStart, intShotSNEnd, doubleCa, doubleCp, doubleCpk, doublePpk);
		// fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[DB_InsertAllCaCpCpkPpk]Fail to insert Ca,Cp,Cpk,Ppk into %s_%s_%s_%d_RawData_FeatureValue.SPCStatisticsList (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			intExitStatus = EXIT_FAILURE;
			// return intLogSN;
		}
	}
	mysql_free_result(mysqlResult);
	return intExitStatus;
}

int DB_UpdateCarbonEmission(MYSQL mysqlCon, int intMOSN)
{
	int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];

	snprintf(charStatement, MAX_STRING_SIZE, "SET @SumPowerConsumption =(SELECT SUM(MeltTemperature) FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList WHERE PartWeight IS NOT NULL)", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	mysql_query(&mysqlCon, charStatement);
	snprintf(charStatement, MAX_STRING_SIZE, "SET @ShotAmount =(SELECT COUNT(PartWeight) FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList WHERE PartWeight IS NOT NULL);", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	mysql_query(&mysqlCon, charStatement);
	snprintf(charStatement, MAX_STRING_SIZE, "SET @SumWeight = @ShotAmount * 13.23");
	mysql_query(&mysqlCon, charStatement);
	snprintf(charStatement, MAX_STRING_SIZE, "SET @CumulativeRealTimeCarbonEmission = @SumPowerConsumption * 0.601 + @SumWeight * 3.26 / 1000");
	mysql_query(&mysqlCon, charStatement);
	snprintf(charStatement, MAX_STRING_SIZE, "SET @CumulativeIndirectCarbonEmissionPropotion = @SumPowerConsumption * 0.601 /(@SumPowerConsumption * 0.601 + @SumWeight * 3.26 / 1000);");
	mysql_query(&mysqlCon, charStatement);
	snprintf(charStatement, MAX_STRING_SIZE, "SET @CumulativeDirectCarbonEmissionPropotion = 1 - @CumulativeIndirectCarbonEmissionPropotion");
	mysql_query(&mysqlCon, charStatement);
	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s.MOSNList "
											 "SET CumulativeRealTimeCarbonEmission = @CumulativeRealTimeCarbonEmission,"
											 "CumulativeIndirectCarbonEmissionPropotion = @CumulativeIndirectCarbonEmissionPropotion,"
											 "CumulativeDirectCarbonEmissionPropotion = @CumulativeDirectCarbonEmissionPropotion,"
											 "EstimatedCumulativePowerConsumption =(@SumPowerConsumption / @ShotAmount) * ExpectedProdShot,"
											 "EstimatedCumulativeCarbonEmission =(@SumPowerConsumption * 0.601 + @SumWeight * 3.26) / @ShotAmount * ExpectedProdShot "
											 "WHERE MOSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_UpdateCarbonEmission]Fail to update carbon emission related information for MOSN:%d in table %s_%s_%s.MOSNList (%d): %s",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int DB_UpdateCustomSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, char charCustomSN[TINY_STRING_SIZE])
//[DB]Update A Specified Custom SN for An Existing MO
{
	int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];

	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s_%s_%d_RawData.ShotSNList Set CustomSN = '%s' WHERE ShotSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, charCustomSN, intShotSN);
	fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[DB_UpdateCustomSN]Fail to update CustomSN for ShotSN:%d in table %s_%s_%s_%d_RawData.ShotSNList (%d): %s",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

//[INDEX]

int INDEX_InsertOPCUAVersion(MYSQL mysqlCon, unsigned int *intOPCUAVersionSN, const char *charOPCUAVersionID, char charOPCUAIMMNodeList[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1][OPCUA_META_NUM][MEDIUM_STRING_SIZE])
//[INDEX]Insert A New OPC UA Version
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charOPCUAVersionSN;

	int intRetval;
	unsigned int intLogSN;

	// Get Next OPCUAVersionSN
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s.OPCUAVersionIndex", SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "OPCUAVersionSN", &charOPCUAVersionSN);
	if (intRetval == EXIT_FAILURE)
		return EXIT_FAILURE;
	*intOPCUAVersionSN = atoi(charOPCUAVersionSN) + 1;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s.OPCUAVersionIndex ("
			 "OPCUAVersionSN							,	OPCUAVersionID,						"											   //
			 "DOMoldClampedType 						,	DOMoldClampedNS							,	DOMoldClampedID						," // 1
			 "DOMoldReleasedType 						,	DOMoldReleasedNS						,	DOMoldReleasedID					," // 2
			 "DOAlarmLampType 							,	DOAlarmLampNS							,	DOAlarmLampID						," // 3
			 "DOStoppedLampType 						,	DOStoppedLampNS							,	DOStoppedLampID						," // 4
			 "DORunningLampType							,	DORunningLampNS							,	DORunningLampID						," // 5
			 "DOMotorStartType							,	DOMotorStartNS							,	DOMotorStartID						," // 6
			 "DOOperationModeType						,	DOOperationModeNS						,	DOOperationModeID					," // 7
			 "DOShotCompleteType						,	DOShotCompleteNS						,	DOShotCompleteID					," // 8
			 "IMMParaInjectStageType					,	IMMParaInjectStageNS					,	IMMParaInjectStageID				," // 9
			 "IMMParaHoldStageType 						,	IMMParaHoldStageNS						,	IMMParaHoldStageID					," // 10
			 "IMMParaPlasStageType						,	IMMParaPlasStageNS						,	IMMParaPlasStageID					," // 11
			 "IMMParaMeltTemperatureType				,	IMMParaMeltTemperatureNS				,	IMMParaMeltTemperatureID			," // 12
			 "IMMParaPlastificationVolume1Type			,	IMMParaPlastificationVolume1NS			,	IMMParaPlastificationVolume1ID		," // 13
			 "IMMParaPlastificationVolume2Type			,	IMMParaPlastificationVolume2NS			,	IMMParaPlastificationVolume2ID		," // 14
			 "IMMParaPlastificationVolume3Type			,	IMMParaPlastificationVolume3NS			,	IMMParaPlastificationVolume3ID		," // 15
			 "IMMParaPlastificationVolume4Type			,	IMMParaPlastificationVolume4NS			,	IMMParaPlastificationVolume4ID		," // 16
			 "IMMParaPlastificationVolume5Type			,	IMMParaPlastificationVolume5NS			,	IMMParaPlastificationVolume5ID		," // 17
			 "IMMParaInjectionPressure1Type				,	IMMParaInjectionPressure1NS				,	IMMParaInjectionPressure1ID			," // 18
			 "IMMParaInjectionPressure2Type				,	IMMParaInjectionPressure2NS				,	IMMParaInjectionPressure2ID			," // 19
			 "IMMParaInjectionPressure3Type				,	IMMParaInjectionPressure3NS				,	IMMParaInjectionPressure3ID			," // 20
			 "IMMParaInjectionPressure4Type				,	IMMParaInjectionPressure4NS				,	IMMParaInjectionPressure4ID			," // 21
			 "IMMParaInjectionPressure5Type				,	IMMParaInjectionPressure5NS				,	IMMParaInjectionPressure5ID			," // 22
			 "IMMParaInjectionSpeed1Type				,	IMMParaInjectionSpeed1NS				,	IMMParaInjectionSpeed1ID			," // 23
			 "IMMParaInjectionSpeed2Type				,	IMMParaInjectionSpeed2NS				,	IMMParaInjectionSpeed2ID			," // 24
			 "IMMParaInjectionSpeed3Type				,	IMMParaInjectionSpeed3NS				,	IMMParaInjectionSpeed3ID			," // 25
			 "IMMParaInjectionSpeed4Type				,	IMMParaInjectionSpeed4NS				,	IMMParaInjectionSpeed4ID			," // 26
			 "IMMParaInjectionSpeed5Type				,	IMMParaInjectionSpeed5NS				,	IMMParaInjectionSpeed5ID			," // 27
			 "IMMParaVPChangeOverPositionType			,	IMMParaVPChangeOverPositionNS			,	IMMParaVPChangeOverPositionID		," // 28
			 "IMMParaVPChangeOverTimeType				,	IMMParaVPChangeOverTimeNS				,	IMMParaVPChangeOverTimeID			," // 29
			 "IMMParaPackingPressureType				,	IMMParaPackingPressureNS				,	IMMParaPackingPressureID			," // 30
			 "IMMParaHoldingPressure1Type				,	IMMParaHoldingPressure1NS				,	IMMParaHoldingPressure1ID			," // 31
			 "IMMParaHoldingPressure2Type				,	IMMParaHoldingPressure2NS				,	IMMParaHoldingPressure2ID			," // 32
			 "IMMParaHoldingPressure3Type				,	IMMParaHoldingPressure3NS				,	IMMParaHoldingPressure3ID			," // 33
			 "IMMParaHoldingPressure4Type				,	IMMParaHoldingPressure4NS				,	IMMParaHoldingPressure4ID			," // 34
			 "IMMParaHoldingPressure5Type				,	IMMParaHoldingPressure5NS				,	IMMParaHoldingPressure5ID			," // 35
			 "IMMParaPackingTimeType					,	IMMParaPackingTimeNS					,	IMMParaPackingTimeID				," // 36
			 "IMMParaHoldingTime1Type					,	IMMParaHoldingTime1NS					,	IMMParaHoldingTime1ID				," // 37
			 "IMMParaHoldingTime2Type					,	IMMParaHoldingTime2NS					,	IMMParaHoldingTime2ID				," // 38
			 "IMMParaHoldingTime3Type					,	IMMParaHoldingTime3NS					,	IMMParaHoldingTime3ID				," // 39
			 "IMMParaHoldingTime4Type					,	IMMParaHoldingTime4NS					,	IMMParaHoldingTime4ID				," // 40
			 "IMMParaHoldingTime5Type					,	IMMParaHoldingTime5NS					,	IMMParaHoldingTime5ID				," // 41
			 "IMMParaCoolingTimeType					,	IMMParaCoolingTimeNS					,	IMMParaCoolingTimeID				," // 42
			 "IMMParaScrewRPM1Type						,	IMMParaScrewRPM1NS						,	IMMParaScrewRPM1ID					," // 43
			 "IMMParaScrewRPM2Type						,	IMMParaScrewRPM2NS						,	IMMParaScrewRPM2ID					," // 44
			 "IMMParaScrewRPM3Type						,	IMMParaScrewRPM3NS						,	IMMParaScrewRPM3ID					," // 45
			 "IMMParaScrewRPM4Type						,	IMMParaScrewRPM4NS						,	IMMParaScrewRPM4ID					," // 46
			 "IMMParaScrewRPM5Type						,	IMMParaScrewRPM5NS						,	IMMParaScrewRPM5ID					," // 47
			 "IMMParaBackPressure1Type					,	IMMParaBackPressure1NS					,	IMMParaBackPressure1ID				," // 48
			 "IMMParaBackPressure2Type					,	IMMParaBackPressure2NS					,	IMMParaBackPressure2ID				," // 49
			 "IMMParaBackPressure3Type					,	IMMParaBackPressure3NS					,	IMMParaBackPressure3ID				," // 50
			 "IMMParaBackPressure4Type					,	IMMParaBackPressure4NS					,	IMMParaBackPressure4ID				," // 51
			 "IMMParaBackPressure5Type					,	IMMParaBackPressure5NS					,	IMMParaBackPressure5ID				," // 52
			 "IMMParaMoldTemperatureType				,	IMMParaMoldTemperatureNS				,	IMMParaMoldTemperatureID			," // 53
			 "IMMSensorCycleTimeType					,	IMMSensorCycleTimeNS					,	IMMSensorCycleTimeID				," // 54
			 "IMMSensorMoldClampingTimeType				,	IMMSensorMoldClampingTimeNS				,	IMMSensorMoldClampingTimeID			," // 55
			 "IMMSensorMoldReleasingTimeType			,	IMMSensorMoldReleasingTimeNS			,	IMMSensorMoldReleasingTimeID		," // 56
			 "IMMSensorInjectionTimeType 				,	IMMSensorInjectionTimeNS				,	IMMSensorInjectionTimeID			," // 57
			 "IMMSensorVPChangeOverDelayTimeType		,	IMMSensorVPChangeOverDelayTimeNS		,	IMMSensorVPChangeOverDelayTimeID	," // 58
			 "IMMSensorHoldingTimeType					,	IMMSensorHoldingTimeNS					,	IMMSensorHoldingTimeID				," // 59
			 "IMMSensorPlastificationTimeType			,	IMMSensorPlastificationTimeNS			,	IMMSensorPlastificationTimeID		," // 60
			 "IMMSensorVPChangeOverPositionType			,	IMMSensorVPChangeOverPositionNS			,	IMMSensorVPChangeOverPositionID		," // 61
			 "IMMSensorCusionVolumeType					,	IMMSensorCusionVolumeNS					,	IMMSensorCusionVolumeID				," // 62
			 "IMMSensorEndHoldingPositionType			,	IMMSensorEndHoldingPositionNS			,	IMMSensorEndHoldingPositionID		," // 63
			 "IMMSensorEndPlastificationPositionType	,	IMMSensorEndPlastificationPositionNS	,	IMMSensorEndPlastificationPositionID," // 64
			 "IMMSensorNozzle1TemperatureType			,	IMMSensorNozzle1TemperatureNS			,	IMMSensorNozzle1TemperatureID		," // 65
			 "IMMSensorNozzle2TemperatureType			,	IMMSensorNozzle2TemperatureNS			,	IMMSensorNozzle2TemperatureID		," // 66
			 "IMMSensorNozzle3TemperatureType			,	IMMSensorNozzle3TemperatureNS			,	IMMSensorNozzle3TemperatureID		," // 67
			 "IMMSensorNozzle4TemperatureType			,	IMMSensorNozzle4TemperatureNS			,	IMMSensorNozzle4TemperatureID		," // 68
			 "IMMSensorNozzle5TemperatureType			,	IMMSensorNozzle5TemperatureNS			,	IMMSensorNozzle5TemperatureID		," // 69
			 "IMMSensorIMMOilTemperatureType			,	IMMSensorIMMOilTemperatureNS			,	IMMSensorIMMOilTemperatureID		," // 70
			 "IMMSensorFallMaterialTemperatureType		,	IMMSensorFallMaterialTemperatureNS		,	IMMSensorFallMaterialTemperatureID	," // 71
			 "IMMSensorMaxInjectionPressureType			,	IMMSensorMaxInjectionPressureNS			,	IMMSensorMaxInjectionPressureID		," // 72
			 "IMMSensorVPChangeOverPressureType			,	IMMSensorVPChangeOverPressureNS			,	IMMSensorVPChangeOverPressureID		," // 73
			 "IMMSensorSumInjectionPressureType			,	IMMSensorSumInjectionPressureNS			,	IMMSensorSumInjectionPressureID		," // 74
			 "IMMSensorSumHoldingPressureType			,	IMMSensorSumHoldingPressureNS			,	IMMSensorSumHoldingPressureID		," // 75
			 "IMMSensorMaxCavityNearGatePressureType	,	IMMSensorMaxCavityNearGatePressureNS	,	IMMSensorMaxCavityNearGatePressureID," // 76
			 "IMMSensorMaxCavityFarGatePressureType		,	IMMSensorMaxCavityFarGatePressureNS		,	IMMSensorMaxCavityFarGatePressureID	," // 77
			 "IMMSensorSumCavityPressureType			,	IMMSensorSumCavityPressureNS			,	IMMSensorSumCavityPressureID		," // 78
			 "IMMSensorSumMoldClampingForceType			,	IMMSensorSumMoldClampingForceNS			,	IMMSensorSumMoldClampingForceID		," // 79
			 "IMMSensorMaxMoldClampingForceType			,	IMMSensorMaxMoldClampingForceNS			,	IMMSensorMaxMoldClampingForceID		," // 80
			 "IMMSensorMaxBackPressureType				,	IMMSensorMaxBackPressureNS				,	IMMSensorMaxBackPressureID			," // 81
			 "IMMSensorDelayPlastificationTimeType		,	IMMSensorDelayPlastificationTimeNS		,	IMMSensorDelayPlastificationTimeID	," // 82
			 "IMMSensorInMoldCoolingTemperatureType		,	IMMSensorInMoldCoolingTemperatureNS		,	IMMSensorInMoldCoolingTemperatureID	," // 83
			 "IMMSensorOutMoldCoolingTemperatureType	,	IMMSensorOutMoldCoolingTemperatureNS	,	IMMSensorOutMoldCoolingTemperatureID," // 84
			 "IMMSensorMoldCoolingVolumeType			,	IMMSensorMoldCoolingVolumeNS			,	IMMSensorMoldCoolingVolumeID		," // 85
			 "IMMSensorMoldReleasingPosition2Type		,	IMMSensorMoldReleasingPosition2NS		,	IMMSensorMoldReleasingPosition2ID	," // 86
			 "IMMSensorMoldReleasingPosition3Type		,	IMMSensorMoldReleasingPosition3NS		,	IMMSensorMoldReleasingPosition3ID	," // 87
			 "IMMSensorMoldReleasingPosition4Type		,	IMMSensorMoldReleasingPosition4NS		,	IMMSensorMoldReleasingPosition4ID	," // 88
			 "IMMSensorMoldReleasingPosition5Type		,	IMMSensorMoldReleasingPosition5NS		,	IMMSensorMoldReleasingPosition5ID	," // 89
			 "IMMSensorScrewSuckBackPositionType		,	IMMSensorScrewSuckBackPositionNS		,	IMMSensorScrewSuckBackPositionID	," // 90
			 "IMMSensorScrewRPMType						,	IMMSensorScrewRPMNS						,	IMMSensorScrewRPMID					," // 91
			 "IMMSensorPartWeightType					,	IMMSensorPartWeightNS					,	IMMSensorPartWeightID				," // 92
			 "IMMSensorGateClosingTimeType				,	IMMSensorGateClosingTimeNS				,	IMMSensorGateClosingTimeID			," // 93
			 "IMMSensorMeltTemperatureType				,	IMMSensorMeltTemperatureNS				,	IMMSensorMeltTemperatureID			," // 94
			 "IMMSensorMoldTemperatureType				,	IMMSensorMoldTemperatureNS				,	IMMSensorMoldTemperatureID			 " // 95
			 ") VALUE ("
			 "%d,'%s',"
			 "%s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s,"
			 "%s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s,"
			 "%s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s,"
			 "%s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s,"
			 "%s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s,"
			 "%s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s,"
			 "%s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s,"
			 "%s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s,"
			 "%s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s,"
			 "%s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s, %s,%s,%s)",
			 SYS_NAME, INDEX_DATABASE_NAME, *intOPCUAVersionSN, charOPCUAVersionID,
			 charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_IDENTIFIER_TYPE], // 1
			 charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_IDENTIFIER_TYPE], // 2
			 charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_IDENTIFIER_TYPE], // 3
			 charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_IDENTIFIER_TYPE], // 4
			 charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_IDENTIFIER_TYPE], // 5
			 charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_IDENTIFIER_TYPE], // 6
			 charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_IDENTIFIER_TYPE], // 7
			 charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_IDENTIFIER_TYPE], // 8
			 charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_IDENTIFIER_TYPE], // 9
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_IDENTIFIER_TYPE], // 10
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_IDENTIFIER_TYPE], // 11
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 12
			 charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_IDENTIFIER_TYPE], // 13
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_IDENTIFIER_TYPE], // 14
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_IDENTIFIER_TYPE], // 15
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_IDENTIFIER_TYPE], // 16
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_IDENTIFIER_TYPE], // 17
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], // 18
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], // 19
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], // 20
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], // 21
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], // 22
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_IDENTIFIER_TYPE], // 23
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_IDENTIFIER_TYPE], // 24
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_IDENTIFIER_TYPE], // 25
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_IDENTIFIER_TYPE], // 26
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_IDENTIFIER_TYPE], // 27
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], // 28
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_IDENTIFIER_TYPE], // 29
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 30
			 charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], // 31
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], // 32
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], // 33
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], // 34
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], // 35
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 36
			 charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_IDENTIFIER_TYPE], // 37
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_IDENTIFIER_TYPE], // 38
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_IDENTIFIER_TYPE], // 39
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_IDENTIFIER_TYPE], // 40
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_IDENTIFIER_TYPE], // 41
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 42
			 charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_IDENTIFIER_TYPE], // 43
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_IDENTIFIER_TYPE], // 44
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_IDENTIFIER_TYPE], // 45
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_IDENTIFIER_TYPE], // 46
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_IDENTIFIER_TYPE], // 47
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], // 48
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], // 49
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], // 50
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], // 51
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], // 52
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 53
			 charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_ID],

			 charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_IDENTIFIER_TYPE], // 54
			 charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 55
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 56
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_IDENTIFIER_TYPE], // 57
			 charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_IDENTIFIER_TYPE], // 58
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 59
			 charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], // 60
			 charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], // 61
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_IDENTIFIER_TYPE], // 62
			 charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_IDENTIFIER_TYPE], // 63
			 charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_IDENTIFIER_TYPE], // 64
			 charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 65
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 66
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 67
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 68
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 69
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 70
			 charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 71
			 charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 72
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 73
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 74
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 75
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 76
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 77
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 78
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], // 79
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], // 80
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 81
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], // 82
			 charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 83
			 charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 84
			 charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_IDENTIFIER_TYPE], // 85
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_IDENTIFIER_TYPE], // 86
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_IDENTIFIER_TYPE], // 87
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_IDENTIFIER_TYPE], // 88
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_IDENTIFIER_TYPE], // 89
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_IDENTIFIER_TYPE], // 90
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_IDENTIFIER_TYPE], // 91
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_IDENTIFIER_TYPE], // 92
			 charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 93
			 charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 94
			 charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 95
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_ID]);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[INDEX_InsertOPCUAVersion]Fail to insert OPC UA (Str:%s) into Table %s_%s.OPCUAVersionIndex (%d):%s",
				 charOPCUAVersionID, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_UpdateOPCUAVersion(MYSQL mysqlCon, unsigned int intOPCUAVersionSN, const char *charOPCUAVersionID, char charOPCUAIMMNodeList[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1][OPCUA_META_NUM][MEDIUM_STRING_SIZE])
//[INDEX]Update An Existing OP CUA Version
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charOPCUAVersionSN;
	int intRetval;
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s.OPCUAVersionIndex SET "
			 "OPCUAVersionID							= %s,"																							   //
			 "DOMoldClampedType 						= %s,	DOMoldClampedNS							= %s,	DOMoldClampedID						= %s," // 1
			 "DOMoldReleasedType 						= %s,	DOMoldReleasedNS						= %s,	DOMoldReleasedID					= %s," // 2
			 "DOAlarmLampType 							= %s,	DOAlarmLampNS							= %s,	DOAlarmLampID						= %s," // 3
			 "DOStoppedLampType 						= %s,	DOStoppedLampNS							= %s,	DOStoppedLampID						= %s," // 4
			 "DORunningLampType							= %s,	DORunningLampNS							= %s,	DORunningLampID						= %s," // 5
			 "DOMotorStartType							= %s,	DOMotorStartNS							= %s,	DOMotorStartID						= %s," // 6
			 "DOOperationModeType						= %s,	DOOperationModeNS						= %s,	DOOperationModeID					= %s," // 7
			 "DOShotCompleteType						= %s,	DOShotCompleteNS						= %s,	DOShotCompleteID					= %s," // 8
			 "IMMParaInjectStageType					= %s,	IMMParaInjectStageNS					= %s,	IMMParaInjectStageID				= %s," // 9
			 "IMMParaHoldStageType 						= %s,	IMMParaHoldStageNS						= %s,	IMMParaHoldStageID					= %s," // 10
			 "IMMParaPlasStageType						= %s,	IMMParaPlasStageNS						= %s,	IMMParaPlasStageID					= %s," // 11
			 "IMMParaMeltTemperatureType				= %s,	IMMParaMeltTemperatureNS				= %s,	IMMParaMeltTemperatureID			= %s," // 12
			 "IMMParaPlastificationVolume1Type			= %s,	IMMParaPlastificationVolume1NS			= %s,	IMMParaPlastificationVolume1ID		= %s," // 13
			 "IMMParaPlastificationVolume2Type			= %s,	IMMParaPlastificationVolume2NS			= %s,	IMMParaPlastificationVolume2ID		= %s," // 14
			 "IMMParaPlastificationVolume3Type			= %s,	IMMParaPlastificationVolume3NS			= %s,	IMMParaPlastificationVolume3ID		= %s," // 15
			 "IMMParaPlastificationVolume4Type			= %s,	IMMParaPlastificationVolume4NS			= %s,	IMMParaPlastificationVolume4ID		= %s," // 16
			 "IMMParaPlastificationVolume5Type			= %s,	IMMParaPlastificationVolume5NS			= %s,	IMMParaPlastificationVolume5ID		= %s," // 17
			 "IMMParaInjectionPressure1Type				= %s,	IMMParaInjectionPressure1NS				= %s,	IMMParaInjectionPressure1ID			= %s," // 18
			 "IMMParaInjectionPressure2Type				= %s,	IMMParaInjectionPressure2NS				= %s,	IMMParaInjectionPressure2ID			= %s," // 19
			 "IMMParaInjectionPressure3Type				= %s,	IMMParaInjectionPressure3NS				= %s,	IMMParaInjectionPressure3ID			= %s," // 20
			 "IMMParaInjectionPressure4Type				= %s,	IMMParaInjectionPressure4NS				= %s,	IMMParaInjectionPressure4ID			= %s," // 21
			 "IMMParaInjectionPressure5Type				= %s,	IMMParaInjectionPressure5NS				= %s,	IMMParaInjectionPressure5ID			= %s," // 22
			 "IMMParaInjectionSpeed1Type				= %s,	IMMParaInjectionSpeed1NS				= %s,	IMMParaInjectionSpeed1ID			= %s," // 23
			 "IMMParaInjectionSpeed2Type				= %s,	IMMParaInjectionSpeed2NS				= %s,	IMMParaInjectionSpeed2ID			= %s," // 24
			 "IMMParaInjectionSpeed3Type				= %s,	IMMParaInjectionSpeed3NS				= %s,	IMMParaInjectionSpeed3ID			= %s," // 25
			 "IMMParaInjectionSpeed4Type				= %s,	IMMParaInjectionSpeed4NS				= %s,	IMMParaInjectionSpeed4ID			= %s," // 26
			 "IMMParaInjectionSpeed5Type				= %s,	IMMParaInjectionSpeed5NS				= %s,	IMMParaInjectionSpeed5ID			= %s," // 27
			 "IMMParaVPChangeOverPositionType			= %s,	IMMParaVPChangeOverPositionNS			= %s,	IMMParaVPChangeOverPositionID		= %s," // 28
			 "IMMParaVPChangeOverTimeType				= %s,	IMMParaVPChangeOverTimeNS				= %s,	IMMParaVPChangeOverTimeID			= %s," // 29
			 "IMMParaPackingPressureType				= %s,	IMMParaPackingPressureNS				= %s,	IMMParaPackingPressureID			= %s," // 30
			 "IMMParaHoldingPressure1Type				= %s,	IMMParaHoldingPressure1NS				= %s,	IMMParaHoldingPressure1ID			= %s," // 31
			 "IMMParaHoldingPressure2Type				= %s,	IMMParaHoldingPressure2NS				= %s,	IMMParaHoldingPressure2ID			= %s," // 32
			 "IMMParaHoldingPressure3Type				= %s,	IMMParaHoldingPressure3NS				= %s,	IMMParaHoldingPressure3ID			= %s," // 33
			 "IMMParaHoldingPressure4Type				= %s,	IMMParaHoldingPressure4NS				= %s,	IMMParaHoldingPressure4ID			= %s," // 34
			 "IMMParaHoldingPressure5Type				= %s,	IMMParaHoldingPressure5NS				= %s,	IMMParaHoldingPressure5ID			= %s," // 35
			 "IMMParaPackingTimeType					= %s,	IMMParaPackingTimeNS					= %s,	IMMParaPackingTimeID				= %s," // 36
			 "IMMParaHoldingTime1Type					= %s,	IMMParaHoldingTime1NS					= %s,	IMMParaHoldingTime1ID				= %s," // 37
			 "IMMParaHoldingTime2Type					= %s,	IMMParaHoldingTime2NS					= %s,	IMMParaHoldingTime2ID				= %s," // 38
			 "IMMParaHoldingTime3Type					= %s,	IMMParaHoldingTime3NS					= %s,	IMMParaHoldingTime3ID				= %s," // 39
			 "IMMParaHoldingTime4Type					= %s,	IMMParaHoldingTime4NS					= %s,	IMMParaHoldingTime4ID				= %s," // 40
			 "IMMParaHoldingTime5Type					= %s,	IMMParaHoldingTime5NS					= %s,	IMMParaHoldingTime5ID				= %s," // 41
			 "IMMParaCoolingTimeType					= %s,	IMMParaCoolingTimeNS					= %s,	IMMParaCoolingTimeID				= %s," // 42
			 "IMMParaScrewRPM1Type						= %s,	IMMParaScrewRPM1NS						= %s,	IMMParaScrewRPM1ID					= %s," // 43
			 "IMMParaScrewRPM2Type						= %s,	IMMParaScrewRPM2NS						= %s,	IMMParaScrewRPM2ID					= %s," // 44
			 "IMMParaScrewRPM3Type						= %s,	IMMParaScrewRPM3NS						= %s,	IMMParaScrewRPM3ID					= %s," // 45
			 "IMMParaScrewRPM4Type						= %s,	IMMParaScrewRPM4NS						= %s,	IMMParaScrewRPM4ID					= %s," // 46
			 "IMMParaScrewRPM5Type						= %s,	IMMParaScrewRPM5NS						= %s,	IMMParaScrewRPM5ID					= %s," // 47
			 "IMMParaBackPressure1Type					= %s,	IMMParaBackPressure1NS					= %s,	IMMParaBackPressure1ID				= %s," // 48
			 "IMMParaBackPressure2Type					= %s,	IMMParaBackPressure2NS					= %s,	IMMParaBackPressure2ID				= %s," // 49
			 "IMMParaBackPressure3Type					= %s,	IMMParaBackPressure3NS					= %s,	IMMParaBackPressure3ID				= %s," // 50
			 "IMMParaBackPressure4Type					= %s,	IMMParaBackPressure4NS					= %s,	IMMParaBackPressure4ID				= %s," // 51
			 "IMMParaBackPressure5Type					= %s,	IMMParaBackPressure5NS					= %s,	IMMParaBackPressure5ID				= %s," // 52
			 "IMMParaMoldTemperatureType				= %s,	IMMParaMoldTemperatureNS				= %s,	IMMParaMoldTemperatureID			= %s," // 53
			 "IMMSensorCycleTimeType					= %s,	IMMSensorCycleTimeNS					= %s,	IMMSensorCycleTime					= %s," // 54
			 "IMMSensorMoldClampingTimeType				= %s,	IMMSensorMoldClampingTimeNS				= %s,	IMMSensorMoldClampingTimeID			= %s," // 55
			 "IMMSensorMoldReleasingTimeType			= %s,	IMMSensorMoldReleasingTimeNS			= %s,	IMMSensorMoldReleasingTimeID		= %s," // 56
			 "IMMSensorInjectionTimeType 				= %s,	IMMSensorInjectionTimeNS				= %s,	IMMSensorInjectionTimeID			= %s," // 57
			 "IMMSensorVPChangeOverDelayTimeType		= %s,	IMMSensorVPChangeOverDelayTimeNS		= %s,	IMMSensorVPChangeOverDelayTimeID	= %s," // 58
			 "IMMSensorHoldingTimeType					= %s,	IMMSensorHoldingTimeNS					= %s,	IMMSensorHoldingTimeID				= %s," // 59
			 "IMMSensorPlastificationTimeType			= %s,	IMMSensorPlastificationTimeNS			= %s,	IMMSensorPlastificationTimeID		= %s," // 60
			 "IMMSensorVPChangeOverPositionType			= %s,	IMMSensorVPChangeOverPositionNS			= %s,	IMMSensorVPChangeOverPositionID		= %s," // 61
			 "IMMSensorCusionVloumeType					= %s,	IMMSensorCusionVloumeNS					= %s,	IMMSensorCusionVloumeID				= %s," // 62
			 "IMMSensorEndHoldingPositionType			= %s,	IMMSensorEndHoldingPositionNS			= %s,	IMMSensorEndHoldingPositionID		= %s," // 63
			 "IMMSensorEndPlastificationPositionType	= %s,	IMMSensorEndPlastificationPositionNS	= %s,	IMMSensorEndPlastificationPositionID= %s," // 64
			 "IMMSensorNozzle1TemperatureType			= %s,	IMMSensorNozzle1TemperatureNS			= %s,	IMMSensorNozzle1TemperatureID		= %s," // 65
			 "IMMSensorNozzle2TemperatureType			= %s,	IMMSensorNozzle2TemperatureNS			= %s,	IMMSensorNozzle2TemperatureID		= %s," // 66
			 "IMMSensorNozzle3TemperatureType			= %s,	IMMSensorNozzle3TemperatureNS			= %s,	IMMSensorNozzle3TemperatureID		= %s," // 67
			 "IMMSensorNozzle4TemperatureType			= %s,	IMMSensorNozzle4TemperatureNS			= %s,	IMMSensorNozzle4TemperatureID		= %s," // 68
			 "IMMSensorNozzle5TemperatureType			= %s,	IMMSensorNozzle5TemperatureNS			= %s,	IMMSensorNozzle5TemperatureID		= %s," // 69
			 "IMMSensorIMMOilTemperatureType			= %s,	IMMSensorIMMOilTemperatureNS			= %s,	IMMSensorIMMOilTemperatureID		= %s," // 70
			 "IMMSensorFallMaterialTemperatureType		= %s,	IMMSensorFallMaterialTemperatureNS		= %s,	IMMSensorFallMaterialTemperatureID	= %s," // 71
			 "IMMSensorMaxInjectionPressureType			= %s,	IMMSensorMaxInjectionPressureNS			= %s,	IMMSensorMaxInjectionPressureID		= %s," // 72
			 "IMMSensorVPChangeOverPressureType			= %s,	IMMSensorVPChangeOverPressureNS			= %s,	IMMSensorVPChangeOverPressureID		= %s," // 73
			 "IMMSensorMaxCavityNearGatePressureType	= %s,	IMMSensorMaxCavityNearGatePressureNS	= %s,	IMMSensorMaxCavityNearGatePressureID= %s," // 74
			 "IMMSensorSumInjectionPressureType			= %s,	IMMSensorSumInjectionPressureNS			= %s,	IMMSensorSumInjectionPressureID		= %s," // 75
			 "IMMSensorSumHoldingPressureType			= %s,	IMMSensorSumHoldingPressureNS			= %s,	IMMSensorSumHoldingPressureID		= %s," // 76
			 "IMMSensorMaxCavityNearGatePressureType	= %s,	IMMSensorMaxCavityNearGatePressureNS	= %s,	IMMSensorMaxCavityNearGatePressureID= %s," // 77
			 "IMMSensorMaxCavityFarGatePressureType		= %s,	IMMSensorMaxCavityFarGatePressureNS		= %s,	IMMSensorMaxCavityFarGatePressureID	= %s," // 78
			 "IMMSensorSumCavityPressureType			= %s,	IMMSensorSumCavityPressureNS			= %s,	IMMSensorSumCavityPressureID		= %s," // 79
			 "IMMSensorSumMoldClampingForceType			= %s,	IMMSensorSumMoldClampingForceNS			= %s,	IMMSensorSumMoldClampingForceID		= %s," // 80
			 "IMMSensorMaxMoldClampingForceType			= %s,	IMMSensorMaxMoldClampingForceNS			= %s,	IMMSensorMaxMoldClampingForceID		= %s," // 81
			 "IMMSensorMaxBackPressureType				= %s,	IMMSensorMaxBackPressureNS				= %s,	IMMSensorMaxBackPressureID			= %s " // 82
			 "IMMSensorDelayPlastificationTimeType		= %s,	IMMSensorDelayPlastificationTimeNS		= %s,	IMMSensorDelayPlastificationTimeID	= %s," // 83
			 "IMMSensorInMoldCoolingTemperatureType		= %s,	IMMSensorInMoldCoolingTemperatureNS		= %s,	IMMSensorInMoldCoolingTemperatureID	= %s," // 84
			 "IMMSensorOutMoldCoolingTemperatureType	= %s,	IMMSensorOutMoldCoolingTemperatureNS	= %s,	IMMSensorOutMoldCoolingTemperatureID= %s," // 85
			 "IMMSensorMoldCoolingVolumeType			= %s,	IMMSensorMoldCoolingVolumeNS			= %s,	IMMSensorMoldCoolingVolumeID		= %s," // 86
			 "IMMSensorMoldReleasingPosition2Type		= %s,	IMMSensorMoldReleasingPosition2NS		= %s,	IMMSensorMoldReleasingPosition2ID	= %s," // 87
			 "IMMSensorMoldReleasingPosition3Type		= %s,	IMMSensorMoldReleasingPosition3NS		= %s,	IMMSensorMoldReleasingPosition3ID	= %s," // 88
			 "IMMSensorMoldReleasingPosition4Type		= %s,	IMMSensorMoldReleasingPosition4NS		= %s,	IMMSensorMoldReleasingPosition4ID	= %s," // 89
			 "IMMSensorMoldReleasingPosition5Type		= %s,	IMMSensorMoldReleasingPosition5NS		= %s,	IMMSensorMoldReleasingPosition5ID	= %s," // 90
			 "IMMSensorScrewSuckBackPositionType		= %s,	IMMSensorScrewSuckBackPositionNS		= %s,	IMMSensorScrewSuckBackPositionID	= %s," // 91
			 "IMMSensorPartWeightType					= %s,	IMMSensorPartWeightNS					= %s,	IMMSensorPartWeightID				= %s," // 92
			 "IMMSensorGateClosingTimeType				= %s,	IMMSensorGateClosingTimeNS				= %s,	IMMSensorGateClosingTimeID			= %s," // 93
			 "IMMSensorMeltTemperatureType				= %s,	IMMSensorMeltTemperatureNS				= %s,	IMMSensorMeltTemperatureID			= %s," // 94
			 "IMMSensorMoldTemperatureType				= %s,	IMMSensorMoldTemperatureNS				= %s,	IMMSensorMoldTemperatureID			= %s," // 95
			 "WHERE OPCUAVersionSN = %d",
			 SYS_NAME, INDEX_DATABASE_NAME, charOPCUAVersionID,
			 charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_IDENTIFIER_TYPE], // 1
			 charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_IDENTIFIER_TYPE], // 2
			 charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_IDENTIFIER_TYPE], // 3
			 charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_IDENTIFIER_TYPE], // 4
			 charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_IDENTIFIER_TYPE], // 5
			 charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_IDENTIFIER_TYPE], // 6
			 charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_IDENTIFIER_TYPE], // 7
			 charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_IDENTIFIER_TYPE], // 8
			 charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_IDENTIFIER_TYPE], // 9
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_IDENTIFIER_TYPE], // 10
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_IDENTIFIER_TYPE], // 11
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 12
			 charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_IDENTIFIER_TYPE], // 13
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_IDENTIFIER_TYPE], // 14
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_IDENTIFIER_TYPE], // 15
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_IDENTIFIER_TYPE], // 16
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_IDENTIFIER_TYPE], // 17
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], // 18
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], // 19
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], // 20
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], // 21
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], // 22
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_IDENTIFIER_TYPE], // 23
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_IDENTIFIER_TYPE], // 24
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_IDENTIFIER_TYPE], // 25
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_IDENTIFIER_TYPE], // 26
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_IDENTIFIER_TYPE], // 27
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], // 28
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_IDENTIFIER_TYPE], // 29
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 30
			 charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], // 31
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], // 32
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], // 33
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], // 34
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], // 35
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 36
			 charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_IDENTIFIER_TYPE], // 37
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_IDENTIFIER_TYPE], // 38
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_IDENTIFIER_TYPE], // 39
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_IDENTIFIER_TYPE], // 40
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_IDENTIFIER_TYPE], // 41
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 42
			 charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_IDENTIFIER_TYPE], // 43
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_IDENTIFIER_TYPE], // 44
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_IDENTIFIER_TYPE], // 45
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_IDENTIFIER_TYPE], // 46
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_IDENTIFIER_TYPE], // 47
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], // 48
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], // 49
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], // 50
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], // 51
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], // 52
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 53
			 charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_ID],

			 charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_IDENTIFIER_TYPE], // 54
			 charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 55
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 56
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_IDENTIFIER_TYPE], // 57
			 charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_IDENTIFIER_TYPE], // 58
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 59
			 charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], // 60
			 charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], // 61
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_IDENTIFIER_TYPE], // 62
			 charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_IDENTIFIER_TYPE], // 63
			 charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_IDENTIFIER_TYPE], // 64
			 charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 65
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 66
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 67
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 68
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 69
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 70
			 charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 71
			 charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 72
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 73
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 74
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 75
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 76
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 77
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 78
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], // 79
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], // 80
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], // 81
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], // 82
			 charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 83
			 charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 84
			 charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_IDENTIFIER_TYPE], // 85
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_IDENTIFIER_TYPE], // 86
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_IDENTIFIER_TYPE], // 87
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_IDENTIFIER_TYPE], // 88
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_IDENTIFIER_TYPE], // 89
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_IDENTIFIER_TYPE], // 90
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_IDENTIFIER_TYPE], // 91
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_IDENTIFIER_TYPE], // 92
			 charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_IDENTIFIER_TYPE], // 93
			 charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 94
			 charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_ID],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], // 95
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_NS],
			 charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_ID],
			 intOPCUAVersionSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[INDEX_UpdateOPCUAVersion]Fail to update OPC UA (Str:%s) in %s_%s.OPCUAVersionIndex (%d):%s",
				 charOPCUAVersionID, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_MaskOPCUAVersion(MYSQL mysqlCon, unsigned int intOPCUAVersionSN)
//[INDEX]Mask An Existing OPC UA Version
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.OPCUAVersionIndex SET OPCUAVersionMasked = 1 WHERE OPCUAVersionSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, intOPCUAVersionSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[INDEX_MaskOPCUAVersion]Fail to mask OPC UA Version (SN:%d) from Table %s_%s.OPCUAVersionIndex (%d):%s",
				 intOPCUAVersionSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_DeleteOPCUAVersion(MYSQL mysqlCon, unsigned int intOPCUAVersionSN)
//[INDEX]Delete An Existing OPC UA Version
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s.OPCUAVersionIndex WHERE OPCUAVersionSN=%d", SYS_NAME, INDEX_DATABASE_NAME, intOPCUAVersionSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[INDEX_DeleteOPCUAVersion]Fail to delete OPC UA Version (SN:%d) from Table %s_%s.OPCUAVersionIndex (%d):%s",
				 intOPCUAVersionSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_InsertIMMModel(MYSQL mysqlCon, unsigned int *intIMMModelSN, const char *charIMMVendor, const char *charIMMModel, stIMMModelSN varIMMModelSN)
//[INDEX]Insert A New IMM Model
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charIMMModelSN;
	int intRetval;
	int intLength;
	unsigned int intLogSN;

	// Get Next OPCUAVersionSN
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s.IMMModelIndex", SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "IMMModelSN", &charIMMModelSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_InsertIMMModel]Fail to get max IMMMoselSN in table %s_%s.IMMModelIndex", SYS_NAME, INDEX_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
		return intLogSN;
	}
	*intIMMModelSN = atoi(charIMMModelSN) + 1;

	if ((intLength = strlen(varIMMModelSN.charIMMModelMeta)) != 0)
	{
		strcpy(varIMMModelSN.charIMMModelMeta + 1, varIMMModelSN.charIMMModelMeta);
		varIMMModelSN.charIMMModelMeta[0] = '"';
		varIMMModelSN.charIMMModelMeta[intLength + 1] = '"';
		varIMMModelSN.charIMMModelMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varIMMModelSN.charIMMModelMeta, "NULL");

	snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s.IMMModelIndex (IMMModelSN,IMMVendor,IMMModel,IMMModelMeta) VALUE (%d,'%s','%s',%s)",
			 SYS_NAME, INDEX_DATABASE_NAME, *intIMMModelSN, charIMMVendor, charIMMModel, varIMMModelSN.charIMMModelMeta);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_InsertIMMModel]Fail to insert IMMModel:%s %s into table %s_%s.IMMModelIndex (%d):%s",
				 charIMMVendor, charIMMModel, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_UpdateIMMModel(MYSQL mysqlCon, unsigned int intIMMModelSN, const char *charIMMVendor, const char *charIMMModel, stIMMModelSN varIMMModelSN)
//[INDEX]Update An Existing IMM Model
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charIMMModelSN;
	int intRetval;
	int intLength;
	unsigned int intLogSN;

	// Handle Empty String and Add String Quotes Marks and Sting End Character
	if ((intLength = strlen(varIMMModelSN.charIMMModelMeta)) != 0)
	{
		strcpy(varIMMModelSN.charIMMModelMeta + 1, varIMMModelSN.charIMMModelMeta);
		varIMMModelSN.charIMMModelMeta[0] = '"';
		varIMMModelSN.charIMMModelMeta[intLength + 1] = '"';
		varIMMModelSN.charIMMModelMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varIMMModelSN.charIMMModelMeta, "NULL");

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMModelIndex SET IMMVendor = '%s',IMMModel = '%s', IMMModelMeta = %s WHERE IMMModelSN = %d",
			 SYS_NAME, INDEX_DATABASE_NAME, charIMMVendor, charIMMModel, varIMMModelSN.charIMMModelMeta, intIMMModelSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_UpdateIMMModel]Fail to update IMMModel:%s %s in table %s_%s.IMMModelIndex (%d):%s",
				 charIMMVendor, charIMMModel, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_MaskIMMModel(MYSQL mysqlCon, unsigned int intIMMModelSN)
//[INDEX]Mask An Existing IMM Model
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMModelIndex SET IMMModelMask = 1 WHERE IMMModelSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, intIMMModelSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_MaskIMMModel]Fail to mask IMMModel (SN:%d) from Table %s_%s.IMMModelIndex (%d):%s",
				 intIMMModelSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_DeleteIMMModel(MYSQL mysqlCon, unsigned int intIMMModelSN)
//[INDEX]Delete An Existing IMM Model
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s.IMMModelIndex WHERE IMMModelSN=%d", SYS_NAME, INDEX_DATABASE_NAME, intIMMModelSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_DeleteIMMModel]Fail to delete IMMModel (SN:%d) from Table %s_%s.IMMModelIndex (%d):%s",
				 intIMMModelSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_InsertMold(MYSQL mysqlCon, unsigned int *intMoldSN, const char *charMoldVendor, const char *charMoldID, stMoldSN varMoldSN)
//[INDEX]Insert A New Mold
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charMoldSN;

	int intRetval;
	int intLength;
	unsigned int intLogSN;

	// Get Next OPCUAVersionSN
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s.MoldIndex", SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "MoldSN", &charMoldSN);
	if (intRetval == EXIT_FAILURE)
		return EXIT_FAILURE;
	*intMoldSN = atoi(charMoldSN) + 1;

	if ((intLength = strlen(varMoldSN.charMoldMeta)) != 0)
	{
		strcpy(varMoldSN.charMoldMeta + 1, varMoldSN.charMoldMeta);
		varMoldSN.charMoldMeta[0] = '"';
		varMoldSN.charMoldMeta[intLength + 1] = '"';
		varMoldSN.charMoldMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varMoldSN.charMoldMeta, "NULL");

	snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s.MoldIndex (MoldSN,MoldVendor,MoldID,MoldMeta) VALUE (%d,'%s','%s',%s)",
			 SYS_NAME, INDEX_DATABASE_NAME, *intMoldSN, charMoldVendor, charMoldID, varMoldSN.charMoldMeta);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_InsertMold]Fail to insert Mold:%s into table %s_%s.MoldIndex (%d):%s",
				 charMoldID, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_UpdateMold(MYSQL mysqlCon, unsigned int intMoldSN, const char *charMoldVendor, const char *charMoldID, stMoldSN varMoldSN)
//[INDEX]Update An Existing Mold
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charMoldSN;
	int intRetval;
	int intLength;
	unsigned int intLogSN;

	// Handle Empty String and Add String Quotes Marks and Sting End Character
	if ((intLength = strlen(varMoldSN.charMoldMeta)) != 0)
	{
		strcpy(varMoldSN.charMoldMeta + 1, varMoldSN.charMoldMeta);
		varMoldSN.charMoldMeta[0] = '"';
		varMoldSN.charMoldMeta[intLength + 1] = '"';
		varMoldSN.charMoldMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varMoldSN.charMoldMeta, "NULL");

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.MoldIndex SET MoldVendor='%s',MoldID='%s',MoldMeta=%s WHERE MoldSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, charMoldVendor, charMoldID, varMoldSN.charMoldMeta, intMoldSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_UpdateMold]Fail to update Mold:%s in  table %s_%s.MoldIndex (%d):%s",
				 charMoldID, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_MaskMold(MYSQL mysqlCon, unsigned int intMoldSN)
//[INDEX]Mask An Existing Mold
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.MoldIndex SET MoldMask = 1 WHERE MoldSN=%d", SYS_NAME, INDEX_DATABASE_NAME, intMoldSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_MaskMold]Fail to mask Mold (SN:%d) from Table %s_%s.MoldIndex (%d):%s",
				 intMoldSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_DeleteMold(MYSQL mysqlCon, unsigned int intMoldSN)
//[INDEX]Delete An Existing Mold
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s.MoldIndex WHERE MoldSN=%d", SYS_NAME, INDEX_DATABASE_NAME, intMoldSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_DeleteMold]Fail to delete Mold (SN:%d) from Table %s_%s.MoldIndex (%d):%s",
				 intMoldSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_InsertMOCustomSensor(MYSQL mysqlCon, unsigned int *intCustomSensorModelSN, unsigned int intCustomSensorClass, unsigned int intCustomSensorCategory, const char *charCustomSensorVendor, const char *charCustomSensorModel, stCustomSensorModelSN varCustomSensorModelSN)
//[INDEX]Insert A New Custom Sensor
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charCustomSensorModelSN;
	int intRetval;
	int intLength;
	unsigned int intLogSN;

	// Get Next OPCUAVersionSN
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s.CustomSensorModelIndex", SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "CustomSensorModelSN", &charCustomSensorModelSN);
	if (intRetval == EXIT_FAILURE)
		return EXIT_FAILURE;
	*intCustomSensorModelSN = atoi(charCustomSensorModelSN) + 1;

	if ((intLength = strlen(varCustomSensorModelSN.charSensorModelMeta)) != 0)
	{
		strcpy(varCustomSensorModelSN.charSensorModelMeta + 1, varCustomSensorModelSN.charSensorModelMeta);
		varCustomSensorModelSN.charSensorModelMeta[0] = '"';
		varCustomSensorModelSN.charSensorModelMeta[intLength + 1] = '"';
		varCustomSensorModelSN.charSensorModelMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varCustomSensorModelSN.charSensorModelMeta, "NULL");

	snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s.CustomSensorModelIndex "
											 "(CustomSensorModelSN,CustomSensorClass, CustomSensorCategory,CustomSensorVendor,CustomSensorModel,CustomSensorModelMeta) "
											 "VALUE (%d,%d, %d,'%s','%s',%s)",
			 SYS_NAME, INDEX_DATABASE_NAME, *intCustomSensorModelSN, intCustomSensorClass, intCustomSensorCategory, charCustomSensorVendor, charCustomSensorModel, varCustomSensorModelSN.charSensorModelMeta);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_InsertMOCustomSensor]Fail to insert SensorModel:%s %s into table %s_%s.CustomSensorModelIndex (%d):%s",
				 charCustomSensorVendor, charCustomSensorModel, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_UpdateMOCustomSensor(MYSQL mysqlCon, unsigned int intCustomSensorModelSN, unsigned int intCustomSensorCategory, const char *charCustomSensorVendor, const char *charCustomSensorModel, stCustomSensorModelSN varCustomSensorModelSN)
//[INDEX]Update An Existing Custom Sensor
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charCustomSensorModelSN;
	int intRetval;
	int intLength;
	unsigned int intLogSN;

	// Handle Empty String and Add String Quotes Marks and Sting End Character
	if ((intLength = strlen(varCustomSensorModelSN.charSensorModelMeta)) != 0)
	{
		strcpy(varCustomSensorModelSN.charSensorModelMeta + 1, varCustomSensorModelSN.charSensorModelMeta);
		varCustomSensorModelSN.charSensorModelMeta[0] = '"';
		varCustomSensorModelSN.charSensorModelMeta[intLength + 1] = '"';
		varCustomSensorModelSN.charSensorModelMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varCustomSensorModelSN.charSensorModelMeta, "NULL");

	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s.CustomSensorModelIndex SET CustomSensorCategory=%d, CustomSensorVendor='%s', CustomSensorModel='%s', CustomSensorModelMeta=%s WHERE CustomSensorModelSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, intCustomSensorCategory, charCustomSensorVendor, charCustomSensorModel, varCustomSensorModelSN.charSensorModelMeta, intCustomSensorModelSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_UpdateMOCustomSensor]Fail to update SensorModel:%s %s in table %s_%s.CustomSensorModelIndex (%d):%s",
				 charCustomSensorVendor, charCustomSensorModel, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_MaskMOCustomSensor(MYSQL mysqlCon, unsigned int intCustomSensorModelSN)
//[INDEX]Mask An Existing Custom Sensor for An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.CustomSensorModelIndex SET MOCustomSensorMask = 1 WHERE MOCustomSensorSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, intCustomSensorModelSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_MaskMOCustomSensor]Fail to mask Sensor (SN:%d) from Table %s_%s.SensorlIndex (%d):%s",
				 intCustomSensorModelSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_DeleteCustomSensorModel(MYSQL mysqlCon, unsigned int intCustomSensorModelSN)
//[INDEX]Delet An Existing Cutom Sensor Model
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s.CustomSensorModelIndex WHERE MOCustomSensorSN=%d", SYS_NAME, INDEX_DATABASE_NAME, intCustomSensorModelSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_DeleteCustomSensorModel]Fail to delete Sensor (SN:%d) from Table %s_%s.SensorlIndex (%d):%s",
				 intCustomSensorModelSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_InsertMaterial(MYSQL mysqlCon, unsigned int *intMaterialSN, const char *charMaterialID, stMaterialSN varMaterialSN)
//[INDEX]Insert A New Material
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charMaterialSN;

	int intRetval;
	unsigned int intLogSN;
	unsigned int intLength;

	// Handle Empty String and Add String Quotes Marks and Sting End Character
	if ((intLength = strlen(varMaterialSN.charMaterialMeta)) != 0)
	{
		strcpy(varMaterialSN.charMaterialMeta + 1, varMaterialSN.charMaterialMeta);
		varMaterialSN.charMaterialMeta[0] = '"';
		varMaterialSN.charMaterialMeta[intLength + 1] = '"';
		varMaterialSN.charMaterialMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varMaterialSN.charMaterialMeta, "NULL");

	// Get Next OPCUAVersionSN
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s.MaterialIndex", SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "MaterialSN", &charMaterialSN);
	if (intRetval == EXIT_FAILURE)
		return EXIT_FAILURE;
	*intMaterialSN = atoi(charMaterialSN) + 1;

	snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s.MaterialIndex (MaterialSN,MaterialID,MaterialMeta) VALUE (%d,'%s',%s)",
			 SYS_NAME, INDEX_DATABASE_NAME, *intMaterialSN, charMaterialID, varMaterialSN.charMaterialMeta);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_InsertMaterial]Fail to insert Material:%s into table %s_%s.MaterialIndex (%d):%s",
				 charMaterialID, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_UpdateMaterial(MYSQL mysqlCon, unsigned int intMaterialSN, const char *charMaterialID, stMaterialSN varMaterialSN)
//[INDEX]Update An Existing Material
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charMaterialSN;
	int intRetval;
	unsigned int intLogSN;
	unsigned int intLength;

	// Handle Empty String and Add String Quotes Marks and Sting End Character
	if ((intLength = strlen(varMaterialSN.charMaterialMeta)) != 0)
	{
		strcpy(varMaterialSN.charMaterialMeta + 1, varMaterialSN.charMaterialMeta);
		varMaterialSN.charMaterialMeta[0] = '"';
		varMaterialSN.charMaterialMeta[intLength + 1] = '"';
		varMaterialSN.charMaterialMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varMaterialSN.charMaterialMeta, "NULL");

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.MaterialIndex SET MaterialID='%s', MaterialMeta = %s WHERE MaterialSN = %d",
			 SYS_NAME, INDEX_DATABASE_NAME, charMaterialID, varMaterialSN.charMaterialMeta, intMaterialSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_UpdateMaterial]Fail to update Material:%s in table %s_%s.MaterialIndex (%d):%s",
				 charMaterialID, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_MaskMaterial(MYSQL mysqlCon, unsigned int intMaterialSN)
//[INDEX]Mask An Existing Material
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.MaterialIndex SET MaterialMask = 1 WHERE MaterialSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, intMaterialSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[INDEX_MaskMaterial]Fail to mask Material (SN:%d) from Table %s_%s.MaterialIndex (%d):%s",
				 intMaterialSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_DeleteMaterial(MYSQL mysqlCon, unsigned int intMaterialSN)
//[INDEX]Delete An Existing Material
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s.MaterialIndex WHERE MaterialSN=%d", SYS_NAME, INDEX_DATABASE_NAME, intMaterialSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[INDEX_DeleteMaterial]Fail to delete Material (SN:%d) from Table %s_%s.MaterialIndex (%d):%s",
				 intMaterialSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_InsertProd(MYSQL mysqlCon, unsigned int *intProdSN, const char *charProdID, stProdSN varProdSN)
//[INDEX]Insert A New Product
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charProdSN;

	int intRetval;
	unsigned int intLogSN;
	unsigned int intLength;

	// Handle Empty String and Add String Quotes Marks and Sting End Character
	if ((intLength = strlen(varProdSN.charProdMeta)) != 0)
	{
		strcpy(varProdSN.charProdMeta + 1, varProdSN.charProdMeta);
		varProdSN.charProdMeta[0] = '"';
		varProdSN.charProdMeta[intLength + 1] = '"';
		varProdSN.charProdMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varProdSN.charProdMeta, "NULL");

	// Get Next OPCUAVersionSN
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s.ProdIndex", SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "ProdSN", &charProdSN);
	if (intRetval == EXIT_FAILURE)
		return EXIT_FAILURE;
	*intProdSN = atoi(charProdSN) + 1;

	snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s.ProdIndex (ProdSN,ProdID,ProdMeta) VALUE (%d,'%s',%s)",
			 SYS_NAME, INDEX_DATABASE_NAME, *intProdSN, charProdID, varProdSN.charProdMeta);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_InsertProd]Fail to insert Prod:%s into table %s_%s.ProdIndex (%d):%s",
				 charProdID, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_UpdateProd(MYSQL mysqlCon, unsigned int intProdSN, const char *charProdID, stProdSN varProdSN)
//[INDEX]Update An Existing Product
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charProdSN;
	int intRetval;
	unsigned int intLogSN;
	unsigned int intLength;

	// Handle Empty String and Add String Quotes Marks and Sting End Character
	if ((intLength = strlen(varProdSN.charProdMeta)) != 0)
	{
		strcpy(varProdSN.charProdMeta + 1, varProdSN.charProdMeta);
		varProdSN.charProdMeta[0] = '"';
		varProdSN.charProdMeta[intLength + 1] = '"';
		varProdSN.charProdMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varProdSN.charProdMeta, "NULL");

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.ProdIndex SET ProdID='%s', ProdMeta=%s WHERE ProdSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, charProdID, varProdSN.charProdMeta, intProdSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_UpdateProd]Fail to update Prod:%s in table %s_%s.ProdIndex (%d):%s",
				 charProdID, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_MaskProd(MYSQL mysqlCon, unsigned int intProdSN)
//[INDEX]Mask An Existing Prod
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.ProdIndex SET ProdMask = 1 WHERE ProdSN=%d", SYS_NAME, INDEX_DATABASE_NAME, intProdSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[INDEX_MaskProd]Fail to mask Product (SN:%d) from Table %s_%s.ProdIndex (%d):%s",
				 intProdSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_DeleteProd(MYSQL mysqlCon, unsigned int intProdSN)
//[INDEX]Delete An Existing Product
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s.ProdIndex WHERE ProdSN=%d", SYS_NAME, INDEX_DATABASE_NAME, intProdSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[INDEX_DeleteProd]Fail to delete Product (SN:%d) from Table %s_%s.ProdIndex (%d):%s",
				 intProdSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_InsertAcceptCriteria(MYSQL mysqlCon, unsigned int *intAcceptCriteriaSN, const char *charAcceptCriteriaID)
//[INDEX]Insert A New Accept Critria
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charAcceptCriteriaSN;
	int intRetval;
	unsigned int intLogSN;

	// Get Next AcceptCriteriaSN
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s.AcceptCriteriaIndex", SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "AcceptCriteriaSN", &charAcceptCriteriaSN);
	if (intRetval == EXIT_FAILURE)
		return EXIT_FAILURE;
	*intAcceptCriteriaSN = atoi(charAcceptCriteriaSN) + 1;

	snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s.AcceptCriteriaIndex (AcceptCriteriaSN,AcceptCriteriaID) VALUE (%d,'%s')",
			 SYS_NAME, INDEX_DATABASE_NAME, *intAcceptCriteriaSN, charAcceptCriteriaID);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_InsertAcceptCriteria]Fail to insert AcceptCriteria:%s into table %s_%s.AcceptCriteriaIndex (%d):%s",
				 charAcceptCriteriaID, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_UpdateAcceptCriteria(MYSQL mysqlCon, unsigned int intAcceptCriteriaSN, const char *charAcceptCriteriaName)
//[INDEX]Update An Existing Accept Criteria
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char *charAcceptCriteriaSN;
	int intRetval;
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.AcceptCriteriaIndex SET AcceptCriteriaName='%s' WHERE AcceptCriteriaSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, charAcceptCriteriaName, intAcceptCriteriaSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[INDEX_UpdateAcceptCriteria]Fail to update AcceptCriteria:%s into table %s_%s.AcceptCriteriaIndex (%d):%s",
				 charAcceptCriteriaName, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_MaskAcceptCriteria(MYSQL mysqlCon, unsigned int intAcceptCriteriaSN)
//[INDEX]Mask An Existing Accept Criteria
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.AcceptCriteriaIndex SET AcceptCriteriaMask = 1 WHERE AcceptCriteriaSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, intAcceptCriteriaSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[INDEX_MaskAcceptCriteria]Fail to mask AcceptCriteria (SN:%d) from Table %s_%s.AcceptCriteriaIndex (%d):%s",
				 intAcceptCriteriaSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int INDEX_DeleteAcceptCriteria(MYSQL mysqlCon, unsigned int intAcceptCriteriaSN)
//[INDEX]Delete An Existing Accept Criteria
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s.AcceptCriteriaIndex WHERE AcceptCriteriaSN=%d", SYS_NAME, INDEX_DATABASE_NAME, intAcceptCriteriaSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[INDEX_DeleteAcceptCriteria]Fail to delete AcceptCriteria (SN:%d) from Table %s_%s.AcceptCriteriaIndex (%d):%s",
				 intAcceptCriteriaSN, SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

//[IMM]

int IMM_InsertIMM(MYSQL mysqlCon, unsigned int *intIMMSN, char charIMMID[SMALL_STRING_SIZE], unsigned int intIMMStationID, unsigned int intIMMModelSN, stIMMSN varIMMSN)
//[IMM]Insert A New IMM
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	char charEndPointURL[MEDIUM_STRING_SIZE];
	char *charIMMSN;
	unsigned int intLogSN;
	unsigned int intLength;
	unsigned int intOPCUAVersionSN;
	unsigned int intModbusMoldSignalSource;
	unsigned int intModbusMoldSignalType;

	// Get Mold Signal Source
	intModbusMoldSignalSource = atoi(varIMMSN.charModbusMoldSignalSource);

	// Get Mold Signal Type
	intModbusMoldSignalType = atoi(varIMMSN.charModbusMoldSignalType);

	// Check OPC UA IP/Port Format
	if ((strcmp(varIMMSN.charOPCUAIP, "") == 0 && strcmp(varIMMSN.charOPCUAPort, "") != 0) ||
		(strcmp(varIMMSN.charOPCUAIP, "") != 0 && strcmp(varIMMSN.charOPCUAPort, "") == 0))
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[IMM_InsertIMM]Fail to insert IMM to table %s_%s.IMMSNList due to either OPCUA IP or Port is NULL",
				 SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
		return intLogSN;
	}
	// Check Modbus IP/Port Format
	else if ((strcmp(varIMMSN.charModbusIP, "") == 0 && strcmp(varIMMSN.charModbusPort, "") != 0) ||
			 (strcmp(varIMMSN.charModbusIP, "") != 0 && strcmp(varIMMSN.charModbusPort, "") == 0))
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[IMM_InsertIMM]Fail to insert IMM to table %s_%s.IMMSNList due to either Modbus IP or Port is NULL",
				 SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
		return intLogSN;
	}
	// Check Mold Signal Source
	else if (strcmp(varIMMSN.charModbusMoldSignalSource, "") != 0 &&
			 intModbusMoldSignalSource != MODBUS_MOLD_SIGNAL_SOURCE_MODBUS &&
			 intModbusMoldSignalSource != MODBUS_MOLD_SIGNAL_SOURCE_OPCUA)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[IMM_InsertIMM]Fail to update IMM to table %s_%s.IMMSNList due to the format of mold signal source is incorrect.",
				 SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
		return intLogSN;
	}
	// Check Mold Signal Type
	else if (strcmp(varIMMSN.charModbusMoldSignalType, "") != 0 &&
			 intModbusMoldSignalType != MODBUS_MOLD_SIGNAL_TYPE_SIGNAL_LOOP &&
			 intModbusMoldSignalType != MODBUS_MOLD_SIGNAL_TYPE_MULTIPLE_LOOP)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[IMM_InsertIMM]Fail to update IMM to table %s_%s.IMMSNList due to the format of mold signal type is incorrect.",
				 SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
		return intLogSN;
	}
	// Traditional IMM
	else if ((strcmp(varIMMSN.charOPCUAIP, "") == 0 && strcmp(varIMMSN.charOPCUAPort, "") == 0) &&
			 (strcmp(varIMMSN.charModbusIP, "") != 0 && strcmp(varIMMSN.charModbusPort, "") != 0))
	{

		// Check OPCUAVersionSN Must Be NULL
		if (strcmp(varIMMSN.charOPCUAVersionSN, "") != 0)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[IMM_InsertIMM]Fail to insert IMM to table %s_%s.IMMSNList due to OPCUAVersion must be NULL when OPCUA/IP are NULL.",
					 SYS_NAME, DATA_DATABASE_NAME);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
			return intLogSN;
		}

		// Check Mold Signal Source
		intModbusMoldSignalSource = atoi(varIMMSN.charModbusMoldSignalSource);
		if (intModbusMoldSignalSource != MODBUS_MOLD_SIGNAL_SOURCE_MODBUS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[IMM_InsertIMM]Fail to insert IMM to table %s_%s.IMMSNList due to mold signal source must be modbus when ModbusIP/Port are specified but no OPCUA IP/Port are specified",
					 SYS_NAME, DATA_DATABASE_NAME);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
			return intLogSN;
		}

		// Format the ModbusIP and ModbusPort
		intLength = strlen(varIMMSN.charModbusIP);
		strcpy(varIMMSN.charModbusIP + 1, varIMMSN.charModbusIP);
		varIMMSN.charModbusIP[0] = '"';
		varIMMSN.charModbusIP[intLength + 1] = '"';
		varIMMSN.charModbusIP[intLength + 2] = '\0';

		intLength = strlen(varIMMSN.charModbusPort);
		strcpy(varIMMSN.charModbusPort + 1, varIMMSN.charModbusPort);
		varIMMSN.charModbusPort[0] = '"';
		varIMMSN.charModbusPort[intLength + 1] = '"';
		varIMMSN.charModbusPort[intLength + 2] = '\0';

		// Format the Modbus IP and ModbusPort
		strcpy(varIMMSN.charOPCUAIP, "NULL");
		strcpy(varIMMSN.charOPCUAPort, "NULL");
	}
	// IMM with OPCUA
	else if ((strcmp(varIMMSN.charOPCUAIP, "") != 0 && strcmp(varIMMSN.charOPCUAPort, "") != 0))
	{
		// Checl OPC UA Version Must Not NULL
		if (strcmp(varIMMSN.charOPCUAVersionSN, "") == 0)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[IMM_InsertIMM]Fail to insert IMM to table %s_%s.IMMSNList due to OPCUAVersion cannot be NULL for IMM with OPC UA IP/Port",
					 SYS_NAME, DATA_DATABASE_NAME);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
			return intLogSN;
		}
		// Get OPCUAVersionSN
		intOPCUAVersionSN = atoi(varIMMSN.charOPCUAVersionSN);

		// Pure OPC UA IMM
		if (strcmp(varIMMSN.charModbusIP, "") == 0 && strcmp(varIMMSN.charModbusPort, "") == 0)
		{
			// Check Mold Signal Source
			if (strcmp(varIMMSN.charModbusMoldSignalSource, "") != 0)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[IMM_InsertIMM]Fail to insert IMM to table %s_%s.IMMSNList due to mold signal source must be NULL for pure OPC UA IMM",
						 SYS_NAME, DATA_DATABASE_NAME);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
				return intLogSN;
			}

			// Check Mold Signal Type
			if (strcmp(varIMMSN.charModbusMoldSignalType, "") != 0)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[IMM_InsertIMM]Fail to insert IMM to table %s_%s.IMMSNList due to mold signal type must be NULL for pure OPC UA IMM",
						 SYS_NAME, DATA_DATABASE_NAME);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
				return intLogSN;
			}

			// Format the OPCUAIP and OPCUAPort
			intLength = strlen(varIMMSN.charOPCUAIP);
			strcpy(varIMMSN.charOPCUAIP + 1, varIMMSN.charOPCUAIP);
			varIMMSN.charOPCUAIP[0] = '"';
			varIMMSN.charOPCUAIP[intLength + 1] = '"';
			varIMMSN.charOPCUAIP[intLength + 2] = '\0';

			intLength = strlen(varIMMSN.charOPCUAPort);
			strcpy(varIMMSN.charOPCUAPort + 1, varIMMSN.charOPCUAPort);
			varIMMSN.charOPCUAPort[0] = '"';
			varIMMSN.charOPCUAPort[intLength + 1] = '"';
			varIMMSN.charOPCUAPort[intLength + 2] = '\0';

			// Format the Modbus IP and ModbusPort
			strcpy(varIMMSN.charModbusIP, "NULL");
			strcpy(varIMMSN.charModbusPort, "NULL");
		}
		// IMM with OPC UA + Modbus
		else if (strcmp(varIMMSN.charModbusIP, "") != 0 && strcmp(varIMMSN.charModbusPort, "") != 0)
		{
			// IMM with OPC UA + Modbus Using Modbus Mold Signal Source
			if (intModbusMoldSignalSource == MODBUS_MOLD_SIGNAL_SOURCE_MODBUS)
			{
				// Check Modbus IP and Port
				if (strcmp(varIMMSN.charModbusIP, "") == 0 || strcmp(varIMMSN.charModbusPort, "") == 0)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[IMM_InsertIMM]Fail to insert IMM to table %s_%s.IMMSNList due to Modbus IP or Port can not be NULL when mold signal source is Modbus",
							 SYS_NAME, DATA_DATABASE_NAME);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
					return intLogSN;
				}

				// Format the OPCUAIP and OPCUAPort
				intLength = strlen(varIMMSN.charOPCUAIP);
				strcpy(varIMMSN.charOPCUAIP + 1, varIMMSN.charOPCUAIP);
				varIMMSN.charOPCUAIP[0] = '"';
				varIMMSN.charOPCUAIP[intLength + 1] = '"';
				varIMMSN.charOPCUAIP[intLength + 2] = '\0';

				intLength = strlen(varIMMSN.charOPCUAPort);
				strcpy(varIMMSN.charOPCUAPort + 1, varIMMSN.charOPCUAPort);
				varIMMSN.charOPCUAPort[0] = '"';
				varIMMSN.charOPCUAPort[intLength + 1] = '"';
				varIMMSN.charOPCUAPort[intLength + 2] = '\0';

				// Format the ModbusIP and ModbusPort
				intLength = strlen(varIMMSN.charModbusIP);
				strcpy(varIMMSN.charModbusIP + 1, varIMMSN.charModbusIP);
				varIMMSN.charModbusIP[0] = '"';
				varIMMSN.charModbusIP[intLength + 1] = '"';
				varIMMSN.charModbusIP[intLength + 2] = '\0';

				intLength = strlen(varIMMSN.charModbusPort);
				strcpy(varIMMSN.charModbusPort + 1, varIMMSN.charModbusPort);
				varIMMSN.charModbusPort[0] = '"';
				varIMMSN.charModbusPort[intLength + 1] = '"';
				varIMMSN.charModbusPort[intLength + 2] = '\0';
			}
			// IMM with OPC UA + Modbus Using Modbus Mold Signal Source Using OPCUA Mold Signal Source
			else if (intModbusMoldSignalSource == MODBUS_MOLD_SIGNAL_SOURCE_OPCUA)
			{
				// Check Mold Signal Type
				if (strcmp(varIMMSN.charModbusMoldSignalType, "") != 0)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[IMM_InsertIMM]Fail to insert IMM to table %s_%s.IMMSNList due to mold signal type must be NULL for IMM with OPC UA +Modbus using OPC UA as Mold signal source",
							 SYS_NAME, DATA_DATABASE_NAME);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
					return intLogSN;
				}

				// Format the OPCUAIP and OPCUAPort
				intLength = strlen(varIMMSN.charOPCUAIP);
				strcpy(varIMMSN.charOPCUAIP + 1, varIMMSN.charOPCUAIP);
				varIMMSN.charOPCUAIP[0] = '"';
				varIMMSN.charOPCUAIP[intLength + 1] = '"';
				varIMMSN.charOPCUAIP[intLength + 2] = '\0';

				intLength = strlen(varIMMSN.charOPCUAPort);
				strcpy(varIMMSN.charOPCUAPort + 1, varIMMSN.charOPCUAPort);
				varIMMSN.charOPCUAPort[0] = '"';
				varIMMSN.charOPCUAPort[intLength + 1] = '"';
				varIMMSN.charOPCUAPort[intLength + 2] = '\0';

				// Format the ModbusIP and ModbusPort
				intLength = strlen(varIMMSN.charModbusIP);
				strcpy(varIMMSN.charModbusIP + 1, varIMMSN.charModbusIP);
				varIMMSN.charModbusIP[0] = '"';
				varIMMSN.charModbusIP[intLength + 1] = '"';
				varIMMSN.charModbusIP[intLength + 2] = '\0';

				intLength = strlen(varIMMSN.charModbusPort);
				strcpy(varIMMSN.charModbusPort + 1, varIMMSN.charModbusPort);
				varIMMSN.charModbusPort[0] = '"';
				varIMMSN.charModbusPort[intLength + 1] = '"';
				varIMMSN.charModbusPort[intLength + 2] = '\0';
			}
			else
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[IMM_InsertIMM]Fail to update IMM to table %s_%s.IMMSNList due to the format of mold signal source is incorrect.",
						 SYS_NAME, DATA_DATABASE_NAME);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
				return intLogSN;
			}
		}
	}

	// Fetch MAX
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s.IMMSNList", SYS_NAME, DATA_DATABASE_NAME);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "IMMSN", &charIMMSN);
	if (intRetval == EXIT_FAILURE)
		return EXIT_FAILURE;
	*intIMMSN = atoi(charIMMSN) + 1;

	// Insert a new IMM to IMM List
	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s.IMMSNList "
			 "(IMMSN,IMMID,IMMStationID,IMMModelSN,ModbusMoldSignalSource,ModbusMoldSignalType,OPCUAVersionSN,OPCUAIP,OPCUAPort,ModBusIP,ModBusPort,IMMInsertTime,IMMLastUpdateTime) VALUES "
			 "(%d,'%s',%d,%d,%d,%d,%s,%s,%s,%s,%s,NOW(),NOW())",
			 SYS_NAME, DATA_DATABASE_NAME,
			 *intIMMSN, charIMMID, intIMMStationID, intIMMModelSN,
			 intModbusMoldSignalSource, intModbusMoldSignalType,
			 strcmp(varIMMSN.charOPCUAVersionSN, "") == 0 ? "NULL" : varIMMSN.charOPCUAVersionSN,
			 varIMMSN.charOPCUAIP, varIMMSN.charOPCUAPort,
			 varIMMSN.charModbusIP, varIMMSN.charModbusPort);
	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_InsertIMM]Fail to insert IMM to table %s_%s.IMMSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME,
				 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, *intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	return EXIT_SUCCESS;
}

int IMM_UpdateIMM(MYSQL mysqlCon, unsigned int intIMMSN, char charIMMID[SMALL_STRING_SIZE], unsigned int intIMMStationID, unsigned int intIMMModelSN, stIMMSN varIMMSN)
//[IMM]Update An Existing IMM
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	char charEndPointURL[MEDIUM_STRING_SIZE];
	char *charIMMSN;
	unsigned int intLogSN;
	unsigned int intLength;
	unsigned int intOPCUAVersionSN;
	unsigned int intModbusMoldSignalSource;
	unsigned int intModbusMoldSignalType;

	// Get Mold Signal Source
	intModbusMoldSignalSource = atoi(varIMMSN.charModbusMoldSignalSource);

	// Get Mold Signal Type
	intModbusMoldSignalType = atoi(varIMMSN.charModbusMoldSignalType);

	// Check OPC UA IP/Port Format
	if ((strcmp(varIMMSN.charOPCUAIP, "") == 0 && strcmp(varIMMSN.charOPCUAPort, "") != 0) ||
		(strcmp(varIMMSN.charOPCUAIP, "") != 0 && strcmp(varIMMSN.charOPCUAPort, "") == 0))
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[IMM_UpdateIMM]Fail to insert IMM to table %s_%s.IMMSNList due to either OPCUA IP or Port is NULL",
				 SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
		return intLogSN;
	}
	// Check Modbus IP/Port Format
	else if ((strcmp(varIMMSN.charModbusIP, "") == 0 && strcmp(varIMMSN.charModbusPort, "") != 0) ||
			 (strcmp(varIMMSN.charModbusIP, "") != 0 && strcmp(varIMMSN.charModbusPort, "") == 0))
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[IMM_UpdateIMM]Fail to insert IMM to table %s_%s.IMMSNList due to either Modbus IP or Port is NULL",
				 SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
		return intLogSN;
	}
	// Check Mold Signal Source
	else if (strcmp(varIMMSN.charModbusMoldSignalSource, "") != 0 &&
			 intModbusMoldSignalSource != MODBUS_MOLD_SIGNAL_SOURCE_MODBUS &&
			 intModbusMoldSignalSource != MODBUS_MOLD_SIGNAL_SOURCE_OPCUA)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[IMM_UpdateIMM]Fail to update IMM to table %s_%s.IMMSNList due to the format of mold signal source is incorrect.",
				 SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
		return intLogSN;
	}
	// Check Mold Signal Type
	else if (strcmp(varIMMSN.charModbusMoldSignalType, "") != 0 &&
			 intModbusMoldSignalType != MODBUS_MOLD_SIGNAL_TYPE_SIGNAL_LOOP &&
			 intModbusMoldSignalType != MODBUS_MOLD_SIGNAL_TYPE_SIGNAL_LOOP)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[IMM_UpdateIMM]Fail to update IMM to table %s_%s.IMMSNList due to the format of mold signal type is incorrect.",
				 SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
		return intLogSN;
	}
	// Traditional IMM
	else if ((strcmp(varIMMSN.charOPCUAIP, "") == 0 && strcmp(varIMMSN.charOPCUAPort, "") == 0) &&
			 (strcmp(varIMMSN.charModbusIP, "") != 0 && strcmp(varIMMSN.charModbusPort, "") != 0))
	{

		// Check OPCUAVersionSN Must Be NULL
		if (strcmp(varIMMSN.charOPCUAVersionSN, "") != 0)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[IMM_UpdateIMM]Fail to insert IMM to table %s_%s.IMMSNList due to OPCUAVersion must be NULL when OPCUA/IP are NULL.",
					 SYS_NAME, DATA_DATABASE_NAME);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
			return intLogSN;
		}

		// Check Mold Signal Source
		intModbusMoldSignalSource = atoi(varIMMSN.charModbusMoldSignalSource);
		if (intModbusMoldSignalSource != MODBUS_MOLD_SIGNAL_SOURCE_MODBUS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[IMM_UpdateIMM]Fail to insert IMM to table %s_%s.IMMSNList due to mold signal source must be modbus when ModbusIP/Port are specified but no OPCUA IP/Port are specified",
					 SYS_NAME, DATA_DATABASE_NAME);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
			return intLogSN;
		}

		// Format the ModbusIP and ModbusPort
		intLength = strlen(varIMMSN.charModbusIP);
		strcpy(varIMMSN.charModbusIP + 1, varIMMSN.charModbusIP);
		varIMMSN.charModbusIP[0] = '"';
		varIMMSN.charModbusIP[intLength + 1] = '"';
		varIMMSN.charModbusIP[intLength + 2] = '\0';

		intLength = strlen(varIMMSN.charModbusPort);
		strcpy(varIMMSN.charModbusPort + 1, varIMMSN.charModbusPort);
		varIMMSN.charModbusPort[0] = '"';
		varIMMSN.charModbusPort[intLength + 1] = '"';
		varIMMSN.charModbusPort[intLength + 2] = '\0';

		// Format the Modbus IP and ModbusPort
		strcpy(varIMMSN.charOPCUAIP, "NULL");
		strcpy(varIMMSN.charOPCUAPort, "NULL");
	}
	// IMM with OPCUA
	else if ((strcmp(varIMMSN.charOPCUAIP, "") != 0 && strcmp(varIMMSN.charOPCUAPort, "") != 0))
	{
		// Checl OPC UA Version Must Not NULL
		if (strcmp(varIMMSN.charOPCUAVersionSN, "") == 0)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[IMM_UpdateIMM]Fail to insert IMM to table %s_%s.IMMSNList due to OPCUAVersion cannot be NULL for IMM with OPC UA IP/Port",
					 SYS_NAME, DATA_DATABASE_NAME);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
			return intLogSN;
		}
		// Get OPCUAVersionSN
		intOPCUAVersionSN = atoi(varIMMSN.charOPCUAVersionSN);

		// Pure OPC UA IMM
		if (strcmp(varIMMSN.charModbusIP, "") == 0 && strcmp(varIMMSN.charModbusPort, "") == 0)
		{
			// Check Mold Signal Source
			if (strcmp(varIMMSN.charModbusMoldSignalSource, "") != 0)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[IMM_UpdateIMM]Fail to insert IMM to table %s_%s.IMMSNList due to mold signal source must be NULL for pure OPC UA IMM",
						 SYS_NAME, DATA_DATABASE_NAME);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
				return intLogSN;
			}

			// Check Mold Signal Type
			if (strcmp(varIMMSN.charModbusMoldSignalType, "") != 0)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[IMM_UpdateIMM]Fail to insert IMM to table %s_%s.IMMSNList due to mold signal type must be NULL for pure OPC UA IMM",
						 SYS_NAME, DATA_DATABASE_NAME);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
				return intLogSN;
			}

			// Format the OPCUAIP and OPCUAPort
			intLength = strlen(varIMMSN.charOPCUAIP);
			strcpy(varIMMSN.charOPCUAIP + 1, varIMMSN.charOPCUAIP);
			varIMMSN.charOPCUAIP[0] = '"';
			varIMMSN.charOPCUAIP[intLength + 1] = '"';
			varIMMSN.charOPCUAIP[intLength + 2] = '\0';

			intLength = strlen(varIMMSN.charOPCUAPort);
			strcpy(varIMMSN.charOPCUAPort + 1, varIMMSN.charOPCUAPort);
			varIMMSN.charOPCUAPort[0] = '"';
			varIMMSN.charOPCUAPort[intLength + 1] = '"';
			varIMMSN.charOPCUAPort[intLength + 2] = '\0';

			// Format the Modbus IP and ModbusPort
			strcpy(varIMMSN.charModbusIP, "NULL");
			strcpy(varIMMSN.charModbusPort, "NULL");
		}
		// IMM with OPC UA + Modbus
		else if (strcmp(varIMMSN.charModbusIP, "") != 0 && strcmp(varIMMSN.charModbusPort, "") != 0)
		{
			// IMM with OPC UA + Modbus Using Modbus Mold Signal Source
			if (intModbusMoldSignalSource == MODBUS_MOLD_SIGNAL_SOURCE_MODBUS)
			{
				// Check Modbus IP and Port
				if (strcmp(varIMMSN.charModbusIP, "") == 0 || strcmp(varIMMSN.charModbusPort, "") == 0)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[IMM_UpdateIMM]Fail to insert IMM to table %s_%s.IMMSNList due to Modbus IP or Port can not be NULL when mold signal source is Modbus",
							 SYS_NAME, DATA_DATABASE_NAME);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
					return intLogSN;
				}

				// Format the OPCUAIP and OPCUAPort
				intLength = strlen(varIMMSN.charOPCUAIP);
				strcpy(varIMMSN.charOPCUAIP + 1, varIMMSN.charOPCUAIP);
				varIMMSN.charOPCUAIP[0] = '"';
				varIMMSN.charOPCUAIP[intLength + 1] = '"';
				varIMMSN.charOPCUAIP[intLength + 2] = '\0';

				intLength = strlen(varIMMSN.charOPCUAPort);
				strcpy(varIMMSN.charOPCUAPort + 1, varIMMSN.charOPCUAPort);
				varIMMSN.charOPCUAPort[0] = '"';
				varIMMSN.charOPCUAPort[intLength + 1] = '"';
				varIMMSN.charOPCUAPort[intLength + 2] = '\0';

				// Format the ModbusIP and ModbusPort
				intLength = strlen(varIMMSN.charModbusIP);
				strcpy(varIMMSN.charModbusIP + 1, varIMMSN.charModbusIP);
				varIMMSN.charModbusIP[0] = '"';
				varIMMSN.charModbusIP[intLength + 1] = '"';
				varIMMSN.charModbusIP[intLength + 2] = '\0';

				intLength = strlen(varIMMSN.charModbusPort);
				strcpy(varIMMSN.charModbusPort + 1, varIMMSN.charModbusPort);
				varIMMSN.charModbusPort[0] = '"';
				varIMMSN.charModbusPort[intLength + 1] = '"';
				varIMMSN.charModbusPort[intLength + 2] = '\0';
			}
			// IMM with OPC UA + Modbus Using Modbus Mold Signal Source Using OPCUA Mold Signal Source
			else if (intModbusMoldSignalSource == MODBUS_MOLD_SIGNAL_SOURCE_OPCUA)
			{
				// Check Mold Signal Type
				if (strcmp(varIMMSN.charModbusMoldSignalType, "") != 0)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[IMM_UpdateIMM]Fail to insert IMM to table %s_%s.IMMSNList due to mold signal type must be NULL for IMM with OPC UA +Modbus using OPC UA as Mold signal source",
							 SYS_NAME, DATA_DATABASE_NAME);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
					return intLogSN;
				}

				// Format the OPCUAIP and OPCUAPort
				intLength = strlen(varIMMSN.charOPCUAIP);
				strcpy(varIMMSN.charOPCUAIP + 1, varIMMSN.charOPCUAIP);
				varIMMSN.charOPCUAIP[0] = '"';
				varIMMSN.charOPCUAIP[intLength + 1] = '"';
				varIMMSN.charOPCUAIP[intLength + 2] = '\0';

				intLength = strlen(varIMMSN.charOPCUAPort);
				strcpy(varIMMSN.charOPCUAPort + 1, varIMMSN.charOPCUAPort);
				varIMMSN.charOPCUAPort[0] = '"';
				varIMMSN.charOPCUAPort[intLength + 1] = '"';
				varIMMSN.charOPCUAPort[intLength + 2] = '\0';

				// Format the ModbusIP and ModbusPort
				intLength = strlen(varIMMSN.charModbusIP);
				strcpy(varIMMSN.charModbusIP + 1, varIMMSN.charModbusIP);
				varIMMSN.charModbusIP[0] = '"';
				varIMMSN.charModbusIP[intLength + 1] = '"';
				varIMMSN.charModbusIP[intLength + 2] = '\0';

				intLength = strlen(varIMMSN.charModbusPort);
				strcpy(varIMMSN.charModbusPort + 1, varIMMSN.charModbusPort);
				varIMMSN.charModbusPort[0] = '"';
				varIMMSN.charModbusPort[intLength + 1] = '"';
				varIMMSN.charModbusPort[intLength + 2] = '\0';
			}
			else
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[IMM_UpdateIMM]Fail to update IMM to table %s_%s.IMMSNList due to the format of mold signal source is incorrect.",
						 SYS_NAME, DATA_DATABASE_NAME);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, 0, charErrMsg);
				return intLogSN;
			}
		}
	}

	// Update IMM to IMMSNList
	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMSNList SET "
											 "IMMID = '%s', IMMStationID = %d, IMMModelSN = %d, ModbusMoldSignalSource = %d, ModbusMoldSignalType = %d,"
											 "OPCUAVersionSN = %s,OPCUAIP = %s, OPCUAPort = %s,"
											 "ModBusIP = %s, ModBusPort = %s,IMMLastUpdateTime=NOW() "
											 "WHERE IMMSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME,
			 charIMMID, intIMMStationID, intIMMModelSN, intModbusMoldSignalSource, intModbusMoldSignalType,
			 intOPCUAVersionSN == VIRTUAL_OPCUA_SERVER_OPCUA_VERSIONSN ? "NULL" : varIMMSN.charOPCUAVersionSN, varIMMSN.charOPCUAIP, varIMMSN.charOPCUAPort,
			 varIMMSN.charModbusIP, varIMMSN.charModbusPort, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UpdateIMM]Fail to update IMM (IMMSN:%d) to table %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME,
				 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	else
	{
		return EXIT_SUCCESS;
	}
}

int IMM_MaskIMM(MYSQL mysqlCon, unsigned int intIMMSN)
//[IMM]Mas An Existing IMM
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	unsigned int intLength;

	// Delete an existing IMM from IMM List
	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMSNList SET IMMMask = 1 WHERE IMMSN=%d ",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);

	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_DeleteIMM]Fail to mask IMM (IMMSN:%d) to table %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME,
				 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int IMM_DeleteIMM(MYSQL mysqlCon, unsigned int intIMMSN)
//[IMM]Delete An Existing IMM
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	unsigned int intLength;

	// Delete an existing IMM from IMM List
	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s.IMMSNList WHERE IMMSN=%d ",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);

	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_DeleteIMM]Fail to delete IMM (IMMSN:%d) to table %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME,
				 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int IMM_SubscribeOPCUA(MYSQL mysqlCon, unsigned int intIMMSN)
//[IMM]Subscribe OPC UA of A Specified IMM
{
	char charCommand[MEDIUM_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;

	snprintf(charCommand, MEDIUM_STRING_SIZE, "./bin/exeSubscribeOPCUA -IMMSN %d &", intIMMSN);
	intRetval = system(charCommand);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_SubscribeOPCUA]Fail to execute SubscribeOPCUA procress for IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intIMMSN, intRetval, charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int IMM_UnsubscribeOPCUA(MYSQL mysqlCon, unsigned int intIMMSN)
//[IMM]Unsubscribe OPC UA of A Specified IMM
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intMOSN;
	int intRetval;
	int intOPCUAClientPID;
	int intCounter = 0;
	unsigned int intLogSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Select OPCUAClientPID From INJPRO_Data_IMMSNList Where IMMSN Is Given
	snprintf(charStatement, MAX_STRING_SIZE, "SELECT MOSN,OPCUAClientPID FROM %s_%s.IMMSNList WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeOPCUA]Fail to select MOSN and OPCUAClientPID where IMMSN = %d from %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	mysql_free_result(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeOPCUA]Fail to unsubscribe IMM due to IMMSN=%d is not found in %s_%s.IMMSNList",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Get MOSN From INJPRO_Data.IMMSNList Where IMMSN Is Given
	if (mysqlRow[0] != NULL)
	{
		intMOSN = atoi(mysqlRow[0]);
	}
	else
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeOPCUA]Fail to unsubscribe IMMSN= %d due to no MO is producing on it in %s_%s.IMMSNList",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Get OPCUAClientPID From INJPRO_Data.IMMSNList Where IMMSN Is Given
	if (mysqlRow[1] != NULL)
	{
		intOPCUAClientPID = atoi(mysqlRow[1]);
		// Kill the Subscribe Procress
		intRetval = kill(intOPCUAClientPID, SIGTERM);

		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMSNList SET OPCUAClientStatus = %d, OPCUAClientPID = NULL, IMMLastUpdateTime = NOW(6) WHERE IMMSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, OPCUA_CLIENT_STATUS_SHUTDOWN, intIMMSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[IMM_UnsubscribeOPCUA]Fail to Update OPCUAClientStatus = %d,  OPCUAClientPID = NULL, and IMMLastUpdateTime = NOW(6) for IMMSN = %d while terminating (%d):%s",
					 OPCUA_CLIENT_STATUS_SHUTDOWN, intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			mysql_close(&mysqlCon);
			return intLogSN;
		}

		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeOPCUA]Fail to kill subscribe process PID:%d of IMMSN:%d", intOPCUAClientPID, intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		else
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeOPCUA]The subscribe process PID:%d of IMMSN:%d is terminated", intOPCUAClientPID, intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return EXIT_SUCCESS;
		}
	}

	// Wait For The OPCUAClientPID = NULL
	/*
	do
	{
		snprintf(charStatement, MAX_STRING_SIZE, "SELECT OPCUAClientPID FROM %s_%s.IMMSNList WHERE IMMSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeOPCUA]Fail to select OPCUAClientPID for IMMSN=%d while exiting (%d):%s",
					 intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);

		//Free mysqlResult
		mysql_free_result(mysqlResult);
		if (intCounter != 0)
			sleep(1);
		intCounter++;
	} while (mysqlRow[0] != NULL && intCounter < UNSUBSCRIBE_OPCUA_TIME_OUT);*/
}

int IMM_SubscribeModbus(MYSQL mysqlCon, unsigned int intIMMSN)
//[IMM]Subscribe Modbus of A Specified IMM
{
	char charCommand[MEDIUM_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;

	snprintf(charCommand, MEDIUM_STRING_SIZE, "./bin/exeSubscribeModbus -IMMSN %d &", intIMMSN);
	intRetval = system(charCommand);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_SubscribeModbus]Fail to execute SubscribeOPCUA procress for IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intIMMSN, intRetval, charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int IMM_UnsubscribeModbus(MYSQL mysqlCon, unsigned int intIMMSN)
//[IMM]Unsubscribe Modbus of A Specified IMM
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intMOSN;
	int intRetval;
	int intModbusClientPID;
	int intCounter = 0;
	unsigned int intLogSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Select OPCUAClientPID From INJPRO_Data_IMMSNList Where IMMSN Is Given
	snprintf(charStatement, MAX_STRING_SIZE, "SELECT MOSN,ModbusClientPID FROM %s_%s.IMMSNList WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeModbus]Fail to select MOSN and OPCUAClientPID where IMMSN=%d from %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	mysql_free_result(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeModbus]Fail to unsubscribe IMM due to IMMSN=%d is not found in %s_%s.IMMSNList",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Get MOSN From INJPRO_Data.IMMSNList Where IMMSN Is Given
	if (mysqlRow[0] != NULL)
	{
		intMOSN = atoi(mysqlRow[0]);
	}
	else
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeModbus]Fail to unsubscribe IMMSN= %d due to no MO is producing on it in %s_%s.IMMSNList",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Get ModbusClientPID From INJPRO_Data.IMMSNList Where IMMSN Is Given
	if (mysqlRow[1] != NULL)
	{
		intModbusClientPID = atoi(mysqlRow[1]);
		// Kill the Subscribe Procress
		intRetval = kill(intModbusClientPID, SIGTERM);

		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMSNList SET MoldStatus = %d, ModbusClientStatus = %d, ModbusClientPID = NULL, IMMLastUpdateTime=NOW(6) WHERE IMMSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MOLD_STATUS_UNKNOW, MODBUS_CLIENT_STATUS_SHUTDOWN, intIMMSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[IMM_UnsubscribeModbus]Fail to Update MoldStatus = %d,  ModbusClientStatus = %d, ModbusClientPID = NULL, and IMMLastUpdateTime = NOW(6) for IMMSN = %d while terminating (%d):%s",
					 MOLD_STATUS_UNKNOW, MODBUS_CLIENT_STATUS_SHUTDOWN, intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			mysql_close(&mysqlCon);
			return intLogSN;
		}

		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeModbus]Fail to kill subscribe process PID:%d of IMMSN:%d. Reseting Modbus status.", intModbusClientPID, intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		else
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeModbus]The subscribe process PID:%d of IMMSN:%d is terminated", intModbusClientPID, intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return EXIT_SUCCESS;
		}
	}

	// Wait For The ModbusClientPID = NULL
	/*
	do
	{
		snprintf(charStatement, MAX_STRING_SIZE, "SELECT ModbusClientPID FROM %s_%s.IMMSNList WHERE IMMSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_UnsubscribeModbus]Fail to select ModbusClientPID for IMMSN=%d while exiting (%d):%s",
					 intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);

		//Free mysqlResult
		mysql_free_result(mysqlResult);
		if (intCounter != 0)
			sleep(1);
		intCounter++;
	} while (mysqlRow[0] != NULL && intCounter < UNSUBSCRIBE_MODBUS_TIME_OUT);*/
}

int IMM_Subscribe(MYSQL mysqlCon, unsigned int intIMMSN)
//[IMM]Subscribe OPC UA and Modbus of A Specified IMM
{
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;

	// Make Sure Mold Is in Released Status
	intRetval = IMM_SubscribeModbus(mysqlCon, intIMMSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_Subscribe]Fail to call IMM_SubscribeModbus for IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intIMMSN, intRetval, charErrMsg);
		return intLogSN;
	}
	else
	{
		intRetval = IMM_SubscribeOPCUA(mysqlCon, intIMMSN);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_Subscribe]Fail to call IMM_SubscribeOPCUA for IMMSN:%d", intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intIMMSN, intRetval, charErrMsg);

			// UnsubscribeModbus While SubscriebIMM Error
			intRetval = IMM_UnsubscribeModbus(mysqlCon, intIMMSN);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, MAX_STRING_SIZE,
						 "[IMM_Subscribe]Fatal Error! Fail to call IMM_UnsubscribeModbus for IMMSN:%d While IMM_SubscribeOPCUA Error", intIMMSN);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intIMMSN, intRetval, charErrMsg);
				return intLogSN;
			}
		}
	}
	return EXIT_SUCCESS;
}

int IMM_Unsubscribe(MYSQL mysqlCon, unsigned int intIMMSN)
//[IMM]Unsubscribe OPC UA and Modbus of A Specified IMM
{
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	bool boolUnsubcribeFail = false;

	// Make Sure Mold Is in Released Status
	intRetval = IMM_UnsubscribeModbus(mysqlCon, intIMMSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_Unsubscribe]Fail to call IMM_UnSubscribeModbus for IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intIMMSN, intRetval, charErrMsg);
		boolUnsubcribeFail = true;
		// return intLogSN;
	}

	intRetval = IMM_UnsubscribeOPCUA(mysqlCon, intIMMSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_Unsubscribe]Fail to call IMM_UnsubscribeOPCUA for IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intIMMSN, intRetval, charErrMsg);
		boolUnsubcribeFail = true;
		// return intLogSN;
	}

	if (boolUnsubcribeFail == true)
		return EXIT_FAILURE;
	else
		return EXIT_SUCCESS;
}

int IMM_TuneIMMPara(MYSQL mysqlCon, unsigned int intIMMSN, unsigned int intTechnicianUserSN, char charIMMParaValue[OPCUA_IMMPARA_NODE_NUM + 1][TINY_STRING_SIZE])
//[IMM]Tune IMM Parameter by Given Values of A Specified IMM
{
	int intIMMParaSN;
	char *charIMMParaSN;
	int intMOSN;
	char charOPCUAIP[16];
	int intOPCUAPort;
	char charEndPointURL[MEDIUM_STRING_SIZE];
	int intOPCUAVersionSN;
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;

	double doubleOPCUAConvertRatio[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1] = {0};
	intRetval = OPCUA_InitConvertRatio(mysqlCon, intOPCUAVersionSN, doubleOPCUAConvertRatio);

	// Select IMM + OPC UA Version Information Where IMMSN Is Given From INJPRO_Data_IMMSNList
	snprintf(charStatement, MAX_STRING_SIZE, "SELECT MOSN,OPCUAVersionSN,OPCUAIP,OPCUAPort FROM %s_%s.IMMSNList WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_TuneIMMPara]Fail to select IMM information where IMMSN=%d from %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	MYSQL_RES *mysqlResult = mysql_store_result(&mysqlCon);
	MYSQL_ROW mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_TuneIMMPara]Fail to tune IMM parameter due to IMMSN=%d is not found in %s_%s.IMMSNList",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Get MOSN
	if (mysqlRow[0] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_TuneIMMPara]Fail to select MOSN from %s_%s.IMMSNList where IMMSN=%d while tuning IMM parameter",
				 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, EXIT_FAILURE, charErrMsg);
		return intLogSN;
	}
	else
		intMOSN = atoi(mysqlRow[0]);

	// Get OPCUAVersionSN
	if (mysqlRow[1] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_TuneIMMPara]Fail to select OPCUAVersionSN from %s_%s.IMMSNList where IMMSN=%d while tuning IMM parameter",
				 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, EXIT_FAILURE, charErrMsg);
		return intLogSN;
	}
	else
		intOPCUAVersionSN = atoi(mysqlRow[1]);

	// Get OPC UA IP
	if (mysqlRow[2] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_TuneIMMPara]Fail to select OPCUA IP of IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, EXIT_FAILURE, charErrMsg);
		return intLogSN;
	}
	else
		strcpy(charOPCUAIP, mysqlRow[2]);

	// Get OPC UA Port
	if (mysqlRow[3] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_TuneIMMPara]Fail to select OPC UA Port of IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, EXIT_FAILURE, charErrMsg);
		return intLogSN;
	}
	else
		intOPCUAPort = atoi(mysqlRow[3]);
	mysql_free_result(mysqlResult);

	// Connect to OPC UA Server
	UA_Client *client = UA_Client_new(UA_ClientConfig_default);
	snprintf(charEndPointURL, MEDIUM_STRING_SIZE, "opc.tcp://%s:%d", charOPCUAIP, intOPCUAPort);
	intRetval = UA_Client_connect(client, charEndPointURL);
	if (intRetval != UA_STATUSCODE_GOOD)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_TuneIMMPara]Fail to tune IMM:%d due to OPC UA connection fail", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMSNList SET IMMLastUpdateTime=NOW() WHERE IMMSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_TuneIMMPara]Fail to update OPCUAClientPID and IMMLastUpdateTime for IMMSN=%d (%d):%s",
					 intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		return intLogSN;
	}

	// Update IMMLastUpdateTime after Connect Successfully
	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMSNList SET IMMLastUpdateTime=NOW() WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_TuneIMMPara]Fail to update TechnicianUserSN and IMMLastUpdateTime for IMMSN=%d (%d):%s",
				 intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select Node NameSpace and ID From INJPRO_Sys_Index.OPCUAVersionIndex Where OPCUAVersionSN Is Given
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT * FROM %s_%s.OPCUAVersionIndex WHERE OPCUAVersionSN=%d", SYS_NAME, INDEX_DATABASE_NAME, intOPCUAVersionSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_TuneIMMPara]Fail to select OPCUAVersionSN from table %s_%s.IMMSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	for (int i = OPCUA_FIRST_IMMPARA; i <= OPCUA_IMMPARA_NODE_NUM; i++)
	{
		// If The IMMPara Is Not NULL and OPC UA Also Support This Node
		if (mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_NS] != NULL && charIMMParaValue[i][0] != '\0')
		{
#ifdef DEBUG_MODE
			fprintf(stderr, "[IMMSN:%2d]ID:%2d NodeName:%-20s:%s\n", intIMMSN, i, mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM], charIMMParaValue[i]);
#endif
			UA_Variant *readVariant = UA_Variant_new();
			UA_Variant *writeVariant = UA_Variant_new();

			if (strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "i") == 0)
			{
				intRetval = UA_Client_readValueAttribute(client,
														 UA_NODEID_NUMERIC(atoi(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_NS]),
																		   atoi(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_ID])),
														 readVariant);
			}
			else if (strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "s") == 0)
			{
				intRetval = UA_Client_readValueAttribute(client,
														 UA_NODEID_STRING(atoi(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_NS]),
																		  mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_ID]),
														 readVariant);
			}
			if (intRetval == UA_STATUSCODE_GOOD && UA_Variant_isScalar(readVariant))
			{
				if (readVariant->type == &UA_TYPES[UA_TYPES_BOOLEAN])
				{
					bool *nodeValue = malloc(sizeof(bool));
					*nodeValue = (bool)atoi(charIMMParaValue[i]);
					UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
				}
				else if (readVariant->type == &UA_TYPES[UA_TYPES_FLOAT])
				{
					float *nodeValue = malloc(sizeof(float));
					*nodeValue = (float)atof(charIMMParaValue[i]);
					UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
					// Unit Convertform from OPC UA to Panel Value
					OPCUA_ConvertPaneltoOPCUA(doubleOPCUAConvertRatio, i, writeVariant);
				}
				else if (readVariant->type == &UA_TYPES[UA_TYPES_DOUBLE])
				{
					double *nodeValue = malloc(sizeof(double));
					*nodeValue = atof(charIMMParaValue[i]);
					UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
					// Unit Convertform from OPC UA to Panel Value
					OPCUA_ConvertPaneltoOPCUA(doubleOPCUAConvertRatio, i, writeVariant);
				}
				else if (readVariant->type == &UA_TYPES[UA_TYPES_INT16])
				{
					int *nodeValue = malloc(sizeof(int));
					*nodeValue = atoi(charIMMParaValue[i]);
					UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
				}
				else if (readVariant->type == &UA_TYPES[UA_TYPES_UINT16])
				{
					int *nodeValue = malloc(sizeof(int));
					*nodeValue = atoi(charIMMParaValue[i]);
					UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
				}
				else if (readVariant->type == &UA_TYPES[UA_TYPES_INT32])
				{
					int *nodeValue = malloc(sizeof(int));
					*nodeValue = atoi(charIMMParaValue[i]);
					UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
				}
				else if (readVariant->type == &UA_TYPES[UA_TYPES_UINT32])
				{
					int *nodeValue = malloc(sizeof(int));
					*nodeValue = atoi(charIMMParaValue[i]);
					UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
				}
				else if (readVariant->type == &UA_TYPES[UA_TYPES_INT64])
				{
					long int *nodeValue = malloc(sizeof(long int));
					*nodeValue = atol(charIMMParaValue[i]);
					UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
					// Unit Convertform from OPC UA to Panel Value
					OPCUA_ConvertPaneltoOPCUA(doubleOPCUAConvertRatio, i, writeVariant);
				}
				else if (readVariant->type == &UA_TYPES[UA_TYPES_UINT64])
				{
					long int *nodeValue = malloc(sizeof(long int));
					*nodeValue = atol(charIMMParaValue[i]);
					UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
				}

				if (i != DO_MOLD_CLAMPED && i != DO_MOLD_RELEASED)
				{
					if (strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "i") == 0)
					{
						UA_Client_writeValueAttribute(client,
													  UA_NODEID_NUMERIC(atoi(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_NS]),
																		atoi(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_ID])),
													  writeVariant);
					}
					else if (strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "s") == 0)
					{
						UA_Client_writeValueAttribute(client,
													  UA_NODEID_STRING(atoi(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_NS]),
																	   mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_ID]),
													  writeVariant);
					}
				}
			}
			UA_Variant_delete(writeVariant);
			UA_Variant_delete(readVariant);
		}
	}
	mysql_free_result(mysqlResult);
	UA_Client_delete(client);
	return EXIT_SUCCESS;
}

int IMM_TuneIMMParaByRecommend(MYSQL mysqlCon, unsigned int intIMMSN, unsigned int intMOSN, unsigned int intRecommendIMMParaSN)
//[IMM]Tune IMM Parameter by Recommneded Values of A Specified IMM
{
	char charIMMParaValue[OPCUA_IMMPARA_NODE_NUM + 1][TINY_STRING_SIZE];
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Check AutoOPCUAControl for IMMSN 1:Auto Mode 0:Manual Mode
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT OPCUAClientPID,AutoOPCUAControl FROM %s_%s.IMMSNList WHERE IMMSN=%d", SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SubscribeOPCUA]Fail to select OPCUAClientPID,AutoOPCUAControl from %s_%s.IMMSNList for IMMSN:%d(%d): %s",
				 SYS_NAME, DATA_DATABASE_NAME, intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	// Check if The IMM is Producing
	if (mysqlRow[0] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_TuneIMMParaByRecommend]No OPCUAClientPID for IMMSN:%d (Not Producing?)", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysql_free_result(mysqlResult);

	// Check if the Auto Mod is Enable
	if (atoi(mysqlRow[1]) == 1)
	{
		fprintf(stderr, "[IMM_TuneIMMParaByRecommend]Auto Mode in ON\n");
	}
	else
	{
		fprintf(stderr, "[IMM_TuneIMMParaByRecommend]Auto Mode in OFF\n");
		return EXIT_SUCCESS;
	}

	// Select RecommendIMMPara
	snprintf(charStatement, MAX_STRING_SIZE, "SELECT * FROM %s_%s_%s_%d_RawData_IMMPara.RecommendIMMParaSNList WHERE RecommendIMMParaSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intRecommendIMMParaSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[IMM_TuneIMMParaByRecommend]Fail to select RecommendIMMParaSN:%d IMM parameter of MOSN:%d for IMMSN: %d from %s_%s_%s_%d_RawData_IMMPara.RecommendIMMParaSNList %d:%s",
				 intRecommendIMMParaSN, intMOSN, intIMMSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	// Write to array
	for (int i = 1; i <= (OPCUA_IMMPARA_NODE_NUM - OPCUA_FIRST_IMMPARA + 1); i++)
	{
		if (mysqlRow[i] != NULL)
		{
			fprintf(stderr, "[IMM_TuneIMMParaByRecommend]NodeID:%d Value:%s \n", i + OPCUA_FIRST_IMMPARA - 1, mysqlRow[i]);
			strcpy(charIMMParaValue[i + OPCUA_FIRST_IMMPARA - 1], mysqlRow[i]);
		}
		else
			strcpy(charIMMParaValue[i + OPCUA_FIRST_IMMPARA - 1], "");
	}

	intRetval = IMM_TuneIMMPara(mysqlCon, intIMMSN, 0, charIMMParaValue);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[IMM_TuneIMMParaByRecommend]Fail to tune IMM parameter for IMMSN:%d given MOSN:%d RecommendIMMParaSN:%d while tunning", intIMMSN, intMOSN, intRecommendIMMParaSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		mysql_free_result(mysqlResult);
		return intLogSN;
	}

	mysql_free_result(mysqlResult);
	return EXIT_SUCCESS;
}

int IMM_SetPrimaryIMM(MYSQL mysqlCon, unsigned int intIMMSN)
//[IMM]Set the Specified IMM as Primary IMM
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMSNList SET PrimaryIMM = 0", SYS_NAME, DATA_DATABASE_NAME);
	// fprintf(stderr,"Q:%s\n",charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_SetPrimaryIMM]Fail to update PrimaryIMM = 0 in %s_%s.IMMSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMSNList SET PrimaryIMM = 1 WHERE IMMSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	// fprintf(stderr,"Q:%s\n",charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_SetPrimaryIMM]Fail to update PrimaryIMM = 1 where IMMSN = %d in %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
}

int IMM_SetIMMMoldStatus(MYSQL mysqlCon, unsigned int intIMMSN, unsigned int intMoldStatus)
//[IMM]Set IMM Mold Status(Used by System)
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intMOSN;
	unsigned int intLogSN;

	intRetval = DB_SelectMOSNbyIMMSN(mysqlCon, intIMMSN, &intMOSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_SetIMMMoldStatus]Fail to select MOSN while set MoldStatus = %d for IMMSN: %d", intMoldStatus, intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMSNList SET MoldStatus = %d WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intMoldStatus, intIMMSN);
	// fprintf(stderr,"Q:%s\n",charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_SetIMMMoldStatus]Fail to update MoldStatus=%d where IMMSN=%d from %s_%s.IMMSNList (%d):%s",
				 intMoldStatus, intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
}

int IMM_AddRoundSN(MYSQL mysqlCon, unsigned int intIMMSN)
//[IMM]Add RoundSN of A Specified IMM
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intMOSN;
	unsigned int intShotSN;

	// Check There Is No MOSN on IMMSN
	intRetval = DB_SelectMOSNbyIMMSN(mysqlCon, intIMMSN, &intMOSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_AddRoundSN]Fail to select existing MOSN for IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}
	else if (intMOSN == 0)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_AddRoundSN]Fail to add RoundSN due to there is no MOSN on IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Check There Is No MOSN on IMMSN
	intRetval = DB_SelectShotSNbyIMMSN(mysqlCon, intIMMSN, &intShotSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_AddRoundSN]Fail to select ShotSN of MOSN:%d for IMMSN:%d", intMOSN, intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}
	else if (intShotSN == 0)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_AddRoundSN]Fail to select shotSN of MOSN:%d for IMMSN:%d dueto ShotSN = 0", intMOSN, intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		// return intLogSN;
	}
	// Update This Shot as New RoundSN
	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_RawData.ShotSNList SET RoundSN = RoundSN + 1 WHERE ShotSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[IMM_AddRoundSN]Fail to Update RoundSN for ShotSN:%d IMMSN:%d from %s_%s.IMMSNList (%d):%s",
				 intShotSN, intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s.IMMSNList SET RoundSN = RoundSN + 1 WHERE IMMSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[IMM_AddRoundSN]Fail to Update RoundSN for IMMSN:%d from %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int IMM_EnableAutoOPCUAIMMParaControl(MYSQL mysqlCon, unsigned int intIMMSN, bool boolValue)
//[IMM]Enable Auto OPC UA IMM Parameter Control
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intMOSN;

	// Check There Is No MOSN on IMMSN
	intRetval = DB_SelectMOSNbyIMMSN(mysqlCon, intIMMSN, &intMOSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_EnableAutoOPCUAIMMParaControl]Fail to select existing MOSN for IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}
	else if (intMOSN == 0)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[IMM_EnableAutoOPCUAIMMParaControl]Fail to set Auto OPCUA Control due to there is no MOSN on IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMSNList SET AutoOPCUAControl=%d,IMMLastUpdateTime=NOW() WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, boolValue, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[IMM_EnableAutoOPCUAIMMParaControl]Fail to update AutoOPCUAControl=%d and IMMLastUpdateTime=NOW() where IMMSN=%d (%d):%s",
				 boolValue, intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

//[OPCUA]

int OPCUA_SetLocalhostOPCUAVersion(char charOPCUAIMMNodeList[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1][OPCUA_META_NUM][MEDIUM_STRING_SIZE])
//[OPCUA]Insert A New OPC UA Version for Modbus Only IMM
{

	for (int i = 0; i < OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1; i++)
	{
		for (int j = 0; j < OPCUA_META_NUM; j++)
		{
			strcpy(charOPCUAIMMNodeList[i][j], "NULL");
		}
	}

	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_ID], "'IMM.MoldClamped'");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_ID], "'IMM.MoldReleased'");
}

int OPCUA_InsertModBusOPCUAVersion(char charOPCUAIMMNodeList[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1][OPCUA_META_NUM][MEDIUM_STRING_SIZE])
//[OPCUA]Insert A New OPC UA Version for Modbus Only IMM
{
	unsigned int intLogSN;

	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_ID], "'IMM.MoldClamped'");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_ID], "'IMM.MoldReleased'");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_ID], "'IMM.CoolingTime'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");

	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING); ////54
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_ID], "'IMM.CycleTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 55
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 56
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 57
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 58
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 59
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 60
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 61
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 62
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 63
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 64
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 65
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 66
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 67
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 68
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 69
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 70
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 71
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 72
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 73
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 74
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 75
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 76
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 77
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 78
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 79
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 80
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 81
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 82
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 83
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 84
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 85
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 86
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 87
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 88
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 89
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 90
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 91
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 92
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 93
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 94
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL"); // 95
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");
	return EXIT_SUCCESS;
}

int OPCUA_CheckOPCUAStatus(MYSQL mysqlCon, char charOPCUAIP[16], unsigned int intOPCUAPort, int *intOPCUAState)
//[OPCUA]Check OPC UA State of A Specified IMM
{

	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	char charEndPointURL[MEDIUM_STRING_SIZE];
	char charStatement[MAX_STRING_SIZE];
	unsigned int intLogSN;
	UA_Variant *UA_NodeVal = UA_Variant_new();

	// OPC UA Client Configuration
	UA_ClientConfig configClient = UA_ClientConfig_default;

	// Create A Client and Connect to EndPointURL
	UA_Client *client = UA_Client_new(configClient);
	snprintf(charEndPointURL, MEDIUM_STRING_SIZE, "opc.tcp://%s:%d", charOPCUAIP, intOPCUAPort);
	intRetval = UA_Client_connect(client, charEndPointURL);

	if (intRetval != UA_STATUSCODE_GOOD)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "Trying to connect to %s timed out", charEndPointURL);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, 0, intRetval, charErrMsg);
		*intOPCUAState = OPCUA_CLIENT_STATUS_WAITING;
	}
	else
		*intOPCUAState = UA_Client_getState(client);
	UA_Client_delete(client);
	return EXIT_SUCCESS;
}

int OPCUA_InitConvertRatio(MYSQL mysqlCon, unsigned int intOPCUAVersionSN, double *doubleOPCUAConvertRatio)
//[OPCUA]Initial ConvertRatio of A Specified OPC UA Version
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Select Node NameSpace and ID Where OPCUAVersionSN Is Given
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT * FROM %s_%s.OPCUAVersionIndex WHERE OPCUAVersionSN=%d", SYS_NAME, INDEX_DATABASE_NAME, intOPCUAVersionSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_InitConvertRatio]Fail to select OPCUAVersionSN from table %s_%s.OPCUAVersionIndex (%d): %s",
				 SYS_NAME, INDEX_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	for (int i = 1; i <= OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM; i++)
	{
		if (mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_NS] != NULL &&
			(strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "i") == 0 ||
			 strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "s") == 0))
		{

			// doubleOPCUAConvertRatio
			doubleOPCUAConvertRatio[i] = atof(mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_RATIO]);

			// fprintf(stderr, "OPC UA Index:%d Ratio:%lf\n", i, doubleOPCUAConvertRatio[i]);
		}
		else
		{
			doubleOPCUAConvertRatio[i] = 1.0;
		}
		// fprintf(stderr, "OPC UA Index:%d Ratio:%lf\n", i, doubleOPCUAConvertRatio[i]);
	}

	// Initialize Convert Ratio

	// CYCU Screw Dim = 200
	// FCS  Screw Dim = 200

	// CYCU
	// doubleOPCUAConvertRatio[IMMPARA_INJECTION_PRESSURE_1] = 13.0514053;
	// doubleOPCUAConvertRatio[IMMPARA_INJECTION_PRESSURE_2] = 13.0514053;
	// doubleOPCUAConvertRatio[IMMPARA_INJECTION_PRESSURE_3] = 13.0514053;
	// doubleOPCUAConvertRatio[IMMPARA_INJECTION_PRESSURE_4] = 13.0514053;
	// doubleOPCUAConvertRatio[IMMPARA_INJECTION_PRESSURE_5] = 13.0514053;

	// FCS
	/*
	doubleOPCUAConvertRatio[IMMPARA_INJECTION_PRESSURE_1]=14.22222;
	doubleOPCUAConvertRatio[IMMPARA_INJECTION_PRESSURE_2]=14.22222;
	doubleOPCUAConvertRatio[IMMPARA_INJECTION_PRESSURE_3]=14.22222;
	doubleOPCUAConvertRatio[IMMPARA_INJECTION_PRESSURE_4]=14.22222;
	doubleOPCUAConvertRatio[IMMPARA_INJECTION_PRESSURE_5]=14.22222;
	*/

	// CYCU
	// doubleOPCUAConvertRatio[IMMPARA_INJECTION_SPEED_1] = 1.5965574;
	// doubleOPCUAConvertRatio[IMMPARA_INJECTION_SPEED_2] = 1.5965574;
	// doubleOPCUAConvertRatio[IMMPARA_INJECTION_SPEED_3] = 1.5965574;
	// doubleOPCUAConvertRatio[IMMPARA_INJECTION_SPEED_4] = 1.5965574;
	// doubleOPCUAConvertRatio[IMMPARA_INJECTION_SPEED_5] = 1.5965574;

	// FCS
	/*
	doubleOPCUAConvertRatio[IMMPARA_INJECTION_SPEED_1]=4.10861;
	doubleOPCUAConvertRatio[IMMPARA_INJECTION_SPEED_2]=4.10861;
	doubleOPCUAConvertRatio[IMMPARA_INJECTION_SPEED_3]=4.10861;
	doubleOPCUAConvertRatio[IMMPARA_INJECTION_SPEED_4]=4.10861;
	doubleOPCUAConvertRatio[IMMPARA_INJECTION_SPEED_5]=4.10861;
	*/

	// CYCU
	// doubleOPCUAConvertRatio[IMMPARA_VPCHANGEOVER_POSITION] = 1.5205309;

	// FCS
	// doubleOPCUAConvertRatio[IMMPARA_VPCHANGEOVER_POSITION]=4.41786;

	// CYCU
	// doubleOPCUAConvertRatio[IMMPARA_HOLDING_PRESSURE_1] = 13.0514053;
	// doubleOPCUAConvertRatio[IMMPARA_HOLDING_PRESSURE_2] = 13.0514053;
	// doubleOPCUAConvertRatio[IMMPARA_HOLDING_PRESSURE_3] = 13.0514053;
	// doubleOPCUAConvertRatio[IMMPARA_HOLDING_PRESSURE_4] = 13.0514053;
	// doubleOPCUAConvertRatio[IMMPARA_HOLDING_PRESSURE_5] = 13.0514053;

	// FCS
	/*
	doubleOPCUAConvertRatio[IMMPARA_HOLDING_PRESSURE_1]=14.22222;
	doubleOPCUAConvertRatio[IMMPARA_HOLDING_PRESSURE_2]=14.22222;
	doubleOPCUAConvertRatio[IMMPARA_HOLDING_PRESSURE_3]=14.22222;
	doubleOPCUAConvertRatio[IMMPARA_HOLDING_PRESSURE_4]=14.22222;
	doubleOPCUAConvertRatio[IMMPARA_HOLDING_PRESSURE_5]=14.22222;
	*/

	// CYCU
	// doubleOPCUAConvertRatio[IMMPARA_PLASTIFICATION_VOLUME_1] = 1.5205309;
	// doubleOPCUAConvertRatio[IMMPARA_PLASTIFICATION_VOLUME_2] = 1.5205309;
	// doubleOPCUAConvertRatio[IMMPARA_PLASTIFICATION_VOLUME_3] = 1.5205309;
	// doubleOPCUAConvertRatio[IMMPARA_PLASTIFICATION_VOLUME_4] = 1.5205309;
	// doubleOPCUAConvertRatio[IMMPARA_PLASTIFICATION_VOLUME_5] = 1.5205309;

	// FCS
	/*
	doubleOPCUAConvertRatio[IMMPARA_PLASTIFICATION_VOLUME_1]=4.41786;
	doubleOPCUAConvertRatio[IMMPARA_PLASTIFICATION_VOLUME_2]=4.41786;
	doubleOPCUAConvertRatio[IMMPARA_PLASTIFICATION_VOLUME_3]=4.41786;
	doubleOPCUAConvertRatio[IMMPARA_PLASTIFICATION_VOLUME_4]=4.41786;
	doubleOPCUAConvertRatio[IMMPARA_PLASTIFICATION_VOLUME_5]=4.41786;
	*/

	// CYCU
	// doubleOPCUAConvertRatio[IMMPARA_SCREW_RPM_1] = 0.2303835;
	// doubleOPCUAConvertRatio[IMMPARA_SCREW_RPM_2] = 0.2303835;
	// doubleOPCUAConvertRatio[IMMPARA_SCREW_RPM_3] = 0.2303835;
	// doubleOPCUAConvertRatio[IMMPARA_SCREW_RPM_4] = 0.2303835;
	// doubleOPCUAConvertRatio[IMMPARA_SCREW_RPM_5] = 0.2303835;

	// FCS
	/*
	doubleOPCUAConvertRatio[IMMPARA_SCREW_RPM_1]=0.39270;
	doubleOPCUAConvertRatio[IMMPARA_SCREW_RPM_2]=0.39270;
	doubleOPCUAConvertRatio[IMMPARA_SCREW_RPM_3]=0.39270;
	doubleOPCUAConvertRatio[IMMPARA_SCREW_RPM_4]=0.39270;
	doubleOPCUAConvertRatio[IMMPARA_SCREW_RPM_5]=0.39270;
	*/

	// doubleOPCUAConvertRatio[IMMPARA_VPCHANGEOVER_TIME] = 1000000;
	// doubleOPCUAConvertRatio[IMMPARA_COOLING_TIME] = 1000000;

	// CYCU
	// doubleOPCUAConvertRatio[IMMSENSOR_VPCHANGEOVER_POSITION] = 1.5205309;

	// FCS
	// doubleOPCUAConvertRatio[IMMSENSOR_VPCHANGEOVER_POSITION]=4.41786;

	// CYCU
	// doubleOPCUAConvertRatio[IMMSENSOR_END_HOLDING_POSITION] = 1.5205309;

	// FCS
	// doubleOPCUAConvertRatio[IMMSENSOR_END_HOLDING_POSITION]=4.41786;

	// CYCU
	// doubleOPCUAConvertRatio[IMMSENSOR_MAX_INJECTION_PRESSURE] = 13.0514053;

	// FCS
	// doubleOPCUAConvertRatio[IMMSENSOR_MAX_INJECTION_PRESSURE]=14.22222;

	// doubleOPCUAConvertRatio[IMMSENSOR_CYCLE_TIME] = 1000000;
	// doubleOPCUAConvertRatio[IMMSENSOR_MOLD_CLAMPING_TIME] = 1000000;
	// doubleOPCUAConvertRatio[IMMSENSOR_MOLD_RELEASING_TIME] = 1000000;
	// doubleOPCUAConvertRatio[IMMSENSOR_INJECTION_TIME] = 1000000;
	// doubleOPCUAConvertRatio[IMMSENSOR_HOLDING_TIME] = 1000000;

	return EXIT_SUCCESS;
}

int OPCUA_ConvertOPCUAtoPanel(double doubleRatio[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1], int intNodeSN, UA_Variant *originalVariant, UA_Variant *convertedVariant)
//[OPCUA]Convert OPC UA Node Data Value to Panel Value (PanelValue = OPCUANodeValue / Ratio)
{
	double doubleConvertedValue;
	if (doubleRatio[intNodeSN] != 1.0)
	{
		if (originalVariant->type->typeIndex == UA_TYPES_FLOAT)
		{
			fprintf(stderr, "[OPCUA_ConvertOPCUAtoPanel]Type:Float NodeSN:%d Original:%lf ", intNodeSN, *(UA_Float *)originalVariant->data);
			// *(UA_Float*)originalVariant->data/=doubleRatio[intNodeSN];
			// *(UA_Float*)originalVariant->data=(int)(*(UA_Float*)originalVariant->data*10000+0.5)/10000.0;
			doubleConvertedValue = *(UA_Float *)originalVariant->data;
			doubleConvertedValue /= doubleRatio[intNodeSN];
			doubleConvertedValue = (int)(doubleConvertedValue * 10000 + 0.5) / 10000;
			fprintf(stderr, "Ratio:%lf Convertformed:%lf\n", doubleRatio[intNodeSN], doubleConvertedValue);
		}
		else if (originalVariant->type->typeIndex == UA_TYPES_DOUBLE)
		{
			fprintf(stderr, "[OPCUA_ConvertOPCUAtoPanel]Type:Double NodeSN:%d  Original:%lf ", intNodeSN, *(UA_Double *)originalVariant->data);
			// *(UA_Double*)originalVariant->data/=doubleRatio[intNodeSN];
			// *(UA_Double*)originalVariant->data=(int)(*(UA_Double*)originalVariant->data*10000+0.5)/10000.0;

			doubleConvertedValue = *(UA_Double *)originalVariant->data;
			doubleConvertedValue /= doubleRatio[intNodeSN];
			doubleConvertedValue = (int)(doubleConvertedValue * 10000 + 0.5) / 10000;
			fprintf(stderr, "Ratio:%lf Convertformed:%lf\n", doubleRatio[intNodeSN], doubleConvertedValue);
		}
		else if (originalVariant->type->typeIndex == UA_TYPES_INT64)
		{
			fprintf(stderr, "[OPCUA_ConvertOPCUAtoPanel]Type:Int64 NodeSN:%d Original:%ld ", intNodeSN, *(UA_Int64 *)originalVariant->data);
			doubleConvertedValue = (*(UA_Int64 *)originalVariant->data) / doubleRatio[intNodeSN];
			doubleConvertedValue = (*(UA_Int64 *)originalVariant->data - (*(UA_Int64 *)originalVariant->data / doubleRatio[intNodeSN])) / doubleRatio[intNodeSN];
			doubleConvertedValue = (doubleConvertedValue * 10000 + 0.5) / 10000;
			fprintf(stderr, "Ratio:%lf Convertformed:%lf\n", doubleRatio[intNodeSN], doubleConvertedValue);
		}
		UA_Variant_setScalarCopy(convertedVariant, &doubleConvertedValue, &UA_TYPES[UA_TYPES_DOUBLE]);
	}
	else
	{
		UA_Variant_setScalarCopy(convertedVariant, originalVariant->data, originalVariant->type);
	}
	return EXIT_SUCCESS;
}

int OPCUA_ConvertPaneltoOPCUA(double doubleRatio[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1], int intNodeSN, UA_Variant *value)
//[OPCUA]Convert Panel Value to OPC UA Node Data Value (OPCUANodeValue = PanelValue * Ratio)
{
	if (doubleRatio[intNodeSN] != 0)
	{
		if (value->type->typeIndex == UA_TYPES_FLOAT)
		{
#ifdef DEBUG_MODE_SUBSCRIBE_OPCUA
			fprintf(stderr, "[OPCUA_ConvertPaneltoOPCUA]NodeSN:%d SNOriginal:%lf ", intNodeSN, *(UA_Float *)value->data);
#endif
			*(UA_Float *)value->data *= doubleRatio[intNodeSN];
			*(UA_Float *)value->data = (int)(*(UA_Float *)value->data * 10000 + 0.5) / 10000.0;
#ifdef DEBUG_MODE_SUBSCRIBE_OPCUA
			fprintf(stderr, "Ratio:%lf Convertformed:%lf\n", doubleRatio[intNodeSN], *(UA_Float *)value->data);
#endif
		}
		else if (value->type->typeIndex == UA_TYPES_DOUBLE)
		{
#ifdef DEBUG_MODE_SUBSCRIBE_OPCUA
			fprintf(stderr, "[OPCUA_ConvertPaneltoOPCUA]Original:%lf ", *(UA_Double *)value->data);
#endif
			*(UA_Double *)value->data *= doubleRatio[intNodeSN];
			*(UA_Double *)value->data = (int)(*(UA_Double *)value->data * 10000 + 0.5) / 10000.0;
#ifdef DEBUG_MODE_SUBSCRIBE_OPCUA
			fprintf(stderr, "Ratio:%lf Convertformed:%lf\n", doubleRatio[intNodeSN], *(UA_Double *)value->data);
#endif
		}
		else if (value->type->typeIndex == UA_TYPES_INT64)
		{
#ifdef DEBUG_MODE_SUBSCRIBE_OPCUA
			fprintf(stderr, "[OPCUA_ConvertPaneltoOPCUA]Original:%ld ", *(UA_Int64 *)value->data);
#endif
			*(UA_Int64 *)value->data *= doubleRatio[intNodeSN];
#ifdef DEBUG_MODE_SUBSCRIBE_OPCUA
			fprintf(stderr, "Ratio:%lf Convertformed:%ld\n", doubleRatio[intNodeSN], *(UA_Int64 *)value->data);
#endif
		}
	}
	return EXIT_SUCCESS;
}

int OPCUA_WriteOPCUANodeValue(MYSQL mysqlCon, unsigned int intIMMSN, unsigned int intOPCUANodeSN, char charValue[TINY_STRING_SIZE])
//[OPCUA]Write Value to A Specified OPC UA Node (by OPC UA Node ID)
{
	unsigned int intIMMParaSN;
	char *charIMMParaSN;
	unsigned int intMOSN;
	char charOPCUAIP[16];
	unsigned int intOPCUAPort;
	char charEndPointURL[MEDIUM_STRING_SIZE];
	unsigned int intOPCUAVersionSN;
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	if (intIMMSN == 0)
	{
		intOPCUAVersionSN = VIRTUAL_OPCUA_SERVER_OPCUA_VERSIONSN;
		strcpy(charOPCUAIP, VIRTUAL_OPCUA_SERVER_IP);
		intOPCUAPort = VIRTUAL_OPCUA_SERVER_PORT;
	}
	else
	{

		// Select IMM Information Where IMMSN Is Given From INJPRO_Data_IMMSNList
		snprintf(charStatement, MAX_STRING_SIZE, "SELECT OPCUAVersionSN,OPCUAIP,OPCUAPort FROM %s_%s.IMMSNList WHERE IMMSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_WriteOPCUANodeValue]Fail to select IMM information where IMMSN=%d from %s_%s.IMMSNList (%d):%s",
					 intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_WriteOPCUANodeValue]IMMSN=%d is not found in %s_%s.IMMSNList",
					 intIMMSN, SYS_NAME, DATA_DATABASE_NAME);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}

		// Get OPCUAVersionSN
		if (mysqlRow[0] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_WriteOPCUANodeValue]Fail to select OPCUAVersionSN from %s_%s.IMMSNList where IMMSN=%d",
					 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, EXIT_FAILURE, charErrMsg);
			return intLogSN;
		}
		else
		{
			if (intIMMSN != 0)
				intOPCUAVersionSN = atoi(mysqlRow[0]);
			else
				intOPCUAVersionSN = VIRTUAL_OPCUA_SERVER_OPCUA_VERSIONSN;
		}

		// Get OPC UA IP
		if (mysqlRow[1] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_WriteOPCUANodeValue]Fail to select OPCUA IP of IMMSN:%d ", intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, EXIT_FAILURE, charErrMsg);
			return intLogSN;
		}
		else
		{
			if (intIMMSN != 0)
				strcpy(charOPCUAIP, mysqlRow[1]);
			else
				strcpy(charOPCUAIP, VIRTUAL_OPCUA_SERVER_IP);
		}

		// Get OPC UA Port
		if (mysqlRow[2] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_WriteOPCUANodeValue]Fail to select OPC UA Port of IMMSN:%d", intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, EXIT_FAILURE, charErrMsg);
			return intLogSN;
		}
		else
		{
			if (intIMMSN != 0)
				intOPCUAPort = atoi(mysqlRow[2]);
			else
				intOPCUAPort = VIRTUAL_OPCUA_SERVER_PORT; // bermuda
		}

		mysql_free_result(mysqlResult);
	}

	UA_Client *client = UA_Client_new(UA_ClientConfig_default);
	snprintf(charEndPointURL, MEDIUM_STRING_SIZE, "opc.tcp://%s:%d", charOPCUAIP, intOPCUAPort);
	intRetval = UA_Client_connect(client, charEndPointURL);
	if (intRetval != UA_STATUSCODE_GOOD)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_WriteOPCUANodeValue]Fail to set OPC UA node:%d value of IMMSN:%d due to OPC UA connection fail",
				 intOPCUANodeSN, intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select Node NameSpace and ID From INJPRO_Sys_Index.OPCUAVersionIndex Where OPCUAVersionSN Is Given
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT * FROM %s_%s.OPCUAVersionIndex WHERE OPCUAVersionSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, intOPCUAVersionSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_WriteOPCUANodeValue]Fail to select OPCUAVersionSN from table %s_%s.IMMSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	// Check If This OPC UA Node Is Supported and Value Is Not NULL
	if (mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NS] != NULL && charValue != NULL)
	{
		UA_Variant *readVariant = UA_Variant_new();
		UA_Variant *writeVariant = UA_Variant_new();

		if (strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "i") == 0)
		{
			intRetval = UA_Client_readValueAttribute(client,
													 UA_NODEID_NUMERIC(atoi(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NS]),
																	   atoi(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_ID])),
													 readVariant);
		}
		else if (strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "s") == 0)
		{
			intRetval = UA_Client_readValueAttribute(client,
													 UA_NODEID_STRING(atoi(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NS]),
																	  mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_ID]),
													 readVariant);
		}
		if (intRetval == UA_STATUSCODE_GOOD && UA_Variant_isScalar(readVariant))
		{
			if (readVariant->type == &UA_TYPES[UA_TYPES_BOOLEAN])
			{
				bool *nodeValue = malloc(sizeof(bool));
				*nodeValue = (bool)atoi(charValue);
				UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_FLOAT])
			{
				float *nodeValue = malloc(sizeof(float));
				*nodeValue = (float)atof(charValue);
				UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_DOUBLE])
			{
				double *nodeValue = malloc(sizeof(double));
				*nodeValue = atof(charValue);
				UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_INT32])
			{
				int *nodeValue = malloc(sizeof(int));
				*nodeValue = atoi(charValue);
				UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_INT64])
			{
				long int *nodeValue = malloc(sizeof(long int));
				*nodeValue = atol(charValue);
				UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
			}
		}
		if (strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "i") == 0)
		{
			UA_Client_writeValueAttribute(client,
										  UA_NODEID_NUMERIC(atoi(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NS]),
															atoi(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_ID])),
										  writeVariant);
		}
		else if (strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "s") == 0)
		{
			UA_Client_writeValueAttribute(client,
										  UA_NODEID_STRING(atoi(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NS]),
														   mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_ID]),
										  writeVariant);
		}
		UA_Variant_delete(writeVariant);
		UA_Variant_delete(readVariant);
	}
	mysql_free_result(mysqlResult);
	UA_Client_delete(client);
	return EXIT_SUCCESS;
}

int OPCUA_ReadOPCUANodeValue(MYSQL mysqlCon, unsigned int intIMMSN, unsigned int intOPCUANodeSN, UA_Variant *readVariant)
//[OPCUA]Read Value from A Specified OPC UA Node (by OPC UA Node ID)
{

	int intIMMParaSN;
	char *charIMMParaSN;
	int intMOSN;
	char charOPCUAIP[16];
	int intOPCUAPort;
	char charEndPointURL[MEDIUM_STRING_SIZE];
	int intOPCUAVersionSN;
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;

	// Select IMM Information Where IMMSN Is Given From INJPRO_Data_IMMSNList
	snprintf(charStatement, MAX_STRING_SIZE, "SELECT OPCUAVersionSN,OPCUAIP,OPCUAPort FROM %s_%s.IMMSNList WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_ReadOPCUANodeValue]Fail to select IMM information where IMMSN=%d from %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	MYSQL_RES *mysqlResult = mysql_store_result(&mysqlCon);
	MYSQL_ROW mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_ReadOPCUANodeValue]Fail to tune IMM parameter due to IMMSN=%d is not found in %s_%s.IMMSNList",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Get OPCUAVersionSN
	if (mysqlRow[0] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_ReadOPCUANodeValue]Fail to select OPCUAVersionSN from %s_%s.IMMSNList where IMMSN=%d while tuning IMM parameter",
				 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, EXIT_FAILURE, charErrMsg);
		return intLogSN;
	}
	else
	{
		if (intIMMSN != 0)
			intOPCUAVersionSN = atoi(mysqlRow[0]);
		else
			intOPCUAVersionSN = VIRTUAL_OPCUA_SERVER_OPCUA_VERSIONSN;
	}

	// Get OPC UA IP
	if (mysqlRow[1] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_ReadOPCUANodeValue]Fail to select OPCUA IP of IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, EXIT_FAILURE, charErrMsg);
		return intLogSN;
	}
	else
	{
		if (intIMMSN != 0)
			strcpy(charOPCUAIP, mysqlRow[1]);
		else
			strcpy(charOPCUAIP, VIRTUAL_OPCUA_SERVER_IP);
	}

	// Get OPC UA Port
	if (mysqlRow[2] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_ReadOPCUANodeValue]Fail to select OPC UA Port of IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, EXIT_FAILURE, charErrMsg);
		return intLogSN;
	}
	else
	{
		if (intIMMSN != 0)
			intOPCUAPort = atoi(mysqlRow[2]);
		else
			intOPCUAPort = VIRTUAL_OPCUA_SERVER_PORT;
	}

	mysql_free_result(mysqlResult);

	UA_Client *client = UA_Client_new(UA_ClientConfig_default);
	snprintf(charEndPointURL, MEDIUM_STRING_SIZE, "opc.tcp://%s:%d", charOPCUAIP, intOPCUAPort);
	intRetval = UA_Client_connect(client, charEndPointURL);
	if (intRetval != UA_STATUSCODE_GOOD)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_ReadOPCUANodeValue]Fail to set OPC UA node value of IMMSN:%d due to OPC UA connection fail", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select Node NameSpace and ID From INJPRO_Sys_Index.OPCUAVersionIndex Where OPCUAVersionSN Is Given
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT * FROM %s_%s.OPCUAVersionIndex WHERE OPCUAVersionSN=%d",
			 SYS_NAME, INDEX_DATABASE_NAME, intOPCUAVersionSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[OPCUA_ReadOPCUANodeValue]Fail to select OPCUAVersionSN from table %s_%s.IMMSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	// Check If This IMM Supports MoldClamped
	if (mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NS] != NULL)
	{
		// UA_Variant *readVariant = UA_Variant_new();

		if (strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "i") == 0)
		{
			intRetval = UA_Client_readValueAttribute(client,
													 UA_NODEID_NUMERIC(atoi(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NS]),
																	   atoi(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_ID])),
													 readVariant);
		}
		else if (strcmp(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_IDENTIFIER_TYPE], "s") == 0)
		{
			intRetval = UA_Client_readValueAttribute(client,
													 UA_NODEID_STRING(atoi(mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NS]),
																	  mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_ID]),
													 readVariant);
		}

		/*
		if (intRetval == UA_STATUSCODE_GOOD && UA_Variant_isScalar(readVariant))
		{
			if (readVariant->type == &UA_TYPES[UA_TYPES_BOOLEAN])
			{
				printf("[IMMSN:%d %s]:%d\n", intIMMSN, mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NAME],
					   *(UA_Boolean *)readVariant->data);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_FLOAT])
			{
				printf("[IMMSN:%d %s]:%f\n", intIMMSN, mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NAME],
					   *(UA_Float *)readVariant->data);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_DOUBLE])
			{
				printf("[IMMSN:%d %s]:%f\n", intIMMSN, mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NAME],
					   *(UA_Double *)readVariant->data);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_INT16])
			{
				printf("[IMMSN:%d %s]:%d\n", intIMMSN, mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NAME],
					   *(UA_Int16 *)readVariant->data);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_UINT16])
			{
				printf("[IMMSN:%d %s]:%d\n", intIMMSN, mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NAME],
					   *(UA_UInt16 *)readVariant->data);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_INT32])
			{
				printf("[IMMSN:%d %s]:%d\n", intIMMSN, mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NAME],
					   *(UA_Int32 *)readVariant->data);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_UINT32])
			{
				printf("[IMMSN:%d %s]:%d\n", intIMMSN, mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NAME],
					   *(UA_UInt32 *)readVariant->data);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_INT64])
			{
				printf("[IMMSN:%d %s]:%ld\n", intIMMSN, mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NAME],
					   *(UA_Int64 *)readVariant->data);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_UINT64])
			{
				printf("[IMMSN:%d %s]:%ld\n", intIMMSN, mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NAME],
					   *(UA_UInt64 *)readVariant->data);
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_STRING])
			{
				printf("[IMMSN:%d %s]:%s\n", intIMMSN, mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NAME],
					   (char *)((UA_String *)readVariant->data));
			}
			else if (readVariant->type == &UA_TYPES[UA_TYPES_DATETIME])
			{
				UA_DateTimeStruct t = UA_DateTime_toStruct(*(UA_DateTime *)readVariant->data);
				printf("[IMMSN:%d %s]:%4d-%02d-%02d %02d:%02d:%02d\n",
					   intIMMSN, mysqlRow[OPCUA_VERSION_META_NUM + (intOPCUANodeSN - 1) * OPCUA_META_NUM + OPCUA_META_NAME], t.year, t.month, t.day, t.hour, t.min, t.sec);
			}
		}
		*/
		// UA_Variant_delete(readVariant);
	}
	mysql_free_result(mysqlResult);
	UA_Client_delete(client);
	return EXIT_SUCCESS;
}

int OPCUA_ResetOPCUAServer(MYSQL mysqlCon, unsigned int intIMMSN)
//[OPCUA]Reset OPC UA Server of A Specified IMM
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	fprintf(stderr, "[OPCUA_ResetOPCUAServer]IMMSN:%d MoldStatus:Released\n", intIMMSN);
	// Set OPC UA Node Value : Mold Released
	intRetval = OPCUA_WriteOPCUANodeValue(mysqlCon, intIMMSN, DO_MOLD_CLAMPED, "0");
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[OPCUA_ResetOPCUAServer]Fail to Set Mold Clamped = 0 for IMMSN:%d via OPC UA (%d):%s",
				 intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	intRetval = OPCUA_WriteOPCUANodeValue(mysqlCon, intIMMSN, DO_MOLD_RELEASED, "1");
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[OPCUA_ResetOPCUAServer]Fail to Set Mold Released = 1 for IMMSN:%d via OPC UA (%d):%s",
				 intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

//[MODBUS]

int MODBUS_SelectModbusClientStatusbyIMMSN(MYSQL mysqlCon, unsigned int intIMMSN, unsigned int *intModbusClientStatus)
//[MODBUS]Select Modbus Client Status of A Specified IMMSN
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	int intExitStatus = EXIT_SUCCESS;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE, "SELECT ModbusClientStatus FROM %s_%s.IMMSNList WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);

	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[DB_SelectModbusClientStatusbyIMMSN]Fail to select MOStatus from %s_%s.MOSNList where MOSN:%d (%d):%s",
				 SYS_NAME, MO_DATABASE_NAME, intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		mysql_free_result(mysqlResult);
		return EXIT_FAILURE;
	}
	else if (mysqlRow[0] != NULL)
	{
		*intModbusClientStatus = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
	else
	{
		return EXIT_FAILURE;
	}
}

//[MANUFACTURING ORDER]

int MO_CreateMO(MYSQL mysqlCon, unsigned int *intMOSN, const char *charMOID, unsigned int intIMMSN, unsigned int intProdSN, unsigned int intMoldSN, unsigned int intMaterialSN, struct tm tmExpectedStartTime, struct tm tmExpectedEndTime, unsigned int intPiecePerShot, unsigned int intExpectedProdVolume)
//[MO]Create A New MO
{
	int intExitStatus = EXIT_SUCCESS;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char *charMOSN;
	char charMonitorItemDisplayName[SMALL_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	char charExpectedStartTime[TINY_STRING_SIZE];
	char charExpectedEndTime[TINY_STRING_SIZE];
	unsigned int intLogSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intOPCUAVersionSN;
	unsigned int intMonitorItemSN = 1;
	bool boolIsomorphism = false;

	// Parameter Checking - PiecePerShot cannot be zero
	if (intPiecePerShot <= 0)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Piece per shot can not be zero or negative.");
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select Max SN from INJPRO_DATA_MO.MOSNList
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s_%s.MOSNList", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "MOSN", &charMOSN);
	if (intRetval == EXIT_FAILURE)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to select max MOSN in table %s_%s_%s.MOSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	*intMOSN = atoi(charMOSN) + 1;

	// Get OPCUAVersionSN According to The Given IMMSN - bermuda
	snprintf(charStatement, MAX_STRING_SIZE, "SELECT OPCUAVersionSN FROM %s_%s.IMMSNList WHERE IMMSN=%d", SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to select OPC UA version where IMMSN=%d from %s_%s.IMMSNList (%d):%s",
				 intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow[0] == NULL)
	{
		intOPCUAVersionSN = VIRTUAL_OPCUA_SERVER_OPCUA_VERSIONSN;
		/*
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to select OPCUAVersionSN of IMMSN:%d", intIMMSN);
		SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, *intMOSN, intIMMSN, EXIT_FAILURE, charErrMsg);
		intExitStatus = EXIT_FAILURE;
		*/
	}
	else
		intOPCUAVersionSN = atoi(mysqlRow[0]);
	mysql_free_result(mysqlResult);

	// Date Time Transfer
	tmExpectedStartTime.tm_year -= 1900;
	tmExpectedStartTime.tm_mon -= 1;
	tmExpectedEndTime.tm_year -= 1900;
	tmExpectedEndTime.tm_mon -= 1;

	strftime(charExpectedStartTime, TINY_STRING_SIZE, "%F %T", &tmExpectedStartTime);
	strftime(charExpectedEndTime, TINY_STRING_SIZE, "%F %T", &tmExpectedEndTime);
	// Insert MO Meta Into Table INJPRO_Data_MO.MOSNList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s_%s.MOSNList ("
			 "MOSN,	MOID,	IMMSN,	OPCUAVersionSN,	ProdSN,	MoldSN,	MaterialSN,	ExpectedStartTime,	ExpectedEndTime,	PiecePerShot, 	ExpectedProdVolume, ExpectedProdShot) VALUE ("
			 "%d,	'%s',	%d,		%d,				%d,		%d,		%d,			'%s',				'%s',				%d,				%d,					ExpectedProdVolume/PiecePerShot)",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME,
			 *intMOSN, charMOID, intIMMSN, intOPCUAVersionSN, intProdSN, intMoldSN, intMaterialSN,
			 charExpectedStartTime, charExpectedEndTime, intPiecePerShot, intExpectedProdVolume);
	// fprintf(stderr,"Q:%s\n",charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to insert table %s_%s_%s.MOSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Database INJPRO_Data_MO_[MOSN]
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Database INJPRO_Data_MO_[MOSN]_Info_Meta
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d_Info_Meta DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d_Info_Meta (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intExitStatus = EXIT_FAILURE;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_Info_Meta.MOCustomSensorSNList
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList ("
											 "MOCustomSensorSN			INT UNSIGNED NOT NULL,"
											 "CustomSensorModelSN		INT UNSIGNED NOT NULL,"
											 "MOCustomSensorChannelSN		INT UNSIGNED NOT NULL,"
											 "MOCustomSensorConvertRatio	DOUBLE NOT NULL,"
											 "MOCustomSensorMeta			VARCHAR(250),"
											 "PRIMARY KEY (MOCustomSensorSN),"
											 "UNIQUE(MOCustomSensorChannelSN),"
											 "CONSTRAINT %d_MOCustomSensorSNList_CustomSensorModelSN FOREIGN KEY (CustomSensorModelSN) REFERENCES %s_%s.CustomSensorModelIndex(CustomSensorModelSN) ON UPDATE CASCADE,"
											 "INDEX(CustomSensorModelSN,MOCustomSensorChannelSN))"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN,
			 *intMOSN, SYS_NAME, INDEX_DATABASE_NAME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_Info_Meta.MOAcceptCriteriaSNList
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList ("
											 "MOAcceptCriteriaSN	INT UNSIGNED NOT NULL,"
											 "AcceptCriteriaSN		INT UNSIGNED,"
											 "MOAcceptCriteriaMeta	VARCHAR(250),"
											 "MOAcceptCriteriaClass	INT UNSIGNED NOT NULL,"
											 "MOAcceptCriteriaUnit	VARCHAR(20) NOT NULL,"
											 "MOAcceptCriteriaMinTH	DOUBLE,"
											 "MOAcceptCriteriaMaxTH	DOUBLE,"
											 "PRIMARY KEY (MOAcceptCriteriaSN),"
											 "CONSTRAINT %d_MOAcceptCriteriaSNList_AcceptCriteriaSN FOREIGN KEY (AcceptCriteriaSN) REFERENCES %s_%s.AcceptCriteriaIndex(AcceptCriteriaSN) ON UPDATE CASCADE,"
											 "INDEX(AcceptCriteriaSN,MOAcceptCriteriaClass))"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN,
			 *intMOSN, SYS_NAME, INDEX_DATABASE_NAME);

	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_Info_Meta.AcceptCriteriaSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Database INJPRO_Data_MO_[MOSN]_Info
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d_Info DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d_Info (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Database INJPRO_Data_MO_[MOSN]_Info_Config
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d_Info_Config DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d_Info_Config (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_Info_Config.MonitorItemSNList
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_Info_Config.MonitorItemSNList ("
											 "MonitorItemSN								INT UNSIGNED NOT NULL,"
											 "MonitorItemName							VARCHAR(50) DEFAULT NULL,"
											 "MonitorItemClass							INT UNSIGNED NOT NULL,"
											 "MonitorItemSensorSN						INT UNSIGNED DEFAULT NULL,"
											 "MonitorItemIndex							INT UNSIGNED DEFAULT NULL,"
											 "SPCEnable									TINYINT(1) DEFAULT 0,"
											 "SPCSampleSize								INT UNSIGNED DEFAULT 2 NOT NULL,"
											 "SPCGroupSize								INT UNSIGNED DEFAULT 10 NOT NULL,"
											 "SPCCLRatio								DOUBLE DEFAULT 3.0 NOT NULL,"
											 "SPCRule1									TINYINT(1) DEFAULT 0,"
											 "SPCRule2									TINYINT(1) DEFAULT 0,"
											 "SPCRule3									TINYINT(1) DEFAULT 0,"
											 "SPCRule4									TINYINT(1) DEFAULT 0,"
											 "SPCRule5									TINYINT(1) DEFAULT 0,"
											 "SPCRule6									TINYINT(1) DEFAULT 0,"
											 "SPCRule7									TINYINT(1) DEFAULT 0,"
											 "SPCRule8									TINYINT(1) DEFAULT 0,"
											 "SPCCC										DOUBLE DEFAULT NULL,"
											 "QCEnable									TINYINT(1) DEFAULT 0,"
											 "QCCLRatio									DOUBLE DEFAULT 1.0 NOT NULL,"
											 "QCCC										DOUBLE DEFAULT NULL,"
											 "ECEnable									TINYINT(1) DEFAULT 0,"
											 "ECCLRatio									DOUBLE DEFAULT 1.0 NOT NULL,"
											 "ECCC										DOUBLE DEFAULT NULL,"
											 "PRIMARY KEY (MonitorItemSN),"
											 "INDEX(MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex))"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_Info_Meta.MOControlLineList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_Info_Meta.MOControlLineList ("
			 "MonitorItemSN			INT UNSIGNED NOT NULL,"
			 "SPCShotSNStart		INT DEFAULT NULL,"
			 "SPCShotSNEnd			INT DEFAULT NULL,"
			 "SPCCLRatioStatic		DOUBLE DEFAULT NULL,"
			 "XUCL					DOUBLE DEFAULT NULL,"
			 "XCL					DOUBLE DEFAULT NULL,"
			 "XLCL					DOUBLE DEFAULT NULL,"
			 "RUCL					DOUBLE DEFAULT NULL,"
			 "RCL					DOUBLE DEFAULT NULL,"
			 "RLCL					DOUBLE DEFAULT NULL,"
			 "QCShotSNStart			INT DEFAULT NULL,"
			 "QCShotSNEnd			INT DEFAULT NULL,"
			 "QCCLRatioStatic		DOUBLE DEFAULT NULL,"
			 "QCUCL					DOUBLE DEFAULT NULL,"
			 "QCCL					DOUBLE DEFAULT NULL,"
			 "QCLCL					DOUBLE DEFAULT NULL,"
			 "ECShotSNStart			INT DEFAULT NULL,"
			 "ECShotSNEnd			INT DEFAULT NULL,"
			 "ECCLRatioStatic		DOUBLE DEFAULT NULL,"
			 "ECUCL					DOUBLE DEFAULT NULL,"
			 "ECCL					DOUBLE DEFAULT NULL,"
			 "ECLCL					DOUBLE DEFAULT NULL,"
			 "PRIMARY KEY (MonitorItemSN),"
			 "CONSTRAINT %d_MOControlLineList_MonitorItemSN FOREIGN KEY (MonitorItemSN) REFERENCES  %s_%s_%s_%d_Info_Config.MonitorItemSNList(MonitorItemSN) ON UPDATE CASCADE)"
			 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN,
			 *intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_Info_Meta.MOControlLineList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Database for INJPRO_Data_MO_[MOSN]_RawData_ChartData
	snprintf(charStatement, MAX_STRING_SIZE,
			 "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d_RawData_ChartData DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d_RawData_ChartData (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Database INJPRO_Data_MO_[MOSN]_RawData
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d_RawData DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d_RawData (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_RawData.ShotSNList
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData.ShotSNList ("
											 "ShotSN					BIGINT UNSIGNED NOT NULL,"
											 "IMMOPCUAShotSN			BIGINT UNSIGNED DEFAULT NULL,"
											 "RoundSN					INT UNSIGNED NOT NULL,"
											 "CustomSN					VARCHAR(20) DEFAULT NULL,"
											 "IMMParaSN 				INT UNSIGNED DEFAULT NULL,"
											 "MOCustomSensorTableSN		INT UNSIGNED NOT NULL,"
											 "IMMParaUnstable			INT UNSIGNED DEFAULT NULL,"
											 "SPCProgressFlag			INT UNSIGNED DEFAULT %d,"
											 "QCProgressFlag			INT UNSIGNED DEFAULT %d,"
											 "ECProgressFlag			INT UNSIGNED DEFAULT %d,"
											 "EmptyShot					INT UNSIGNED DEFAULT NULL,"
											 "ErrorShot					INT UNSIGNED DEFAULT NULL,"
											 "MoldClampingTime			DATETIME(6) NOT NULL,"
											 "MoldClampedTime			DATETIME(6) DEFAULT NULL,"
											 "StartPackingTime			DATETIME(6) DEFAULT NULL,"
											 "StartHoldingTime			DATETIME(6) DEFAULT NULL,"
											 "StartCoolingTime			DATETIME(6) DEFAULT NULL,"
											 "MoldReleasingTime			DATETIME(6) DEFAULT NULL,"
											 "MoldReleasedTime 			DATETIME(6) DEFAULT NULL,"
											 "CycleTime					DOUBLE UNSIGNED DEFAULT NULL,"
											 "MoldClampedCycleTime		DOUBLE UNSIGNED DEFAULT NULL,"
											 "MoldBasedCycleTime		DOUBLE UNSIGNED DEFAULT NULL,"
											 "MoldShotInterval			DOUBLE UNSIGNED DEFAULT NULL,"
											 "MoldCompleteCycleTime		DOUBLE UNSIGNED DEFAULT NULL,"
											 "PRIMARY KEY (ShotSN),"
											 //"CONSTRAINT %d_ShotSNList_IMMParaSN FOREIGN KEY (IMMParaSN) REFERENCES %s_%s_%s_%d_RawData_IMMPara.IMMParaSNList(IMMParaSN) ON UPDATE CASCADE,"
											 "INDEX(IMMOPCUAShotSN,RoundSN,IMMParaSN,MOCustomSensorTableSN,ErrorShot))"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN,
			 SPC_PROGRESS_FLAG_MODBUS_READY | SPC_PROGRESS_FLAG_OPCUA_READY | SPC_PROGRESS_FLAG_FINISHED,
			 QC_PROGRESS_FLAG_MODBUS_READY | QC_PROGRESS_FLAG_OPCUA_READY | QC_PROGRESS_FLAG_FINISHED,
			 EC_PROGRESS_FLAG_MODBUS_READY | !EC_PROGRESS_FLAG_OPCUA_READY | EC_PROGRESS_FLAG_FINISHED);
	// *intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_RawData.ShotSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_RawData_ChartData.SPCChartData
	/*
	snprintf(charStatement, MAX_STRING_SIZE,
			 "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_ChartData.SPCChartData ("
			 "MonitorItemSN		INT UNSIGNED NOT NULL,"
			 "ShotSN			INT DEFAULT NULL,"
			 "GroupSN			INT DEFAULT NULL,"
			 "XBar				DOUBLE DEFAULT NULL,"
			 "R					DOUBLE DEFAULT NULL,"
			 "UNIQUE KEY (MonitorItemSN,GroupSN))"
			 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_RawData_ChartData.SPCChartData (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}*/

	// Create Table INJPRO_Data_MO_[MOSN]_RawData_ChartData.QCChartData
	/*
	snprintf(charStatement, MAX_STRING_SIZE,
			 "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_ChartData.QCChartData ("
			 "MonitorItemSN		INT UNSIGNED NOT NULL,"
			 "ShotSN			INT DEFAULT NULL,"
			 "X					DOUBLE DEFAULT NULL,"
			 "UNIQUE KEY (MonitorItemSN,ShotSN))"
			 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_RawData_ChartData.QCChartData (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}*/

	// Insert IMM Sensor SPC Control Index if OPCUA Version = 1 (Traditional IMM)
	if (intOPCUAVersionSN != VIRTUAL_OPCUA_SERVER_OPCUA_VERSIONSN)
	{
		// Insert All IMM Sensor Node != NULL
		snprintf(charStatement, MAX_STRING_SIZE, "SELECT * FROM %s_%s.OPCUAVersionIndex WHERE OPCUAVersionSN =%d",
				 SYS_NAME, INDEX_DATABASE_NAME, intOPCUAVersionSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to select IMM sensor nodes of OPCUAVersionSN:%d from table %s_%s.IMMSNList (%d): %s",
					 intOPCUAVersionSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			intExitStatus = EXIT_FAILURE;
		}

		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Empty IMM sensor node of OPCUAVersionSN from table %s_%s.IMMSNList",
					 SYS_NAME, DATA_DATABASE_NAME);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			intExitStatus = EXIT_FAILURE;
		}

		// Check if NameSpace of IMM Sensor Node != NULL, then Inset its SPC Control Index and Quality Control List
		for (int i = OPCUA_FIRST_IMMSENSOR; i <= OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM; i++)
		{

			if (mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_NS] != NULL)
			{
				// fprintf(stderr,"i:%d NS:%s\n",i,mysqlRow[OPCUA_VERSION_META_NUM + (i - 1) * OPCUA_META_NUM + OPCUA_META_NS]);
				//  Insert MonitorItemSN Monitor Item
				snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Config.MonitorItemSNList "
														 "(MonitorItemSN,MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex) VALUE (%d,%d,%d,%d)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN,
						 intMonitorItemSN, MONITOR_ITEM_CLASS_OPCUA, i, MONITOR_ITEM_INDEX_SINGLE_VALUE);
				// fprintf(stderr,"Q:%s\n",charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[MO_CreateMO]Fail to insert MonitorItemSN for MOSN:%d IMMSensor:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
							 *intMOSN, i, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
					intExitStatus = EXIT_FAILURE;
				}

				// Select MonitorItemDisplayName
				intRetval = DB_SelectMonitorItemDisplayName(mysqlCon, *intMOSN, intMonitorItemSN, charMonitorItemDisplayName);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[MO_CreateMO]Fail to select MonitorItemName for MOSN:%d IMMSensor:%d (%d):%s",
							 *intMOSN, i, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
					intExitStatus = EXIT_FAILURE;
				}

				// Create SPC XBarChart and RChart Data Table
				snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d ("
														 "ShotSN		BIGINT UNSIGNED NOT NULL,"
														 "GroupSN		BIGINT UNSIGNED DEFAULT NULL,"
														 "XValue		DOUBLE DEFAULT NULL,"
														 "XBarValue		DOUBLE DEFAULT NULL,"
														 "RValue		DOUBLE DEFAULT NULL,"
														 "PRIMARY KEY(ShotSN),"
														 "INDEX(GroupSN),"
														 "CONSTRAINT %d_MonitorItemSN_%dShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
														 "ENGINE=InnoDB",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, intMonitorItemSN,
						 *intMOSN, intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d (%d):%s",
							 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, intMonitorItemSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}

				// Update MonitorItemName
				snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET MonitorItemName = '%s' WHERE MonitorItemSN = %d",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, charMonitorItemDisplayName, intMonitorItemSN);
				// fprintf(stderr,"Q:%s\n",charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[MO_CreateMO]Fail to update MonitorItemName for MOSN:%d IMMSensor:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
							 *intMOSN, i, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
					intExitStatus = EXIT_FAILURE;
				}

				// Insert MOControlLineList Monitor Item
				snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList (MonitorItemSN) VALUE (%d)",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, intMonitorItemSN++);
				// fprintf(stderr, "Q:%s\n", charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[MO_CreateMO]Fail to insert MonitorItemSN for MOSN:%d IMMSensor:%d to table %s_%s_%s_%d_Info_Meta.MOControlLineList.MonitorItemSNList (%d):%s",
							 *intMOSN, i, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
					intExitStatus = EXIT_FAILURE;
				}
			}
		}
		mysql_free_result(mysqlResult);
	}

	// Create Database INJPRO_Data_MO_[MOSN]_RawData_Alarm
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d_RawData_Alarm DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d_RawData_Alarm (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_RawData_Alarm.QualityControlAlarmLog
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_Alarm.QualityControlAlarmLog ("
											 "QualityControlAlarmSN		INT UNSIGNED NOT NULL,"
											 "ShotSN					INT UNSIGNED NOT NULL,"
											 "MonitorItemSN 			INT UNSIGNED NOT NULL,"
											 "QualityControlAlarmRead	TINYINT(1) DEFAULT 0,"
											 "QualityControlAlarm		TINYINT(1) DEFAULT NULL,"
											 "QualityControlUCL			DOUBLE DEFAULT NULL,"
											 "QualityControlLCL			DOUBLE DEFAULT NULL,"
											 "QualityControlXValue		DOUBLE DEFAULT NULL,"
											 "QualityControlXDiff		DOUBLE DEFAULT NULL,"
											 "QualityControlAlarmTime	DATETIME(6) DEFAULT NULL,"
											 "PRIMARY KEY (QualityControlAlarmSN),"
											 "CONSTRAINT %d_QualityControlAlarmLog_MonitorItemSN FOREIGN KEY (MonitorItemSN) REFERENCES %s_%s_%s_%d_Info_Config.MonitorItemSNList(MonitorItemSN) ON UPDATE CASCADE,"
											 "UNIQUE(ShotSN,MonitorItemSN),"
											 "INDEX(QualityControlAlarm,QualityControlAlarmRead))"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN,
			 *intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_RawData_Alarm.QualityControlAlarmLog (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_RawData_Alarm.SPCAlarmLog
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_Alarm.SPCAlarmLog ("
											 "SPCAlarmSN		INT UNSIGNED NOT NULL,"
											 "ShotSNStart		INT UNSIGNED NOT NULL,"
											 "ShotSNEnd			INT UNSIGNED NOT NULL,"
											 "GroupSN			INT UNSIGNED NOT NULL,"
											 "MonitorItemSN 	INT UNSIGNED NOT NULL,"
											 "SPCAlarmRead		TINYINT(1) DEFAULT 0,"
											 "SPCAlarm			TINYINT(1) DEFAULT NULL,"
											 "SPCRAlarm			INT DEFAULT NULL,"
											 "SPCRUCL			DOUBLE DEFAULT NULL,"
											 "SPCRLCL			DOUBLE DEFAULT NULL,"
											 "SPCRValue			DOUBLE DEFAULT NULL,"
											 "SPCRDiff			DOUBLE DEFAULT NULL,"
											 "SPCRule1Alarm		INT DEFAULT NULL,"
											 "SPCRule1UCL		DOUBLE DEFAULT NULL,"
											 "SPCRule1LCL		DOUBLE DEFAULT NULL,"
											 "SPCRule1XBarValue	DOUBLE DEFAULT NULL,"
											 "SPCRule1XBarDiff	DOUBLE DEFAULT NULL,"
											 "SPCRule2Alarm		INT DEFAULT NULL,"
											 "SPCRule3Alarm		INT DEFAULT NULL,"
											 "SPCRule4Alarm		INT DEFAULT NULL,"
											 "SPCRule5Alarm		INT DEFAULT NULL,"
											 "SPCRule6Alarm		INT DEFAULT NULL,"
											 "SPCRule7Alarm		INT DEFAULT NULL,"
											 "SPCRule8Alarm		INT DEFAULT NULL,"
											 "SPCAlarmTime		DATETIME(6) DEFAULT NULL,"
											 "PRIMARY KEY (SPCAlarmSN),"
											 "CONSTRAINT %d_SPCAlarmLog_MonitorItemSN FOREIGN KEY (MonitorItemSN) REFERENCES %s_%s_%s_%d_Info_Config.MonitorItemSNList(MonitorItemSN) ON UPDATE CASCADE,"
											 "UNIQUE(ShotSNStart,ShotSNEnd,MonitorItemSN),"
											 "INDEX(SPCAlarm,SPCRAlarm))"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN,
			 *intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_RawData_Alarm.SPCAlarmLog (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	/*
	//Create Database INJPRO_Data_MO_[MOSN]_RawData_IMMSensor
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d_RawData_IMMSensor DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d_RawData_IMMSensor (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}*/

	// Create Database INJPRO_Data_MO_[MOSN]_RawData_CustomSensor
	snprintf(charStatement, MAX_STRING_SIZE,
			 "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d_RawData_CustomSensor DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d_RawData_CustomSensor (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Database INJPRO_Data_MO_[MOSN]_RawData_IMMPara
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d_RawData_IMMPara DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d_RawData_IMMPara (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_RawData_IMMPara.IMMParaSNList
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_IMMPara.IMMParaSNList ("
											 "IMMParaSN					INT UNSIGNED NOT NULL,"
											 "SubscribeSN				INT UNSIGNED NOT NULL,"
											 "TechnicianUserSN			INT UNSIGNED,"
											 "IMMParaLastUpdateTime		DATETIME(6),"
											 "InjectStage				INT UNSIGNED,"
											 "HoldStage					INT UNSIGNED,"
											 "PlasStage					INT UNSIGNED,"
											 "MeltTemperature			DOUBLE UNSIGNED,"
											 "PlastificationVolume1		DOUBLE UNSIGNED,"
											 "PlastificationVolume2		DOUBLE UNSIGNED,"
											 "PlastificationVolume3		DOUBLE UNSIGNED,"
											 "PlastificationVolume4		DOUBLE UNSIGNED,"
											 "PlastificationVolume5		DOUBLE UNSIGNED,"
											 "InjectionPressure1		DOUBLE UNSIGNED,"
											 "InjectionPressure2		DOUBLE UNSIGNED,"
											 "InjectionPressure3		DOUBLE UNSIGNED,"
											 "InjectionPressure4		DOUBLE UNSIGNED,"
											 "InjectionPressure5		DOUBLE UNSIGNED,"
											 "InjectionSpeed1			DOUBLE UNSIGNED,"
											 "InjectionSpeed2			DOUBLE UNSIGNED,"
											 "InjectionSpeed3			DOUBLE UNSIGNED,"
											 "InjectionSpeed4			DOUBLE UNSIGNED,"
											 "InjectionSpeed5			DOUBLE UNSIGNED,"
											 "VPChangeOverPosition		DOUBLE UNSIGNED,"
											 "VPChangeOverTime			DOUBLE UNSIGNED,"
											 "PackingPressure			DOUBLE UNSIGNED,"
											 "HoldingPressure1			DOUBLE UNSIGNED,"
											 "HoldingPressure2			DOUBLE UNSIGNED,"
											 "HoldingPressure3			DOUBLE UNSIGNED,"
											 "HoldingPressure4			DOUBLE UNSIGNED,"
											 "HoldingPressure5			DOUBLE UNSIGNED,"
											 "PackingTime				DOUBLE UNSIGNED,"
											 "HoldingTime1				DOUBLE UNSIGNED,"
											 "HoldingTime2				DOUBLE UNSIGNED,"
											 "HoldingTime3				DOUBLE UNSIGNED,"
											 "HoldingTime4				DOUBLE UNSIGNED,"
											 "HoldingTime5				DOUBLE UNSIGNED,"
											 "CoolingTime				DOUBLE UNSIGNED,"
											 "ScrewRPM1					DOUBLE UNSIGNED,"
											 "ScrewRPM2					DOUBLE UNSIGNED,"
											 "ScrewRPM3					DOUBLE UNSIGNED,"
											 "ScrewRPM4					DOUBLE UNSIGNED,"
											 "ScrewRPM5					DOUBLE UNSIGNED,"
											 "BackPressure1				DOUBLE UNSIGNED,"
											 "BackPressure2				DOUBLE UNSIGNED,"
											 "BackPressure3				DOUBLE UNSIGNED,"
											 "BackPressure4				DOUBLE UNSIGNED,"
											 "BackPressure5				DOUBLE UNSIGNED,"
											 "MoldTemperature			DOUBLE UNSIGNED,"
											 "PRIMARY KEY (IMMParaSN),"
											 "INDEX(TechnicianUserSN))"
											 //"CONSTRAINT %d_IMMParaSNList_IMMParaSN FOREIGN KEY (IMMParaSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(IMMParaSN) ON UPDATE CASCADE)"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	//*intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_RawData_IMMPara.IMMParaSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_RawData_IMMPara.RecommendIMMParaSNList
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_IMMPara.RecommendIMMParaSNList ("
											 "RecommendIMMParaSN			INT UNSIGNED NOT NULL,"
											 "InjectStage				INT UNSIGNED,"
											 "HoldStage					INT UNSIGNED,"
											 "PlasStage					INT UNSIGNED,"
											 "MeltTemperature			DOUBLE UNSIGNED,"
											 "PlastificationVolume1		DOUBLE UNSIGNED,"
											 "PlastificationVolume2		DOUBLE UNSIGNED,"
											 "PlastificationVolume3		DOUBLE UNSIGNED,"
											 "PlastificationVolume4		DOUBLE UNSIGNED,"
											 "PlastificationVolume5		DOUBLE UNSIGNED,"
											 "InjectionPressure1		DOUBLE UNSIGNED,"
											 "InjectionPressure2		DOUBLE UNSIGNED,"
											 "InjectionPressure3		DOUBLE UNSIGNED,"
											 "InjectionPressure4		DOUBLE UNSIGNED,"
											 "InjectionPressure5		DOUBLE UNSIGNED,"
											 "InjectionSpeed1			DOUBLE UNSIGNED,"
											 "InjectionSpeed2			DOUBLE UNSIGNED,"
											 "InjectionSpeed3			DOUBLE UNSIGNED,"
											 "InjectionSpeed4			DOUBLE UNSIGNED,"
											 "InjectionSpeed5			DOUBLE UNSIGNED,"
											 "VPChangeOverPosition		DOUBLE UNSIGNED,"
											 "VPChangeOverTime			DOUBLE UNSIGNED,"
											 "PackingPressure			DOUBLE UNSIGNED,"
											 "HoldingPressure1			DOUBLE UNSIGNED,"
											 "HoldingPressure2			DOUBLE UNSIGNED,"
											 "HoldingPressure3			DOUBLE UNSIGNED,"
											 "HoldingPressure4			DOUBLE UNSIGNED,"
											 "HoldingPressure5			DOUBLE UNSIGNED,"
											 "PackingTime				DOUBLE UNSIGNED,"
											 "HoldingTime1				DOUBLE UNSIGNED,"
											 "HoldingTime2				DOUBLE UNSIGNED,"
											 "HoldingTime3				DOUBLE UNSIGNED,"
											 "HoldingTime4				DOUBLE UNSIGNED,"
											 "HoldingTime5				DOUBLE UNSIGNED,"
											 "CoolingTime				DOUBLE UNSIGNED,"
											 "ScrewRPM1					DOUBLE UNSIGNED,"
											 "ScrewRPM2					DOUBLE UNSIGNED,"
											 "ScrewRPM3					DOUBLE UNSIGNED,"
											 "ScrewRPM4					DOUBLE UNSIGNED,"
											 "ScrewRPM5					DOUBLE UNSIGNED,"
											 "BackPressure1				DOUBLE UNSIGNED,"
											 "BackPressure2				DOUBLE UNSIGNED,"
											 "BackPressure3				DOUBLE UNSIGNED,"
											 "BackPressure4				DOUBLE UNSIGNED,"
											 "BackPressure5				DOUBLE UNSIGNED,"
											 "MoldTemperature			DOUBLE UNSIGNED,"
											 "PRIMARY KEY (RecommendIMMParaSN))"
											 //"CONSTRAINT %d_RecommendIMMParaSNList_ShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	//*intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_RawData_IMMPara.RecommendIMMParaSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Database for INJPRO_Data_MO_[MOSN]_RawData_AcceptCriteria
	snprintf(charStatement, MAX_STRING_SIZE,
			 "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d_RawData_AcceptCriteria DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d_RawData_AcceptCriteria (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Insert MOAcceptCriteriaSN=1 into Table INJPRO_Data_MO_[MOSN]_Info_Meta.AcceptCriteriaSNList
	// Create Table INJPRO_Data_MO_[MOSN]_RawData_AcceptCriteria.MOAcceptCriteriaSN
	stMOAcceptCriteriaSN varAcceptCriteriaSN;
	strcpy(varAcceptCriteriaSN.charAcceptCriteriaMeta, "Quality");
	strcpy(varAcceptCriteriaSN.charAcceptCriteriaMinTH, "");
	strcpy(varAcceptCriteriaSN.charAcceptCriteriaMaxTH, "");
	// if (intPiecePerShot == 1)
	// intRetval = MO_InsertMOAcceptCriteriaSNList(mysqlCon, *intMOSN, 1, ACCEPTCRITERIA_CATEGORY_BOOLEAN, "Pass/Fail", varAcceptCriteriaSN);
	// else
	// intRetval = MO_InsertMOAcceptCriteriaSNList(mysqlCon, *intMOSN, 1, ACCEPTCRITERIA_CATEGORY_VALUE, "Number of Fail", varAcceptCriteriaSN);
	intRetval = MO_InsertMOAcceptCriteriaSNList(mysqlCon, *intMOSN, 1, ACCEPTCRITERIA_CATEGORY_BOOLEAN, "Pass/Fail", varAcceptCriteriaSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to insert Quality as MOAcceptcriteriaSN1. (%d):%s", mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Database for INJPRO_Data_MO_[MOSN]_RawData_FeatureValue
	snprintf(charStatement, MAX_STRING_SIZE,
			 "CREATE DATABASE IF NOT EXISTS %s_%s_%s_%d_RawData_FeatureValue DEFAULT CHARACTER SET UTF8",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create database %s_%s_%s_%d_RawData_FeatureValue (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_RawData_FeatureValue.IMMSensorSNList
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList ("
											 "ShotSN					BIGINT UNSIGNED NOT NULL,"
											 "CycleTime					DOUBLE UNSIGNED," // 54
											 "MoldClampingTime			DOUBLE UNSIGNED," // 55
											 "MoldReleasingTime			DOUBLE UNSIGNED," // 56
											 "InjectionTime				DOUBLE UNSIGNED," // 57
											 "VPChangeOverDelayTime		DOUBLE UNSIGNED," // 58
											 "HoldingTime				DOUBLE UNSIGNED," // 59
											 "PlastificationTime		DOUBLE UNSIGNED," // 60
											 "VPChangeOverPosition		DOUBLE UNSIGNED," // 61
											 "CusionVolume				DOUBLE UNSIGNED," // 62
											 "EndHoldingPosition		DOUBLE UNSIGNED," // 63
											 "EndPlastificationPosition	DOUBLE UNSIGNED," // 64
											 "Nozzle1Temperature		DOUBLE ,"		  // 65
											 "Nozzle2Temperature		DOUBLE ,"		  // 66
											 "Nozzle3Temperature		DOUBLE ,"		  // 67
											 "Nozzle4Temperature		DOUBLE ,"		  // 68
											 "Nozzle5Temperature		DOUBLE ,"		  // 69
											 "IMMOilTemperature			DOUBLE ,"		  // 70
											 "FallMaterialTemperature	DOUBLE ,"		  // 71
											 "MaxInjectionPressure		DOUBLE ,"		  // 72
											 "VPChangeOverPressure		DOUBLE ,"		  // 73
											 "SumInjectionPressure		DOUBLE ,"		  // 74
											 "SumHoldingPressure		DOUBLE ,"		  // 75
											 "MaxCavityNearGatePressure	DOUBLE ,"		  // 76
											 "MaxCavityFarGatePressure	DOUBLE ,"		  // 77
											 "SumCavityPressure			DOUBLE ,"		  // 78
											 "SumMoldClampingForce		DOUBLE ,"		  // 79
											 "MaxMoldClampingForce		DOUBLE ,"		  // 80
											 "MaxBackPressure			DOUBLE ,"		  // 81
											 "DelayPlastificationTime	DOUBLE ,"		  // 82
											 "InMoldCoolingTemperature	DOUBLE ,"		  // 83
											 "OutMoldCoolingTemperature	DOUBLE ,"		  // 84
											 "MoldCoolingVolume			DOUBLE UNSIGNED," // 85
											 "MoldReleasingPosition2	DOUBLE UNSIGNED," // 86
											 "MoldReleasingPosition3	DOUBLE UNSIGNED," // 87
											 "MoldReleasingPosition4	DOUBLE UNSIGNED," // 88
											 "MoldReleasingPosition5	DOUBLE UNSIGNED," // 89
											 "ScrewSuckBackPosition		DOUBLE UNSIGNED," // 90
											 "ScrewRPM					DOUBLE ,"		  // 91
											 "PartWeight				DOUBLE UNSIGNED," // 92
											 "GateClosingTime			DOUBLE UNSIGNED," // 93
											 "MeltTemperature			DOUBLE ,"		  // 94
											 "MoldTemperature			DOUBLE ,"		  // 95
											 "PRIMARY KEY (ShotSN),"
											 "CONSTRAINT %d_IMMSensor_ShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN,
			 *intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_Info_Meta.IMMSensorSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// Create Basic Mold Related Feature Value List INJPRO_Data_MO_[MOSN]_RawData_FeatureValue_MOCustomSensorSN[MOCustomSensorSN] for the Sensor
	snprintf(charStatement, MAX_STRING_SIZE,
			 "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_FeatureValue.SoftSensor ("
			 "ShotSN								BIGINT UNSIGNED NOT NULL,"
			 "MoldClampedCycleTime					DOUBLE DEFAULT NULL,"
			 "MoldBasedCycleTime					DOUBLE DEFAULT NULL,"
			 "MoldShotInterval						DOUBLE DEFAULT NULL,"
			 "MoldCompleteCycleTime					DOUBLE DEFAULT NULL,"
			 "DiffMaxPressure						DOUBLE DEFAULT NULL,"
			 "DiffIncreasePressureTime				DOUBLE DEFAULT NULL,"
			 "DiffMoldReleasePressure				DOUBLE DEFAULT NULL,"
			 "PRIMARY KEY (ShotSN),"
			 "CONSTRAINT %d_FeatureValue_SoftSensor_ShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
			 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN,
			 *intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Insert Basic Mold Related Feauture Value Information into INJPRO_Data_MO_[MOSN]_Info_Config.MonitorItemSNList
	snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Config.MonitorItemSNList "
											 "(MonitorItemSN,MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex) VALUES "
											 "(%d,%d,NULL,%d),"
											 "(%d,%d,NULL,%d),"
											 "(%d,%d,NULL,%d),"
											 "(%d,%d,NULL,%d)",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN,
			 intMonitorItemSN, MONITOR_ITEM_CLASS_SOFT, SOFT_MOLD_CLAMPED_CYCLETIME,
			 intMonitorItemSN + 1, MONITOR_ITEM_CLASS_SOFT, SOFT_MOLD_BASED_CYCLETIME,
			 intMonitorItemSN + 2, MONITOR_ITEM_CLASS_SOFT, SOFT_MOLD_SHOT_INTERVAL,
			 intMonitorItemSN + 3, MONITOR_ITEM_CLASS_SOFT, SOFT_MOLD_COMPLETE_CYCLETIME);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[MO_CreateMO]Fail to insert SPC mold softsensor feature value index for MOSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 *intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Update All MonitorItemName for All Basic Mold Related Feauture Value
	for (int i = 0; i < MOLD_RELATED_SOFT_SENSOR_FEATURE_NUM; i++)
	{
		intRetval = DB_SelectMonitorItemDisplayName(mysqlCon, *intMOSN, intMonitorItemSN + i, charMonitorItemDisplayName);
		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET MonitorItemName = '%s' WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, charMonitorItemDisplayName, intMonitorItemSN + i);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_CreateMO]Fail to update MonitorItemName for MOSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 *intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Create SPC XBarChart and RChart Data Table
		snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d ("
												 "ShotSN		BIGINT UNSIGNED NOT NULL,"
												 "GroupSN		BIGINT UNSIGNED DEFAULT NULL,"
												 "XValue		DOUBLE DEFAULT NULL,"
												 "XBarValue		DOUBLE DEFAULT NULL,"
												 "RValue		DOUBLE DEFAULT NULL,"
												 "PRIMARY KEY(ShotSN),"
												 "INDEX(GroupSN),"
												 "CONSTRAINT %d_MonitorItemSN_%dShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
												 "ENGINE=InnoDB",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, intMonitorItemSN + i,
				 *intMOSN, intMonitorItemSN + i, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
		// fprintf(stderr,"Q:%s\n",charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOCustomSensorSNList]Fail to create table %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, intMonitorItemSN + i, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Insert MOControlLineList Monitor Item
		snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList (MonitorItemSN) VALUE (%d)",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, intMonitorItemSN + i);
		// fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_CreateMO]Fail to insert MonitorItemSN:%d for MOSN:%d  to table %s_%s_%s_%d_Info_Meta.MOControlLineList.MonitorItemSNList (%d):%s",
					 *intMOSN, i, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			intExitStatus = EXIT_FAILURE;
		}
	}
	intMonitorItemSN += MOLD_RELATED_SOFT_SENSOR_FEATURE_NUM;

	// Create Table INJPRO_Data_MO_[MOSN]_RawData_FeatureValue.SPCStatisticsList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_FeatureValue.SPCStatisticsList ("
			 "MonitorItemSN					INT UNSIGNED NOT NULL,"
			 "ShotSNStart			INT DEFAULT NULL,"
			 "ShotSNEnd				INT DEFAULT NULL,"
			 "Ca					DOUBLE DEFAULT NULL,"
			 "Cp					DOUBLE DEFAULT NULL,"
			 "Cpk					DOUBLE DEFAULT NULL,"
			 "Ppk					DOUBLE DEFAULT NULL,"
			 "PRIMARY KEY (MonitorItemSN),"
			 "CONSTRAINT %d_SPCStatisticsList_MonitorItemSN FOREIGN KEY (MonitorItemSN) REFERENCES %s_%s_%s_%d_Info_Config.MonitorItemSNList(MonitorItemSN) ON UPDATE CASCADE)"
			 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN,
			 *intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to create table %s_%s_%s_%d_RawData_FeatureValue.SPCStatisticsList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	if (intExitStatus == EXIT_FAILURE)
	{
		snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s_%s.MOSNList WHERE MOSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, *intMOSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_CreateMO]Fail to delete MO[%d:%s] from %s_%s_%s.MOSNList while creating.",
					 *intMOSN, charMOID, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, *intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		}
		MO_DeleteMO(mysqlCon, *intMOSN);
	}

	return intExitStatus;
}

int MO_UpdateMO(MYSQL mysqlCon,
				unsigned int intMOSN, const char *charMOID, unsigned int intIMMSN,
				unsigned int intProdSN, unsigned int intMoldSN, unsigned int intMaterialSN,
				struct tm tmExpectedStartTime, struct tm tmExpectedEndTime,
				unsigned int intPiecePerShot, unsigned int intExpectedProdVolume)
//[MO]Update An Existing MO
{
	int intExitStatus = EXIT_SUCCESS;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char *charMOSN;
	char charErrMsg[LONG_STRING_SIZE];
	char charExpectedStartTime[TINY_STRING_SIZE];
	char charExpectedEndTime[TINY_STRING_SIZE];
	unsigned int intLogSN;

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Date Time Transfer
	tmExpectedStartTime.tm_year -= 1900;
	tmExpectedStartTime.tm_mon -= 1;
	tmExpectedEndTime.tm_year -= 1900;
	tmExpectedEndTime.tm_mon -= 1;

	strftime(charExpectedStartTime, TINY_STRING_SIZE, "%F %T", &tmExpectedStartTime);
	strftime(charExpectedEndTime, TINY_STRING_SIZE, "%F %T", &tmExpectedEndTime);

	// Check If This MO Has Been Produced Before
	snprintf(charStatement, MAX_STRING_SIZE, "SELECT ActualStartTime FROM %s_%s_%s.MOSNList WHERE MOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateMO]Fail to select ActualStartTime from %s_%s_%s.MOSNList while updating MOSN:%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow[0] != NULL)
	{
		fprintf(stderr, "[MO_UpdateMO]MOSN:%d has been login at %s, thus only ExpectedStartTime, ExpectedEndTime and ExpectedProdVolume can be modified.\n", intMOSN, mysqlRow[0]);

		// Insert MO Meta Into Table INJPRO_Data_MO.MOSNList
		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s.MOSNList SET "
												 "ExpectedStartTime = '%s', ExpectedEndTime ='%s', "
												 "ExpectedProdVolume = %d ,ExpectedProdShot = ExpectedProdVolume/PiecePerShot "
												 "WHERE MOSN = %d OR ReferenceMOSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME,
				 charExpectedStartTime, charExpectedEndTime, intExpectedProdVolume, intMOSN, intMOSN);
		// fprintf(stderr,"Q:%s\n",charStatement);
	}
	else
	{
		// Insert MO Meta Into Table INJPRO_Data_MO.MOSNList
		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s.MOSNList SET "
												 "MOID = '%s', IMMSN = %d, ProdSN = %d, MoldSN = %d, MaterialSN = %d, "
												 "ExpectedStartTime = '%s', ExpectedEndTime ='%s', "
												 "PiecePerShot = %d, ExpectedProdVolume = %d ,ExpectedProdShot = %d/%d "
												 "WHERE MOSN = %d OR ReferenceMOSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME,
				 charMOID, intIMMSN, intProdSN, intMoldSN, intMaterialSN,
				 charExpectedStartTime, charExpectedEndTime,
				 intPiecePerShot, intExpectedProdVolume, intExpectedProdVolume, intPiecePerShot,
				 intMOSN, intMOSN);
		// fprintf(stderr,"Q:%s\n",charStatement);
	}

	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateMO]Fail to update MO (MOSN:%d) in table %s_%s_%s.MOSNList (%d):%s",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	// snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateMO]Fail to update MO:%d due to  ActualStartTime is not NULL from %s_%s_%s.MOSNList while updating",
	//		 intMOSN,SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME);
	// intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, 0, charErrMsg);
	// return intLogSN;
	return intExitStatus;
}

int MO_MaskMO(MYSQL mysqlCon, unsigned int intMOSN)
//[MO]Mask An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s.MOSNList SET MOMask = 1 WHERE MOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[INDEX_MaskAcceptCriteria]Fail to mask MO (SN:%d) from Table %s_%s_%s.MOSNList (%d):%s",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int MO_DeleteMO(MYSQL mysqlCon, unsigned int intMOSN)
//[INDEX]Delete An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	int intExitStatus = EXIT_SUCCESS;
	unsigned int intLogSN;

	// Select IMMSN From INJPRO_Data.IMMSNList Where MOSN Is Given
	snprintf(charStatement, MAX_STRING_SIZE, "SELECT IMMSN FROM %s_%s.IMMSNList WHERE MOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to select IMMSN from %s_%s.IMMSNList while deleting MOSN:%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// If The Give MOSN Is On IMMSNList Then Unable To Be Deleted
	MYSQL_RES *mysqlResult = mysql_store_result(&mysqlCon);
	MYSQL_ROW mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow != NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to delete MOSN:%d due to foreign key reference to %s_%s.IMMSNList (StopMOonIMMSN)",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysql_free_result(mysqlResult);

	/*
	snprintf(charStatement,MAX_STRING_SIZE,"DROP DATABASE IF EXISTS %s_%s_%s_%d_Info_Meta",
	 SYS_NAME,DATA_DATABASE_NAME,MO_DATABASE_NAME,intMOSN);
	fprintf(stderr,"Q:%s\n",charStatement);
	intRetval=mysql_query(&mysqlCon,charStatement);
	if(intRetval!=EXIT_SUCCESS){
		snprintf(charErrMsg,LONG_STRING_SIZE,"[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_Info_Meta (%d):%s",
		 SYS_NAME,DATA_DATABASE_NAME,MO_DATABASE_NAME,intMOSN,mysql_errno(&mysqlCon),mysql_error(&mysqlCon));
		intLogSN=SYS_InsertSysErrMsg(mysqlCon,ERRCLASS_MYSQL,intMOSN,0,mysql_errno(&mysqlCon),charErrMsg);
		return intLogSN;
		//intExitStatus=EXIT_FAILURE;
	}

	snprintf(charStatement,MAX_STRING_SIZE,"DROP DATABASE IF EXISTS %s_%s_%s_%d_Info",
	 SYS_NAME,DATA_DATABASE_NAME,MO_DATABASE_NAME,intMOSN);
	intRetval=mysql_query(&mysqlCon,charStatement);
	if(intRetval!=EXIT_SUCCESS){
		snprintf(charErrMsg,LONG_STRING_SIZE,"[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_Info (%d):%s",
		 SYS_NAME,DATA_DATABASE_NAME,MO_DATABASE_NAME,intMOSN,mysql_errno(&mysqlCon),mysql_error(&mysqlCon));
		intLogSN=SYS_InsertSysErrMsg(mysqlCon,ERRCLASS_MYSQL,intMOSN,0,mysql_errno(&mysqlCon),charErrMsg);
		return intLogSN;
		//intExitStatus=EXIT_FAILURE;
	}*/

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_RawData_Alarm",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_RawData_Alarm (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_RawData_AcceptCriteria",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_RawData_AcceptCriteria (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	/*
	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_RawData_IMMSensor",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_RawData_IMMSensor (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}*/

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_RawData_CustomSensor",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_RawData_CustomSensor (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_RawData_FeatureValue",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_RawData_FeatureValue (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_RawData_ChartData",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_RawData_ChartData (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_Info_Meta",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_Info_Meta (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_Info",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_Info (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_RawData_AcceptCriteria",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_RawData_AcceptCriteria (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_Info_Config",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_Info_Config (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_RawData_IMMPara",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_RawData_IMMPara (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DROP TABLE IF EXISTS %s_%s_%s_%d_RawData.ShotSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop table %s_%s_%s_%d_RawData.ShotSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d_RawData",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d_RawData (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DROP DATABASE IF EXISTS %s_%s_%s_%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to drop database %s_%s_%s_%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}

	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s_%s.MOSNList WHERE MOSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to delete row from table %s_%s_%s.MOSNList where MOSN = %d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		intExitStatus = EXIT_FAILURE;
	}
	return intExitStatus;
}

int MO_DeleteShot(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN_Start, unsigned int intShotSN_End)
//[MO]Delete the Speficed Shot(s) of the Specified MO
{
	char charErrMsg[LONG_STRING_SIZE];
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charTableName[MEDIUM_STRING_SIZE];
	char *charCountMOCustomSensorSN;
	int intCountMOCustomSensorSN;
	int intLogSN;
	int intTableSN_Start, intTableSN_End;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	if (intShotSN_Start > intShotSN_End)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_DeleteShot]Fail to delete shot data for MOSN:%d due to the start of ShotSN:%d is greater than the end ShotSN:%d\n",
				 intMOSN, intShotSN_Start, intShotSN_End);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, 0, charErrMsg);
		return intLogSN;
	}

	// Select Total Number of MOCustomSensor
	snprintf(charTableName, MEDIUM_STRING_SIZE, "%s_%s_%s_%d_Info_Meta.MOCustomSensorSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = DB_SelectColumnMax(mysqlCon, charTableName, "MOCustomSensorSN", &charCountMOCustomSensorSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_DeleteShot]Fail to select total number of sensor for MOSN:%d from %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList (%d):%s",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	intCountMOCustomSensorSN = atoi(charCountMOCustomSensorSN);

	if (intShotSN_Start != intShotSN_End)
	{

		// Select The TableSN of intShotSN_Start and intShotSN_End
		snprintf(charStatement, MAX_STRING_SIZE, "SELECT MOCustomSensorTableSN FROM %s_%s_%s_%d_RawData.ShotSNList WHERE ShotSN = %d OR ShotSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN_Start, intShotSN_End);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_DeleteShot]Fail to select MOCustomSensorTableSN where ShotSN = %d or %d of MOSN: %d from %s_%s_%s_%d_RawData.ShotSNList (%d):%s",
					 intShotSN_Start, intShotSN_End, intMOSN,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return EXIT_FAILURE;
		}

		// Select MOCustomSensorTableSN for ShotSN_Start
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow != NULL)
		{
			intTableSN_Start = atoi(mysqlRow[0]);
		}
		else
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_DeleteShot]Fail to select MOCustomSensorTableSN due to ShotSN: %d to %d of MOSN:%d is not found in %s_%s_%s_%d_RawData.ShotSNList",
					 intShotSN_Start, intShotSN_End, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, 0, charErrMsg);
			return EXIT_FAILURE;
		}

		// Select MOCustomSensorTableSN for ShotSN_End
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow != NULL)
		{
			intTableSN_End = atoi(mysqlRow[0]);
		}
		else
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_DeleteShot]Fail to select MOCustomSensorTableSN due to ShotSN: %d to %d of MOSN:%d is not found in %s_%s_%s_%d_RawData.ShotSNList",
					 intShotSN_Start, intShotSN_End, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, 0, charErrMsg);
			return EXIT_FAILURE;
		}
		mysql_free_result(mysqlResult);
	}
	else
	{
		// Select The TableSN of intShotSN_Start and intShotSN_End
		snprintf(charStatement, MAX_STRING_SIZE, "SELECT MOCustomSensorTableSN FROM %s_%s_%s_%d_RawData.ShotSNList WHERE ShotSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN_Start);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_DeleteShot]Fail to select MOCustomSensorTableSN where ShotSN = %d of MOSN: %d from %s_%s_%s_%d_RawData.ShotSNList (%d):%s",
					 intShotSN_Start, intMOSN,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return EXIT_FAILURE;
		}

		// Select MOCustomSensorTableSN for ShotSN_Start
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow != NULL)
		{
			intTableSN_Start = atoi(mysqlRow[0]);
		}
		else
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_DeleteShot]Fail to select MOCustomSensorTableSN due to ShotSN: %d to %d of MOSN:%d is not found in %s_%s_%s_%d_RawData.ShotSNList",
					 intShotSN_Start, intShotSN_End, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, 0, charErrMsg);
			return EXIT_FAILURE;
		}

		intTableSN_End = intTableSN_Start;
	}

	// Delete Data From MOCustomSensor and Feature Value According  To intCountMOCustomSensorSN
	for (int i = 1; i <= intCountMOCustomSensorSN; i++)
	{

		// Delete FROM INJPRO_Data_MO_[MOSN]_RawData_CustomSensor.MOCustomSensorSN[MOCustomSensorSN]_TableSN[MOCustomSensorTableSN] WHERE ShotSN >= & <= The Given Range
		snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN>=%d AND ShotSN <=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i, intShotSN_Start, intShotSN_End);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_DeleteShot]Fail to delete ShotSN %d-%d of MOSN:%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 intShotSN_Start, intShotSN_End, intMOSN,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Delete FROM INJPRO_Data_MO_[MOSN]_RawData_CustomSensor.MOCustomSensorSN[MOCustomSensorSN]_TableSN[MOCustomSensorTableSN] WHERE ShotSN >= & <= The Given Range
		for (int j = intTableSN_Start; j <= intTableSN_End; j++)
		{
			snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN%d WHERE ShotSN>=%d AND ShotSN <=%d",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i, j, intShotSN_Start, intShotSN_End);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, MAX_STRING_SIZE,
						 "[MO_DeleteShot]Fail to delete ShotSN %d-%d of MOSN:%d from %s_%s_%s_%d_RawData._Sensor_Mold.MOCustomSensorSN%d_TableSN%d (%d):%s",
						 intShotSN_Start, intShotSN_End, intMOSN,
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i, j,
						 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
		}
	}

	// Delete INJPRO_Data_MO_[MOSN]_RawData_FeatureValue.SoftSensor
	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN_Start, intShotSN_End);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to delete ShotSN %d-%d from table %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
				 intShotSN_Start, intShotSN_End, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select All AcceptCriteriaSN from INJPRO_Data_MO_[MOSN]_Info_Meta.MOAcceptCriteriaSNList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MOAcceptCriteriaSN FROM %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteShot]Fail to select information from %s_%s_MO_%d_Info_Meta.MOAcceptCriteriaSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return EXIT_FAILURE;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	while ((mysqlRow = mysql_fetch_row(mysqlResult)) != NULL)
	{
		snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d WHERE ShotSN >= %d AND ShotSN <= %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, atoi(mysqlRow[0]), intShotSN_Start, intShotSN_End);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteShot]Fail to delete ShotSN %d-%d table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
					 intShotSN_Start, intShotSN_End, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, atoi(mysqlRow[0]), mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}

	// Delete Shot from INJPRO_Data_MO_[MOSN]_RawData_Alarm.SPCAlarmLog
	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s_%s_%d_RawData_Alarm.SPCAlarmLog WHERE ShotSN >= %d AND ShotSN <= %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN_Start, intShotSN_End);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to delete ShotSN %d-%d from table %s_%s_%s_%d_RawData_Alarm.SPCAlarmLog (%d):%s",
				 intShotSN_Start, intShotSN_End, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Delete Shot from INJPRO_Data_MO_[MOSN]_RawData_Alarm.QualityControlAlarmLog
	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s_%s_%d_RawData_Alarm.QualityControlAlarmLog WHERE ShotSN >= %d AND ShotSN <= %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN_Start, intShotSN_End);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to delete ShotSN %d-%d from table %s_%s_%s_%d_RawData_Alarm.SPCAlarmLog (%d):%s",
				 intShotSN_Start, intShotSN_End, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Delete INJPRO_Data_MO_[MOSN]_RawData_FeatureValue.IMMSensorSNList
	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList WHERE ShotSN >= %d AND ShotSN <=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN_Start, intShotSN_End);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to delete ShotSN %d-%d table %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
				 intShotSN_Start, intShotSN_End, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Delete From INJPRO_Data_MO_[MOSN]_RawData.ShotSNList Where ShotSN >= & <= The Given Range
	snprintf(charStatement, MAX_STRING_SIZE, "DELETE FROM %s_%s_%s_%d_RawData.ShotSNList WHERE ShotSN>=%d AND ShotSN <=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN_Start, intShotSN_End);

	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteShot]Fail to delete ShotSN %d-%d of MOSN:%d from %s_%s_%s_%d_RawData.ShotSNList (%d):%s",
				 intShotSN_Start, intShotSN_End, intMOSN,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	return EXIT_SUCCESS;
}

int MO_TruncateMO(MYSQL mysqlCon, unsigned int intMOSN)
//[MO]Truncate An Existing MO
{

	unsigned int intIMMSN;
	char *charShotSN;
	unsigned int intShotSN;
	char charTableName[MEDIUM_STRING_SIZE];
	char *charCountMOCustomSensorSN;
	unsigned int intCountMOCustomSensorSN;
	unsigned int intTableSN;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	int intExitStatus = EXIT_SUCCESS;
	unsigned int intLogSN;

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Select IMMSN From INJPRO_Data.IMMSNList Where MOSN Is Given
	snprintf(charStatement, MAX_STRING_SIZE, "SELECT IMMSN FROM %s_%s.IMMSNList WHERE MOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_DeleteMO]Fail to select IMMSN from %s_%s.IMMSNList while truncating MOSN:%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// If The Give MOSN Is On IMMSNList Then Unable To Be Truncated
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow != NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate MOSN:%d due to foreign key reference to %s_%s.IMMSNList (Producing?)",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysql_free_result(mysqlResult);

	// Select All AcceptCriteriaSN from INJPRO_Data_MO_[MOSN]_Info_Meta.MOAcceptCriteriaSNList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MOAcceptCriteriaSN FROM %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to select information from %s_%s_MO_%d_Info_Meta.MOAcceptCriteriaSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return EXIT_FAILURE;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	while ((mysqlRow = mysql_fetch_row(mysqlResult)) != NULL)
	{
		snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, atoi(mysqlRow[0]));
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, atoi(mysqlRow[0]), mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}

	// Truncate INJPRO_Data_MO_[MOSN]_RawData_Alarm.SPCAlarmLog
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_Alarm.SPCAlarmLog",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData_Alarm.SPCAlarmLog (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Truncate INJPRO_Data_MO_[MOSN]_RawData_Alarm.QualityControlAlarmLog
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_Alarm.QualityControlAlarmLog",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData_Alarm.QualityControlAlarmLog (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Truncate INJPRO_Data_MO_[MOSN]_RawData_FeatureValue.IMMSensorSNList
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Get The Amount of Custom Sensor of The MOSN
	snprintf(charTableName, MEDIUM_STRING_SIZE, "%s_%s_%s_%d_Info_Meta.MOCustomSensorSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = DB_SelectColumnMax(mysqlCon, charTableName, "MOCustomSensorSN", &charCountMOCustomSensorSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to get the amount of the custom sensor of MOSN:%d while truncating tables in database %s_%s_%s_%d_RawData_CustomSensor",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	fprintf(stderr, "[MO_TruncateMO]Amount of MOCustomSensorSN:%s\n", charCountMOCustomSensorSN);
	intCountMOCustomSensorSN = atoi(charCountMOCustomSensorSN);

	// Get Curren ShotSN of The MOSN
	snprintf(charTableName, MEDIUM_STRING_SIZE, "%s_%s_%s_%d_RawData.ShotSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = DB_SelectColumnMax(mysqlCon, charTableName, "ShotSN", &charShotSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to get ShotSN of MOSN:%d while truncating tables in database %s_%s_%s_%d_RawData_CustomSensor",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	intShotSN = atoi(charShotSN);

	// Truncate INJPRO_Data_MO_[MOSN]_RawData_FeatureValue.SoftSensor
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_FeatureValue.SoftSensor",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Truncate INJPRO_Data_MO_[MOSN]_RawData_ChartData.SPCChartData
	/*
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_ChartData.SPCChartData",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData_ChartData.SPCChartData (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}*/

	// Truncate INJPRO_Data_MO_[MOSN]_RawData_ChartData.QCChartData
	/*
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_ChartData.QCChartData",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData_ChartData.QCChartData (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}*/

	// Truncate INJPRO_Data_MO_[MOSN]_RawData_FeatureValue.SPCStatisticsList
	/*
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_FeatureValue.SPCStatisticsList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData_FeatureValue.SPCStatisticsList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}*/

	// Caculate Table for ShotSN : Default is 10000 shots per Table
	// fprintf(stderr, "[MO_TruncateMO]Final ShotSN:%d\n", intShotSN);
	intTableSN = intShotSN / SHOT_NUM_PER_TABLE + 1;

	// Drop and Truncate Tables (Keep Only TableSN=1)
	for (int i = 1; i <= intCountMOCustomSensorSN; i++)
	{
		// Truncate INJPRO_Data_MO_[MOSN]_RawData_FeatureValue.MOCustomSensorSN[i]
		snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		for (int j = intTableSN; j >= 1; j--)
		{
			// Truncate INJPRO_Data_MO_[MOSN]_RawData_CustomSensor.MOCustomSensorSN[i]_TableSN[j]
			if (j != 1)
			{
				snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN%d",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i, j);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to drop table %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN%d (%d):%s",
							 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i, j, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}
			}
			else
			{
				snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN1",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN1 (%d):%s",
							 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}
			}
		}
	}

	mysql_query(&mysqlCon, "SET FOREIGN_KEY_CHECKS=0;");

	// Truncate INJPRO_Data_MO_[MOSN]_RawData.ShotSNList
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData.ShotSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData.ShotSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Truncate INJPRO_Data_MO_[MOSN]_RawData_IMMPara.IMMParaSNList
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_IMMPara.IMMParaSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	// fprintf(stderr,"Q:%s\n",charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_RawData_IMMPara.IMMParaSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Truncate INJPRO_Data_MO_[MOSN]_RawData_IMMPara.RecommendIMMParaSNList
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_RawData_IMMPara.RecommendIMMParaSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_Info.RecommendIMMParaSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Truncate INJPRO_Data_MO_[MOSN]_Info.MOAcceptCriteriaSNList
	/*
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}*/

	mysql_query(&mysqlCon, "SET FOREIGN_KEY_CHECKS=1;");

	// Truncate INJPRO_Data_MO_[MOSN]_Info.MOAcceptCriteriaSNList
	/*
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}*/

	// Truncate INJPRO_Data_MO_[MOSN]_Info.MOCustomSensorSNList
	/*
	snprintf(charStatement, MAX_STRING_SIZE, "TRUNCATE TABLE %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate table %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}*/

	// Update INJPRO_Data_MO.MOSNList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s_%s.MOSNList SET CompletedShot = 0, ProdShot = 0, ProdVolume = 0, AcceptProdShot = 0, RejectProdShot = 0, YieldRate = 0, MOProgress = 0, EstimatedEndTime = NULL, ActualStartTime = NULL, ActualEndTime = NULL, MOLastUpdateTime = NULL "
			 "WHERE MOSN=%d OR ReferenceMOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_TruncateMO]Fail to truncate MOSN:%d while update %s_%s_%s.MOSNList (%d):%s",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	return EXIT_SUCCESS;
	// return intExitStatus;
}

int MO_ExportMO(MYSQL mysqlCon, unsigned int intMOSN)
//[MO]Export An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	snprintf(charStatement, MAX_STRING_SIZE, "mysqldump -u %s -p%s -t %s_%s_%s_%d_Info_Config > ./../Rawdata/Temp/%s_%s_%s_%d_Info_Config.sql",
			 MYSQL_USER_NAME, MYSQL_PASSWORD, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = system(charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_ExportMO]Fail to export database %s_%s_%s_%d_Info_Config\n", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	}

	snprintf(charStatement, MAX_STRING_SIZE, "mysqldump -u %s -p%s -t %s_%s_%s_%d_Info_Meta > ./../Rawdata/Temp/%s_%s_%s_%d_Info_Meta.sql",
			 MYSQL_USER_NAME, MYSQL_PASSWORD, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = system(charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_ExportMO]Fail to export database %s_%s_%s_%d_Info_Meta\n", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	}

	snprintf(charStatement, MAX_STRING_SIZE, "mysqldump -u %s -p%s -t %s_%s_%s_%d_RawData > ./../Rawdata/Temp/%s_%s_%s_%d_RawData.sql",
			 MYSQL_USER_NAME, MYSQL_PASSWORD, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = system(charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_ExportMO]Fail to export database %s_%s_%s_%d_RawData\n", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	}

	snprintf(charStatement, MAX_STRING_SIZE, "mysqldump -u %s -p%s -t %s_%s_%s_%d_RawData_AcceptCriteria > ./../Rawdata/Temp/%s_%s_%s_%d_RawData_AcceptCriteria.sql",
			 MYSQL_USER_NAME, MYSQL_PASSWORD, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = system(charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_ExportMO]Fail to export database %s_%s_%s_%d_RawData_AcceptCriteria\n", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	}

	snprintf(charStatement, MAX_STRING_SIZE, "mysqldump -u %s -p%s -t %s_%s_%s_%d_RawData_Alarm > ./../Rawdata/Temp/%s_%s_%s_%d_RawData_Alarm.sql",
			 MYSQL_USER_NAME, MYSQL_PASSWORD, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = system(charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_ExportMO]Fail to export database %s_%s_%s_%d_RawData_Alarm\n", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	}

	snprintf(charStatement, MAX_STRING_SIZE, "mysqldump -u %s -p%s -t %s_%s_%s_%d_RawData_FeatureValue > ./../Rawdata/Temp/%s_%s_%s_%d_RawData_FeatureValue.sql",
			 MYSQL_USER_NAME, MYSQL_PASSWORD, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = system(charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_ExportMO]Fail to export database %s_%s_%s_%d_RawData_FeatureValue\n", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	}

	snprintf(charStatement, MAX_STRING_SIZE, "mysqldump -u %s -p%s -t %s_%s_%s_%d_RawData_IMMPara > ./../Rawdata/Temp/%s_%s_%s_%d_RawData_IMMPara.sql",
			 MYSQL_USER_NAME, MYSQL_PASSWORD, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = system(charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_ExportMO]Fail to export database %s_%s_%s_%d_RawData_IMMPara\n", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	}

	/*
	snprintf(charStatement, MAX_STRING_SIZE, "mysqldump -u %s -p%s -t %s_%s_%s_%d_RawData_IMMSensor > ./../Rawdata/Temp/%s_%s_%s_%d_RawData_IMMSensor.sql",
			 MYSQL_USER_NAME, MYSQL_PASSWORD, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = system(charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_ExportMO]Fail to export database %s_%s_%s_%d_RawData_IMMSensor\n", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	}*/

	snprintf(charStatement, MAX_STRING_SIZE, "mysqldump -u %s -p%s -t %s_%s_%s_%d_RawData_CustomSensor > ./../Rawdata/Temp/%s_%s_%s_%d_RawData_CustomSensor.sql",
			 MYSQL_USER_NAME, MYSQL_PASSWORD, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = system(charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_ExportMO]Fail to export database %s_%s_%s_%d_RawData_CustomSensor\n", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	}
	return EXIT_SUCCESS;
}

int MO_InsertMOCustomSensorSNList(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intCustomSensorModelSN, unsigned int intMOCustomSensorChannelSN, double doubleMOCustomSensorConvertRatio, stMOCustomSensorSN varMOCustomSensorSN)
//[MO]Insert A New Custom Sensor to An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	char *charMOCustomSensorSN;
	unsigned int intMOCustomSensorSN;
	unsigned int intCustomSensorClass;
	unsigned int intCustomSensorCategory;
	unsigned int intHistorySensorClass;
	unsigned int intHistorySensorCategory;
	unsigned int intCavityPressureSensorCount = 0;
	int intLength;
	char *charMonitorItemSN;
	char charMonitorItemDisplayName[SMALL_STRING_SIZE];
	unsigned int intMonitorItemSN;
	unsigned int intLogSN;

	intRetval = DB_SelectMOCustomSensorClassAndCategorybyCustomSensorModelSN(mysqlCon, intCustomSensorModelSN, &intCustomSensorClass, &intCustomSensorCategory);
	// fprintf(stderr,"SensorClass:%d SensorCategory:%d\n",intCustomSensorClass,intCustomSensorCategory);

	if ((intLength = strlen(varMOCustomSensorSN.charMOCustomSensorMeta)) != 0)
	{
		strcpy(varMOCustomSensorSN.charMOCustomSensorMeta + 1, varMOCustomSensorSN.charMOCustomSensorMeta);
		varMOCustomSensorSN.charMOCustomSensorMeta[0] = '"';
		varMOCustomSensorSN.charMOCustomSensorMeta[intLength + 1] = '"';
		varMOCustomSensorSN.charMOCustomSensorMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varMOCustomSensorSN.charMOCustomSensorMeta, "NULL");

	// Get a New MOCustomSensorSN
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s_%s_%d_Info_Meta.MOCustomSensorSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "MOCustomSensorSN", &charMOCustomSensorSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_InsertMOCustomSensorSNList]Fail to get next MOCustomSensorSN from table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	else
		intMOCustomSensorSN = atoi(charMOCustomSensorSN) + 1;

	/*
	//If the Sensor is inside a IMM
	if (intCustomSensorClass == CUSTOM_SENSOR_CLASS_IMM)
	{
		//Insert Sensor to INJPRO_Data_MO_[MOSN]_Meta.MOCustomSensorSNList
		snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList "
												 "(MOCustomSensorSN, CustomSensorModelSN,MOCustomSensorChannelSN,MOCustomSensorConvertRatio,MOCustomSensorMeta) VALUE "
												 "(%d, %d,  %d, %lf, %s)",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intMOCustomSensorSN, intCustomSensorModelSN, intMOCustomSensorChannelSN, doubleMOCustomSensorConvertRatio, varMOCustomSensorSN.charMOCustomSensorMeta);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_InsertMOCustomSensorSNList]Fail to insert custom sensor class:%d model:%d into table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList (%d):%s",
					 intCustomSensorClass, intCustomSensorModelSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	else if (intCustomSensorClass == CUSTOM_SENSOR_CLASS_CAVITY)
	{

		//Insert Sensor to INJPRO_Data_MO_[MOSN]_Meta.MOCustomSensorSNList
		snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList "
												 "(MOCustomSensorSN, CustomSensorModelSN,MOCustomSensorChannelSN,MOCustomSensorConvertRatio,MOCustomSensorMeta) VALUE "
												 "(%d, %d, %d, %lf,%s)",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intMOCustomSensorSN, intCustomSensorModelSN, intMOCustomSensorChannelSN, doubleMOCustomSensorConvertRatio, varMOCustomSensorSN.charMOCustomSensorMeta);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_InsertMOCustomSensorSNList]Fail to insert custom sensor class:%d model:%d into table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList (%d):%s",
					 intCustomSensorClass, intCustomSensorModelSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}*/

	// Insert Sensor to INJPRO_Data_MO_[MOSN]_Meta.MOCustomSensorSNList
	snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList "
											 "(MOCustomSensorSN, CustomSensorModelSN,MOCustomSensorChannelSN,MOCustomSensorConvertRatio,MOCustomSensorMeta) VALUE "
											 "(%d, %d,  %d, %lf, %s)",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 intMOCustomSensorSN, intCustomSensorModelSN, intMOCustomSensorChannelSN, doubleMOCustomSensorConvertRatio, varMOCustomSensorSN.charMOCustomSensorMeta);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_InsertMOCustomSensorSNList]Fail to insert custom sensor class:%d model:%d into table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList (%d):%s",
				 intCustomSensorClass, intCustomSensorModelSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_RawData_CustomSensor.[MOCustomSensorSN]_[TableSN]
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN1 ("
											 "ShotSN	BIGINT UNSIGNED NOT NULL,"
											 "ElapsedTime	DOUBLE UNSIGNED,"
											 "SensorValue	DOUBLE,"
											 "DisplayValue	DOUBLE,"
											 "INDEX (ShotSN),"
											 "UNIQUE KEY(ShotSN,ElapsedTime))"
											 //"CONSTRAINT %d_MOCustomSensorSN_%d_TableSN_%d_ShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN);
	// intMOSN,intMOCustomSensorSN,1,SYS_NAME,DATA_DATABASE_NAME,MO_DATABASE_NAME,intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOCustomSensorSNList]Fail to create table %s_%s_%s_%d_RawData_CustomSensor.MOCustomSensorSN%d_TableSN1 (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Get a New MonitorItemSN
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s_%s_%d_Info_Config.MonitorItemSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "MonitorItemSN", &charMonitorItemSN);
	if (intRetval == EXIT_FAILURE)
		return EXIT_FAILURE;
	intMonitorItemSN = atoi(charMonitorItemSN) + 1;

	if (intCustomSensorClass == CUSTOM_SENSOR_CLASS_IMM && intCustomSensorCategory == CUSTOM_SENSOR_CATEGORY_PRESSURE)
	{
		// Create Corrsponding SPC Feature Value List INJPRO_Data_MO_[MOSN]_RawData_FeatureValue_MOCustomSensorSN[MOCustomSensorSN] for the Sensor
		snprintf(charStatement, MAX_STRING_SIZE,
				 "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d ("
				 "ShotSN					BIGINT UNSIGNED NOT NULL,"
				 "Stage1StartTime			DOUBLE DEFAULT NULL," // New
				 "Stage1EndTime				DOUBLE DEFAULT NULL,"
				 "Stage1Period				DOUBLE DEFAULT NULL," // New
				 "AvgStage1PressureSlope	DOUBLE DEFAULT NULL,"
				 "SumStage1Pressure			DOUBLE DEFAULT NULL,"
				 "Stage1EndPressure			DOUBLE DEFAULT NULL,"

				 "Stage2StartTime			DOUBLE DEFAULT NULL," // New
				 "Stage2EndTime				DOUBLE DEFAULT NULL," // New
				 "Stage2Period				DOUBLE DEFAULT NULL," // New
				 "AvgStage2PressureSlope	DOUBLE DEFAULT NULL,"
				 "SumStage2Pressure			DOUBLE DEFAULT NULL,"

				 "Stage3StartTime			DOUBLE DEFAULT NULL,"
				 "Stage3EndTime				DOUBLE DEFAULT NULL,"
				 "Stage3Period				DOUBLE DEFAULT NULL,"
				 "SumStage3Pressure			DOUBLE DEFAULT NULL,"
				 "MaxStage3Pressure			DOUBLE DEFAULT NULL,"
				 "MaxStage3PressureTime		DOUBLE DEFAULT NULL,"
				 "CycleTime					DOUBLE DEFAULT NULL," // New
				 "SumPressure				DOUBLE DEFAULT NULL,"

				 "PRIMARY KEY (ShotSN),"
				 "CONSTRAINT %d_FeatureValue_MOCustomSensorSN_%d_ShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
				 "ENGINE=InnoDB",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN,
				 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOCustomSensorSNList]Fail to create table %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Insert Corrsponding SPC Monitor Item for the Sensor to Table INJPRO_Data_MO_[MOSN]_Info_Config.MonitorItemSNList
		snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Config.MonitorItemSNList "
												 "(MonitorItemSN,MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex) VALUES "
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d)",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,

				 intMonitorItemSN, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_START_TIME,
				 intMonitorItemSN + 1, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME,
				 intMonitorItemSN + 2, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_PERIOD,
				 intMonitorItemSN + 3, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE,
				 intMonitorItemSN + 4, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE1_PRESSURE,
				 intMonitorItemSN + 5, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE,
				 intMonitorItemSN + 6, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_START_TIME,
				 intMonitorItemSN + 7, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_END_TIME,
				 intMonitorItemSN + 8, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_PERIOD,
				 intMonitorItemSN + 9, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE,
				 intMonitorItemSN + 10, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE2_PRESSURE,
				 intMonitorItemSN + 11, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_START_TIME,
				 intMonitorItemSN + 12, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_END_TIME,
				 intMonitorItemSN + 13, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_PERIOD,
				 intMonitorItemSN + 14, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE,
				 intMonitorItemSN + 15, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE_TIME,
				 intMonitorItemSN + 16, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE3_PRESSURE,
				 intMonitorItemSN + 17, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_CYCLE_TIME,
				 intMonitorItemSN + 18, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_PRESSURE);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaSNList]Fail to insert SPC mold pressure control index for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Insert Corrsponding EC Monitor Item for the Sensor to Table INJPRO_Data_MO_[MOSN]_Info_Config.MonitorItemSNList
		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET ECEnable = 1 , ECCLRatio = %lf WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, EC_IMM_SYSPRESSURE_RATIO_STAGE1_END_TIME, intMonitorItemSN + IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME - 1);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaSNList]Fail to set certain ECEnable flags for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET ECEnable = 1 , ECCLRatio = %lf WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, EC_IMM_SYSPRESSURE_RATIO_AVG_STAGE1_PRESSURESLOPE, intMonitorItemSN + IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE - 1);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaSNList]Fail to set certain ECEnable flags for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET ECEnable = 1 , ECCLRatio = %lf WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, EC_IMM_SYSPRESSURE_RATIO_STAGE1_END_PRESSURE, intMonitorItemSN + IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE - 1);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaSNList]Fail to set certain ECEnable flags for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET ECEnable = 1 , ECCLRatio = %lf WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, EC_IMM_SYSPRESSURE_RATIO_SUM_STAGE2_PRESSURE, intMonitorItemSN + IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE2_PRESSURE - 1);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaSNList]Fail to set certain ECEnable flags for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET ECEnable = 1 , ECCLRatio = %lf WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, EC_IMM_SYSPRESSURE_RATIO_STAGE3_PERIOD, intMonitorItemSN + IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_PERIOD - 1);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaSNList]Fail to set certain ECEnable flags for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET ECEnable = 1 , ECCLRatio = %lf WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, EC_IMM_SYSPRESSURE_RATIO_SUM_STAGE3_PRESSURE, intMonitorItemSN + IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE3_PRESSURE - 1);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaSNList]Fail to set certain ECEnable flags for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET ECEnable = 1 , ECCLRatio = %lf WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, EC_IMM_SYSPRESSURE_RATIO_SUM_PRESSURE, intMonitorItemSN + IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_PRESSURE - 1);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaSNList]Fail to set certain ECEnable flags for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Update All MonitorItemName for All Pressure Sensor Single Feature
		for (int i = 0; i < IMM_SYSPRESSURE_SENSOR_SINGLE_FEATURE_NUM; i++)
		{
			intRetval = DB_SelectMonitorItemDisplayName(mysqlCon, intMOSN, intMonitorItemSN + i, charMonitorItemDisplayName);
			snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET MonitorItemName = '%s' WHERE MonitorItemSN = %d",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, charMonitorItemDisplayName, intMonitorItemSN + i);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[MO_InsertMOAcceptCriteriaSNList]Fail to update MonitorItemName for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
						 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}

			// Create SPC XBarChart and RChart Data Table
			snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d ("
													 "ShotSN		BIGINT UNSIGNED NOT NULL,"
													 "GroupSN		BIGINT UNSIGNED DEFAULT NULL,"
													 "XValue		DOUBLE DEFAULT NULL,"
													 "XBarValue		DOUBLE DEFAULT NULL,"
													 "RValue		DOUBLE DEFAULT NULL,"
													 "PRIMARY KEY(ShotSN),"
													 "INDEX(GroupSN),"
													 "CONSTRAINT %d_MonitorItemSN_%dShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
													 "ENGINE=InnoDB",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN + i,
					 intMOSN, intMonitorItemSN + i, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			// fprintf(stderr,"Q:%s\n",charStatement);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOCustomSensorSNList]Fail to create table %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d (%d):%s",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN + i, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
		}
		// Insert MOControlLineList Monitor Item
		snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList (MonitorItemSN) VALUES "
												 "(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d),(%d)",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intMonitorItemSN,
				 intMonitorItemSN + 1,
				 intMonitorItemSN + 2,
				 intMonitorItemSN + 3,
				 intMonitorItemSN + 4,
				 intMonitorItemSN + 5,
				 intMonitorItemSN + 6,
				 intMonitorItemSN + 7,
				 intMonitorItemSN + 8,
				 intMonitorItemSN + 9,
				 intMonitorItemSN + 10,
				 intMonitorItemSN + 11,
				 intMonitorItemSN + 12,
				 intMonitorItemSN + 13,
				 intMonitorItemSN + 14,
				 intMonitorItemSN + 15,
				 intMonitorItemSN + 16,
				 intMonitorItemSN + 17,
				 intMonitorItemSN + 18);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOCustomSensorSNList]Fail to Insert IMM System Pressure sensor MonitorItemSN(%d-%d) for MOSN:%d to table %s_%s_%s_%d_Meta.MOControlLineList.MonitorItemSNList (%d):%s",
					 intMonitorItemSN, intMonitorItemSN + 18, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	else if (intCustomSensorClass == CUSTOM_SENSOR_CLASS_CAVITY && intCustomSensorCategory == CUSTOM_SENSOR_CATEGORY_PRESSURE)
	{
		// Create Corrsponding SPC Feature Value List INJPRO_Data_MO_[MOSN]_RawData_FeatureValue_MOCustomSensorSN[MOCustomSensorSN] for the Sensor
		snprintf(charStatement, MAX_STRING_SIZE,
				 "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d ("
				 "ShotSN					BIGINT UNSIGNED NOT NULL,"
				 "MaxPressure				DOUBLE DEFAULT NULL,"
				 "SumStage1Pressure			DOUBLE DEFAULT NULL,"
				 "MaxPressureTime			DOUBLE DEFAULT NULL,"
				 "AvgStage1PressureSlope 	DOUBLE DEFAULT NULL,"
				 "AvgStage2PressureSlope	DOUBLE DEFAULT NULL,"
				 "MoldReleasePressure		DOUBLE DEFAULT NULL,"
				 "PRIMARY KEY (ShotSN),"
				 "CONSTRAINT %d_FeatureValue_MOCustomSensorSN_%d_ShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
				 "ENGINE=InnoDB",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN,
				 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOCustomSensorSNList]Fail to create table %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Insert Corrsponding SPC Monitor Item for the Sensor to Table INJPRO_Data_MO_[MOSN]_Info_Config.MonitorItemSNList
		snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Config.MonitorItemSNList "
												 "(MonitorItemSN,MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex) VALUES "
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d)",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intMonitorItemSN, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE,
				 intMonitorItemSN + 1, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, CAVITY_PRESSURE_SENSOR_FEATURE_STAGE1_PRESSURE_SUM,
				 intMonitorItemSN + 2, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, CAVITY_PRESSURE_SENSOR_FEATURE_MAX_PRESSURE_TIME,
				 intMonitorItemSN + 3, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, CAVITY_PRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE,
				 intMonitorItemSN + 4, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, CAVITY_PRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE,
				 intMonitorItemSN + 5, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, CAVITY_PRESSURE_SENSOR_FEATURE_RELEASED_PRESSURE);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaSNList]Fail to insert SPC mold pressure control index for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Update All MonitorItemName for All Pressure Sensor Single Feature
		for (int i = 0; i < CAVITY_PRESSURE_SENSOR_SINGLE_FEATURE_NUM; i++)
		{
			intRetval = DB_SelectMonitorItemDisplayName(mysqlCon, intMOSN, intMonitorItemSN + i, charMonitorItemDisplayName);
			snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET MonitorItemName = '%s' WHERE MonitorItemSN = %d",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, charMonitorItemDisplayName, intMonitorItemSN + i);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[MO_InsertMOAcceptCriteriaSNList]Fail to update MonitorItemName for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
						 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}

			// Create SPC XBarChart and RChart Data Table
			snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d ("
													 "ShotSN		BIGINT UNSIGNED NOT NULL,"
													 "GroupSN		BIGINT UNSIGNED DEFAULT NULL,"
													 "XValue		DOUBLE DEFAULT NULL,"
													 "XBarValue		DOUBLE DEFAULT NULL,"
													 "RValue		DOUBLE DEFAULT NULL,"
													 "PRIMARY KEY(ShotSN),"
													 "INDEX(GroupSN),"
													 "CONSTRAINT %d_MonitorItemSN_%dShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
													 "ENGINE=InnoDB",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN + i,
					 intMOSN, intMonitorItemSN + i, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			// fprintf(stderr,"Q:%s\n",charStatement);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOCustomSensorSNList]Fail to create table %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d (%d):%s",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN + i, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
		}

		// Insert MOControlLineList Monitor Item
		snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList (MonitorItemSN) VALUES (%d),(%d),(%d),(%d),(%d),(%d)",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intMonitorItemSN,
				 intMonitorItemSN + 1,
				 intMonitorItemSN + 2,
				 intMonitorItemSN + 3,
				 intMonitorItemSN + 4,
				 intMonitorItemSN + 5);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOCustomSensorSNList]Fail to insert cavity pressure sensor MonitorItemSN(%d-%d) for MOSN:%d to table %s_%s_%s_%d_Meta.MOControlLineList.MonitorItemSNList (%d):%s",
					 intMonitorItemSN, intMonitorItemSN + 5, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Additional 3 SPC Monitor Item Will Be Added for the Second Mold Pressure
		for (int i = 1; i <= intMOCustomSensorSN; i++)
		{
			intRetval = DB_SelectMOCustomSensorClassAndCategorybyMOCustomSensorSN(mysqlCon, intMOSN, intMOCustomSensorSN, &intHistorySensorClass, &intHistorySensorCategory);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, MAX_STRING_SIZE,
						 "[MO_InsertMOCustomSensorSNList]Fail to select custom sensor category of MOSN:%d MOCustomSensorSN:%d from %s_%s.CustomSensorModelIndex and "
						 "%s_%s_%s_%d_Info_Meta.MOCustomSensorSNList while check the amount of mold pressure sensor(%d):%s",
						 intMOSN, intMOCustomSensorSN, SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
						 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
			if (intHistorySensorClass == CUSTOM_SENSOR_CLASS_CAVITY && intHistorySensorCategory == CUSTOM_SENSOR_CATEGORY_PRESSURE)
				intCavityPressureSensorCount++;
		}
		// If So Far Only 2 Mold Pressure Are Inserted, then Add the 3 Additional SPC Monitor Item
		if (intCavityPressureSensorCount == 2)
		{
			// SOFT_PRESSURE_SENSOR_DIFF_MAX_PRESSURE 1
			// SOFT_PRESSURE_SENSOR_DIFF_INCREASE_PRESSURE_TIME 2
			// SOFT_PRESSURE_SENSOR_DIFF_MOLD_RELEASE_PRESSURE 3

			// Add The Columns for Soft Sensor of Cavity Pressure Sensors
			/*
			snprintf(charStatement, MAX_STRING_SIZE,
					 "ALTER TABLE %s_%s_%s_%d_RawData_FeatureValue.SoftSensor "
					 "ADD COLUMN DiffMaxPressure				DOUBLE DEFAULT NULL,"
					 "ADD COLUMN DiffIncreasePressureTime		DOUBLE DEFAULT NULL,"
					 "ADD COLUMN DiffMoldReleasePressure		DOUBLE DEFAULT NULL",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			// fprintf(stderr,"Q:%s\n",charStatement);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOCustomSensorSNList]Fail to create table %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
			*/

			// Create Corrsponding SPC Feature Value List INJPRO_Data_MO_[MOSN]_RawData_FeatureValue_MOCustomSensorSN[MOCustomSensorSN] for the Sensor
			/*
			snprintf(charStatement, MAX_STRING_SIZE,
					 "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_FeatureValue.SoftSensor ("
					 "ShotSN					BIGINT UNSIGNED NOT NULL,"
					 "DiffMaxPressure			DOUBLE DEFAULT NULL,"
					 "DiffIncreasePressureTime	DOUBLE DEFAULT NULL,"
					 "DiffMoldReleasePressure	DOUBLE DEFAULT NULL,"
					 "PRIMARY KEY (ShotSN),"
					 "CONSTRAINT %d_FeatureValue_SoftSensor_ShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
					 "ENGINE=InnoDB",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOCustomSensorSNList]Fail to create table %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}*/

			snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Config.MonitorItemSNList "
													 "(MonitorItemSN,MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex) VALUES "
													 "(%d,%d,NULL,%d),"
													 "(%d,%d,NULL,%d),"
													 "(%d,%d,NULL,%d)",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 intMonitorItemSN + 6, MONITOR_ITEM_CLASS_SOFT, SOFT_PRESSURE_SENSOR_FEATURE_DIFF_MAX_PRESSURE,
					 intMonitorItemSN + 7, MONITOR_ITEM_CLASS_SOFT, SOFT_PRESSURE_SENSOR_FEATURE_DIFF_INCREASE_PRESSURE_TIME,
					 intMonitorItemSN + 8, MONITOR_ITEM_CLASS_SOFT, SOFT_PRESSURE_SENSOR_FEATURE_DIFF_MOLD_RELEASEPRESSURE);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[MO_InsertMOCustomSensorSNList]Fail to insert SPC mold pressure-else control index for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
						 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}

			// Insert MOControlLineList Monitor Item
			snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList (MonitorItemSN) VALUES (%d),(%d),(%d)",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN + 6, intMonitorItemSN + 7, intMonitorItemSN + 8);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[MO_InsertMOCustomSensorSNList]Fail to insert soft sensor MonitorItemSN(%d-%d) for MOSN:%d to table %s_%s_%s_%d_Meta.MOControlLineList.MonitorItemSNList (%d):%s",
						 intMonitorItemSN + 6, intMonitorItemSN + 8, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}

			// Claire

			// Update All MonitorItemName for All Pressure Soft Sensor Feature Value
			for (int i = CAVITY_PRESSURE_SENSOR_SINGLE_FEATURE_NUM; i < (CAVITY_PRESSURE_SENSOR_SINGLE_FEATURE_NUM + CAVITY_PRESSURE_SOFT_SENSOR_FEATURE_NUM); i++)
			{
				intRetval = DB_SelectMonitorItemDisplayName(mysqlCon, intMOSN, intMonitorItemSN + i, charMonitorItemDisplayName);
				snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET MonitorItemName = '%s' WHERE MonitorItemSN = %d",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, charMonitorItemDisplayName, intMonitorItemSN + i);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[MO_InsertMOAcceptCriteriaSNList]Fail to update MonitorItemName for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
							 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}

				// Create SPC XBarChart and RChart Data Table
				snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d ("
														 "ShotSN		BIGINT UNSIGNED NOT NULL,"
														 "GroupSN		BIGINT UNSIGNED DEFAULT NULL,"
														 "XValue		DOUBLE DEFAULT NULL,"
														 "XBarValue		DOUBLE DEFAULT NULL,"
														 "RValue		DOUBLE DEFAULT NULL,"
														 "PRIMARY KEY(ShotSN),"
														 "INDEX(GroupSN),"
														 "CONSTRAINT %d_MonitorItemSN_%dShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
														 "ENGINE=InnoDB",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN + i,
						 intMOSN, intMonitorItemSN + i, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
				// fprintf(stderr,"Q:%s\n",charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOCustomSensorSNList]Fail to create table %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d (%d):%s",
							 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN + i, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}
			}
		}
	}
	else if (intCustomSensorClass == CUSTOM_SENSOR_CLASS_CAVITY && intCustomSensorCategory == CUSTOM_SENSOR_CATEGORY_TEMPERATURE)
	{
		// Mold Temperature Sensor has the Following 5 SCP Control Index:
		// CAVITY_TEMPERATURE_SENSOR_SINGLE_FEATURE_NUM 5
		// CAVITY_TEMPERATURE_SENSOR_FEATURE_START_TEMPERATURE 1
		// CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE 2
		// CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE_TIME 3
		// CAVITY_TEMPERATURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE 4
		// CAVITY_TEMPERATURE_SENSOR_FEATURE_RELEASED_TEMPERATURE 5

		// Create Corrsponding SPC Feature Value List INJPRO_Data_MO_[MOSN]_RawData_FeatureValue_MOCustomSensorSN[MOCustomSensorSN] for the Sensor
		snprintf(charStatement, MAX_STRING_SIZE,
				 "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d ("
				 "ShotSN					BIGINT UNSIGNED NOT NULL,"
				 "StartTemperature			DOUBLE DEFAULT NULL,"
				 "MaxTemperature			DOUBLE DEFAULT NULL,"
				 "MaxTemperatureTime		DOUBLE DEFAULT NULL,"
				 "AvgStage2TemperatureSlope	DOUBLE DEFAULT NULL,"
				 "MoldReleaseTemperature 	DOUBLE DEFAULT NULL,"
				 "INDEX (ShotSN),"
				 "CONSTRAINT %d_FeatureValue_MOCustomSensorSN_%d_ShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
				 "ENGINE=InnoDB",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN,
				 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOCustomSensorSNList]Fail to create table %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOCustomSensorSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Insert Corrsponding SPC Monitor Item for the Sensor to Table INJPRO_Data_MO_[MOSN]_Info_Config.MonitorItemSNList
		snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Config.MonitorItemSNList "
												 "(MonitorItemSN,MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex) VALUES "
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d),"
												 "(%d,%d,%d,%d)",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intMonitorItemSN, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, CAVITY_TEMPERATURE_SENSOR_FEATURE_START_TEMPERATURE,
				 intMonitorItemSN + 1, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE,
				 intMonitorItemSN + 2, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, CAVITY_TEMPERATURE_SENSOR_FEATURE_MAX_TEMPERATURE_TIME,
				 intMonitorItemSN + 3, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, CAVITY_TEMPERATURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE,
				 intMonitorItemSN + 4, MONITOR_ITEM_CLASS_MODBUS, intMOCustomSensorSN, CAVITY_TEMPERATURE_SENSOR_FEATURE_RELEASED_TEMPERATURE);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_CreateMO]Fail to insert mold temperature SPC control index for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Update All MonitorItemName for All Temperature Sensor Feature Value
		for (int i = 0; i < CAVITY_TEMPERATURE_SENSOR_SINGLE_FEATURE_NUM; i++)
		{
			intRetval = DB_SelectMonitorItemDisplayName(mysqlCon, intMOSN, intMonitorItemSN + i, charMonitorItemDisplayName);
			snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET MonitorItemName = '%s' WHERE MonitorItemSN = %d",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, charMonitorItemDisplayName, intMonitorItemSN + i);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[MO_InsertMOAcceptCriteriaSNList]Fail to update MonitorItemName for MOSN:%d MOCustomSensorSN:%d to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
						 intMOSN, intMOCustomSensorSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}

			// Create SPC XBarChart and RChart Data Table
			snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d ("
													 "ShotSN		BIGINT UNSIGNED NOT NULL,"
													 "GroupSN		BIGINT UNSIGNED DEFAULT NULL,"
													 "XValue		DOUBLE DEFAULT NULL,"
													 "XBarValue		DOUBLE DEFAULT NULL,"
													 "RValue		DOUBLE DEFAULT NULL,"
													 "PRIMARY KEY(ShotSN),"
													 "INDEX(GroupSN),"
													 "CONSTRAINT %d_MonitorItemSN_%dShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
													 "ENGINE=InnoDB",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN + i,
					 intMOSN, intMonitorItemSN + i, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOCustomSensorSNList]Fail to create table %s_%s_%s_%d_RawData_ChartData.MonitorItemSN%d (%d):%s",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN + i, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
		}

		// Insert MOControlLineList Monitor Item
		snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList (MonitorItemSN) VALUES (%d),(%d),(%d),(%d),(%d)",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intMonitorItemSN,
				 intMonitorItemSN + 1,
				 intMonitorItemSN + 2,
				 intMonitorItemSN + 3,
				 intMonitorItemSN + 4);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_InsertMOCustomSensorSNList]Fail to insert cavity pressure sensor MonitorItemSN(%d-%d) for MOSN:%d to table %s_%s_%s_%d_Meta.MOControlLineList.MonitorItemSNList (%d):%s",
					 intMonitorItemSN, intMonitorItemSN + 5, intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}

#ifdef ENABLE_SET_ALL_MONITOR_ON
	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET SPCEnable = 1, SPCRule1 = 1",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[MO_InsertMOAcceptCriteriaSNList]Fail to enable all MonitorItem from table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
#endif
	return EXIT_SUCCESS;
}

int MO_InsertMOAcceptCriteriaSNList(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intAcceptCriteriaSN, unsigned int intAcceptCriteriaClass, const char *charAcceptCriteriaUnit, stMOAcceptCriteriaSN varAcceptCriteriaSN)
//[MO]Insert An Existing Accept Criteria to An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	char *charMOAcceptCriteriaSN;
	int intMOAcceptCriteriaSN;
	int intLength;
	unsigned int intLogSN;

	// Get Next MOAcceptCriteriaSN
	snprintf(charStatement, MAX_STRING_SIZE, "%s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "MOAcceptCriteriaSN", &charMOAcceptCriteriaSN);
	if (intRetval == EXIT_FAILURE)
		return EXIT_FAILURE;
	intMOAcceptCriteriaSN = atoi(charMOAcceptCriteriaSN) + 1;

	if ((intLength = strlen(varAcceptCriteriaSN.charAcceptCriteriaMeta)) != 0)
	{
		strcpy(varAcceptCriteriaSN.charAcceptCriteriaMeta + 1, varAcceptCriteriaSN.charAcceptCriteriaMeta);
		varAcceptCriteriaSN.charAcceptCriteriaMeta[0] = '"';
		varAcceptCriteriaSN.charAcceptCriteriaMeta[intLength + 1] = '"';
		varAcceptCriteriaSN.charAcceptCriteriaMeta[intLength + 2] = '\0';
	}
	else
		strcpy(varAcceptCriteriaSN.charAcceptCriteriaMeta, "NULL");

	if ((intLength = strlen(varAcceptCriteriaSN.charAcceptCriteriaMinTH)) != 0)
	{
		strcpy(varAcceptCriteriaSN.charAcceptCriteriaMinTH + 1, varAcceptCriteriaSN.charAcceptCriteriaMinTH);
		varAcceptCriteriaSN.charAcceptCriteriaMinTH[0] = '"';
		varAcceptCriteriaSN.charAcceptCriteriaMinTH[intLength + 1] = '"';
		varAcceptCriteriaSN.charAcceptCriteriaMinTH[intLength + 2] = '\0';
	}
	else
		strcpy(varAcceptCriteriaSN.charAcceptCriteriaMinTH, "NULL");

	if ((intLength = strlen(varAcceptCriteriaSN.charAcceptCriteriaMaxTH)) != 0)
	{
		strcpy(varAcceptCriteriaSN.charAcceptCriteriaMaxTH + 1, varAcceptCriteriaSN.charAcceptCriteriaMaxTH);
		varAcceptCriteriaSN.charAcceptCriteriaMaxTH[0] = '"';
		varAcceptCriteriaSN.charAcceptCriteriaMaxTH[intLength + 1] = '"';
		varAcceptCriteriaSN.charAcceptCriteriaMaxTH[intLength + 2] = '\0';
	}
	else
		strcpy(varAcceptCriteriaSN.charAcceptCriteriaMaxTH, "NULL");

	// Insert MOAcceptCriteriaSN into Table INJPRO_Data_MO_[MOSN]_Info_Meta.MOAcceptCriteriaSNList
	snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList "
											 "(MOAcceptCriteriaSN,AcceptCriteriaSN,MOAcceptCriteriaMeta,MOAcceptCriteriaClass,MOAcceptCriteriaUnit,MOAcceptCriteriaMinTH,MOAcceptCriteriaMaxTH) VALUE "
											 "(%d,%d,%s,%d,'%s',%s,%s)",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 intMOAcceptCriteriaSN, intAcceptCriteriaSN, varAcceptCriteriaSN.charAcceptCriteriaMeta, intAcceptCriteriaClass,
			 charAcceptCriteriaUnit, varAcceptCriteriaSN.charAcceptCriteriaMinTH, varAcceptCriteriaSN.charAcceptCriteriaMaxTH);

	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_InsertMOAcceptCriteriaSNList]Fail to insert MOAcceptCriteriaSN=%d into table %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList (%d):%s",
				 intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Create Table INJPRO_Data_MO_[MOSN]_RawData_AcceptCriteria.[MOAcceptCriteriaSN]
	snprintf(charStatement, MAX_STRING_SIZE, "CREATE TABLE IF NOT EXISTS %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d ("
											 "ShotSN	BIGINT UNSIGNED NOT NULL,"
											 "ActualBool	INT UNSIGNED DEFAULT NULL,"
											 "PredictBool	INT UNSIGNED DEFAULT NULL,"
											 "ActualValue 	DOUBLE DEFAULT NULL,"
											 "PredictValue	DOUBLE DEFAULT NULL,"
											 "PRIMARY KEY (ShotSN),"
											 "CONSTRAINT %d_AcceptCriteria_%d_ShotSN FOREIGN KEY (ShotSN) REFERENCES %s_%s_%s_%d_RawData.ShotSNList(ShotSN) ON UPDATE CASCADE)"
											 "ENGINE=InnoDB",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN,
			 intMOSN, intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_InsertMOAcceptCriteriaSNList]Fail to create table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int MO_StartMOonIMM(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intIMMSN)
//[MO]Start MO on A Specified IMM
{
	char charStatement[MAX_STRING_SIZE];
	char charTableName[MEDIUM_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intOriginalIMMSN;
	unsigned int intMOStatus;
	unsigned int intReferenceMOSN;
	unsigned int intMoldSN, intExistingMoldSN;
	unsigned int intProdSN, intExistingProdSN;
	unsigned int intMaterialSN, intExistingMaterialSN;
	unsigned int intOPCUAVersionSN, intOriginalOPCUAVersionSN, intExistingOPCUAVersionSN;
	unsigned int intExistingShotSN, intExistingMOSN;
	unsigned int intShotSN;
	unsigned int intExpectedProdVolume, intAcceptProdShot, intRejectProdShot;
	char *charMOSNCustomSensorCount;
	char *charExistingMOSNCustomSensorCount;
	unsigned int intMOSNCustomSensorCount, intExistingMOSNCustomSensorCount;
	unsigned int intModelSN, intExistingModelSN;
	double doubleYieldRate, doubleMOProgress;
	unsigned int intLogSN;

	// Check MOStatus for MOSN
	intRetval = DB_SelectMOStatusbyMOSN(mysqlCon, intMOSN, &intMOStatus);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select MOStatus for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	if (intMOStatus == MO_STATUS_START)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to start the MOSN:%d twice", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}
	else if (intMOStatus == MO_STATUS_FINISHED)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to start the MOSN:%d due to the MOSN is finished", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Check if Original IMMSN is equal Target IMMSN
	intRetval = DB_SelectIMMSNbyMOSN(mysqlCon, intMOSN, &intOriginalIMMSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select original IMMSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}
	if (intOriginalIMMSN != intIMMSN)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[MO_StartMOonIMM]Fail to start the MOSN:%d due to the original IMMSN:%d is not the same as assigned IMMSN:%d", intMOSN, intOriginalIMMSN, intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Select MoldSN of This MO
	intRetval = DB_SelectMoldSNbyMOSN(mysqlCon, intMOSN, &intMoldSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select MoldSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Select OPCUAVersionSN of This MO
	intRetval = DB_SelectOPCUAVersionSNbyIMMSN(mysqlCon, intIMMSN, &intOPCUAVersionSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select OPCUAVersionSN for IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// If The MOSN in not New (i.e. Login Before)
	if (intMOStatus == MO_STATUS_STOP)
	{
		intRetval = DB_SelectOPCUAVersionSNbyMOSN(mysqlCon, intMOSN, &intOriginalOPCUAVersionSN);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select OPCUAVersionSN for MOSN:%d", intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, 0, charErrMsg);
			return intLogSN;
		}
		if (intOriginalOPCUAVersionSN != intOPCUAVersionSN)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to start MOSN:%d on IMMSN:%d due to OPCUAVersionSN change from %d to %d",
					 intMOSN, intIMMSN, intOriginalOPCUAVersionSN, intOPCUAVersionSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
	}

	intRetval = DB_SelectShotSNbyMOSN(mysqlCon, intMOSN, &intShotSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select ShotSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Check There Is No MOSN on IMMSN
	intRetval = DB_SelectMOSNbyIMMSN(mysqlCon, intIMMSN, &intExistingMOSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select existing MOSN for IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// If There Is A Existing MOSN on IMMSN, Then Check The Availability of CO-MOSN
	if (intExistingMOSN != 0)
	{
		// If The Existing MOSN And The Target MOSN Are The Same, Then Fail To Start The Target MOSN
		if (intExistingMOSN == intMOSN)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to start the same MOSN:%d twice on IMMSN:%d", intMOSN, intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}

		// Check If the OPCUAVersionSN is the Same
		intRetval = DB_SelectOPCUAVersionSNbyMOSN(mysqlCon, intExistingMOSN, &intExistingOPCUAVersionSN);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select MoldSN for IMMSN:%d", intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		if (intExistingOPCUAVersionSN != intOPCUAVersionSN)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to start CO-MOSN:%d (intOPCUAVersionSN:%d) on IMMSN:%d due to MOSN:%d (intOPCUAVersionSN:%d)",
					 intMOSN, intOPCUAVersionSN, intIMMSN, intExistingMOSN, intExistingOPCUAVersionSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}

		// Check if the  MoldSN is the Same
		intRetval = DB_SelectMoldSNbyMOSN(mysqlCon, intExistingMOSN, &intExistingMoldSN);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select MoldSN for MOSN:%d", intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		if (intExistingMoldSN != intMoldSN)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to start CO-MOSN:%d (MoldSN:%d) on IMMSN:%d due to MOSN:%d (MoldSN:%d)",
					 intMOSN, intMoldSN, intIMMSN, intExistingMOSN, intExistingMoldSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}

		// Check if the ShotSN is the Same
		intRetval = DB_SelectShotSNbyMOSN(mysqlCon, intExistingMOSN, &intExistingShotSN);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select ShotSN for existing MOSN:%d", intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		// fprintf(stderr, "ExistingMOSN:%d ExistingShotSN:%d\n", intExistingMOSN, intExistingShotSN);
		// If ShotSN of CO-MOSN and Existing MOSN Are Not The Same
		if (intExistingShotSN != intShotSN)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to start CO-MOSN:%d (ShotSN:%d) on IMMSN:%d due to MOSN:%d (ShotSN:%d)",
					 intMOSN, intShotSN, intIMMSN, intExistingMOSN, intExistingShotSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}

		// Select The CustomerSensor Count for The MOSN
		snprintf(charStatement, MAX_STRING_SIZE, "%s_%s_%s_%d_Info_Meta.MOCustomSensorSNList",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "MOCustomSensorSN", &charMOSNCustomSensorCount);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to get the count of MOCustomSensorSN from table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		intMOSNCustomSensorCount = atoi(charMOSNCustomSensorCount);

		// fprintf(stderr, "MOSN:%d Sensor Count:%d\n", intMOSN, intMOSNCustomSensorCount);

		// Select The CustomerSensor Count for The ExistingMOSN
		snprintf(charStatement, MAX_STRING_SIZE, "%s_%s_%s_%d_Info_Meta.MOCustomSensorSNList",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intExistingMOSN);
		intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "MOCustomSensorSN", &charExistingMOSNCustomSensorCount);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to get the count of MOCustomSensorSN from table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		intExistingMOSNCustomSensorCount = atoi(charExistingMOSNCustomSensorCount);

		// fprintf(stderr, "ExMOSN:%d Sensor Count:%d\n", intExistingMOSN, intExistingMOSNCustomSensorCount);

		// If The CustomerSensor Count of Both MOSN and ExistingMOSN Are Not The Same
		if (intMOSNCustomSensorCount != intExistingMOSNCustomSensorCount)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to start MOSN:%d on IMMSN:%d due to Sensor Count is not the same", intMOSN, intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		else
		{
			// Check ModelSN of CustomSensor One by One
			for (int i = 1; i <= intExistingMOSNCustomSensorCount; i++)
			{
				intRetval = DB_SelectCustomSensorModelSNbyMOCustomSensorSN(mysqlCon, intMOSN, i, &intModelSN);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, MAX_STRING_SIZE,
							 "[MO_StartMOonIMM]Fail to select the ModelSN of MOSN from table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList",
							 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, 0, charErrMsg);
					return intLogSN;
				}

				intRetval = DB_SelectCustomSensorModelSNbyMOCustomSensorSN(mysqlCon, intExistingMOSN, i, &intExistingModelSN);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, MAX_STRING_SIZE,
							 "[MO_StartMOonIMM]Fail to select the ModelSN of ExistingMOSN from table %s_%s_%s_%d.Info_Meta.MOCustomSensorSNList",
							 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, 0, charErrMsg);
					return intLogSN;
				}

				if (intModelSN != intExistingModelSN)
				{
					snprintf(charErrMsg, MAX_STRING_SIZE,
							 "[MO_StartMOonIMM]Fail to start MOSN:%d due to ModelSN of CustomerSensorSN:%d for MOSN and CO-MOSN are different %d:%d",
							 intMOSN, i, intModelSN, intExistingModelSN);
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, 0, charErrMsg);
					return intLogSN;
				}
			}
		}

		// If This Is A Reference MO then intMOSN=intReferenceMOSN
		intRetval = DB_SelectReferenceMOSNbyMOSN(mysqlCon, intMOSN, &intReferenceMOSN);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select ReferenceMOSN for MOSN:%d", intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		if (intReferenceMOSN != 0)
		{
			intMOSN = intReferenceMOSN;
		}
	}

	// Update ReferenceMOSN When There Is Already A MONS on This IMMSN
	if (intExistingMOSN != 0 && intMOSN < intExistingMOSN)
	{
		// Update INJPRO_Data_MO.MOSNList Set ActualStartTime=NOW() and MOLastUpdateTime=NOW()
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s.MOSNList SET ReferenceMOSN=%d,MOLastUpdateTime=NOW() WHERE MOSN=%d OR ReferenceMOSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intExistingMOSN, intExistingMOSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to update %s_%s_%s.MOSNList set ActualStartTime=NOW() where IMMSN:%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intIMMSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	else if (intExistingMOSN != 0)
	{
		// Update INJPRO_Data_MO.MOSNList Set ActualStartTime=NOW() and MOLastUpdateTime=NOW()
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s.MOSNList SET ReferenceMOSN=%d,MOLastUpdateTime=NOW() WHERE MOSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intExistingMOSN, intMOSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to update %s_%s_%s.MOSNList set ActualStartTime=NOW() where IMMSN:%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intIMMSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	// Note That RoundSN in ShotSNList Could Appear More Than One Time. For Each Time Login MO, The RoundSN Will be Reset As 1.

	// If this MO has been started
	if (intShotSN != 1)
	{
#ifdef DEBUG_MODE
		fprintf(stderr, "IMMSN:%d resumes the MOSN:%d from ShotSN:%d\n", intIMMSN, intMOSN, intShotSN);
		// Update INJPRO_Data_MO.MOSNList Set MOLastUpdateTime=NOW()
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s.MOSNList SET ProdShot=%d,MOStatus=%d,MOLastUpdateTime=NOW() WHERE MOSN=%d OR ReferenceMOSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intShotSN - 1, MO_STATUS_START, intMOSN, intMOSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to update %s_%s_%s.MOSNList set ActualStartTime=NOW() where IMMSN:%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intIMMSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

/*
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s.IMMSNList SET MOSN=%d, RoundSN=1, ShotSN=%d, IMMLastUpdateTime=NOW() WHERE IMMSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, (intExistingMOSN == 0 || intMOSN < intExistingMOSN) ? intMOSN : intExistingMOSN, intShotSN, intIMMSN);
		//fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to update MOSN:%d ShotSN:%d to %s_%s.IMMSNList where IMMSN:%d (%d):%s",
					 intMOSN, intShotSN, SYS_NAME, DATA_DATABASE_NAME, intIMMSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		*/
#endif
	}
	else // This MO Is Brand New
	{
		intRetval = MO_AutoCopyAllControlLine(mysqlCon, intMOSN);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to automatically copy contrl line for MOSN:%d\n", intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		}

		fprintf(stderr, "IMMSN:%d starts the MOSN:%d from ShotSN:%d\n", intIMMSN, intMOSN, intShotSN);

		// Update INJPRO_Data_MO.MOSNList Set ActualStartTime=NOW() and MOLastUpdateTime=NOW()
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s.MOSNList SET "
				 "OPCUAVersionSN= (SELECT OPCUAVersionSN FROM %s_%s.IMMSNList WHERE IMMSN = %d) , "
				 "ProdShot=0, MOStatus=%d, ActualStartTime=NOW(), MOLastUpdateTime=NOW() WHERE MOSN=%d OR ReferenceMOSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME,
				 SYS_NAME, DATA_DATABASE_NAME, intIMMSN,
				 MO_STATUS_START, intMOSN, intMOSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_StartMOonIMM]Fail to update %s_%s_%s.MOSNList set OPCUAVersionSN, ProdShot=0, MOStatus, ActualStartTime=NOW() where IMMSN:%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intIMMSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}

	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s.IMMSNList SET MOSN=%d, RoundSN=1, ShotSN=%d, IMMLastUpdateTime=NOW() WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, (intExistingMOSN == 0 || intMOSN < intExistingMOSN) ? intMOSN : intExistingMOSN, intShotSN, intIMMSN);
	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[MO_StartMOonIMM]Fail to update MOSN:%d ShotSN:%d to %s_%s.IMMSNList where IMMSN:%d (%d):%s",
				 intMOSN, intShotSN, SYS_NAME, DATA_DATABASE_NAME, intIMMSN,
				 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	else
	{
		// Update VIRTUAL OPCUA Server
		intRetval = MO_UpdateVirtualOPCUAServer(mysqlCon, intMOSN, intShotSN, -1);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to update info to virtual OPCUA Server(MO_StartMOonIMM).\n");
			intLogSN=SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}

	// fprintf(stderr,"MOSN:%d Existing MOSN:%d\n",intMOSN,intExistingMOSN);

	/*
	snprintf(charStatement,MAX_STRING_SIZE,"SELECT ExpectedProdVolume, AcceptProdShot, RejectProdShot, YieldRate FROM %s_%s_%s.MOSNList WHERE MOSN=%d",
	 SYS_NAME,DATA_DATABASE_NAME,MO_DATABASE_NAME,intMOSN);
	intRetval=mysql_query(&mysqlCon,charStatement);
	if(intRetval!=EXIT_SUCCESS){
		snprintf(charErrMsg,LONG_STRING_SIZE,
		 "[MO_StartMOonIMM]Fail to select ProdShot, AcceptProdShot, Rejectpart,Yieldrate from %s_%s_%s.MOSNList while starting MOSN:%d (%d):%s",
		 SYS_NAME,DATA_DATABASE_NAME,MO_DATABASE_NAME,intMOSN,mysql_errno(&mysqlCon),mysql_error(&mysqlCon));
		intLogSN=SYS_InsertSysErrMsg(mysqlCon,ERRCLASS_MYSQL,intMOSN,intIMMSN,mysql_errno(&mysqlCon),charErrMsg);
		return intLogSN;
	}
	MYSQL_RES *mysqlResult=mysql_store_result(&mysqlCon);
	MYSQL_ROW mysqlRow=mysql_fetch_row(mysqlResult);
	intExpectedProdVolume=mysqlRow[0]==NULL?0:atoi(mysqlRow[0]);
	intAcceptProdShot=mysqlRow[1]==NULL?0:atoi(mysqlRow[1]);
	intRejectProdShot=mysqlRow[2]==NULL?0:atoi(mysqlRow[2]);
	doubleYieldRate=mysqlRow[3]==NULL?0:atof(mysqlRow[3]);
	mysql_free_result(mysqlResult);

	doubleMOProgress=intAcceptProdShot>intExpectedProdVolume?100:(double)intAcceptProdShot/(double)intExpectedProdVolume*100.0;
	snprintf(charStatement,MAX_STRING_SIZE,
	"UPDATE %s_%s.IMMSNList SET MOSN=%d, ShotSN=%d, MOProgress=%lf, AcceptProdShot=%d, RejectProdShot=%d, YieldRate=%lf, IMMLastUpdateTime=NOW() WHERE IMMSN=%d",
	SYS_NAME,DATA_DATABASE_NAME,intMOSN,intShotSN,doubleMOProgress,intAcceptProdShot,intRejectProdShot,doubleYieldRate,intIMMSN);
	intRetval=mysql_query(&mysqlCon,charStatement);
	if(intRetval!=EXIT_SUCCESS){
		snprintf(charErrMsg,LONG_STRING_SIZE,
		 "[MO_StartMOonIMM]Fail to update MOSN:%d ShotSN:%d to %s_%s.IMMSNList where IMMSN:%d (%d):%s",
		 intMOSN,intShotSN,SYS_NAME,DATA_DATABASE_NAME,intIMMSN,
		 mysql_errno(&mysqlCon),mysql_error(&mysqlCon));
		intLogSN=SYS_InsertSysErrMsg(mysqlCon,ERRCLASS_MYSQL,intMOSN,intIMMSN,mysql_errno(&mysqlCon),charErrMsg);
		return intLogSN;
	}
	*/
	return EXIT_SUCCESS;
}

int MO_StopMOonIMM(MYSQL mysqlCon, unsigned int intIMMSN, bool boolMOFinished)
//[MO]Stop A MO by the Specified IMM
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intMOSN;
	unsigned int intShotSN;
	unsigned int intAcceptProdShot;
	unsigned int intRejectProdShot;
	double doubleYieldRate;
	unsigned int intLogSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Check There Is No MOSN on IMMSN
	intRetval = DB_SelectMOSNbyIMMSN(mysqlCon, intIMMSN, &intMOSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to select existing MOSN for IMMSN:%d", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// If there is no MONS on The Given IMMSN
	if (intMOSN == 0)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StartMOonIMM]Fail to Stop MOSN on IMMSN:%d due to there is no MOSN", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, 0, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Select OPCUAClientPID From INJPRO_DaTa.IMMSNList Where MOSN and IMMSN Are Given
	snprintf(charStatement, MAX_STRING_SIZE, "SELECT ModbusClientPID, OPCUAClientPID FROM %s_%s.IMMSNList WHERE IMMSN=%d LIMIT 1",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);

	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StopMOonIMM]Fail to select OPCUAClientPID for MOSN:%d on IMMSN:%d from %s_%s.IMMSNList(%d):%s",
				 intMOSN, intIMMSN, SYS_NAME, DATA_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StopMOonIMM]Fail to stop MOSN due to MOSN:%d and IMMSN:%d from %s_%s.IMMSNList does not exist",
				 intMOSN, intIMMSN, SYS_NAME, DATA_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intMOSN, 0, charErrMsg);
		return intLogSN;
	}

	if (mysqlRow[0] != NULL || mysqlRow[1] != NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StopMOonIMM]Fail to stop MOSN due to MOSN:%d on IMMSN:%d is still producing (OPCUA or Modbus is RUNNING)",
				 intMOSN, intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, 0, charErrMsg);

		return intLogSN;
	}
	mysql_free_result(mysqlResult);

	// Update INJPRO_Data_MO.MOSNList Set ProdShot, ActualEndTime, AcceptProdShot, RejectProdShot, YieldRate
	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s.MOSNList SET MOStatus=%d, ActualEndTime=NOW() WHERE MOSN=%d OR ReferenceMOSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, boolMOFinished == true ? MO_STATUS_FINISHED : MO_STATUS_STOP, intMOSN, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_StopMOonIMM]Fail to update %s_%s.MOSNList set ActualEndTime=NOW() where IMMSN:%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, intIMMSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Update INJPRO_Data.IMMSNList Set MOSN=NULL Where IMMSN Is Given
	snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s.IMMSNList SET "
											 "AutoOPCUAControl=NULL, MOSN=NULL, RoundSN=NULL, MoldStatus=NULL, ShotSN=NULL, "
											 "IMMLastUpdateTime=NOW() WHERE IMMSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, intIMMSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, MAX_STRING_SIZE,
				 "[MO_StopMOonIMM]Fail to update %s_%s.IMMSNList set all columns as NULL where IMMSN:%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, intIMMSN,
				 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	else
	{
		// Update VIRTUAL OPCUA Server
		intRetval = MO_UpdateVirtualOPCUAServer(mysqlCon, 0, -1, -1);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StopMOonIMM]Fail to update info to virtual OPCUA Server(MO_StopMOonIMM).\n");
			intLogSN=SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		/*
		char charOPCUAIP[16];
		unsigned int intOPCUAPort;
		char charEndPointURL[MEDIUM_STRING_SIZE];
		int *nodeValue = malloc(sizeof(int));
		UA_String argString;

		strcpy(charOPCUAIP, VIRTUAL_OPCUA_SERVER_IP);
		intOPCUAPort = VIRTUAL_OPCUA_SERVER_PORT;
		UA_Client *client = UA_Client_new(UA_ClientConfig_default);
		snprintf(charEndPointURL, MEDIUM_STRING_SIZE, "opc.tcp://%s:%d", charOPCUAIP, intOPCUAPort);
		intRetval = UA_Client_connect(client, charEndPointURL);
		if (intRetval != UA_STATUSCODE_GOOD)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StopMOonIMM]Fail to connect OPCUA Server of IMMSN:%d ", intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		UA_Variant *readVariant = UA_Variant_new();
		intRetval = UA_Client_readValueAttribute(client, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.MOID"), readVariant);
		if (intRetval != UA_STATUSCODE_GOOD || !UA_Variant_isScalar(readVariant))
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StopMOonIMM]Fail to read node IMM.MOID on OPCUA Server of IMMSN:%d ", intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		UA_Variant *writeVariant = UA_Variant_new();
		argString = UA_STRING("");
		UA_Variant_setScalarCopy(writeVariant, &argString, readVariant->type);
		UA_Client_writeValueAttribute(client, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.MOID"), writeVariant);

		intRetval = UA_Client_readValueAttribute(client, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.MOSN"), readVariant);
		if (intRetval != UA_STATUSCODE_GOOD || !UA_Variant_isScalar(readVariant))
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_StopMOonIMM]Fail to read node IMM.MOSN on OPCUA Server of IMMSN:%d ", intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		*nodeValue = 0;
		UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
		UA_Client_writeValueAttribute(client, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.MOSN"), writeVariant);
		UA_Client_writeValueAttribute(client, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.MOID"), writeVariant);
		UA_Client_writeValueAttribute(client, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.RealTimeShotSN"), writeVariant);
		UA_Client_writeValueAttribute(client, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.IMMSensorDataReadyShotSN"), writeVariant);
		UA_Variant_delete(writeVariant);
		UA_Variant_delete(readVariant);
		UA_Client_delete(client);
		*/
	}
	return EXIT_SUCCESS;
}

int MO_InsertMOAcceptCriteriaPredictValue(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int intMOAcceptCriteriaSN, char charPredictValue[TINY_STRING_SIZE])
//[MO]Insert Predict Value of A Specified Accept Criteria in An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	unsigned int intIMMSN;
	unsigned int intPiecePerShot;
	unsigned int intMOAcceptCriteriaClass;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	bool boolUseActual;

	intRetval = DB_SelectIMMSNbyMOSN(mysqlCon, intMOSN, &intIMMSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaPredictValue]Fail to select IMMSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}
	if (intIMMSN == 0)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaPredictValue]No IMMSN for MOSN:%d while insert MOAcceptCriteriaSN predict value (not producing?)", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select PiesePerShot from INJPRO_Data_MO.MOSNList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT PiecePerShot FROM %s_%s_%s.MOSNList WHERE MOSN = %d", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaPredictValue]Fail to select PiecePerShot for MOSN:%d from %s_%s_%s.MOSNList (%d):%s",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow[0] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaPredictValue]No PiecePerShot for MOSN:%d from %s_%s_%s.MOSNList",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	intPiecePerShot = atoi(mysqlRow[0]);
	mysql_free_result(mysqlResult);

	// Select MAX AcceptCriteriaSN from INJPRO_Data_MO_[MOSN]_Info_Meta.MOAcceptCriteriaSNList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MOAcceptCriteriaClass FROM %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList WHERE MOAcceptCriteriaSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaPredictValue]Fail to select MOAcceptCriteriaClass from %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	// Select AcceptCriteriaSN
	if (mysqlRow[0] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaPredictValue]No MOAcceptCriteriaClass for MOAcceptCriteriaSN=%d from %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList",
				 intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	intMOAcceptCriteriaClass = atoi(mysqlRow[0]);
	mysql_free_result(mysqlResult);

	if (intMOAcceptCriteriaClass == ACCEPTCRITERIA_CATEGORY_BOOLEAN && intMOAcceptCriteriaSN == 1)
	{
		if (strcmp(charPredictValue, "1") != 0 && strcmp(charPredictValue, "0") != 0 && strcmp(charPredictValue, "NULL") != 0)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaPredictValue]The predict value should be 0 or 1 since boolean type is set for MOAcceptCriteriaSN=%d", intMOAcceptCriteriaSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		snprintf(charStatement, MAX_STRING_SIZE,
				 "INSERT INTO %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d "
				 "(ShotSN,PredictBool,PredictValue) VALUE (%d,%s,%d) ON DUPLICATE KEY UPDATE PredictBool=%s, PredictValue=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, intShotSN, charPredictValue, strcmp(charPredictValue, "0") == 0 ? intPiecePerShot : 0,
				 charPredictValue, strcmp(charPredictValue, "0") == 0 ? intPiecePerShot : 0);

		// fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);

		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaPredictValue]Fail to insert accept criteria predict value of ShotSN:%d MOAcceptCriteriaSN:%d into "
					 "table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
					 intShotSN, intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	else if (intMOAcceptCriteriaClass == ACCEPTCRITERIA_CATEGORY_BOOLEAN)
	{
		if (strcmp(charPredictValue, "1") != 0 && strcmp(charPredictValue, "0") != 0)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaPredictValue]The predict value should be 0 or 1 since boolean type is set for MOAcceptCriteriaSN=%d", intMOAcceptCriteriaSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		snprintf(charStatement, MAX_STRING_SIZE,
				 "INSERT INTO %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d "
				 "(ShotSN,PredictBool) VALUE (%d,%s) ON DUPLICATE KEY UPDATE PredictBool=%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, intShotSN, charPredictValue, charPredictValue);

		// fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);

		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaPredictValue]Fail to insert accept criteria predict value of ShotSN:%d MOAcceptCriteriaSN:%d into "
					 "table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
					 intShotSN, intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	else if (intMOAcceptCriteriaClass == ACCEPTCRITERIA_CATEGORY_VALUE)
	{
		snprintf(charStatement, MAX_STRING_SIZE,
				 "INSERT INTO %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d "
				 "(ShotSN,PredictValue) VALUE (%d,%s) ON DUPLICATE KEY UPDATE PredictValue=%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, intShotSN, charPredictValue, charPredictValue);

		// fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);

		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaPredictValue]Fail to insert accept criteria predict value of ShotSN:%d MOAcceptCriteriaSN:%d into "
					 "table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
					 intShotSN, intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}

	// Update YieldRate, MOPorgress, EstimatedEndTime, AcceptProdShot, RejectProdShot, ProdShot
	if (intMOAcceptCriteriaSN == 1)
	{
		boolUseActual = YIELD_RATE_USE_ACTUAL;
		intRetval = MO_UpdateMOSNListAfterShot(mysqlCon, intMOSN, boolUseActual);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaPredictValue]Fail to update yield, progress, estimated end time ... ,etc for ShotSN:%d MOAcceptCriteriaSN:%d "
					 "into table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
					 intShotSN, intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}

	return EXIT_SUCCESS;
}

int MO_InsertMOAcceptCriteriaActualValue(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int intMOAcceptCriteriaSN, char charActualValue[TINY_STRING_SIZE])
//[MO]Insert Actual Value of A Specified Accept Criteria in An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	unsigned int intIMMSN;
	unsigned int intPiecePerShot;
	unsigned int intMOAcceptCriteriaClass;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	bool boolUseActual;

	intRetval = DB_SelectIMMSNbyMOSN(mysqlCon, intMOSN, &intIMMSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaActualValue]Fail to select IMMSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}
	if (intIMMSN == 0)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaActualValue]No IMMSN for MOSN:%d while insert MOAcceptCriteriaSN actual value (not producing?)", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Select PiesePerShot from INJPRO_Data_MO.MOSNList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT PiecePerShot FROM %s_%s_%s.MOSNList WHERE MOSN = %d", SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaActualValue]Fail to select PiecePerShot for MONS:%d from %s_%s_%s.MOSNList (%d):%s",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow[0] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaActualValue]No PiecePerShot for MOSN:%d from %s_%s_%s.MOSNList",
				 intMOSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	intPiecePerShot = atoi(mysqlRow[0]);
	mysql_free_result(mysqlResult);

	// Select MAX AcceptCriteriaSN from INJPRO_Data_MO_[MOSN]_Info_Meta.MOAcceptCriteriaSNList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MOAcceptCriteriaClass FROM %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList WHERE MOAcceptCriteriaSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaActualValue]Fail to select MOAcceptCriteriaClass from %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);

	// Select AcceptCriteriaSN
	if (mysqlRow[0] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaActualValue]No MOAcceptCriteriaClass for MOAcceptCriteriaSN=%d from %s_%s_%s_%d_Info_Meta.MOAcceptCriteriaSNList",
				 intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	intMOAcceptCriteriaClass = atoi(mysqlRow[0]);
	mysql_free_result(mysqlResult);

	if (intMOAcceptCriteriaClass == ACCEPTCRITERIA_CATEGORY_BOOLEAN && intMOAcceptCriteriaSN == 1)
	{
		if (strcmp(charActualValue, "1") != 0 && strcmp(charActualValue, "0") != 0 && strcmp(charActualValue, "NULL") != 0)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaActualValue]The actual value should be 0 or 1 since boolean type is set for MOAcceptCriteriaSN=%d", intMOAcceptCriteriaSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		snprintf(charStatement, MAX_STRING_SIZE,
				 "INSERT INTO %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d "
				 "(ShotSN,ActualBool,ActualValue) VALUE (%d,%s,%d) ON DUPLICATE KEY UPDATE ActualBool=%s, ActualValue=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, intShotSN, charActualValue, strcmp(charActualValue, "0") == 0 ? intPiecePerShot : 0,
				 charActualValue, strcmp(charActualValue, "0") == 0 ? intPiecePerShot : 0);

		// fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);

		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaActualValue]Fail to insert accept criteria actual value of ShotSN:%d MOAcceptCriteriaSN:%d into "
					 "table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
					 intShotSN, intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	else if (intMOAcceptCriteriaClass == ACCEPTCRITERIA_CATEGORY_BOOLEAN)
	{
		if (strcmp(charActualValue, "1") != 0 && strcmp(charActualValue, "0") != 0)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_InsertMOAcceptCriteriaActualValue]The actual value should be 0 or 1 since boolean type is set for MOAcceptCriteriaSN=%d", intMOAcceptCriteriaSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		snprintf(charStatement, MAX_STRING_SIZE,
				 "INSERT INTO %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d "
				 "(ShotSN,ActualBool) VALUE (%d,%s) ON DUPLICATE KEY UPDATE ActualBool=%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, intShotSN, charActualValue, charActualValue);

		// fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);

		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaActualValue]Fail to insert accept criteria actual value of ShotSN:%d MOAcceptCriteriaSN:%d into "
					 "table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
					 intShotSN, intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	else if (intMOAcceptCriteriaClass == ACCEPTCRITERIA_CATEGORY_VALUE)
	{
		snprintf(charStatement, MAX_STRING_SIZE,
				 "INSERT INTO %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d "
				 "(ShotSN,ActualValue) VALUE (%d,%s) ON DUPLICATE KEY UPDATE ActualValue=%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, intShotSN, charActualValue, charActualValue);

		// fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);

		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaActualValue]Fail to insert accept criteria actual value of ShotSN:%d MOAcceptCriteriaSN:%d into "
					 "table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
					 intShotSN, intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}

	// Update YieldRate, MOPorgress, EstimatedEndTime, AcceptProdShot, RejectProdShot, ProdShot
	if (intMOAcceptCriteriaSN == 1)
	{
		boolUseActual = YIELD_RATE_USE_ACTUAL;
		intRetval = MO_UpdateMOSNListAfterShot(mysqlCon, intMOSN, boolUseActual);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[MO_InsertMOAcceptCriteriaActualValue]Fail to update yield, progress, estimated end time ... ,etc for ShotSN:%d MOAcceptCriteriaSN:%d "
					 "into table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
					 intShotSN, intMOAcceptCriteriaSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOAcceptCriteriaSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}

	return EXIT_SUCCESS;
}

int MO_UpdateMOSNListAfterShot(MYSQL mysqlCon, unsigned int intMOSN, bool boolUseActual)
//[MO]Update All Information after Completing A New Shot
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intAcceptProdShot;
	unsigned int intRejectProdShot;
	unsigned int intProdShot;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s_%s.MOSNList SET "
			 "OPPeriod = ("
			 "      SELECT SUM(RoundPeriod) "
			 "      FROM ("
			 "              SELECT "
			 "                      RoundSN, TIMESTAMPDIFF(MICROSECOND, MIN(MoldClampingTime), MAX(MoldReleasedTime)) / 1000000 AS RoundPeriod "
			 "              FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList "
			 "              GROUP BY RoundSN "
			 "      ) AS PeriodList "
			 "      WHERE RoundSN MOD 2 = 0"
			 "),"
			 "StartNonOPEmptyShot = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.RoundSN = 1 AND ShotSNList.EmptyShot = 1),"
			 "StartNonOPProdShot  = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.RoundSN = 1 AND ShotSNList.EmptyShot = 0),"
			 "OPEmptyShot = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.RoundSN MOD 2 = 0 AND ShotSNList.EmptyShot = 1),"
			 "OPProdShot  = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.RoundSN MOD 2 = 0 AND ShotSNList.EmptyShot = 0),"
			 "NonOPEmptyShot = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.RoundSN <> 1 AND ShotSNList.RoundSN MOD 2 = 1 AND ShotSNList.EmptyShot = 1),"
			 "NonOPProdShot  = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.RoundSN <> 1 AND ShotSNList.RoundSN MOD 2 = 1 AND ShotSNList.EmptyShot = 0),"
			 "CompletedShot = StartNonOPEmptyShot + StartNonOPProdShot + OPEmptyShot + OPProdShot + NonOPEmptyShot + NonOPProdShot,"
			 "MOLastUpdateTime = NOW()"
			 "WHERE MOSN = %d OR ReferenceMOSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME,		  // Update Table Path
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, // OPPeriod
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, // StartNonOPEmptyShot
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, // StartNonOPProdShot
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, // OPEmptyShot
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, // OPProdShot
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, // NonOPEmptyShot
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, // NonOPProdShot
			 intMOSN, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateMOSNListAfterShot]Fail to update empty shot information in table %s_%s_%s.MOSNList where MOSN=%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return EXIT_FAILURE;
	}

	// Use PredictValue for Yield Rate Caculation
	if (boolUseActual == false)
	{
		// Select Amount of Reject Part From INJPRO_Data_MO_[MOSN]_RawData.ShotSNList and INJPRO_Data_MO_[MOSN]_RawData_AcceptCriteria.MOAcceptCriteriaSN1
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT SUM(PredictBool) FROM "
				 "%s_%s_%s_%d_RawData.ShotSNList AS ShotSNList, "
				 "%s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN1 AS MOAcceptCriteriaSN1 "
				 "WHERE "
				 "ShotSNList.ShotSN = MOAcceptCriteriaSN1.ShotSN AND "
				 "ShotSNList.RoundSN MOD 2 = 0",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);

		// fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateMOSNListAfterShot]Fail to select Acceptpart from "
												   "%s_%s_%s_%d_RawData.ShotSNList and %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN1 where MOSN=%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return EXIT_FAILURE;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow[0] == NULL)
		{
			// No Shot Has Been Done
			fprintf(stderr, "[MO_UpdateMOSNListAfterShot]No shot has been done(the sum of PredictValue where RoundSN == even is zero)!\n");
			return EXIT_SUCCESS;
		}
		else
			intRejectProdShot = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
	}
	else if (boolUseActual == true)
	{
		// Select Amount of Accept Part From INJPRO_Data_MO_[MOSN]_RawData.ShotSNList and INJPRO_Data_MO_[MOSN]_RawData_AcceptCriteria.MOAcceptCriteriaSN1
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT SUM(ActualBool) FROM "
				 "%s_%s_%s_%d_RawData.ShotSNList AS ShotSNList, "
				 "%s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN1 AS MOAcceptCriteriaSN1 "
				 "WHERE "
				 "ShotSNList.ShotSN = MOAcceptCriteriaSN1.ShotSN AND "
				 "ShotSNList.RoundSN MOD 2 = 0 AND ShotSNList.ErrorShot = 0",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);

		// fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateMOSNListAfterShot]Fail to select Acceptpart from "
												   "%s_%s_%s_%d_RawData.ShotSNList and %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN1 where MOSN=%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return EXIT_FAILURE;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow[0] == NULL)
		{
			// No Shot Has Been Done
			fprintf(stderr, "[MO_UpdateMOSNListAfterShot]No shot has been done(the sum of ActualValue where RoundSN == even is zero)!\n");
			return EXIT_SUCCESS;
		}
		else
			intRejectProdShot = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
	}

	// Select the Amount of Shot From INJPRO_Data_MO_[MOSN]_RawData.ShotSNList and INJPRO_Data_MO_[MOSN]_RawData_AcceptCriteria.MOAcceptCriteriaSN1
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT COUNT(*) FROM "
			 "%s_%s_%s_%d_RawData.ShotSNList AS ShotSNList, "
			 "%s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN1 AS MOAcceptCriteriaSN1 "
			 "WHERE "
			 "ShotSNList.ShotSN = MOAcceptCriteriaSN1.ShotSN AND "
			 "ShotSNList.RoundSN MOD 2 = 0 AND ShotSNList.ErrorShot = 0",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);

	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateMOSNListAfterShot]Fail to select ProdShot from "
											   "%s_%s_%s_%d_RawData.ShotSNList and %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN1  where MOSN=%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMOSN,
				 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return EXIT_FAILURE;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow[0] == NULL)
	{
		// No Shot Has Been Done
		return EXIT_SUCCESS;
	}
	else
		intProdShot = atoi(mysqlRow[0]);
	mysql_free_result(mysqlResult);

	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s_%s.MOSNList SET "
			 "ProdShot = %d, "
			 "ProdVolume = %d * PiecePerShot, "
			 //"ProdVolume = OPProdShot * PiecePerShot, "
			 "AcceptProdShot = ( %d - %d ), "
			 "RejectProdShot = %d, "
			 "YieldRate = IF(ProdShot = 0 , 0, ROUND( AcceptProdShot / ProdShot * 100.0, 2)), "
			 //"MOProgress = ROUND( %d *  PiecePerShot / ExpectedProdVolume * 100.0, 2), "
			 "MOProgress = ROUND( ProdVolume / ExpectedProdVolume * 100.0, 2), "
			 "OPPeriod = ("
			 "	SELECT SUM(RoundPeriod) "
			 "	FROM ("
			 "		SELECT "
			 "			RoundSN, TIMESTAMPDIFF(MICROSECOND, MIN(MoldClampingTime), MAX(MoldReleasedTime)) / 1000000 AS RoundPeriod "
			 "		FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList "
			 "		GROUP BY RoundSN "
			 "	) AS PeriodList "
			 "	WHERE RoundSN MOD 2 = 0"
			 "),"
			 "EstimatedEndTime = IF(MOProgress >= 100 OR %d = 0 OR ExpectedProdVolume <= %d, NOW() ,DATE_ADD(NOW(), INTERVAL ((ExpectedProdVolume - %d) * OPPeriod / %d) SECOND_MICROSECOND)),"
			 "StartNonOPEmptyShot = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.ErrorShot = 0 AND ShotSNList.RoundSN = 1 AND ShotSNList.EmptyShot = 1),"
			 "StartNonOPProdShot  = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.ErrorShot = 0 AND ShotSNList.RoundSN = 1 AND (ShotSNList.EmptyShot = 0 OR ShotSNList.EmptyShot IS NULL)) ,"
			 "OPEmptyShot = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.ErrorShot = 0 AND ShotSNList.RoundSN MOD 2 = 0 AND ShotSNList.EmptyShot = 1),"
			 "OPProdShot  = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.ErrorShot = 0 AND ShotSNList.RoundSN MOD 2 = 0 AND (ShotSNList.EmptyShot = 0 OR ShotSNList.EmptyShot IS NULL)),"
			 "NonOPEmptyShot = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.ErrorShot = 0 AND ShotSNList.RoundSN <> 1 AND ShotSNList.RoundSN MOD 2 = 1 AND ShotSNList.EmptyShot = 1),"
			 "NonOPProdShot  = (SELECT COUNT(ShotSN) FROM %s_%s_%s_%d_RawData.ShotSNList AS ShotSNList WHERE ShotSNList.ErrorShot = 0 AND ShotSNList.RoundSN <> 1 AND ShotSNList.RoundSN MOD 2 = 1 AND (ShotSNList.EmptyShot = 0 OR ShotSNList.EmptyShot IS NULL)),"
			 "MOLastUpdateTime = NOW()"
			 "WHERE MOSN = %d OR ReferenceMOSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, // Update Table Path
			 intProdShot,									 // ProdShot
			 intProdShot,									 // ProdVolume = ProdShot * PiecePerShot
			 intProdShot, intRejectProdShot,				 // AcceptProdShot
			 intRejectProdShot,								 // RejectProdShot = ProdShot * PiecePerShot - AcceptProdShot = ProdVolume - RejectProdShot
			 // intAcceptProdShot, intProdShot,				 //YieldRate = AccpetPart / ProdVolume
			 // intProdShot,											  //MOProgress = ProdShot / ExpectedProdVolume
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,					 // OPPeriod
			 intAcceptProdShot, intAcceptProdShot, intAcceptProdShot, intAcceptProdShot, // EstimatedEndTime
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,					 // StartNonOPEmptyShot
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,					 // StartNonOPProdShot
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,					 // OPEmptyShot
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,					 // OPProdShot
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,					 // NonOPEmptyShot
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,					 // NonOPProdShot
			 intMOSN, intMOSN);
	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateMOSNListAfterShot]Fail to update accept/reject part, yield rate, time in table %s_%s_%s.MOSNList where MOSN=%d (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return EXIT_FAILURE;
	}
#ifdef DEBUG_MODE
	fprintf(stderr, "[MO_UpdateMOSNListAfterShot]Successfully update shot information for MOSN:%d with ProdShot:%d\n", intMOSN, intProdShot);
#endif

	return EXIT_SUCCESS;
}

int MO_UpdateVirtualOPCUAServer(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intRealTimeShotSN, unsigned int intIMMSensorDataReadyShotSN)
{

	int intIMMSN;
	char charMOID[MEDIUM_STRING_SIZE];
	char charOPCUAIP[16];
	unsigned int intOPCUAPort;
	char charEndPointURL[MEDIUM_STRING_SIZE];
	UA_Variant *uaReadVariant;
	UA_Variant *uaWriteVariant;
	UA_UInt64 intOPCUANodeValue;
	UA_Client *uaClient;
	UA_String uastrMOID;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;

	// If MOSN == 0 then Reset to Default
	if (intMOSN != 0)
	{
		// Select MOID
		intRetval = DB_SelectMOIDbyMOSN(mysqlCon, intMOSN, charMOID);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateVirtualOPCUAServer]Fail to select MOID for MOSN:%d", intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}

		// Select IMMSN
		intRetval = DB_SelectIMMSNbyMOSN(mysqlCon, intMOSN, &intIMMSN);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateVirtualOPCUAServer]Fail to select IMMSN for MOSN:%d", intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
	}
	else
	{
		charMOID[0] = '\0';
		intRealTimeShotSN = 0;
		intIMMSensorDataReadyShotSN = 0;
	}

	// Set Virtual OPCUA Server IP and Port
	strcpy(charOPCUAIP, VIRTUAL_OPCUA_SERVER_IP);
	//strcpy(charOPCUAIP, "192.168.30.26");
	intOPCUAPort = VIRTUAL_OPCUA_SERVER_PORT;

	// Connect to Virtual OPCUA Server
	uaClient = UA_Client_new(UA_ClientConfig_default);
	snprintf(charEndPointURL, MEDIUM_STRING_SIZE, "opc.tcp://%s:%d", charOPCUAIP, intOPCUAPort);
	intRetval = UA_Client_connect(uaClient, charEndPointURL);
	if (intRetval != UA_STATUSCODE_GOOD)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateVirtualOPCUAServer]Fail to connect OPCUA Server of MOSN:%d ", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	//[MOSN-Read]Read IMM.MOSN Node for Scalar Copy
	uaReadVariant = UA_Variant_new();
	intRetval = UA_Client_readValueAttribute(uaClient, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.MOSN"), uaReadVariant);
	if (intRetval != UA_STATUSCODE_GOOD || !UA_Variant_isScalar(uaReadVariant))
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateVirtualOPCUAServer]Fail to read node IMM.MOSN on OPCUA Server of IMMSN:%d ", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	//[MOSN-Write]Write IMM.MOSN by intMOSN
	uaWriteVariant = UA_Variant_new();
	intOPCUANodeValue = intMOSN;
	 //fprintf(stderr,"Write MOSN %d to OPCUA Server\n",intMOSN);
	UA_Variant_setScalarCopy(uaWriteVariant, &intOPCUANodeValue, uaReadVariant->type);
	UA_Client_writeValueAttribute(uaClient, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.MOSN"), uaWriteVariant);

	//[MOSN]Delete Variant
	UA_Variant_delete(uaReadVariant);
	UA_Variant_delete(uaWriteVariant);

	//[MOID-Read]Read IMM.MOID Node for Scalar Copy
	uaReadVariant = UA_Variant_new();
	intRetval = UA_Client_readValueAttribute(uaClient, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.MOID"), uaReadVariant);
	if (intRetval != UA_STATUSCODE_GOOD || !UA_Variant_isScalar(uaReadVariant))
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateVirtualOPCUAServer]Fail to read node IMM.MOID on OPCUA Server of IMMSN:%d ", intIMMSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	//[MOID-Write]Write IMM.MOID by charMOID
	uaWriteVariant = UA_Variant_new();
	uastrMOID = UA_STRING(charMOID);
	UA_Variant_setScalarCopy(uaWriteVariant, &uastrMOID, uaReadVariant->type);
	UA_Client_writeValueAttribute(uaClient, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.MOID"), uaWriteVariant);

	//[MOID]Delete Variant
	UA_Variant_delete(uaReadVariant);
	UA_Variant_delete(uaWriteVariant);

	//[RealTimeShotSN-Check]If intRealTimeShotSN!=-1 then Update IMM.RealTimeShotSN on Virtual OPCUAServer
	if (intRealTimeShotSN != -1)
	{
		//[RealTimeShotSN-Read]Read IMM.RealTimeShotSN Node for Scalar Copy
		uaReadVariant = UA_Variant_new();
		intRetval = UA_Client_readValueAttribute(uaClient, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.RealTimeShotSN"), uaReadVariant);
		if (intRetval != UA_STATUSCODE_GOOD || !UA_Variant_isScalar(uaReadVariant))
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateVirtualOPCUAServer]Fail to read node IMM.MOSN on OPCUA Server of IMMSN:%d ", intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		//[RealTimeShotSN-Write]Write IMM.RealTimeShotSN by intRealTimeShotSN
		uaWriteVariant = UA_Variant_new();
		intOPCUANodeValue = intRealTimeShotSN;
		UA_Variant_setScalarCopy(uaWriteVariant, &intRealTimeShotSN, uaReadVariant->type);
		//fprintf(stderr, "RealTimeShotSN:%ld\n", intOPCUANodeValue);
		UA_Client_writeValueAttribute(uaClient, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.RealTimeShotSN"), uaWriteVariant);

		//[RealTimeShotSN]Delete Variant
		UA_Variant_delete(uaReadVariant);
		UA_Variant_delete(uaWriteVariant);
	}

	//[intIMMSensorDataReadyShotSN-Check]If intIMMSensorDataReadyShotSN!=-1 then Update IMM.IMMSensorDataReadyShotSN on Virtual OPCUAServer
	if (intIMMSensorDataReadyShotSN != -1)
	{
		//[IMMSensorDataReadyShotSN-Read]Read IMM.IMMSensorDataReadyShotSN Node for Scalar Copy
		uaReadVariant = UA_Variant_new();
		intRetval = UA_Client_readValueAttribute(uaClient, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.IMMSensorDataReadyShotSN"), uaReadVariant);
		if (intRetval != UA_STATUSCODE_GOOD || !UA_Variant_isScalar(uaReadVariant))
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_UpdateVirtualOPCUAServer]Fail to read node IMM.MOSN on OPCUA Server of IMMSN:%d ", intIMMSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		//[IMMSensorDataReadyShotSN-Write]Write IMM.IMMSensorDataReadyShotSN by IMMSensorDataReadyShotSN
		uaWriteVariant = UA_Variant_new();
		intOPCUANodeValue = intIMMSensorDataReadyShotSN;
		UA_Variant_setScalarCopy(uaWriteVariant, &intIMMSensorDataReadyShotSN, uaReadVariant->type);
		//fprintf(stderr,"IMMSensorDataReadyShotSN:%ld\n",intOPCUANodeValue);
		UA_Client_writeValueAttribute(uaClient, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.IMMSensorDataReadyShotSN"), uaWriteVariant);

		//[IMMSensorDataReadyShotSN]Delete Variant
		UA_Variant_delete(uaReadVariant);
		UA_Variant_delete(uaWriteVariant);
	}
	UA_Client_delete(uaClient);
	fprintf(stderr,"[MO_UpdateVirtualOPCUAServer]Execute successfully.\n");
	return EXIT_SUCCESS;
}

int MO_AutoCopyAllControlLine(MYSQL mysqlCon, unsigned int intMOSN)
//[MO]Find Out All Control Line Data from the Oldest and Isomorphic MO, and Copy to the Specified MO
{
	char charStatement[MAX_STRING_SIZE];
	char charErrMsg[LONG_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	bool boolIsomorphism;
	int intExitStatus = EXIT_SUCCESS;

	for (int i = 1; i < intMOSN && boolIsomorphism == false; i++)
	{
		intRetval = DB_CheckIsomorphismbyMOSN(mysqlCon, intMOSN, i, &boolIsomorphism);
		if (intRetval == EXIT_SUCCESS && boolIsomorphism == true)
		{
			fprintf(stderr, "Copying SPC/QC/EC Control Line From MOSN:%d\n", i);
			intRetval = SPC_CopySPCControlLine(mysqlCon, i, intMOSN);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_AutoCopyAllControlLine]Fail to copy SPC control line from MOSN:%d to MOSN:%d\n", i, intMOSN);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, ERRCLASS_DB, charErrMsg);
				intExitStatus = EXIT_FAILURE;
			}
			intRetval = QC_CopyQCControlLine(mysqlCon, i, intMOSN);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_AutoCopyAllControlLine]Fail to copy QC control line from MOSN:%d to MOSN:%d\n", i, intMOSN);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, ERRCLASS_DB, charErrMsg);
				intExitStatus = EXIT_FAILURE;
			}
			intRetval = EC_CopyECControlLine(mysqlCon, i, intMOSN);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE, "[MO_AutoCopyAllControlLine]Fail to copy EC control line from MOSN:%d to MOSN:%d\n", i, intMOSN);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, ERRCLASS_DB, charErrMsg);
				intExitStatus = EXIT_FAILURE;
			}
		}
	}
	return intExitStatus;
}

//[EMPTY SHOT CONTROL]

int EC_SelectECProgressFlag(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int *intECProgressFlag)
//[EC]Select Empty Control Progress Flag
{
	int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT ECProgressFlag FROM %s_%s_%s_%d_RawData.ShotSNList WHERE ShotSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN);
	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[EC_SelectECProgressFlag]Fail to select ECProgressFlag for ShotSN:%d in table %s_%s_%s_%d_RawData.ShotSNList (%d): %s",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[EC_SelectECProgressFlag]Fail to select ECProgressFlag ShotSN=%d from %s_%s_%s_%d_RawData.ShotSNList",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		mysql_free_result(mysqlResult);
		return intLogSN;
	}
	else if (mysqlRow[0] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[EC_SelectECProgressFlag]Fail to select ECProgressFlag ShotSN=%d from %s_%s_%s_%d_RawData.ShotSNList (ECProgressFlag == NULL)",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		mysql_free_result(mysqlResult);
		return intLogSN;
	}
	else
	{
		*intECProgressFlag = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
}

int EC_TriggerECProgressFlag(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int intECProgressFlagBit)
//[EC]Trigger Empty Control Progress Flag
{
	int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];

	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s_%s_%d_RawData.ShotSNList Set ECProgressFlag = ECProgressFlag ^ %d WHERE ShotSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intECProgressFlagBit, intShotSN);
	// fprintf(stderr,"Q:%s\n",charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[EC_TriggerECProgressFlag]Fail to update ECProgressFlag (Bit:%d) for ShotSN:%d in table %s_%s_%s_%d_RawData.ShotSNList (%d): %s",
				 intECProgressFlagBit, intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int EC_InsertAllECCL(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSNStart, unsigned int intShotSNEnd)
//[EC]Insert Empty Control Control Lines for All Monitor Items
{
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	unsigned int intMonitorItemSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Select All MonitorItemSN of Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList ORDER BY MonitorItemSN ASC",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[EC_InsertAllECCL]Fail to select all MonitorItemSN from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	intRetval = EXIT_SUCCESS;
	mysqlResult = mysql_store_result(&mysqlCon);
	while ((mysqlRow = mysql_fetch_row(mysqlResult)) != NULL)
	{
		intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
		// fprintf(stderr, "[EC_InsertAllECCL]Caculate ECCL for MOSN:%d MonitorItemSN:%d ShotSNStart:%d ShotSNEnd:%d\n",
		//		intMOSN, intMonitorItemSN, intShotSNStart, intShotSNEnd);
		if (intMonitorItemSN == 0 || EC_InsertECCL(mysqlCon, intMOSN, intMonitorItemSN, intShotSNStart, intShotSNEnd) != EXIT_SUCCESS)
			intRetval = EXIT_FAILURE;
	}
	mysql_free_result(mysqlResult);
	return intRetval;
}

int EC_InsertECCL(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMonitorItemSN, unsigned int intShotSNStart, unsigned int intShotSNEnd)
//[EC]Insert Empty Control Control Lines for A Specified Monitor Item
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intIMMSN;
	double doubleECCLRatio;

	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intMonitorItemIndex;
	char charMonitorItemDBName[SMALL_STRING_SIZE];
	unsigned int intCustomSensorClass;
	unsigned int intCustomSensorCategory;
	unsigned int intRoundSN;

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	double doubleECUCL;
	double doubleECCL;
	double doubleECLCL;

	intRetval = DB_SelectIMMSNbyMOSN(mysqlCon, intMOSN, &intIMMSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[EC_InsertECCL]Fail to select IMMSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Select All Enable SPC Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex,ECCLRatio FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[EC_InsertECCL]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[EC_InsertECCL]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList. (No Such MonitorItemSN)",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	intMonitorItemClass = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
	// fprintf(stderr, "intMonitorItemClass:%d\n", intMonitorItemClass);
	intMonitorItemSensorSN = mysqlRow[1] != NULL ? atoi(mysqlRow[1]) : 0;
	// fprintf(stderr, "intMonitorItemSensorSN:%d\n", intMonitorItemSensorSN);
	intMonitorItemIndex = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
	// fprintf(stderr, "intMonitorItemIndex:%d\n", intMonitorItemIndex);
	doubleECCLRatio = mysqlRow[3] != NULL ? atof(mysqlRow[3]) : 0;
	// fprintf(stderr, "doubleECCLRatio:%lf\n", doubleECCLRatio);
	mysql_free_result(mysqlResult);

#ifdef ENABLE_ECCL_ROUNDSN_CHECK

	// Check If the RoundSN of First ShotSN and The Last ShotSN Are the Same
	intRetval = DB_SelectRoundSNbyShotSN(mysqlCon, intMOSN, intShotSNStart, &intRoundSNStart);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[EC_InsertECCL]Fail to select RoundSN for ShotSNStart:%d from table %s_%s_%s_%d_RawData.ShotSNList",
				 intShotSNStart, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	intRetval = DB_SelectRoundSNbyShotSN(mysqlCon, intMOSN, intShotSNEnd, &intRoundSNEnd);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[EC_InsertECCL]Fail to select RoundSN for ShotSNStart:%d from table %s_%s_%s_%d_RawData.ShotSNList",
				 intRoundSNEnd, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	if (intRoundSNStart != intRoundSNEnd)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[EC_InsertECCL]ShotSNStart:%d RoundSNStart:%d And ShotSNEnd:%d RoundSNEnd:%d are not the same in the table %s_%s_%s_%d_RawData.ShotSNList",
				 intShotSNStart, intRoundSNStart, intShotSNEnd, intRoundSNEnd, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

#endif

	// Handle Various Categories of SPC Monitor Item
	if (intMonitorItemClass == MONITOR_ITEM_CLASS_QUALITY)
	{
		return EXIT_SUCCESS;
	}
	/*
	Empty Control Now Only Aviable For IMM System Oil Pressure
	*/
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_OPCUA) // Select IMM Sensor Data from ShotSNStart to ShotSNEnd
	{
		return EXIT_SUCCESS;
		/*
		//Select IMMSensor Value by Given IMMSensorSN
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN, %s FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList "
				 "WHERE ShotSN >= %d AND ShotSN <= %d AND %s IS NOT NULL ORDER BY ShotSN",
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd, charMonitorItemDBName);

		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select IMMSensor:%s where MonitorItemSN=%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
					 charMonitorItemDBName, intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		mysqlResult = mysql_store_result(&mysqlCon);

		//Check if the amount of data = intShotSNEnd - intShotSNStart + 1 and All Values Is Not NULL
		if (mysql_num_rows(mysqlResult) == 0 || mysql_num_rows(mysqlResult) != intShotSNEnd - intShotSNStart + 1)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select IMMSensor:%s where MonitorItemSN=%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result empty or No enough data)",
					 charMonitorItemDBName, intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		//Select Max, Avg and Min Value
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT MAX(%s), AVG(%s), MIN(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList WHERE ShotSN >= %d AND ShotSN <= %d ",
				 charMonitorItemDBName, charMonitorItemDBName, charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select Max, XBarBar and Min value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select Max, XBarBar and Min value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		doubleECUCL = atof(mysqlRow[0]);
		doubleECCL = atof(mysqlRow[1]);
		doubleECLCL = atof(mysqlRow[2]);
		*/
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS)
	{
		// Get Name by Given MonitorItemSN
		intRetval = DB_SelectMonitorItemDBName(mysqlCon, intMOSN, intMonitorItemSN, charMonitorItemDBName);
		// fprintf(stderr, "intMonitorItemName:%s\n", charMonitorItemDBName);

		// Select MOCustomSensor RawData by Given MOCustomSensorSN
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN, %s FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN >= %d AND ShotSN <= %d AND %s IS NOT NULL ORDER BY ShotSN ASC",
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN, intShotSNStart, intShotSNEnd, charMonitorItemDBName);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select MOCustomSensorSN:%d where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensor%d (%d):%s",
					 intMonitorItemSensorSN, intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 intMonitorItemSensorSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		mysqlResult = mysql_store_result(&mysqlCon);

		// Check if the amount of data = the sample size * group size and All Values Is Not NULL
		if (mysql_num_rows(mysqlResult) == 0 || mysql_num_rows(mysqlResult) != intShotSNEnd - intShotSNStart + 1)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select MOCustomSensorSN:%d where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensor%d (Result empty or No enough data):",
					 intMonitorItemSensorSN, intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 intMonitorItemSensorSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysql_free_result(mysqlResult);

		// Select Max, Avg and Min
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT MAX(%s), AVG(%s), MIN(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN >= %d AND ShotSN <= %d ",
				 charMonitorItemDBName, charMonitorItemDBName, charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intMonitorItemSensorSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select Max, XBarBar and Min value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 intMonitorItemSensorSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select Max, XBarBar and Min value value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (Result Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		// doubleECUCL = atof(mysqlRow[0]);
		doubleECCL = atof(mysqlRow[1]);
		// doubleECLCL = atof(mysqlRow[2]);

		// Get MOCustomSensorClass and MOCustomSensorCategory
		intRetval = DB_SelectMOCustomSensorClassAndCategorybyMOCustomSensorSN(mysqlCon, intMOSN, intMonitorItemSensorSN, &intCustomSensorClass, &intCustomSensorCategory);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[EC_InsertECCL]Fail to select custom sensor category of MOSN:%d MOCustomSensorSN:%d from %s_%s.CustomSensorModelIndex and %s_%s_%s_%d_Info_Meta.MOCustomSensorSNList (%d):%s",
					 intMOSN, intMonitorItemSensorSN, SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		if (intCustomSensorClass == CUSTOM_SENSOR_CLASS_IMM && intCustomSensorCategory == CUSTOM_SENSOR_CATEGORY_PRESSURE)
		{
			//==MAC
			if (intMonitorItemIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME)
			{
				doubleECLCL = doubleECCL * doubleECCLRatio;

				fprintf(stderr, "[EC_InsertECCL]MonitorItemName:%s MonitorItemSensorSN:%d AVG:%lf ECLCL:%lf\n", charMonitorItemDBName, intMonitorItemSensorSN, doubleECCL, doubleECLCL);
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList "
						 "(MonitorItemSN, ECShotSNStart, ECShotSNEnd, ECCLRatioStatic, ECCL, ECLCL) VALUE (%d,%d,%d,%lf,%lf,%lf) "
						 "ON DUPLICATE KEY UPDATE ECShotSNStart = %d, ECShotSNEnd = %d, ECCLRatioStatic = %lf, ECCL = %lf, ECLCL = %lf",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
						 intMonitorItemSN, intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECLCL,
						 intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECLCL);

				// fprintf(stderr, "Q:%s\n", charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE, "[EC_InsertECCL]Fail to insert ECUCL/EC (MonitorItemSN:%d) to table %s_%s_%s_%d_Info_Meta.MOControlLineList (%d):%s",
							 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}
			}
			else if (intMonitorItemIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE)
			{
				doubleECUCL = doubleECCL * doubleECCLRatio;

				fprintf(stderr, "[EC_InsertECCL]MonitorItemName:%s MonitorItemSensorSN:%d AVG:%lf ECUCL:%lf\n", charMonitorItemDBName, intMonitorItemSensorSN, doubleECCL, doubleECUCL);
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList "
						 "(MonitorItemSN, ECShotSNStart, ECShotSNEnd, ECCLRatioStatic, ECCL, ECUCL) VALUE (%d,%d,%d,%lf,%lf,%lf) "
						 "ON DUPLICATE KEY UPDATE ECShotSNStart = %d, ECShotSNEnd = %d, ECCLRatioStatic = %lf, ECCL = %lf, ECUCL = %lf",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
						 intMonitorItemSN, intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECUCL,
						 intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECUCL);

				// fprintf(stderr, "Q:%s\n", charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE, "[EC_InsertECCL]Fail to insert ECUCL/EC (MonitorItemSN:%d) to table %s_%s_%s_%d_Info_Meta.MOControlLineList (%d):%s",
							 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}
			}
			else if (intMonitorItemIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE)
			{
				doubleECUCL = doubleECCL * doubleECCLRatio;

				fprintf(stderr, "[EC_InsertECCL]MonitorItemName:%s MonitorItemSensorSN:%d AVG:%lf ECUCL:%lf\n", charMonitorItemDBName, intMonitorItemSensorSN, doubleECCL, doubleECUCL);
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList "
						 "(MonitorItemSN, ECShotSNStart, ECShotSNEnd, ECCLRatioStatic, ECCL, ECUCL) VALUE (%d,%d,%d,%lf,%lf,%lf) "
						 "ON DUPLICATE KEY UPDATE ECShotSNStart = %d, ECShotSNEnd = %d, ECCLRatioStatic = %lf, ECCL=%lf, ECUCL = %lf",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
						 intMonitorItemSN, intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECUCL,
						 intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECUCL);

				// fprintf(stderr, "Q:%s\n", charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE, "[EC_InsertECCL]Fail to insert ECUCL/EC (MonitorItemSN:%d) to table %s_%s_%s_%d_Info_Meta.MOControlLineList (%d):%s",
							 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}
			}
			else if (intMonitorItemIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE2_PRESSURE)
			{
				doubleECUCL = doubleECCL * doubleECCLRatio;

				fprintf(stderr, "[EC_InsertECCL]MonitorItemName:%s MonitorItemSensorSN:%d AVG:%lf ECUCL:%lf\n", charMonitorItemDBName, intMonitorItemSensorSN, doubleECCL, doubleECUCL);
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList "
						 "(MonitorItemSN, ECShotSNStart, ECShotSNEnd, ECCLRatioStatic, ECCL, ECUCL) VALUE (%d,%d,%d,%lf,%lf,%lf) "
						 "ON DUPLICATE KEY UPDATE ECShotSNStart = %d, ECShotSNEnd = %d, ECCLRatioStatic = %lf, ECCL=%lf, ECUCL = %lf",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
						 intMonitorItemSN, intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECUCL,
						 intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECUCL);

				// fprintf(stderr, "Q:%s\n", charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE, "[EC_InsertECCL]Fail to insert ECUCL/EC (MonitorItemSN:%d) to table %s_%s_%s_%d_Info_Meta.MOControlLineList (%d):%s",
							 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}
			}
			else if (intMonitorItemIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_PERIOD)
			{
				doubleECLCL = doubleECCL * doubleECCLRatio;
				fprintf(stderr, "[EC_InsertECCL]MonitorItemName:%s MonitorItemSensorSN:%d AVG:%lf ECLCL:%lf\n", charMonitorItemDBName, intMonitorItemSensorSN, doubleECCL, doubleECLCL);
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList "
						 "(MonitorItemSN, ECShotSNStart, ECShotSNEnd, ECCLRatioStatic, ECCL, ECLCL) VALUE (%d,%d,%d,%lf,%lf,%lf) "
						 "ON DUPLICATE KEY UPDATE ECShotSNStart = %d, ECShotSNEnd = %d, ECCLRatioStatic = %lf, ECCL = %lf, ECLCL = %lf",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
						 intMonitorItemSN, intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECLCL,
						 intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECLCL);

				// fprintf(stderr, "Q:%s\n", charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE, "[EC_InsertECCL]Fail to insert ECUCL/EC (MonitorItemSN:%d) to table %s_%s_%s_%d_Info_Meta.MOControlLineList (%d):%s",
							 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}
			}
			else if (intMonitorItemIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE3_PRESSURE)
			{
				doubleECLCL = doubleECCL * doubleECCLRatio;
				fprintf(stderr, "[EC_InsertECCL]MonitorItemName:%s MonitorItemSensorSN:%d AVG:%lf ECLCL:%lf\n", charMonitorItemDBName, intMonitorItemSensorSN, doubleECCL, doubleECLCL);
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList "
						 "(MonitorItemSN, ECShotSNStart, ECShotSNEnd, ECCLRatioStatic, ECCL, ECLCL) VALUE (%d,%d,%d,%lf,%lf,%lf) "
						 "ON DUPLICATE KEY UPDATE ECShotSNStart = %d, ECShotSNEnd = %d, ECCLRatioStatic = %lf, ECCL = %lf, ECLCL = %lf",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
						 intMonitorItemSN, intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECLCL,
						 intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECLCL);

				// fprintf(stderr, "Q:%s\n", charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE, "[EC_InsertECCL]Fail to insert ECUCL/EC (MonitorItemSN:%d) to table %s_%s_%s_%d_Info_Meta.MOControlLineList (%d):%s",
							 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}
			}
			else if (intMonitorItemIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_PRESSURE)
			{
				doubleECLCL = doubleECCL * doubleECCLRatio;

				fprintf(stderr, "[EC_InsertECCL]MonitorItemName:%s MonitorItemSensorSN:%d AVG:%lf ECLCL:%lf\n", charMonitorItemDBName, intMonitorItemSensorSN, doubleECCL, doubleECLCL);
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList "
						 "(MonitorItemSN, ECShotSNStart, ECShotSNEnd, ECCLRatioStatic, ECCL, ECLCL) VALUE (%d,%d,%d,%lf,%lf,%lf) "
						 "ON DUPLICATE KEY UPDATE ECShotSNStart = %d, ECShotSNEnd = %d, ECCLRatioStatic = %lf, ECCL = %lf, ECLCL = %lf",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
						 intMonitorItemSN, intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECLCL,
						 intShotSNStart, intShotSNEnd, doubleECCLRatio, doubleECCL, doubleECLCL);

				// fprintf(stderr, "Q:%s\n", charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE, "[EC_InsertECCL]Fail to insert ECUCL/EC (MonitorItemSN:%d) to table %s_%s_%s_%d_Info_Meta.MOControlLineList (%d):%s",
							 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
					return intLogSN;
				}
			}
		}
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_SOFT)
	{
		return EXIT_SUCCESS;
		/*
		//Select MOCustomSensor RawData From Table SoftSensor
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN, %s FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d AND %s IS NOT NULL ORDER BY ShotSN ASC",
				 charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd, charMonitorItemDBName);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select SoftSensor data where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		mysqlResult = mysql_store_result(&mysqlCon);

		//Check if the amount of data = the sample size * group size and All Values Is Not NULL
		if (mysql_num_rows(mysqlResult) == 0 || mysql_num_rows(mysqlResult) != intShotSNEnd - intShotSNStart + 1)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select SoftSensor data where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (Result empty or No enough data):",
					 intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysql_free_result(mysqlResult);

		//Select Max, XBarBar and Min Value
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT MAX(%s), AVG(%s), MIN(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d ",
				 charMonitorItemDBName, charMonitorItemDBName, charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select Max, XBarBar and Min value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_InsertECCL]Fail to select Max, XBarBar and Min  value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (Result Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		doubleECUCL = atof(mysqlRow[0]);
		doubleECCL = atof(mysqlRow[1]);
		doubleECLCL = atof(mysqlRow[2]);
		*/
	}

	return EXIT_SUCCESS;
}

int EC_CopyECControlLine(MYSQL mysqlCon, unsigned int intSourceMOSN, unsigned int intDestinationMOSN)
//[EC]Copy All Empty Control Control Lines from Source MO to Destinated MO
{
	int intRetval;
	unsigned int intIMMSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intRowSize;
	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intMonitorItemIndex;
	double doubleECUCL, doubleECCL, doubleECLCL;

	// Select Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN,ECUCL,ECCL,ECLCL FROM %s_%s_%s_%d_Info_Meta.MOControlLineList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[EC_CopyECControlLine]Fail to select all MonitorItemSN control line from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	intRowSize = (unsigned int)mysql_num_rows(mysqlResult);

	// For All MonitorItemSN Monitor Item
	for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
	{
		if (mysqlRow[0] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_CopyECControlLine]Source MonitorItemSN is null from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, ERRCLASS_DB, charErrMsg);
			return intLogSN;
		}
		else
		{
			intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
			// fprintf(stderr, "MonintorItemSN:%d ",intMonitorItemSN);
		}

		if (mysqlRow[1] != NULL)
		{
			doubleECUCL = atof(mysqlRow[1]);
			snprintf(charStatement, MAX_STRING_SIZE,
					 "UPDATE %s_%s_%s_%d_Info_Meta.MOControlLineList SET ECUCL = %lf WHERE MonitorItemSN = %d",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, doubleECUCL, intMonitorItemSN);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[EC_CopyECControlLine]Fail to update MonitorItemSN ECUCL from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intDestinationMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
		}

		if (mysqlRow[2] != NULL)
		{
			doubleECCL = atof(mysqlRow[2]);
			snprintf(charStatement, MAX_STRING_SIZE,
					 "UPDATE %s_%s_%s_%d_Info_Meta.MOControlLineList SET ECCL = %lf WHERE MonitorItemSN = %d",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, doubleECCL, intMonitorItemSN);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[EC_CopyECControlLine]Fail to update MonitorItemSN ECCL from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intDestinationMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
		}

		if (mysqlRow[3] != NULL)
		{
			doubleECLCL = atof(mysqlRow[3]);
			snprintf(charStatement, MAX_STRING_SIZE,
					 "UPDATE %s_%s_%s_%d_Info_Meta.MOControlLineList SET ECLCL = %lf WHERE MonitorItemSN = %d",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, doubleECLCL, intMonitorItemSN);
			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[EC_CopyECControlLine]Fail to update MonitorItemSN ECLCL from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intDestinationMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}
		}
	}
	return EXIT_SUCCESS;
}

int EC_CheckEmptyShot(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN)
//[EC]Check Empty Shot for A Specified ShotSN in An Existing MO
{
	int intRetval;
	unsigned int intIMMSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intRowSize;
	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intMonitorItemIndex;

	unsigned int intSensorClass;
	unsigned int intSensorCategory;

	double doubleECUCL;
	double doubleECCL;
	double doubleECLCL;
	double doubleECCLRatio;
	char *charSPCAlarmSN;
	unsigned int intQualityControlAlarmSN;
	// int intSPCAlarm;
	int intQualityControlAlarm;
	char charQualityControlAlarm[5];
	int intSPCRAlarm;
	char charMonitorItemDBName[SMALL_STRING_SIZE];

	double *doubleXBarValue;
	bool boolAllECCLIsNULL = true;
	bool boolECUCLIsNULL;
	bool boolECLCLIsNULL;
	bool boolIsMultipleCondition;
	unsigned int intMutipleConditionCount = 0;
	bool boolIsEmptyShot = false;

	// Select All Enable SPC Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT %s_%s_%s_%d_Info_Config.MonitorItemSNList.MonitorItemSN,"	// 0
			 "MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex,ECCLRatio," // 1~4
			 "ECUCL,ECCL,ECLCL "												// 5~7
			 "FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList, %s_%s_%s_%d_Info_Meta.MOControlLineList "
			 "WHERE %s_%s_%s_%d_Info_Config.MonitorItemSNList.MonitorItemSN = %s_%s_%s_%d_Info_Meta.MOControlLineList.MonitorItemSN "
			 "AND %s_%s_%s_%d_Info_Config.MonitorItemSNList.ECEnable = 1",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[EC_EheckEmptyShot]Fail to select all MonitorItemSN control line where ECEnable = 1 from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	intRowSize = (unsigned int)mysql_num_rows(mysqlResult);

	// Set Default Empty Flag as False
	boolIsEmptyShot = false;
	for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
	{
		intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
		intMonitorItemClass = mysqlRow[1] != NULL ? atoi(mysqlRow[1]) : 0;
		intMonitorItemSensorSN = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
		intMonitorItemIndex = mysqlRow[3] != NULL ? atoi(mysqlRow[3]) : 0;
		doubleECCLRatio = mysqlRow[4] != NULL ? atof(mysqlRow[4]) : 0;

		doubleECUCL = 0;
		doubleECLCL = 0;
		boolECUCLIsNULL = true;
		boolECLCLIsNULL = true;

		if (mysqlRow[5] != NULL)
		{
			boolAllECCLIsNULL = false;
			boolECUCLIsNULL = false;
			doubleECUCL = atof(mysqlRow[5]);
		}
		else
			boolECUCLIsNULL = true;

		if (mysqlRow[7] != NULL)
		{
			boolAllECCLIsNULL = false;
			boolECLCLIsNULL = false;
			doubleECLCL = atof(mysqlRow[7]);
		}
		else
			boolECLCLIsNULL = true;

		if (boolECUCLIsNULL == true && boolECLCLIsNULL)
			continue;

		DB_SelectMonitorItemDBName(mysqlCon, intMOSN, intMonitorItemSN, charMonitorItemDBName);

		fprintf(stderr, "ShotSN:%d MonitorItemSN:%d intShotSN:%s ", intShotSN, intMonitorItemSN, charMonitorItemDBName);
		if (boolECUCLIsNULL != true)
			fprintf(stderr, "ECUCL:%lf ", doubleECUCL);
		if (boolECLCLIsNULL != true)
			fprintf(stderr, "ECLCL:%lf ", doubleECLCL);
		fprintf(stderr, "\n");

		// fprintf(stderr, "MonitorItemSN:%d ECUCL:%lf ECCL:%lf ECLCL:%lf\n", intMonitorItemSN, doubleECUCL, doubleECCL, doubleECLCL);

		// Fetch XBar Value
		intRetval = QC_SelectQCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleXBarValue);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_EheckEmptyShot]Fail to select X value for MOSN:%d ShotSN:%d", intMOSN, intShotSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		else if (doubleXBarValue == NULL)
		{
			fprintf(stderr, "[EC_EheckEmptyShot]The XBarValue is null\n");
			continue;
		}

		boolIsMultipleCondition = false;

		// C&D
		intRetval = DB_SelectMOCustomSensorClassAndCategorybyMOCustomSensorSN(mysqlCon, intMOSN, intMonitorItemSensorSN, &intSensorClass, &intSensorCategory);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[EC_EheckEmptyShot]Fail to select custom sensor category of MOSN:%d MOCustomSensorSN:%d from %s_%s.CustomSensorModelIndex and "
					 "%s_%s_%s_%d_Info_Meta.MOCustomSensorSNList while check system pressure's existance(%d):%s",
					 intMOSN, intMonitorItemSensorSN, SYS_NAME, INDEX_DATABASE_NAME, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		if (intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS &&
			intSensorClass == CUSTOM_SENSOR_CLASS_IMM &&
			intSensorCategory == CUSTOM_SENSOR_CATEGORY_PRESSURE &&
			(intMonitorItemIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE ||
			 intMonitorItemIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME))
		{
			if (intMonitorItemIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE)
			{
				fprintf(stderr, "Multiple Condition Stage1EndPressure ");
			}
			else if (intMonitorItemIndex == IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME)
			{
				fprintf(stderr, "Multiple Condition Stage1EndTime ");
			}
			boolIsMultipleCondition = true;
		}

		if (boolECUCLIsNULL != true && *doubleXBarValue > doubleECUCL)
		{
			fprintf(stderr, "ShotSN:%d Empty Control - %s Result:%d(too high) Value:%lf > UCL:%lf\n", intShotSN, charMonitorItemDBName, intQualityControlAlarm, *doubleXBarValue, doubleECUCL);
			if (boolIsMultipleCondition == true)
			{
				intMutipleConditionCount++;
				if (intMutipleConditionCount == 2)
				{
					boolIsEmptyShot = true;
					fprintf(stderr, "ShotSN:%d Empty Control - Result: Empty. (2 Violations)\n", intShotSN);
				}
			}
			else
			{
				boolIsEmptyShot = true;
			}
		}
		else if (boolECLCLIsNULL != true && *doubleXBarValue < doubleECLCL)
		{
			fprintf(stderr, "ShotSN:%d Empty Control - %s Result:%d(too low) Value:%lf < LCL:%lf\n", intShotSN, charMonitorItemDBName, intQualityControlAlarm, *doubleXBarValue, doubleECLCL);
			if (boolIsMultipleCondition == true)
			{
				intMutipleConditionCount++;
				if (intMutipleConditionCount == 2)
				{
					boolIsEmptyShot = true;
					fprintf(stderr, "ShotSN:%d Empty Control - Result: Empty. (2 Violations)\n", intShotSN);
				}
			}
			else
			{
				boolIsEmptyShot = true;
			}
		}
		else
		{
			fprintf(stderr, "ShotSN:%d Empty Control - %s Result:%d(pass) LCL:%lf < Value:%lf < UCL:%lf\n",
					intShotSN, charMonitorItemDBName, intQualityControlAlarm, doubleECLCL, *doubleXBarValue, doubleECUCL);
		}
	}

	if (boolAllECCLIsNULL != true)
	{
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s_%d_RawData.ShotSNList Set EmptyShot = %d WHERE ShotSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 boolIsEmptyShot == true ? EMPTY_SHOT_TRUE : EMPTY_SHOT_FALSE,
				 intShotSN);
		// fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[EC_EheckEmptyShot]Fail to update emptyshot (%d) for ShotSN:%d in table %s_%s_%s_%d_RawData.ShotSNList (%d): %s",
					 boolIsEmptyShot, intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}

	mysql_free_result(mysqlResult);

	return EXIT_SUCCESS;
}

//[QUALITY CONTROL]

int QC_ConfigMonitorItemSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMonitorItemSN, bool boolQCEnable, double doubleQCCLRatio)
//[QC]Config Enable/Disable and Control Line Ratio of A Specified Monitor Item in An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	// Insert The Configuration of Such SPC Monitor Item
	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET QCEnable = %d , QCCLRatio = %lf WHERE MonitorItemSN = %d ",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 boolQCEnable, doubleQCCLRatio, intMonitorItemSN);
	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[QC_EnableMonitorItemSN]Fail to update MonitorItemSN:%d configuration to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int QC_ConfigAllMonitorItemSN(MYSQL mysqlCon, unsigned int intMOSN, double doubleQCCLRatio)
//[QC]Config All Control Ratio of All Monitor Items in An Existing MO
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	bool boolintMonitorItemSNEnable = 0;
	unsigned int intShotSN;

	intRetval = DB_SelectShotSNbyMOSN(mysqlCon, intMOSN, &intShotSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[QC_ConfigAllMonitorItemSN]Fail to select ShotSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Update The Configuration of The QC MonitorItem
	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET QCCLRatio = %lf",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, doubleQCCLRatio);

	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[QC_ConfigAllMonitorItemSN]Fail to update all MonitorItemSN configuration to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int QC_SelectQCProgressFlag(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int *intQCProgressFlag)
//[QC]Select Quality Control Progress Flag of An Existing MO
{
	int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT QCProgressFlag FROM  %s_%s_%s_%d_RawData.ShotSNList WHERE ShotSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_SelectQCProgressFlag]Fail to select QCProgressFlag for ShotSN:%d in table %s_%s_%s_%d_RawData.ShotSNList (%d): %s",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_SelectQCProgressFlag]Fail to select QCProgressFlag ShotSNSN=%d from %s_%s_%s_%d_RawData.ShotSNList (QCProgressFlag == NULL)",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	else
		*intQCProgressFlag = atoi(mysqlRow[0]);

	return EXIT_SUCCESS;
}

int QC_TriggerQCProgressFlag(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int intQCProgressFlagBit)
//[QC]Trigger Quality Control Progress Flag of An Existing MO
{
	int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];

	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s_%s_%d_RawData.ShotSNList Set QCProgressFlag = QCProgressFlag ^ %d WHERE ShotSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intQCProgressFlagBit, intShotSN);
	// fprintf(stderr,"Q:%s\n",charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_TriggerQCProgressFlag]Fail to update QCProgressFlag (Bit:%d) for ShotSN:%d in table %s_%s_%s_%d_RawData.ShotSNList (%d): %s",
				 intQCProgressFlagBit, intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	/*
	else if (intQCProgressFlagBit == QC_PROGRESS_FLAG_OPCUA_READY)
	{
		char charOPCUAIP[16];
		unsigned int intOPCUAPort;
		char charEndPointURL[MEDIUM_STRING_SIZE];
		int *nodeValue = malloc(sizeof(int));

		strcpy(charOPCUAIP, VIRTUAL_OPCUA_SERVER_IP);
		intOPCUAPort = VIRTUAL_OPCUA_SERVER_PORT;
		UA_Client *client = UA_Client_new(UA_ClientConfig_default);
		snprintf(charEndPointURL, MEDIUM_STRING_SIZE, "opc.tcp://%s:%d", charOPCUAIP, intOPCUAPort);
		intRetval = UA_Client_connect(client, charEndPointURL);
		if (intRetval != UA_STATUSCODE_GOOD)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[QC_TriggerQCProgressFlag]Fail to connect OPCUA Server of MOSN:%d ", intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intMOSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		UA_Variant *readVariant = UA_Variant_new();
		intRetval = UA_Client_readValueAttribute(client, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.IMMSensorDataReadyShotSN"), readVariant);
		if (intRetval != UA_STATUSCODE_GOOD || !UA_Variant_isScalar(readVariant))
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[QC_TriggerQCProgressFlag]Fail to read node IMM.IMMSensorDataReadyShotSN on OPCUA Server of MOSN:%d ", intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_OPCUA_CLIENT, 0, intMOSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		*nodeValue = intShotSN;
		UA_Variant *writeVariant = UA_Variant_new();
		UA_Variant_setScalarCopy(writeVariant, nodeValue, readVariant->type);
		UA_Client_writeValueAttribute(client, UA_NODEID_STRING(VIRTUAL_OPCUA_SERVER_NAMESPACE, "IMM.IMMSensorDataReadyShotSN"), writeVariant);
		UA_Variant_delete(writeVariant);
		UA_Variant_delete(readVariant);
	}
	*/
	return EXIT_SUCCESS;
}

int QC_InsertAllQCCL(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSNStart, unsigned int intShotSNEnd)
//[QC]Insert Quality Control Control Lines for All Monitor Items in An Existing MO
{
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	unsigned int intMonitorItemSN;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Select All MonitorItemSN of Given MOSN
	// snprintf(charStatement, MAX_STRING_SIZE,
	//		 "SELECT MonitorItemSN FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE QCEnable = 1 ORDER BY MonitorItemSN ASC",
	//		 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	// Select All MonitorItemSN of Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList ORDER BY MonitorItemSN ASC",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_InsertAllQCCL]Fail to select all MonitorItemSN from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	intRetval = EXIT_SUCCESS;
	mysqlResult = mysql_store_result(&mysqlCon);
	while ((mysqlRow = mysql_fetch_row(mysqlResult)) != NULL)
	{
		intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
		fprintf(stderr, "[QC_InsertAllQCCL]Caculate QCCL for MOSN:%d MonitorItemSN:%d ShotSNStart:%d ShotSNEnd:%d\n",
				intMOSN, intMonitorItemSN, intShotSNStart, intShotSNEnd);
		if (intMonitorItemSN == 0 || QC_InsertQCCL(mysqlCon, intMOSN, intMonitorItemSN, intShotSNStart, intShotSNEnd) != EXIT_SUCCESS)
			intRetval = EXIT_FAILURE;
	}

	mysql_free_result(mysqlResult);
	if (intRetval == EXIT_FAILURE)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_InsertAllQCCL]Fail to caculate some(or all) MonitorItemSN quality control lines from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	else
		return EXIT_SUCCESS;

	return intRetval;
}

int QC_InsertQCCL(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMonitorItemSN, unsigned int intShotSNStart, unsigned int intShotSNEnd)
//[QC]Insert Quality Control Control Line for A Specified Monitor Item in An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intIMMSN;
	double doubleQCCLRatio;

	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intSensorMonitorIndex;
	char charMonitorItemDBName[SMALL_STRING_SIZE];
	unsigned int intCustomSensorCategory;
	unsigned int intRoundSN;

	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	double doubleSTD;
	double doubleQCUCL;
	double doubleQCCL;
	double doubleQCLCL;

	intRetval = DB_SelectIMMSNbyMOSN(mysqlCon, intMOSN, &intIMMSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[QC_InsertQCCL]Fail to select IMMSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Select All Enable QC Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex,QCCLRatio FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_InsertQCCL]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_InsertQCCL]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList. (No Such MonitorItemSN)",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	intMonitorItemClass = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
	// fprintf(stderr, "intMonitorItemClass:%d\n", intMonitorItemClass);
	intMonitorItemSensorSN = mysqlRow[1] != NULL ? atoi(mysqlRow[1]) : 0;
	// fprintf(stderr, "intMonitorItemSensorSN:%d\n", intMonitorItemSensorSN);
	intSensorMonitorIndex = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
	// fprintf(stderr, "intSensorMonitorIndex:%d\n", intSensorMonitorIndex);
	doubleQCCLRatio = mysqlRow[3] != NULL ? atof(mysqlRow[3]) : 0;
	// fprintf(stderr, "doubleQCCLRatio:%lf\n", doubleQCCLRatio);
	mysql_free_result(mysqlResult);

#ifdef ENABLE_QCCL_ROUNDSN_CHECK

	// Check If the RoundSN of First ShotSN and The Last ShotSN Are the Same
	intRetval = DB_SelectRoundSNbyShotSN(mysqlCon, intMOSN, intShotSNStart, &intRoundSNStart);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[QC_InsertQCCL]Fail to select RoundSN for ShotSNStart:%d from table %s_%s_%s_%d_RawData.ShotSNList",
				 intShotSNStart, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	intRetval = DB_SelectRoundSNbyShotSN(mysqlCon, intMOSN, intShotSNEnd, &intRoundSNEnd);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[QC_InsertQCCL]Fail to select RoundSN for ShotSNStart:%d from table %s_%s_%s_%d_RawData.ShotSNList",
				 intRoundSNEnd, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	if (intRoundSNStart != intRoundSNEnd)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_InsertQCCL]ShotSNStart:%d RoundSNStart:%d And ShotSNEnd:%d RoundSNEnd:%d are not the same in the table %s_%s_%s_%d_RawData.ShotSNList",
				 intShotSNStart, intRoundSNStart, intShotSNEnd, intRoundSNEnd, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

#endif

	// Get Name by Given MonitorItemSN
	intRetval = DB_SelectMonitorItemDBName(mysqlCon, intMOSN, intMonitorItemSN, charMonitorItemDBName);
	// fprintf(stderr, "intMonitorItemName:%s\n", charMonitorItemDBName);

	// Handle Various Categories of QC Monitor Item
	if (intMonitorItemClass == MONITOR_ITEM_CLASS_QUALITY)
	{
		return EXIT_SUCCESS;
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_OPCUA) // Select IMM Sensor Data from ShotSNStart to ShotSNEnd
	{
		// Select IMMSensor Value by Given IMMSensorSN
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN, %s FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList "
				 "WHERE ShotSN >= %d AND ShotSN <= %d AND %s IS NOT NULL ORDER BY ShotSN",
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd, charMonitorItemDBName);

		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select IMMSensor:%s where MonitorItemSN=%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
					 charMonitorItemDBName, intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		mysqlResult = mysql_store_result(&mysqlCon);

		// Check if the amount of data = intShotSNEnd - intShotSNStart + 1 and All Values Is Not NULL
		if (mysql_num_rows(mysqlResult) == 0 || mysql_num_rows(mysqlResult) != intShotSNEnd - intShotSNStart + 1)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select IMMSensor:%s where MonitorItemSN=%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result empty or No enough data)",
					 charMonitorItemDBName, intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		// Select Max, Avg and Min Value
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT MAX(%s), AVG(%s), MIN(%s),STD(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList WHERE ShotSN >= %d AND ShotSN <= %d ",
				 charMonitorItemDBName, charMonitorItemDBName, charMonitorItemDBName, charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select Max, XBarBar and Min value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select Max, XBarBar and Min value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}

		// doubleQCUCL = atof(mysqlRow[0]);
		doubleQCCL = atof(mysqlRow[1]);
		// doubleQCLCL = atof(mysqlRow[2]);
		doubleSTD = atof(mysqlRow[3]);
		doubleQCUCL = doubleQCCL + doubleQCCLRatio * doubleSTD;
		doubleQCLCL = doubleQCCL - doubleQCCLRatio * doubleSTD;
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS)
	{
		// Select MOCustomSensor RawData by Given MOCustomSensorSN
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN, %s FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN >= %d AND ShotSN <= %d AND %s IS NOT NULL ORDER BY ShotSN ASC",
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN, intShotSNStart, intShotSNEnd, charMonitorItemDBName);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select MOCustomSensorSN:%d where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensor%d (%d):%s",
					 intMonitorItemSensorSN, intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 intMonitorItemSensorSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		mysqlResult = mysql_store_result(&mysqlCon);

		// Check if the amount of data = the sample size * group size and All Values Is Not NULL
		if (mysql_num_rows(mysqlResult) == 0 || mysql_num_rows(mysqlResult) != intShotSNEnd - intShotSNStart + 1)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select MOCustomSensorSN:%d where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensor%d (Result empty or No enough data):",
					 intMonitorItemSensorSN, intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 intMonitorItemSensorSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysql_free_result(mysqlResult);

		// Select Max, Avg and Min
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT MAX(%s), AVG(%s), MIN(%s),STD(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN >= %d AND ShotSN <= %d ",
				 charMonitorItemDBName, charMonitorItemDBName, charMonitorItemDBName, charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intMonitorItemSensorSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select Max, XBarBar and Min value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 intMonitorItemSensorSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select Max, XBarBar and Min value value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (Result Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}

		// doubleQCUCL = atof(mysqlRow[0]);
		doubleQCCL = atof(mysqlRow[1]);
		// doubleQCLCL = atof(mysqlRow[2]);
		doubleSTD = atof(mysqlRow[3]);
		doubleQCUCL = doubleQCCL + doubleQCCLRatio * doubleSTD;
		doubleQCLCL = doubleQCCL - doubleQCCLRatio * doubleSTD;
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_SOFT)
	{
		// Select MOCustomSensor RawData From Table SoftSensor
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN, %s FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d AND %s IS NOT NULL ORDER BY ShotSN ASC",
				 charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd, charMonitorItemDBName);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select SoftSensor data where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		mysqlResult = mysql_store_result(&mysqlCon);

		// Check if the amount of data = the sample size * group size and All Values Is Not NULL
		if (mysql_num_rows(mysqlResult) == 0 || mysql_num_rows(mysqlResult) != intShotSNEnd - intShotSNStart + 1)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select SoftSensor data where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (Result empty or No enough data):",
					 intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysql_free_result(mysqlResult);

		// Select Max, XBarBar and Min Value
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT MAX(%s), AVG(%s), MIN(%s),STD(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d ",
				 charMonitorItemDBName, charMonitorItemDBName, charMonitorItemDBName, charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select Max, XBarBar and Min value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_InsertQCCL]Fail to select Max, XBarBar and Min  value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (Result Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		// doubleQCUCL = atof(mysqlRow[0]);
		doubleQCCL = atof(mysqlRow[1]);
		// doubleQCLCL = atof(mysqlRow[2]);
		doubleSTD = atof(mysqlRow[3]);
		doubleQCUCL = doubleQCCL + doubleQCCLRatio * doubleSTD;
		doubleQCLCL = doubleQCCL - doubleQCCLRatio * doubleSTD;
	}

	// doubleQCUCL *= doubleQCCLRatio;
	// doubleQCCL *= doubleQCCLRatio;
	// doubleQCLCL *= doubleQCCLRatio;

	// Insert a new QCCL to MOControlLineList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList "
			 "(MonitorItemSN,	QCShotSNStart,	QCShotSNEnd,	QCCLRatioStatic,	QCUCL,	QCCL,	QCLCL) VALUE "
			 "(%d,		%d,				%d,				%lf,	%lf,				%lf,	%lf) "
			 "ON DUPLICATE KEY UPDATE "
			 "QCShotSNStart = %d,	QCShotSNEnd = %d, QCCLRatioStatic = %lf, QCUCL = %lf, QCCL = %lf, QCLCL = %lf",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 intMonitorItemSN, intShotSNStart, intShotSNEnd, doubleQCCLRatio, doubleQCUCL, doubleQCCL, doubleQCLCL,
			 intShotSNStart, intShotSNEnd, doubleQCCLRatio, doubleQCUCL, doubleQCCL, doubleQCLCL);
	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[QC_InsertQCCL]Fail to insert QC (MonitorItemSN:%d) to table %s_%s_%s_%d_Info_Meta.MOControlLineList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int QC_CopyAllMonitorItemSN(MYSQL mysqlCon, unsigned int intSourceMOSN, unsigned int intDestinationMOSN)
//[QC]Copy All SPC Configurations from Source MO to Destinated MO
{
	if (QC_CopyQCEnable(mysqlCon, intSourceMOSN, intDestinationMOSN) != EXIT_SUCCESS)
		return EXIT_FAILURE;
	if (QC_CopyQCControlLine(mysqlCon, intSourceMOSN, intDestinationMOSN) != EXIT_SUCCESS)
		return EXIT_FAILURE;
}

int QC_CopyQCControlLine(MYSQL mysqlCon, unsigned int intSourceMOSN, unsigned int intDestinationMOSN)
//[QC]Copy All Quality Control Control Lines from Source MO to Destinated MO
{
	int intRetval;
	unsigned int intIMMSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intRowSize;
	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intMonitorItemIndex;
	double doubleQCUCL, doubleQCCL, doubleQCLCL;

	// Select Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN,QCUCL,QCCL,QCLCL FROM %s_%s_%s_%d_Info_Meta.MOControlLineList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_CopyQCControlLine]Fail to select all MonitorItemSN control line from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	intRowSize = (unsigned int)mysql_num_rows(mysqlResult);

	// For All MonitorItemSN Monitor Item
	for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
	{
		if (mysqlRow[0] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_CopyQCControlLine]Source MonitorItemSN is null from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, ERRCLASS_DB, charErrMsg);
			return intLogSN;
		}
		else
			intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;

		if (mysqlRow[1] == NULL || mysqlRow[2] == NULL || mysqlRow[3] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_CopyQCControlLine]XBar control line of source MonitorItemSN:%d is null from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
					 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, ERRCLASS_DB, charErrMsg);
			return intLogSN;
		}
		else
		{
			doubleQCUCL = atof(mysqlRow[1]);
			doubleQCCL = atof(mysqlRow[2]);
			doubleQCLCL = atof(mysqlRow[3]);
		}

		fprintf(stderr, "MonintorItemSN:%d QCUCL:%lf QCCL:%lf QCLCL:%lf\n",
				intMonitorItemSN, doubleQCUCL, doubleQCCL, doubleQCLCL);

		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s_%d_Info_Meta.MOControlLineList SET QCUCL = %lf, QCCL = %lf ,QCLCL = %lf WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, doubleQCUCL, doubleQCCL, doubleQCLCL, intMonitorItemSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_CopyQCControlLine]Fail to update MonitorItemSN control line from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intDestinationMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	return EXIT_SUCCESS;
}

int QC_CopyQCEnable(MYSQL mysqlCon, unsigned int intSourceMOSN, unsigned int intDestinationMOSN)
//[QC]Copy All QCEnable of each MonitorItemSN from Source MO to Destinated MO
{
	int intRetval;
	unsigned int intIMMSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	int intRowSize;
	int intMonitorItemSN;
	int intQCEnable;

	// Select All Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN, QCEnable FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_CopyQCEnable]Fail to select SPC configurations of all MonitorItemSN  from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	intRowSize = (unsigned int)mysql_num_rows(mysqlResult);

	// For All MonitorItemSN Monitor Item
	for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
	{
		if (mysqlRow[0] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_CopyQCEnable]Source MonitorItemSN is null from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, ERRCLASS_DB, charErrMsg);
			return intLogSN;
		}
		else
			intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;

		if (mysqlRow[1] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_CopyQCEnable] QC configurations is null of source MonitorItemSN:%d is null from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
					 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, ERRCLASS_DB, charErrMsg);
			return intLogSN;
		}
		else
		{
			intQCEnable = atoi(mysqlRow[1]);
		}

		// fprintf(stderr, "[QC_CopyQCEnable]MonintorItemSN:%d QEnable:%d\n",intMonitorItemSN, intQCEnable);

		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET QCEnable = %d WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, intQCEnable, intMonitorItemSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_CopyQCEnable]Fail to update MonitorItemSN control line from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intDestinationMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	return EXIT_SUCCESS;
}

int QC_SelectQCXBarValue(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMonitorItemSN, unsigned int intShotSN, unsigned int intFetchSize, double **doubleXBarValue)
//[QC]Select X Bar Value of A Specified ShotSN in An Existing MO for Quality Control
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intShotSNStart;
	unsigned int intShotSNEnd;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intSPCSensorMonitorIndex;

	char charMonitorItemDBName[SMALL_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Select All SPC Monitor Item Configuration According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_SelectQCXBarValue]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_SelectQCXBarValue]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList. (No Such MonitorItemSN)",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
		return intLogSN;
	}

	intMonitorItemClass = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
	// fprintf(stderr, "intMonitorItemClass:%d\n", intMonitorItemClass);
	intMonitorItemSensorSN = mysqlRow[1] != NULL ? atoi(mysqlRow[1]) : 0;
	// fprintf(stderr, "intMonitorItemSensorSN:%d\n", intMonitorItemSensorSN);
	intSPCSensorMonitorIndex = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
	// fprintf(stderr, "intSPCSensorMonitorIndex:%d\n", intSPCSensorMonitorIndex);

	intShotSNEnd = intShotSN;
	intShotSNStart = intShotSNEnd - intFetchSize + 1;

	// fprintf(stderr,"Start:%d End:%d\n",intShotSNStart,intShotSNEnd);
	if (intShotSNStart <= 0)
	{
#ifdef DEBUG_MODE
		fprintf(stderr,
				"[QC_SelectQCXBarValue]MOSN:%d MonitorItemSN:%d ShotSN:%d have no enough data for group size:%d, thus no X bar value",
				intMOSN, intMonitorItemSN, intShotSN, intFetchSize);
#endif
		return EXIT_SUCCESS;
	}

	// Get Name by Given MonitorItemSN
	intRetval = DB_SelectMonitorItemDBName(mysqlCon, intMOSN, intMonitorItemSN, charMonitorItemDBName);
	// fprintf(stderr, "intMonitorItemName:%s\n", charMonitorItemDBName);

	if (intMonitorItemClass == MONITOR_ITEM_CLASS_QUALITY)
	{
		return EXIT_SUCCESS;
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_OPCUA)
	{
		// Select XBar Value
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN,%s FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN DESC",
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSNStart, intShotSNEnd);

		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_SelectQCXBarValue]Fail to select XBar value of IMMSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);

		// Check The Amount Select == Fetch Size
		if (mysql_num_rows(mysqlResult) != intFetchSize)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_SelectQCXBarValue]Fail to select XBar value of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result empty or No enough data)",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
			return intLogSN;
		}

		*doubleXBarValue = (double *)malloc(sizeof(double) * intFetchSize);
		for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
		{
			if (mysqlRow[1] != NULL)
			{
				*((*doubleXBarValue) + i) = atof(mysqlRow[1]);
				// fprintf(stderr, "XBarValue[%d]:%lf\n", i, *((*doubleXBarValue) + i));
			}
			else
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[QC_SelectQCXBarValue]Fail to select XBar value(NULL) of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result empty or No enough data)",
						 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
				return intLogSN;
			}
		}
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS)
	{
		// Select XBar Value

		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN,%s FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN DESC",
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_SelectQCXBarValue]Fail to select XBar value of MOCustomSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);

		// Check The Amount Select == Fetch Size
		if (mysql_num_rows(mysqlResult) != intFetchSize)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_SelectQCXBarValue]Fail to select XBar value of MOCustomSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (Result empty or No enough data)",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
			return intLogSN;
		}

		*doubleXBarValue = (double *)malloc(sizeof(double) * intFetchSize);
		for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
		{
			if (mysqlRow[1] != NULL)
			{
				*((*doubleXBarValue) + i) = atof(mysqlRow[1]);
				// fprintf(stderr, "XBarValue[%d]:%lf\n", i, *((*doubleXBarValue) + i));
			}
			else
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[QC_SelectQCXBarValue]Fail to select XBar value(NULL) of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result empty or No enough data)",
						 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
				return intLogSN;
			}
		}
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_SOFT)
	{
		// Select XBar Value
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN,%s FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN DESC",
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);

		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_SelectQCXBarValue]Fail to select XBar value of IMMSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		if (mysql_num_rows(mysqlResult) != intFetchSize)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[QC_SelectQCXBarValue]Fail to select XBar value of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (Result empty or No enough data)",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
			return intLogSN;
		}

		*doubleXBarValue = (double *)malloc(sizeof(double) * intFetchSize);
		for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
		{
			if (mysqlRow[1] != NULL)
			{
				*((*doubleXBarValue) + i) = atof(mysqlRow[1]);
				// fprintf(stderr, "XBarValue[%d]:%lf\n", i, *((*doubleXBarValue) + i));
			}
			else
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[QC_SelectQCXBarValue]Fail to select XBar value(NULL) of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (Result empty or No enough data)",
						 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
				return intLogSN;
			}
		}
	}
	// for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
	//{
	//	fprintf(stderr, "XBarValue[%d]:%lf\n", i, *((*doubleXBarValue) + i));
	// }
	return EXIT_SUCCESS;
}

int QC_InsertQCAlarm(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN)
//[QC]Insert Quality Alarm of A Specified ShotSN in An Existing MO
{
	int intRetval;
	unsigned int intIMMSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intRowSize;
	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intMonitorItemIndex;

	double doubleQCUCL;
	double doubleQCCL;
	double doubleQCLCL;
	double doubleQCCLRatio;
	double doubleQCAlarmDiff;
	char *charQCAlarmSN;
	unsigned int intQualityControlAlarmSN;
	// int intSPCAlarm;
	int intQualityControlAlarm;
	char charQualityControlAlarm[5];
	int intSPCRAlarm;
	char charMonitorItemDBName[SMALL_STRING_SIZE];

	double *doubleXValue;
	bool boolQCCLIsNULL = false;

	// Select All Enable SPC Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT %s_%s_%s_%d_Info_Config.MonitorItemSNList.MonitorItemSN,"	// 0
			 "MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex,QCCLRatio," // 1~4
			 "QCUCL,QCCL,QCLCL "												// 5~7
			 "FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList, %s_%s_%s_%d_Info_Meta.MOControlLineList "
			 "WHERE %s_%s_%s_%d_Info_Config.MonitorItemSNList.MonitorItemSN = %s_%s_%s_%d_Info_Meta.MOControlLineList.MonitorItemSN AND %s_%s_%s_%d_Info_Config.MonitorItemSNList.QCEnable = 1",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[QC_InsertQCAlarm]Fail to select all MonitorItemSN control line where QCEnable = 1 from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	intRowSize = (unsigned int)mysql_num_rows(mysqlResult);

	for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
	{
		intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
		intMonitorItemClass = mysqlRow[1] != NULL ? atoi(mysqlRow[1]) : 0;
		intMonitorItemSensorSN = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
		intMonitorItemIndex = mysqlRow[3] != NULL ? atoi(mysqlRow[3]) : 0;
		doubleQCCLRatio = mysqlRow[4] != NULL ? atof(mysqlRow[4]) : 0;

		if (mysqlRow[5] == NULL || mysqlRow[6] == NULL || mysqlRow[7] == NULL)
		{
			boolQCCLIsNULL = true;
		}
		else
		{
			doubleQCUCL = mysqlRow[5] != NULL ? atof(mysqlRow[5]) : 0;
			doubleQCCL = mysqlRow[6] != NULL ? atof(mysqlRow[6]) : 0;
			doubleQCLCL = mysqlRow[7] != NULL ? atof(mysqlRow[7]) : 0;
		}

		DB_SelectMonitorItemDBName(mysqlCon, intMOSN, intMonitorItemSN, charMonitorItemDBName);
		// fprintf(stderr, "ShotSN:%d MonitorItemSN:%d intShotSN:%s\n", intShotSN, intMonitorItemSN, charMonitorItemDBName);
		// fprintf(stderr, "MonitorItemSN:%d QCUCL:%lf QCCL:%lf QCLCL:%lf\n", intMonitorItemSN, doubleQCUCL, doubleQCCL, doubleQCLCL);

		// Fetch XBar Value
		intRetval = QC_SelectQCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleXValue);
		if (intRetval != EXIT_SUCCESS)
			return EXIT_SUCCESS;
		else
		{

			// Insert QC X Value to QCChartData
			/*
			snprintf(charStatement, MAX_STRING_SIZE,
					 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.QCChartData (MonitorItemSN,ShotSN,X) VALUE (%d,%d,%lf)",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN, intShotSN, *doubleXValue);

			intRetval = mysql_query(&mysqlCon, charStatement);
			if (intRetval != EXIT_SUCCESS)
			{

				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[QC_InsertQCAlarm]Fail to insert X value for ShotSN:%d into %s_%s_%s_%d_RawData_ChartData.QCChartData (%d):%s",
						 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
				//fprintf(stderr, "Q:%s\n", charStatement);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
			}*/

			// If QC Control Line Is Not NULL,Then Use SPC Rule1 To Judge
			if (boolQCCLIsNULL != true)
			{
				// Use SPC Rule1 XBar To
				SPC_Rule1(doubleXValue, doubleQCUCL, doubleQCLCL, &intQualityControlAlarm);

				// Display The SPC Result
				if (intQualityControlAlarm == 1)
				{
					fprintf(stderr, "Quality Control Result:%d(too high) Value:%lf > UCL:%lf\n", intQualityControlAlarm, *doubleXValue, doubleQCUCL);
					doubleQCAlarmDiff = *doubleXValue - doubleQCUCL;
				}
				else if (intQualityControlAlarm == -1)
				{
					fprintf(stderr, "Quality Control Result:%d(too low) Value:%lf < LCL:%lf\n", intQualityControlAlarm, *doubleXValue, doubleQCLCL);
					doubleQCAlarmDiff = *doubleXValue - doubleQCLCL;
				}
				else
				{
					fprintf(stderr, "Quality Control Result:%d(pass) UCL:%lf > Value:%lf > LCL:%lf\n", intQualityControlAlarm, doubleQCUCL, *doubleXValue, doubleQCLCL);
					doubleQCAlarmDiff = 0;
				}
			}

			// Insert Into Database If and Only If the SPC Alarm Is Triggered
			if (intQualityControlAlarm != 0)
			{
				snprintf(charStatement, MAX_STRING_SIZE, "%s_%s_%s_%d_RawData_Alarm.QualityControlAlarmLog",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
				intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "QualityControlAlarmSN", &charQCAlarmSN);
				if (intRetval == EXIT_FAILURE)
					return EXIT_FAILURE;
				intQualityControlAlarmSN = atoi(charQCAlarmSN) + 1;

				// Insert THe SPC Result into Database
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_Alarm.QualityControlAlarmLog "
						 "(QualityControlAlarmSN,	ShotSN,				MonitorItemSN,			QualityControlAlarm,"
						 "QualityControlUCL,		QualityControlLCL,	QualityControlXValue,	QualityControlXDiff, QualityControlAlarmTime) VALUE "
						 "(%d,%d,%d,%d,%lf,%lf,%lf,%lf,NOW())",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
						 intQualityControlAlarmSN, intShotSN, intMonitorItemSN, intQualityControlAlarm, doubleQCUCL, doubleQCLCL, *doubleXValue, doubleQCAlarmDiff);

				// fprintf(stderr, "[QC_InsertQCAlarm]:%s\n", charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[QC_InsertQCAlarm]Fail to insert QC Alarm for ShotSN:%d MonitorItemSN:%d into  %s_%s_%s_%d_RawData_Alarm.QualityControlAlarmLog (%d):%s",
							 intShotSN, intMonitorItemSN,
							 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
							 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
					// return intLogSN;
				}
			}
		}
	}
	mysql_free_result(mysqlResult);

	return EXIT_SUCCESS;
}

int QC_UpdateQCAlarmRead(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intQualityControlAlarmSN, bool boolQualityControlAlarmRead)
//[QC]Update A Specified Quality Control Alarm as Read

{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	if (boolQualityControlAlarmRead == false || boolQualityControlAlarmRead == true)
	{
		// Update QualityControlAlarmRead
		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_RawData_Alarm.QualityControlAlarmLog SET QualityControlAlarmRead=%d WHERE QualityControlAlarmSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, boolQualityControlAlarmRead, intQualityControlAlarmSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[QC_UpdateQCAlarmRead]Fail to set QualityControlAlarmSN:%d as read in %s_%s_%s_%d_RawData_Alarm.QualityControlAlarmLog (%d):%s",
					 intQualityControlAlarmSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		else
		{
			return EXIT_SUCCESS;
		}
	}
	else
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[QC_UpdateQCAlarmRead]Parameter boolQualityControlAlarmRead should be true or false");
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
}

//[SPC]

int SPC_ConfigMonitorItemSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMonitorItemSN, unsigned int intSPCSampleSize, unsigned int intSPCGroupSize, double doubleSPCCLRatio, bool boolSPCRule[8])
//[SPC]Config Sample Size,Group Size, Control Line Ratio of A Specified Monitor Item in An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	bool boolintMonitorItemSNEnable = 0;
	unsigned int intShotSN;

	if (intSPCGroupSize < 1)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_ConfigMonitorItemSN]Fail to update MonitorItemSN:%d configuration to table %s_%s_%s_%d_Info_Config.MonitorItemSNList due to group size must > 1",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	if (intSPCSampleSize < 2)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_ConfigMonitorItemSN]Fail to update MonitorItemSN:%d configuration to table %s_%s_%s_%d_Info_Config.MonitorItemSNList due to sample size must >= 2",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// If Rule 1 Is Disable Then All Rule Must Be Disable
	if (boolSPCRule[0] == 0)
	{
		boolintMonitorItemSNEnable = 0;
		for (int i = 1; i < 8; i++)
		{
			if (boolSPCRule[i] != 0)
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[SPC_ConfigMonitorItemSN]Fail to update MonitorItemSN:%d configuration to table %s_%s_%s_%d_Info_Config.MonitorItemSNList due to Rule1 is Disable and some other Rule is Enable",
						 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
				return intLogSN;
				// boolSPCRule[i] = 0;
			}
		}
	}
	else
		boolintMonitorItemSNEnable = 1;

	intRetval = DB_SelectShotSNbyMOSN(mysqlCon, intMOSN, &intShotSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_ConfigMonitorItemSN]Fail to select ShotSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Brand New MO
	if (intShotSN == 1)
	{
		// Insert The Configuration of Such SPC Monitor Item
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET "
				 "SPCEnable = %d,"
				 "SPCSampleSize = %d,"
				 "SPCGroupSize = %d,"
				 "SPCCLRatio = %lf,"
				 "SPCRule1 = %d,"
				 "SPCRule2 = %d,"
				 "SPCRule3 = %d,"
				 "SPCRule4 = %d,"
				 "SPCRule5 = %d,"
				 "SPCRule6 = %d,"
				 "SPCRule7 = %d,"
				 "SPCRule8 = %d "
				 "WHERE MonitorItemSN = %d ",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 boolintMonitorItemSNEnable,
				 intSPCSampleSize,
				 intSPCGroupSize,
				 doubleSPCCLRatio,
				 boolSPCRule[0], boolSPCRule[1], boolSPCRule[2], boolSPCRule[3],
				 boolSPCRule[4], boolSPCRule[5], boolSPCRule[6], boolSPCRule[7],
				 intMonitorItemSN);
	}
	else
	{
		// Insert The Configuration of Such SPC Monitor Item
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET "
				 "SPCEnable = %d,"
				 "SPCGroupSize = %d,"
				 "SPCCLRatio = %lf,"
				 "SPCRule1 = %d,"
				 "SPCRule2 = %d,"
				 "SPCRule3 = %d,"
				 "SPCRule4 = %d,"
				 "SPCRule5 = %d,"
				 "SPCRule6 = %d,"
				 "SPCRule7 = %d,"
				 "SPCRule8 = %d "
				 "WHERE MonitorItemSN = %d ",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 boolintMonitorItemSNEnable,
				 intSPCGroupSize,
				 doubleSPCCLRatio,
				 boolSPCRule[0], boolSPCRule[1], boolSPCRule[2], boolSPCRule[3],
				 boolSPCRule[4], boolSPCRule[5], boolSPCRule[6], boolSPCRule[7],
				 intMonitorItemSN);
	}

	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_ConfigMonitorItemSN]Fail to update MonitorItemSN:%d configuration to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int SPC_ConfigAllMonitorItemSN(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intSPCSampleSize, unsigned int intSPCGroupSize, double doubleSPCCLRatio)
//[SPC]Config All Sample Size, Group Size and Control Ratio of All Monitor Items in An Existing MO
{

	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	bool boolintMonitorItemSNEnable = 0;
	unsigned int intShotSN;

	if (intSPCGroupSize < 1)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_ConfigAllMonitorItemSN]Fail to update all MonitorItemSN configuration to table %s_%s_%s_%d_Info_Config.MonitorItemSNList due to group size must > 1",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	if (intSPCSampleSize < 2)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_ConfigAllMonitorItemSN]Fail to update all MonitorItemSN configuration to table %s_%s_%s_%d_Info_Config.MonitorItemSNList due to sample size must >= 2",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	intRetval = DB_SelectShotSNbyMOSN(mysqlCon, intMOSN, &intShotSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_ConfigAllMonitorItemSN]Fail to select ShotSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	// Brand New MO
	if (intShotSN == 1)
	{
		// Insert The Configuration of Such SPC Monitor Item
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET SPCSampleSize = %d, SPCGroupSize = %d, SPCCLRatio = %lf",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intSPCSampleSize, intSPCGroupSize, doubleSPCCLRatio);
	}
	else
	{
		// Insert The Configuration of Such SPC Monitor Item
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET SPCGroupSize = %d, SPCCLRatio = %lf",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intSPCGroupSize, doubleSPCCLRatio);
	}

	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_ConfigAllMonitorItemSN]Fail to update all MonitorItemSN configuration to table %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int SPC_SelectSPCProgressFlag(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int *intSPCProgressFlag)
//[SPC]Select SPC Progress Flag of An Existing MO
{
	int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT SPCProgressFlag FROM %s_%s_%s_%d_RawData.ShotSNList WHERE ShotSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSN);
	// fprintf(stderr, "Q:%s\n", charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_SelectSPCProgressFlag]Fail to select SPCProgressFlag for ShotSN:%d in table %s_%s_%s_%d_RawData.ShotSNList (%d): %s",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_SelectSPCProgressFlag]Fail to select SPCProgressFlag ShotSN=%d from %s_%s_%s_%d_RawData.ShotSNList",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		mysql_free_result(mysqlResult);
		return intLogSN;
	}
	else if (mysqlRow[0] == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_SelectSPCProgressFlag]Fail to select SPCProgressFlag ShotSN=%d from %s_%s_%s_%d_RawData.ShotSNList (SPCProgressFlag == NULL)",
				 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		mysql_free_result(mysqlResult);
		return intLogSN;
	}
	else
	{
		*intSPCProgressFlag = atoi(mysqlRow[0]);
		mysql_free_result(mysqlResult);
		return EXIT_SUCCESS;
	}
}

int SPC_TriggerSPCProgressFlag(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN, unsigned int intSPCProgressFlagBit)
//[SPC]Trigger SPC Progress Flag of An Existing MO
{
	int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	char charErrMsg[LONG_STRING_SIZE];

	snprintf(charStatement, MAX_STRING_SIZE,
			 "UPDATE %s_%s_%s_%d_RawData.ShotSNList Set SPCProgressFlag = SPCProgressFlag ^ %d WHERE ShotSN = %d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intSPCProgressFlagBit, intShotSN);
	// fprintf(stderr,"Q:%s\n",charStatement);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_TriggerSPCProgressFlag]Fail to update SPCProgressFlag (Bit:%d) for ShotSN:%d in table %s_%s_%s_%d_RawData.ShotSNList (%d): %s",
				 intSPCProgressFlagBit, intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int SPC_InsertAllSPCCL(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSNEnd)
//[SPC]Insert SPC Control Lines for All Monitor Items in An Existing MO
{
	int intRetval;
	unsigned int intIMMSN;
	char charErrMsg[LONG_STRING_SIZE];
	char charSummaryErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	unsigned int intMonitorItemSN;
	unsigned int intExitStatus;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	intRetval = DB_SelectIMMSNbyMOSN(mysqlCon, intMOSN, &intIMMSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_InsertAllSPCCL]Fail to select IMMSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Select All MonitorItemSN of Given MOSN
	// snprintf(charStatement, MAX_STRING_SIZE,
	//		 "SELECT MonitorItemSN FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE SPCEnable = 1 ORDER BY MonitorItemSN ASC",
	//		 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList ORDER BY MonitorItemSN ASC",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_InsertAllSPCCL]Fail to select all MonitorItemSN from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	snprintf(charSummaryErrMsg, MAX_STRING_SIZE, "[SPC_InsertAllSPCCL]Fail to caculate SPCCL for MOSN:%d MonitorItemSN:", intMOSN);

	mysqlResult = mysql_store_result(&mysqlCon);
	while ((mysqlRow = mysql_fetch_row(mysqlResult)) != NULL)
	{
		intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
		fprintf(stderr, "[SPC_InsertAllSPCCL]Caculate SPCCL for MOSN:%d MonitorItemSN:%d ShotSNEnd:%d\n", intMOSN, intMonitorItemSN, intShotSNEnd);
		if (intMonitorItemSN == 0)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertAllSPCCL]Fail to convert MonitorItemSN:%s to integer from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 mysqlRow[0], SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			intExitStatus = EXIT_FAILURE;
			snprintf(charSummaryErrMsg + strlen(charSummaryErrMsg), MAX_STRING_SIZE, "%d ", intMonitorItemSN);
			continue;
		}

		intRetval = SPC_InsertSPCCL(mysqlCon, intMOSN, intMonitorItemSN, intShotSNEnd);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertAllSPCCL]Fail to select caculate SPC control line for MonitorItemSN:%d EndShotSN:%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 intMonitorItemSN, intShotSNEnd, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			intExitStatus = EXIT_FAILURE;
			snprintf(charSummaryErrMsg + strlen(charSummaryErrMsg), MAX_STRING_SIZE, "%d ", intMonitorItemSN);
		}
	}
	snprintf(charSummaryErrMsg + strlen(charSummaryErrMsg), MAX_STRING_SIZE, "\n");

	//======================================================[TEMP]============================================================
	int intShotSNStart;

	// Set intShotSNStart
	intShotSNStart = intShotSNEnd - 2 + 1;
	intRetval = EC_InsertAllECCL(mysqlCon, intMOSN, intShotSNStart, intShotSNEnd);
	// intRetval = QC_InsertAllQCCL(mysqlCon, intMOSN, intShotSNStart, intShotSNEnd);
	//======================================================[TEMP]============================================================

	mysql_free_result(mysqlResult);
	if (intExitStatus == EXIT_FAILURE)
	{
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charSummaryErrMsg);
		return intLogSN;
	}
	else
	{
		return EXIT_SUCCESS;
	}
}

int SPC_InsertSPCCL(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMonitorItemSN, unsigned int intShotSNEnd)
//[SPC]Insert SPC Control Line for A Specified Monitor Item in An Existing MO
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intIMMSN;
	double doubleSPCCLRatio;

	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intSPCSensorMonitorIndex;
	unsigned int intSPCSampleSize;
	unsigned int intSPCGroupSize;
	char charMonitorItemDBName[SMALL_STRING_SIZE];
	unsigned int intCustomSensorCategory;
	unsigned int intRoundSNStart;
	unsigned int intRoundSNEnd;
	unsigned int intShotSNStart;
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	double doubleXBarSTD;
	double doubleRSTD;
	double doubleXBarBar;
	double doubleRBar;
	double doubleA2[26] = {0, 0, 1.880, 1.023, 0.729, 0.577, 0.483, 0.419, 0.373, 0.337, 0.308, 0.285, 0.266, 0.249, 0.235, 0.223, 0.212, 0.203, 0.194, 0.187, 0.180, 0.173, 0.167, 0.162, 0.157, 0.153};
	double doubleD3[26] = {0, 0, 0, 0, 0, 0, 0, 0.076, 0.136, 0.184, 0.223, 0.256, 0.283, 0.307, 0.328, 0.347, 0.363, 0.378, 0.391, 0.403, 0.415, 0.425, 0.434, 0.443, 0.451, 0.459};
	double doubleD4[26] = {0, 0, 3.267, 2.575, 2.282, 2.115, 2.004, 1.924, 1.864, 1.816, 1.777, 1.744, 1.717, 1.693, 1.672, 1.653, 1.637, 1.622, 1.608, 1.597, 1.585, 1.575, 1.566, 1.557, 1.548, 1.541};
	double doubleXUCL;
	double doubleXCL;
	double doubleXLCL;
	double doubleRUCL;
	double doubleRCL;
	double doubleRLCL;

	intRetval = DB_SelectIMMSNbyMOSN(mysqlCon, intMOSN, &intIMMSN);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_InsertSPCCL]Fail to select IMMSN for MOSN:%d", intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	// Select All Enable SPC Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex,SPCCLRatio, SPCSampleSize,SPCGroupSize FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_InsertSPCCL]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_InsertSPCCL]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList. (No Such MonitorItemSN)",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	intMonitorItemClass = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
	// fprintf(stderr, "intMonitorItemClass:%d\n", intMonitorItemClass);
	intMonitorItemSensorSN = mysqlRow[1] != NULL ? atoi(mysqlRow[1]) : 0;
	// fprintf(stderr, "intMonitorItemSensorSN:%d\n", intMonitorItemSensorSN);
	intSPCSensorMonitorIndex = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
	// fprintf(stderr, "intSPCSensorMonitorIndex:%d\n", intSPCSensorMonitorIndex);
	doubleSPCCLRatio = mysqlRow[3] != NULL ? atof(mysqlRow[3]) : 0;
	// fprintf(stderr, "doubleSPCCLRatio:%lf\n", doubleSPCCLRatio);
	intSPCSampleSize = mysqlRow[4] != NULL ? atoi(mysqlRow[4]) : 0;
	// fprintf(stderr, "intSPCSampleSize:%d\n", intSPCSampleSize);
	intSPCGroupSize = mysqlRow[5] != NULL ? atoi(mysqlRow[5]) : 0;
	// fprintf(stderr, "intSPCGroupSize:%d\n", intSPCGroupSize);
	mysql_free_result(mysqlResult);

	// Set intShotSNStart
	intShotSNStart = intShotSNEnd - intSPCSampleSize * intSPCGroupSize + 1;

#ifdef ENABLE_SPCCL_ROUNDSN_CHECK

	// Check If the RoundSN of First ShotSN and The Last ShotSN Are the Same
	intRetval = DB_SelectRoundSNbyShotSN(mysqlCon, intMOSN, intShotSNStart, &intRoundSNStart);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_InsertSPCCL]Fail to select RoundSN for ShotSNStart:%d from table %s_%s_%s_%d_RawData.ShotSNList",
				 intShotSNStart, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	intRetval = DB_SelectRoundSNbyShotSN(mysqlCon, intMOSN, intShotSNEnd, &intRoundSNEnd);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_InsertSPCCL]Fail to select RoundSN for ShotSNStart:%d from table %s_%s_%s_%d_RawData.ShotSNList",
				 intRoundSNEnd, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

	if (intRoundSNStart != intRoundSNEnd)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_InsertSPCCL]ShotSNStart:%d RoundSNStart:%d And ShotSNEnd:%d RoundSNEnd:%d are not the same in the table %s_%s_%s_%d_RawData.ShotSNList",
				 intShotSNStart, intRoundSNStart, intShotSNEnd, intRoundSNEnd, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
		return intLogSN;
	}

#endif

	// Get Name by Given MonitorItemSN
	intRetval = DB_SelectMonitorItemDBName(mysqlCon, intMOSN, intMonitorItemSN, charMonitorItemDBName);
	// fprintf(stderr, "intMonitorItemName:%s\n", charMonitorItemDBName);

	// Handle Various Categories of SPC Monitor Item
	if (intMonitorItemClass == MONITOR_ITEM_CLASS_QUALITY)
	{
		return EXIT_SUCCESS;
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_OPCUA) // Select IMM Sensor Data from ShotSNStart to ShotSNEnd
	{
		// Select IMMSensor Value by Given IMMSensorSN
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN %s FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList "
				 "WHERE ShotSN >= %d AND ShotSN <= %d AND %s IS NOT NULL ORDER BY ShotSN",
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd, charMonitorItemDBName);

		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select IMMSensor:%s where MonitorItemSN=%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
					 charMonitorItemDBName, intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);

		// Check if the amount of data = the sample size * group size and All Values Is Not NULL
		if (mysql_num_rows(mysqlResult) == 0 || mysql_num_rows(mysqlResult) != intSPCSampleSize * intSPCGroupSize)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select IMMSensor:%s where MonitorItemSN=%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result empty or No enough data)",
					 charMonitorItemDBName, intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysql_free_result(mysqlResult);

		// Select XBarBar and STD
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT AVG(%s), STD(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList WHERE ShotSN >= %d AND ShotSN <= %d ",
				 charMonitorItemDBName, charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select XBarBar and STD value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select XBarBar, Max, Min and STD value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		doubleXBarBar = atof(mysqlRow[0]);
		doubleXBarSTD = atof(mysqlRow[1]);
		mysql_free_result(mysqlResult);

		// Select RBar Value
		mysql_query(&mysqlCon, "set @RowSN:=-1");
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT AVG(R), STD(R) FROM("
				 "	SELECT MAX(%s) - MIN(%s) AS R FROM("
				 "		SELECT @RowSN:= @RowSN + 1 AS RowSN, @RowSN DIV %d AS GroupSN, ShotSN, %s FROM("
				 "			SELECT ShotSN, %s FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN ASC"
				 " 		)AS SortedTable"
				 "	)AS GroupedTable"
				 "	GROUP BY GroupSN"
				 ") AS RTable",
				 charMonitorItemDBName, charMonitorItemDBName,
				 intSPCSampleSize, charMonitorItemDBName,
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select RBar Value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select RBar Value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		doubleRBar = atof(mysqlRow[0]);
		doubleRSTD = atof(mysqlRow[1]);
		mysql_free_result(mysqlResult);
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS)
	{
		// Select MOCustomSensor RawData by Given MOCustomSensorSN
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN %s FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN >= %d AND ShotSN <= %d AND %s IS NOT NULL ORDER BY ShotSN ASC",
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN, intShotSNStart, intShotSNEnd, charMonitorItemDBName);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select MOCustomSensorSN:%d where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensor%d (%d):%s",
					 intMonitorItemSensorSN, intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 intMonitorItemSensorSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);

		// Check if the amount of data = the sample size * group size and All Values Is Not NULL
		if (mysql_num_rows(mysqlResult) == 0 || mysql_num_rows(mysqlResult) != intShotSNEnd - intShotSNStart + 1)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select MOCustomSensorSN:%d where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensor%d (Result empty or No enough data):",
					 intMonitorItemSensorSN, intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 intMonitorItemSensorSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysql_free_result(mysqlResult);

		// Select XBarBar and STD
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT AVG(%s), STD(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN >= %d AND ShotSN <= %d ",
				 charMonitorItemDBName, charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intMonitorItemSensorSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select XBarBar, Max, Min and STD value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 intMonitorItemSensorSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select XBarBar, Max, Min and STD value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (Result Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		doubleXBarBar = atof(mysqlRow[0]);
		doubleXBarSTD = atof(mysqlRow[1]);
		mysql_free_result(mysqlResult);

		// Select RBar Value
		mysql_query(&mysqlCon, "set @RowSN:=-1");
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT AVG(R), STD(R) FROM("
				 "	SELECT MAX(%s) - MIN(%s) AS R FROM("
				 "		SELECT @RowSN:= @RowSN + 1 AS RowSN, @RowSN DIV %d AS GroupSN, ShotSN, %s FROM("
				 "			SELECT ShotSN, %s FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN ASC"
				 " 		)AS SortedTable"
				 "	)AS GroupedTable"
				 "	GROUP BY GroupSN"
				 ") AS RTable",
				 charMonitorItemDBName, charMonitorItemDBName,
				 intSPCSampleSize, charMonitorItemDBName,
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select RBar Value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select RBar Value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (Result Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		doubleRBar = atof(mysqlRow[0]);
		doubleRSTD = atof(mysqlRow[1]);
		mysql_free_result(mysqlResult);
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_SOFT)
	{
		// Select MOCustomSensor RawData From Table SoftSensor
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT ShotSN %s FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d AND %s IS NOT NULL ORDER BY ShotSN ASC",
				 charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd, charMonitorItemDBName);
		fprintf(stderr, "Q:%s\n", charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select SoftSensor data where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}

		mysqlResult = mysql_store_result(&mysqlCon);

		// Check if the amount of data = the sample size * group size and All Values Is Not NULL
		if (mysql_num_rows(mysqlResult) == 0 || mysql_num_rows(mysqlResult) != intShotSNEnd - intShotSNStart + 1)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select SoftSensor data where MonitorItemSN=%d (%s) from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (Result empty or No enough data):",
					 intMonitorItemSN, charMonitorItemDBName,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysql_free_result(mysqlResult);

		// Select XBarBar and STD
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT AVG(%s), STD(%s) FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d ",
				 charMonitorItemDBName, charMonitorItemDBName,
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select XBarBar and STD value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select XBarBar, Max, Min and STD value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (Result Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		doubleXBarBar = atof(mysqlRow[0]);
		doubleXBarSTD = atof(mysqlRow[1]);
		mysql_free_result(mysqlResult);

		// Select RBar Value
		mysql_query(&mysqlCon, "set @RowSN:=-1");
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT AVG(R), STD(R) FROM("
				 "	SELECT MAX(%s) - MIN(%s) AS R FROM("
				 "		SELECT @RowSN:= @RowSN + 1 AS RowSN, @RowSN DIV %d AS GroupSN, ShotSN, %s FROM("
				 "			SELECT ShotSN, %s FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN ASC"
				 " 		)AS SortedTable"
				 "	)AS GroupedTable"
				 "	GROUP BY GroupSN"
				 ") AS RTable",
				 charMonitorItemDBName, charMonitorItemDBName,
				 intSPCSampleSize, charMonitorItemDBName,
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select RBar Value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		mysqlRow = mysql_fetch_row(mysqlResult);
		if (mysqlRow == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_InsertSPCCL]Fail to select RBar Value of MonitorItemSN=%d (%s) ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (Result Empty)",
					 intMonitorItemSN, charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}
		doubleRBar = atof(mysqlRow[0]);
		doubleRSTD = atof(mysqlRow[1]);
		mysql_free_result(mysqlResult);
	}

	// doubleXUCL = doubleXBarBar + doubleA2[intSPCSampleSize] / 3.0 * doubleSPCCLRatio * doubleRBar;
	// doubleXUCL = doubleXBarBar +  3.0 * (doubleSPCCLRatio /3.0) * doubleXBarSTD / sqrt((double)(intShotSNEnd-intShotSNStart+1));
	doubleXUCL = doubleXBarBar + doubleSPCCLRatio * doubleXBarSTD;
	doubleXCL = doubleXBarBar;
	// doubleXLCL = doubleXBarBar - doubleA2[intSPCSampleSize] / 3.0 * doubleSPCCLRatio * doubleRBar;
	// doubleXLCL = doubleXBarBar -  3.0 * (doubleSPCCLRatio /3.0) * doubleXBarSTD / sqrt((double)(intShotSNEnd-intShotSNStart+1));
	doubleXLCL = doubleXBarBar - doubleSPCCLRatio * doubleXBarSTD;
	// if (doubleXLCL < 0)
	//	doubleXLCL = 0;

	// doubleRUCL = doubleD4[intSPCSampleSize] / 3.0 * doubleSPCCLRatio * doubleRBar;
	// doubleRUCL = doubleD4[intSPCSampleSize] / 3.0 * doubleSPCCLRatio * doubleRBar;
	doubleRUCL = doubleRBar + doubleSPCCLRatio * doubleRSTD;
	doubleRCL = doubleRBar;
	doubleRLCL = doubleRBar - doubleSPCCLRatio * doubleRSTD;
	if (doubleRLCL < 0)
		doubleRLCL = 0;

	// doubleRLCL = doubleD3[intSPCSampleSize] / 3.0 * doubleSPCCLRatio * doubleRBar;

	// doubleXUCL = doubleQCUCL;
	// doubleXCL = doubleQCCL;
	// doubleXLCL = doubleQCLCL;

	fprintf(stderr, "[SPC_InsertSPCCL]MonitorItemDBName:%s ShotSN:%d-%d SampleSize:%d GroupSize:%d SPCCLRatio:%lf XBarSTD:%lf RSTD:%lf\n"
					"\tXBarbar:%lf XUCL:%lf XCL:%lf XLCL:%lf\n"
					"\tRbar:%lf RUCL:%lf RCL:%lf RLCL:%lf \n",
			charMonitorItemDBName, intShotSNStart, intShotSNEnd, intSPCSampleSize, intSPCGroupSize, doubleSPCCLRatio, doubleXBarSTD, doubleRSTD,
			doubleXBarBar, doubleXUCL, doubleXCL, doubleXLCL,
			doubleRBar, doubleRUCL, doubleRCL, doubleRLCL);

	// Insert a new SPCCL to MOControlLineList
	snprintf(charStatement, MAX_STRING_SIZE,
			 "INSERT INTO %s_%s_%s_%d_Info_Meta.MOControlLineList "
			 "(MonitorItemSN,	SPCShotSNStart,	SPCShotSNEnd, SPCCLRatioStatic,"
			 "XUCL,		XCL,	XLCL,"
			 "RUCL,		RCL,	RLCL) VALUES "
			 "(%d,				%d,				%d,				%lf,"
			 "%lf,		%lf,	%lf,"
			 "%lf,		%lf,	%lf) "
			 "ON DUPLICATE KEY UPDATE "
			 "SPCShotSNStart = % d, SPCShotSNEnd = %d, SPCCLRatioStatic = %lf,"
			 "XUCL = %lf, 	XCL = %lf,	XLCL = %lf,"
			 "RUCL = %lf, 	RCL = %lf, 	RLCL = %lf",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 intMonitorItemSN, intShotSNStart, intShotSNEnd, doubleSPCCLRatio,
			 doubleXUCL, doubleXCL, doubleXLCL,
			 doubleRUCL, doubleRCL, doubleRLCL,
			 intShotSNStart, intShotSNEnd, doubleSPCCLRatio,
			 doubleXUCL, doubleXCL, doubleXLCL,
			 doubleRUCL, doubleRCL, doubleRLCL);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_InsertSPCCL]Fail to insert SPCCL (MonitorItemSN:%d) to table %s_%s_%s_%d_Info_Meta.MOControlLineList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	return EXIT_SUCCESS;
}

int SPC_CopyAllMonitorItemSN(MYSQL mysqlCon, unsigned int intSourceMOSN, unsigned int intDestinationMOSN)
//[SPC]Copy All SPC Configurations from Source MO to Destinated MO
{
	int intRetval;
	if ((intRetval=SPC_CopySPCEnable(mysqlCon, intSourceMOSN, intDestinationMOSN)) != EXIT_SUCCESS)
		return intRetval;
	if ((intRetval=SPC_CopySPCControlLine(mysqlCon, intSourceMOSN, intDestinationMOSN)) != EXIT_SUCCESS)
		return intRetval;
}

int SPC_CopySPCControlLine(MYSQL mysqlCon, unsigned int intSourceMOSN, unsigned int intDestinationMOSN)
//[SPC]Copy All SPC Control Line from Source MO to Destinated MO
{
	int intRetval;
	unsigned int intIMMSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intRowSize;
	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intMonitorItemIndex;
	double doubleXUCL, doubleXCL, doubleXLCL, doubleRUCL, doubleRCL, doubleRLCL;

	// Select All Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN,XUCL,XCL,XLCL,RUCL,RCL,RLCL FROM %s_%s_%s_%d_Info_Meta.MOControlLineList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_CopySPCControlLine]Fail to select all MonitorItemSN control line from %s_%s_%s_%d_Info_Meta.MOControlLineList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	intRowSize = (unsigned int)mysql_num_rows(mysqlResult);

	// For All MonitorItemSN Monitor Item
	for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
	{
		if (mysqlRow[0] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_CopySPCControlLine]Source MonitorItemSN is null from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, ERRCLASS_DB, charErrMsg);
			return intLogSN;
		}
		else
			intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;

		if (mysqlRow[1] == NULL || mysqlRow[2] == NULL || mysqlRow[3] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_CopySPCControlLine]XBar control line of source MonitorItemSN:%d is null from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
					 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
		
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, ERRCLASS_DB, charErrMsg);		
			return intLogSN;
		}
		else
		{
			doubleXUCL = atof(mysqlRow[1]);
			doubleXCL = atof(mysqlRow[2]);
			doubleXLCL = atof(mysqlRow[3]);
		}

		if (mysqlRow[4] == NULL || mysqlRow[5] == NULL || mysqlRow[6] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_CopySPCControlLine]R control line of source MonitorItemSN:%d is null from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
					 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, ERRCLASS_DB, charErrMsg);
			return intLogSN;
		}
		else
		{
			doubleRUCL = atof(mysqlRow[4]);
			doubleRCL = atof(mysqlRow[5]);
			doubleRLCL = atof(mysqlRow[6]);
		}
		fprintf(stderr, "MonintorItemSN:%d XUCL:%lf XCL:%lf XLCL:%lf RUCL:%lf RCL:%lf RLCL:%lf\n",
				intMonitorItemSN, doubleXUCL, doubleXCL, doubleXLCL, doubleRUCL, doubleRCL, doubleRLCL);

		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s_%d_Info_Meta.MOControlLineList SET XUCL = %lf, XCL = %lf ,XLCL = %lf ,RUCL = %lf ,RCL = %lf ,RLCL = %lf WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, doubleXUCL, doubleXCL, doubleXLCL, doubleRUCL, doubleRCL, doubleRLCL, intMonitorItemSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_CopySPCControlLine]Fail to update MonitorItemSN control line from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intDestinationMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	return EXIT_SUCCESS;
}

int SPC_CopySPCEnable(MYSQL mysqlCon, unsigned int intSourceMOSN, unsigned int intDestinationMOSN)
//[SPC]Copy All SPCEnable of each MonitorItemSN from Source MO to Destinated MO
{
	int intRetval;
	unsigned int intIMMSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	int intRowSize;
	int intMonitorItemSN, intSPCEnable, intSPCSampleSize, intSPCGroupSize;
	int intSPCRule1, intSPCRule2, intSPCRule3, intSPCRule4, intSPCRule5, intSPCRule6, intSPCRule7, intSPCRule8;

	// Select All Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemSN, SPCEnable, SPCSampleSize, SPCGroupSize, "
			 "SPCRule1, SPCRule2, SPCRule3, SPCRule4, SPCRule5, SPCRule6, SPCRule7, SPCRule8 "
			 "FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_CopySPCEnable]Fail to select SPC configurations of all MonitorItemSN  from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	intRowSize = (unsigned int)mysql_num_rows(mysqlResult);

	// For All MonitorItemSN Monitor Item
	for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
	{
		if (mysqlRow[0] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_CopySPCEnable]Source MonitorItemSN is null from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, ERRCLASS_DB, charErrMsg);
			return intLogSN;
		}
		else
			intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;

		if (mysqlRow[1] == NULL || mysqlRow[2] == NULL || mysqlRow[3] == NULL)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_CopySPCEnable] SPC configurations is null of source MonitorItemSN:%d is null from %s_%s_%s_%d_Info_Config.MonitorItemSNList",
					 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intSourceMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intSourceMOSN, 0, ERRCLASS_DB, charErrMsg);
			return intLogSN;
		}
		else
		{
			intSPCEnable = atoi(mysqlRow[1]);
			intSPCSampleSize = atoi(mysqlRow[2]);
			intSPCGroupSize = atoi(mysqlRow[3]);
			intSPCRule1 = atoi(mysqlRow[4]);
			intSPCRule2 = atoi(mysqlRow[5]);
			intSPCRule3 = atoi(mysqlRow[6]);
			intSPCRule4 = atoi(mysqlRow[7]);
			intSPCRule5 = atoi(mysqlRow[8]);
			intSPCRule6 = atoi(mysqlRow[9]);
			intSPCRule7 = atoi(mysqlRow[10]);
			intSPCRule8 = atoi(mysqlRow[11]);
		}

		// fprintf(stderr, "[SPC_CopySPCEnable]MonintorItemSN:%d SPCEnable:%d SPCSampleSize:%d SPCGroupSize:%d\n",
		// intMonitorItemSN, intSPCEnable, intSPCSampleSize, intSPCGroupSize);

		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s_%d_Info_Config.MonitorItemSNList SET SPCEnable = %d, SPCSampleSize = %d, SPCGroupSize = %d, "
				 "SPCRule1 = %d, SPCRule2 = %d, SPCRule3 = %d, SPCRule4 = %d, SPCRule5 = %d, SPCRule6 = %d, SPCRule7 = %d, SPCRule8 = %d "
				 "WHERE MonitorItemSN = %d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, intSPCEnable, intSPCSampleSize, intSPCGroupSize,
				 intSPCRule1, intSPCRule2, intSPCRule3, intSPCRule4, intSPCRule5, intSPCRule6, intSPCRule7, intSPCRule8,
				 intMonitorItemSN);
		// fprintf(stderr,"Q:%s\n",charStatement);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_CopySPCEnable]Fail to update MonitorItemSN control line from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intDestinationMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intDestinationMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
	}
	return EXIT_SUCCESS;
}

int SPC_SelectSPCXBarValue(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMonitorItemSN, unsigned int intShotSN, unsigned int intFetchSize, double **doubleXBarValue)
//[SPC]Select X Bar Value of A Specified ShotSN in An Existing MO for SPC
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intShotSNStart;
	unsigned int intShotSNEnd;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intSPCSensorMonitorIndex;
	unsigned int intSPCSampleSize;

	char charMonitorItemDBName[SMALL_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Select All SPC Monitor Item Configuration According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex,SPCSampleSize FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_SelectSPCXBarValue]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_SelectSPCXBarValue]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList. (No Such MonitorItemSN)",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
		return intLogSN;
	}

	intMonitorItemClass = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
	// fprintf(stderr, "intMonitorItemClass:%d\n", intMonitorItemClass);
	intMonitorItemSensorSN = mysqlRow[1] != NULL ? atoi(mysqlRow[1]) : 0;
	// fprintf(stderr, "intMonitorItemSensorSN:%d\n", intMonitorItemSensorSN);
	intSPCSensorMonitorIndex = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
	// fprintf(stderr, "intSPCSensorMonitorIndex:%d\n", intSPCSensorMonitorIndex);
	intSPCSampleSize = mysqlRow[3] != NULL ? atoi(mysqlRow[3]) : 0;
	// fprintf(stderr, "intSPCSampleSize:%d\n", intSPCSampleSize);

	intShotSNEnd = intShotSN;
	intShotSNStart = intShotSNEnd - intSPCSampleSize * intFetchSize + 1;

	if (intShotSNStart <= 0)
	{
#ifdef DEBUG_MODE
		fprintf(stderr,
				"[SPC_SelectSPCXBarValue]MOSN:%d MonitorItemSN:%d SampleSize:%d ShotSN:%d have no enough data for group size:%d, thus no X bar value",
				intMOSN, intMonitorItemSN, intSPCSampleSize, intShotSN, intFetchSize);
#endif
		return EXIT_FAILURE;
	}

	// Get Name by Given MonitorItemSN
	intRetval = DB_SelectMonitorItemDBName(mysqlCon, intMOSN, intMonitorItemSN, charMonitorItemDBName);
	//fprintf(stderr, "[SPC_SelectSPCXBarValue]intMonitorItemName:%s\n", charMonitorItemDBName);

	if (intMonitorItemClass == MONITOR_ITEM_CLASS_QUALITY)
	{
		return EXIT_SUCCESS;
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_OPCUA)
	{
		// Select XBar Value
		mysql_query(&mysqlCon, "set @RowSN:=-1");
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT GroupSN, AVG(%s) AS XBar FROM("
				 "	SELECT @RowSN:= @RowSN + 1 AS RowSN, @RowSN DIV %d +1 AS GroupSN, ShotSN, %s FROM("
				 "		SELECT ShotSN,%s FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN DESC"
				 "	)AS SortedTable"
				 ")AS GroupedTable"
				 " GROUP BY GroupSN",
				 charMonitorItemDBName,
				 intSPCSampleSize, charMonitorItemDBName,
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);

		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectSPCXBarValue]Fail to select XBar value of IMMSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);

		// Check The Amount Select == Fetch Size
		if (mysql_num_rows(mysqlResult) != intFetchSize)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectSPCXBarValue]Fail to select XBar value of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result empty or No enough data)",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
			return intLogSN;
		}

		*doubleXBarValue = (double *)malloc(sizeof(double) * intFetchSize);
		for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
		{
			if (mysqlRow[1] != NULL)
			{
				*((*doubleXBarValue) + i) = atof(mysqlRow[1]);
				// fprintf(stderr, "XBarValue[%d]:%lf\n", i, *((*doubleXBarValue) + i));
			}
			else
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[SPC_SelectSPCXBarValue]Fail to select XBar value (value=NULL) of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result empty or No enough data)",
						 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
				return intLogSN;
			}
		}
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS)
	{
		// Select XBar Value
		mysql_query(&mysqlCon, "set @RowSN:=-1");
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT GroupSN, AVG(%s) AS XBar FROM("
				 "	SELECT @RowSN:= @RowSN + 1 AS RowSN, @RowSN DIV %d +1 AS GroupSN, ShotSN, %s FROM("
				 "		SELECT ShotSN,%s FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN DESC"
				 "	)AS SortedTable"
				 ")AS GroupedTable"
				 " GROUP BY GroupSN",
				 charMonitorItemDBName,
				 intSPCSampleSize, charMonitorItemDBName,
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectSPCXBarValue]Fail to select XBar value of MOCustomSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);

		// Check The Amount Select == Fetch Size
		if (mysql_num_rows(mysqlResult) != intFetchSize)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectSPCXBarValue]Fail to select XBar value of MOCustomSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (Result empty or No enough data)",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
			return intLogSN;
		}

		*doubleXBarValue = (double *)malloc(sizeof(double) * intFetchSize);
		for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
		{			
			if (mysqlRow[1] != NULL)
			{
				*((*doubleXBarValue) + i) = atof(mysqlRow[1]);
				// fprintf(stderr, "XBarValue[%d]:%lf\n", i, *((*doubleXBarValue) + i));
			}
			else
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[SPC_SelectSPCXBarValue]Fail to select XBar value (value=NULL) of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result empty or No enough data)",
						 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
				return intLogSN;
			}
		}
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_SOFT)
	{
		// Select XBar Value
		mysql_query(&mysqlCon, "set @RowSN:=-1");
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT GroupSN, AVG(%s) AS XBar FROM("
				 "	SELECT @RowSN:= @RowSN + 1 AS RowSN, @RowSN DIV %d +1 AS GroupSN, ShotSN, %s FROM("
				 "		SELECT ShotSN,%s FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN DESC"
				 "	)AS SortedTable"
				 ")AS GroupedTable"
				 " GROUP BY GroupSN",
				 charMonitorItemDBName,
				 intSPCSampleSize, charMonitorItemDBName,
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);

		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectSPCXBarValue]Fail to select XBar value of IMMSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		if (mysql_num_rows(mysqlResult) != intFetchSize)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectSPCXBarValue]Fail to select XBar value of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (Result empty or No enough data)",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
			return intLogSN;
		}

		*doubleXBarValue = (double *)malloc(sizeof(double) * intFetchSize);
		for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
		{
			if (mysqlRow[1] != NULL)
			{
				*((*doubleXBarValue) + i) = atof(mysqlRow[1]);
				// fprintf(stderr, "XBarValue[%d]:%lf\n", i, *((*doubleXBarValue) + i));
			}
			else
			{
				snprintf(charErrMsg, LONG_STRING_SIZE,
						 "[SPC_SelectSPCXBarValue]Fail to select XBar value (value=NULL) of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result empty or No enough data)",
						 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
				intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
				return intLogSN;
			}
		}
	}
	// for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
	//{
	//	fprintf(stderr, "XBarValue[%d]:%lf\n", i, *((*doubleXBarValue) + i));
	// }
	return EXIT_SUCCESS;
}

int SPC_SelectRValue(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intMonitorItemSN, unsigned int intShotSN, unsigned int intFetchSize, double **doubleRValue)
//[SPC]Select R Value of A Specified ShotSN in An Existing MO for SPC
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intShotSNStart;
	unsigned int intShotSNEnd;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intSPCSensorMonitorIndex;
	unsigned int intSPCSampleSize;

	char charMonitorItemDBName[SMALL_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;

	// Select All Enable SPC Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex,SPCSampleSize FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList WHERE MonitorItemSN=%d",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_SelectRValue]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}

	mysqlResult = mysql_store_result(&mysqlCon);
	mysqlRow = mysql_fetch_row(mysqlResult);
	if (mysqlRow == NULL)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_SelectRValue]Fail to select MonitorItemSN information where MonitorItemSN=%d from %s_%s_%s_%d_Info_Config.MonitorItemSNList. (No Such MonitorItemSN)",
				 intMonitorItemSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
		return intLogSN;
	}

	intMonitorItemClass = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
	// fprintf(stderr, "intMonitorItemClass:%d\n", intMonitorItemClass);
	intMonitorItemSensorSN = mysqlRow[1] != NULL ? atoi(mysqlRow[1]) : 0;
	// fprintf(stderr, "intMonitorItemSensorSN:%d\n", intMonitorItemSensorSN);
	intSPCSensorMonitorIndex = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
	// fprintf(stderr, "intSPCSensorMonitorIndex:%d\n", intSPCSensorMonitorIndex);
	intSPCSampleSize = mysqlRow[3] != NULL ? atoi(mysqlRow[3]) : 0;
	// fprintf(stderr, "intSPCSampleSize:%d\n", intSPCSampleSize);

	intShotSNEnd = intShotSN;
	intShotSNStart = intShotSNEnd - intSPCSampleSize * intFetchSize + 1;
	if (intShotSNStart <= 0)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_SelectRValue]MOSN:%d MonitorItemSN:%d SampleSize:%d ShotSN:%d have no enough data for group size:%d, thus no X bar value",
				 intMOSN, intMonitorItemSN, intSPCSampleSize, intShotSN, intFetchSize);
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
		return intLogSN;
	}

	// Get Name by Given MonitorItemSN
	intRetval = DB_SelectMonitorItemDBName(mysqlCon, intMOSN, intMonitorItemSN, charMonitorItemDBName);
	// fprintf(stderr, "intMonitorItemName:%s\n", charMonitorItemDBName);

	if (intMonitorItemClass == MONITOR_ITEM_CLASS_QUALITY)
	{
		return EXIT_SUCCESS;
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_OPCUA)
	{
		// Select R Value
		mysql_query(&mysqlCon, "set @RowSN:=-1");
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT GroupSN, MAX(%s)-MIN(%s) AS R FROM("
				 "	SELECT @RowSN:= @RowSN + 1 AS RowSN, @RowSN DIV %d +1 AS GroupSN, ShotSN, %s FROM("
				 "		SELECT ShotSN,%s FROM %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN DESC"
				 "	)AS SortedTable"
				 ")AS GroupedTable"
				 " GROUP BY GroupSN",
				 charMonitorItemDBName, charMonitorItemDBName,
				 intSPCSampleSize, charMonitorItemDBName,
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectRValue]Fail to select XBar value of IMMSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (%d):%s",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);

		// Check The Amount Select == Fetch Size
		if (mysql_num_rows(mysqlResult) != intFetchSize)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectRValue]Fail to select XBar value of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.IMMSensorSNList (Result empty or No enough data)",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
			return intLogSN;
		}

		*doubleRValue = (double *)malloc(sizeof(double) * intFetchSize);
		for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
		{
			*((*doubleRValue) + i) = atof(mysqlRow[1]);
			// fprintf(stderr, "XBarValue[%d]:%lf\n", i, *((*doubleRValue) + i));
		}
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_MODBUS)
	{
		// Select R Value
		mysql_query(&mysqlCon, "set @RowSN:=-1");
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT GroupSN, MAX(%s)-MIN(%s) AS R FROM("
				 "	SELECT @RowSN:= @RowSN + 1 AS RowSN, @RowSN DIV %d +1 AS GroupSN, ShotSN, %s FROM("
				 "		SELECT ShotSN,%s FROM %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN DESC"
				 "	)AS SortedTable"
				 ")AS GroupedTable"
				 " GROUP BY GroupSN",
				 charMonitorItemDBName, charMonitorItemDBName,
				 intSPCSampleSize, charMonitorItemDBName,
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectRValue]Fail to select XBar value of MOCustomSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (%d):%s",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN,
					 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);

		// Check The Amount Select == Fetch Size
		if (mysql_num_rows(mysqlResult) != intFetchSize)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectRValue]Fail to select XBar value of MOCustomSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.MOCustomSensorSN%d (Result empty or No enough data)",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSensorSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
			return intLogSN;
		}

		*doubleRValue = (double *)malloc(sizeof(double) * intFetchSize);

		for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
		{
			*((*doubleRValue) + i) = atof(mysqlRow[1]);
			// fprintf(stderr, "XBarValue[%d]:%lf\n", i, *((*doubleRValue) + i));
		}
	}
	else if (intMonitorItemClass == MONITOR_ITEM_CLASS_SOFT)
	{
		// Select R Value
		mysql_query(&mysqlCon, "set @RowSN:=-1");
		snprintf(charStatement, MAX_STRING_SIZE,
				 "SELECT GroupSN, MAX(%s)-MIN(%s) AS R FROM("
				 "	SELECT @RowSN:= @RowSN + 1 AS RowSN, @RowSN DIV %d +1 AS GroupSN, ShotSN, %s FROM("
				 "		SELECT ShotSN,%s FROM %s_%s_%s_%d_RawData_FeatureValue.SoftSensor WHERE ShotSN >= %d AND ShotSN <= %d ORDER BY ShotSN DESC"
				 "	)AS SortedTable"
				 ")AS GroupedTable"
				 " GROUP BY GroupSN",
				 charMonitorItemDBName, charMonitorItemDBName,
				 intSPCSampleSize, charMonitorItemDBName,
				 charMonitorItemDBName, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
				 intShotSNStart, intShotSNEnd);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectSPCXBarValue]Fail to select XBar value of IMMSensor=%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (%d):%s",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		mysqlResult = mysql_store_result(&mysqlCon);
		if (mysql_num_rows(mysqlResult) != intFetchSize)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE,
					 "[SPC_SelectSPCXBarValue]Fail to select XBar value of IMMSensor:%s ShotSN:%d-%d from %s_%s_%s_%d_RawData_FeatureValue.SoftSensor (Result empty or No enough data)",
					 charMonitorItemDBName, intShotSNStart, intShotSNEnd,
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, 0, charErrMsg);
			return intLogSN;
		}

		*doubleRValue = (double *)malloc(sizeof(double) * intFetchSize);
		for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
		{
			*((*doubleRValue) + i) = atof(mysqlRow[1]);
			// fprintf(stderr, "XBarValue[%d]:%lf\n", i, *((*doubleRValue) + i));
		}
	}
	return EXIT_SUCCESS;
}

int SPC_InsertSPCAlarm(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intShotSN)
//[SPC]Insert SPC Alarm of A Specified ShotSN in An Existing MO
{
	int intRetval;
	unsigned int intIMMSN;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;
	char charStatement[MAX_STRING_SIZE];
	MYSQL_RES *mysqlResult;
	MYSQL_ROW mysqlRow;
	unsigned int intRowSize;
	unsigned int intMonitorItemSN;
	unsigned int intMonitorItemClass;
	unsigned int intMonitorItemSensorSN;
	unsigned int intMonitorItemIndex;
	unsigned int intSPCSampleSize;
	unsigned int intSPCGroupSize;
	unsigned int intSPCRoundSNStart;
	unsigned int intSPCRoundSNEnd;
	unsigned int intRoundSN;
	int intStartShotSN;
	int intThisRoundFirstShotSN;
	int intGroupSN;
	double doubleXUCL;
	double doubleXCL;
	double doubleXLCL;
	double doubleRUCL;
	double doubleRCL;
	double doubleRLCL;
	double doubleSPCCLRatio;
	bool boolSPCEnable[8];
	char *charSPCAlarmSN;
	unsigned int intSPCAlarmSN;
	int intSPCAlarm;
	int intSPCRulesAlarm[8];
	char charSPCRulesAlarm[8][5];
	int intSPCRAlarm;
	char charSPCRAlarm[5];
	double doubleSPCAlarmXBarDiff;
	double doubleSPCAlarmRDiff;

	char charMonitorItemDBName[SMALL_STRING_SIZE];
	double *doubleXBarValue;
	double *doubleRValue;

	bool boolXCLIsNULL = false;
	bool boolRCLIsNULL = false;
	/*
	unsigned int intMonitorItemSN[SPC_MAX_MONITOR_ITEM];
	bool boolSPCEnableDisable[SPC_MAX_MONITOR_ITEM];
	double doubleXUCL[SPC_MAX_MONITOR_ITEM];
	double doubleXCL[SPC_MAX_MONITOR_ITEM];
	double doubleXLCL[SPC_MAX_MONITOR_ITEM];
	double doubleRUCL[SPC_MAX_MONITOR_ITEM];
	double doubleRCL[SPC_MAX_MONITOR_ITEM];
	double doubleRLCL[SPC_MAX_MONITOR_ITEM];
	double doubleSPCCLRatio[SPC_MAX_MONITOR_ITEM];
	*/

	// fprintf(stderr,"[SPC_InsertSPCAlarm]MOSN:%d ShotSN:%d InserSPCAlarm\n",intMOSN,intShotSN);

	// Select All Enable SPC Monitor Item According to The Given MOSN
	snprintf(charStatement, MAX_STRING_SIZE,
			 "SELECT %s_%s_%s_%d_Info_Config.MonitorItemSNList.MonitorItemSN,"								// 0
			 "MonitorItemClass,MonitorItemSensorSN,MonitorItemIndex,SPCSampleSize,SPCGroupSize,SPCCLRatio," // 1~6
			 "XUCL,XCL,XLCL,RUCL,RCL,RLCL, "																// 7~12
			 "SPCRule1,SPCRule2,SPCRule3,SPCRule4,SPCRule5,SPCRule6,SPCRule7,SPCRule8 "						// 13~20
			 "FROM %s_%s_%s_%d_Info_Config.MonitorItemSNList, %s_%s_%s_%d_Info_Meta.MOControlLineList "
			 "WHERE %s_%s_%s_%d_Info_Config.MonitorItemSNList.MonitorItemSN = %s_%s_%s_%d_Info_Meta.MOControlLineList.MonitorItemSN AND %s_%s_%s_%d_Info_Config.MonitorItemSNList.SPCEnable = 1",
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
			 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
	intRetval = mysql_query(&mysqlCon, charStatement);
	if (intRetval != EXIT_SUCCESS)
	{
		snprintf(charErrMsg, LONG_STRING_SIZE,
				 "[SPC_InsertSPCAlarm]Fail to select all MonitorItemSN control line where SPCEnable = 1 from %s_%s_%s_%d_Info_Config.MonitorItemSNList (%d):%s",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
	mysqlResult = mysql_store_result(&mysqlCon);
	intRowSize = (unsigned int)mysql_num_rows(mysqlResult);

	// For All MonitorItemSN Monitor Item
	for (int i = 0; (mysqlRow = mysql_fetch_row(mysqlResult)) != NULL; i++)
	{
		intSPCAlarm = 0;

		intMonitorItemSN = mysqlRow[0] != NULL ? atoi(mysqlRow[0]) : 0;
		intMonitorItemClass = mysqlRow[1] != NULL ? atoi(mysqlRow[1]) : 0;
		intMonitorItemSensorSN = mysqlRow[2] != NULL ? atoi(mysqlRow[2]) : 0;
		intMonitorItemIndex = mysqlRow[3] != NULL ? atoi(mysqlRow[3]) : 0;
		intSPCSampleSize = mysqlRow[4] != NULL ? atoi(mysqlRow[4]) : 0;
		intSPCGroupSize = mysqlRow[5] != NULL ? atoi(mysqlRow[5]) : 0;
		doubleSPCCLRatio = mysqlRow[6] != NULL ? atof(mysqlRow[6]) : 0;

		doubleSPCAlarmXBarDiff = 0;
		doubleSPCAlarmRDiff = 0;

		if (mysqlRow[7] == NULL || mysqlRow[8] == NULL || mysqlRow[9] == NULL)
		{
			boolXCLIsNULL = true;
			// fprintf(stderr, "XCL is NULL\n");
		}
		else
		{
			doubleXUCL = atof(mysqlRow[7]);
			doubleXCL = atof(mysqlRow[8]);
			doubleXLCL = atof(mysqlRow[9]);
		}

		if (mysqlRow[10] == NULL || mysqlRow[11] == NULL || mysqlRow[12] == NULL)
		{
			boolRCLIsNULL = true;
			// fprintf(stderr, "RCL is NULL\n");
		}
		else
		{
			doubleRUCL = atof(mysqlRow[10]);
			doubleRCL = atof(mysqlRow[11]);
			doubleRLCL = atof(mysqlRow[12]);
		}

		boolSPCEnable[0] = mysqlRow[13] != NULL ? atoi(mysqlRow[13]) : 0;
		boolSPCEnable[1] = mysqlRow[14] != NULL ? atoi(mysqlRow[14]) : 0;
		boolSPCEnable[2] = mysqlRow[15] != NULL ? atoi(mysqlRow[15]) : 0;
		boolSPCEnable[3] = mysqlRow[16] != NULL ? atoi(mysqlRow[16]) : 0;
		boolSPCEnable[4] = mysqlRow[17] != NULL ? atoi(mysqlRow[17]) : 0;
		boolSPCEnable[5] = mysqlRow[18] != NULL ? atoi(mysqlRow[18]) : 0;
		boolSPCEnable[6] = mysqlRow[19] != NULL ? atoi(mysqlRow[19]) : 0;
		boolSPCEnable[7] = mysqlRow[20] != NULL ? atoi(mysqlRow[20]) : 0;

		intRetval = DB_SelectRoundSNbyShotSN(mysqlCon, intMOSN, intShotSN, &intRoundSN);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_InsertSPCAlarm]Fail to select RoundSN for ShotSN:%d int table %s_%s_%s_%d_RawData.ShotSNList",
					 intShotSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}

		intRetval = DB_SelectFirstShotSNbyRoundSN(mysqlCon, intMOSN, intRoundSN, &intThisRoundFirstShotSN);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_InsertSPCAlarm]Fail to select first ShotSN for Round:%d int table %s_%s_%s_%d_RawData.ShotSNList",
					 intRoundSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
			return intLogSN;
		}

		// If Ths intShotSN in This Round Can Be Divided By intSPCSampleSize, It Implies Another New Point Is Ready
		// Otherwise, The SPC Rule Will Not Be Checked
		if (intShotSN % intSPCSampleSize != 0)
		{
#ifdef DEBUG_MODE
			fprintf(stderr, "Skip SPCRule Check ShotSN:%d CurrentRoundFirstShotSN:%d SampleSize:%d\n", intShotSN, intThisRoundFirstShotSN, intSPCSampleSize);
#endif
			return EXIT_SUCCESS;
		}
		else
		{
			// Caculate GroupSN
			intGroupSN = intShotSN / intSPCSampleSize;

			// Display Information for Shot,MonitorItemSN,SPCRule
			DB_SelectMonitorItemDBName(mysqlCon, intMOSN, intMonitorItemSN, charMonitorItemDBName);

			fprintf(stderr, "ShotSN:%d MonitorItemSN:%d MonitorItemName:%s ", intShotSN, intMonitorItemSN, charMonitorItemDBName);
			for (int i = 0; i <= 7; i++)
			{
				if (boolSPCEnable[i] == 1)
					fprintf(stderr, "[Rule:%d]:Enable ", i + 1);
			}
			fprintf(stderr, "\n");

			// SPC Rule1
			//  1: Value > UCL
			//  0: UCL > Value > LCL
			//-1: Value < LCL
			if (boolSPCEnable[0] == 1)
			{
				// Check The Required Shot For Such SPC Rule Has Enough Data
				if ((intShotSN - (SPC_RULE1_POINT_SIZE * intSPCSampleSize) + 1) < intThisRoundFirstShotSN)
				{
					intSPCRulesAlarm[0] = 0;
					fprintf(stderr, "SPC Rule 1 Result:%d(PASS) No enough data (Shot:%d) after ShotSN:%d \n",
							intSPCRulesAlarm[0], intShotSN - (SPC_RULE1_POINT_SIZE * intSPCSampleSize) + 1, intThisRoundFirstShotSN);
				}
				else
				{
					// Fetch XBar Value
					intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleXBarValue);
					if (intRetval != EXIT_SUCCESS)
					{
						snprintf(charErrMsg, LONG_STRING_SIZE,
								 "[SPC_InsertSPCAlarm]Fail to select Rule1 XBar Value for MOSN:%d ShotSN:%d PointSize:%d",
								 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE);
						intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
						return intLogSN;
					}
					else if (boolXCLIsNULL == false)
					{
						// SPC Rule1 XBarBar Value
						SPC_Rule1(doubleXBarValue, doubleXUCL, doubleXLCL, &(intSPCRulesAlarm[0]));

						// Display The SPC Result
						if (intSPCRulesAlarm[0] == 1)
						{
							fprintf(stderr, "SPC Rule 1 Result:%d(too high) X Bar Value:%lf > UCL:%lf\n", intSPCRulesAlarm[0], *doubleXBarValue, doubleXUCL);
							doubleSPCAlarmXBarDiff = *doubleXBarValue - doubleXUCL;
						}
						else if (intSPCRulesAlarm[0] == -1)
						{
							fprintf(stderr, "SPC Rule 1 Result:%d(too low) X Bar Value:%lf < LCL:%lf\n", intSPCRulesAlarm[0], *doubleXBarValue, doubleXLCL);
							doubleSPCAlarmXBarDiff = *doubleXBarValue - doubleXLCL;
						}
						else
						{
							fprintf(stderr, "SPC Rule 1 Result:%d(Pass) UCL:%lf > X Bar Value:%lf > LCL:%lf\n", intSPCRulesAlarm[0], doubleXUCL, *doubleXBarValue, doubleXLCL);
							doubleSPCAlarmXBarDiff = 0;
						}
					}

					// Fetch R Value
					intRetval = SPC_SelectRValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE1_POINT_SIZE, &doubleRValue);
					if (intRetval != EXIT_SUCCESS)
					{
						snprintf(charErrMsg, LONG_STRING_SIZE,
								 "[SPC_InsertSPCAlarm]Fail to select R Value for MOSN:%d ShotSN:%d PointSize:%d MonitorItemSN:%d",
								 intMOSN, intShotSN, SPC_RULE1_POINT_SIZE, intMonitorItemSN);
						intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
						return intLogSN;
					}
					else if (boolRCLIsNULL == false)
					{
						// SPC Rule1 R Value
						SPC_Rule1(doubleRValue, doubleRUCL, doubleRLCL, &intSPCRAlarm);

						// Display The SPC Result
						if (intSPCRAlarm == 1)
						{
							fprintf(stderr, "SPC R Result:%d(too high) R Value:%lf > UCL:%lf\n", intSPCRulesAlarm[0], *doubleRValue, doubleRUCL);
							doubleSPCAlarmRDiff = *doubleRValue - doubleRUCL;
						}
						else if (intSPCRAlarm == -1)
						{
							fprintf(stderr, "SPC R Result:%d(too low) R Value:%lf < LCL:%lf\n", intSPCRulesAlarm[0], *doubleRValue, doubleRLCL);
							doubleSPCAlarmRDiff = *doubleRValue - doubleRLCL;
						}
						else
						{
							fprintf(stderr, "SPC R Result:%d(Pass) UCL:%lf > R Value:%lf > LCL:%lf\n", intSPCRulesAlarm[0], doubleRUCL, *doubleRValue, doubleRLCL);
							doubleSPCAlarmRDiff = 0;
						}
					}

					/*
					//fprintf(stderr, "Insert SPC Chart Data\n");
					//Insert XBar and R Value to SPCChartData
					snprintf(charStatement, MAX_STRING_SIZE,
							 "INSERT INTO %s_%s_%s_%d_RawData_ChartData.SPCChartData (MonitorItemSN,ShotSN,GroupSN,XBar,R) VALUE (%d,%d,%d,%lf,%lf)",
							 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, intMonitorItemSN, intShotSN, intGroupSN, *doubleXBarValue, *doubleRValue);

					intRetval = mysql_query(&mysqlCon, charStatement);
					if (intRetval != EXIT_SUCCESS)
					{

						snprintf(charErrMsg, LONG_STRING_SIZE,
								 "[SPC_InsertSPCAlarm]Fail to insert XBar and R value for ShotSN:%d GroupSN:%d into %s_%s_%s_%d_RawData_ChartData.SPCChartData (%d):%s",
								 intShotSN, intGroupSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
						//fprintf(stderr, "Q:%s\n", charStatement);
						intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
						//return intLogSN;
					}*/
				}
			}

			// SPC Rule 2
			//  1: Nine (or more) points in a row are on the UCL side of the mean
			//  0: Pass
			//-1: Nine (or more) points in a row are on the LCL side of the mean
			if (intSPCRulesAlarm[0] == 0 && boolSPCEnable[1] == 1 && boolXCLIsNULL == false)
			{
				intStartShotSN = intShotSN - (SPC_RULE2_POINT_SIZE * intSPCSampleSize) + 1;
				// fprintf(stderr, "[Rule2]StartShotSN:%d EndShotSN:%d ThisRound:%d\n", intThisStartShotSN, intShotSN, intThisRoundFirstShotSN);
				// Check The Required Shot For Such SPC Rule Has Enough Data
				if (intStartShotSN < intThisRoundFirstShotSN)
				{
					intSPCRulesAlarm[1] = 0;
					fprintf(stderr, "SPC Rule 2 Result:%d(Pass)\n", intSPCRulesAlarm[1]);
				}
				else
				{
					fprintf(stderr, "SPC Rule 2 Result:%d(DEBUG)\n", intSPCRulesAlarm[1]);
					intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE2_POINT_SIZE, &doubleXBarValue);
					if (intRetval != EXIT_SUCCESS)
					{
						snprintf(charErrMsg, LONG_STRING_SIZE,
								 "[SPC_InsertSPCAlarm]Fail to select Rule2 XBar Value for MOSN:%d ShotSN:%d PointSize:%d",
								 intMOSN, intShotSN, SPC_RULE2_POINT_SIZE);
						intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
						return intLogSN;
					}
					else if (boolXCLIsNULL == false)
					{
						SPC_Rule2(doubleXBarValue, SPC_RULE2_POINT_SIZE, doubleXCL, &(intSPCRulesAlarm[1]));

						// Display The SPC Result
						if (intSPCRulesAlarm[1] == 1)
							fprintf(stderr, "SPC Rule 2 Result:%d Nine (or more) points in a row are on the UCL side of the mean\n", intSPCRulesAlarm[1]);
						else if (intSPCRulesAlarm[1] == -1)
							fprintf(stderr, "SPC Rule 2 Result:%d Nine (or more) points in a row are on the UCL side of the mean\n", intSPCRulesAlarm[1]);
						else
							fprintf(stderr, "SPC Rule 2 Result:%d(Pass)\n", intSPCRulesAlarm[1]);
					}
				}
			}

			// SPC Rule 3
			//  1: Six (or more) points in a row are continuously increasing
			//  0: Pass
			//-1: Six (or more) points in a row are continuously decreasing
			if (intSPCRulesAlarm[0] == 0 && boolSPCEnable[2] == 1 && boolXCLIsNULL == false)
			{
				intStartShotSN = intShotSN - (SPC_RULE3_POINT_SIZE * intSPCSampleSize) + 1;
				// Check The Required Shot For Such SPC Rule Has Enough Data
				if (intStartShotSN < intThisRoundFirstShotSN)
					intSPCRulesAlarm[2] = 0;
				else
				{
					intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE3_POINT_SIZE, &doubleXBarValue);
					if (intRetval != EXIT_SUCCESS)
					{
						snprintf(charErrMsg, LONG_STRING_SIZE,
								 "[SPC_InsertSPCAlarm]Fail to select Rule3 XBar Value for MOSN:%d ShotSN:%d PointSize:%d",
								 intMOSN, intShotSN, SPC_RULE3_POINT_SIZE);
						intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
						return intLogSN;
					}
					else if (boolXCLIsNULL == false)
					{
						SPC_Rule3(doubleXBarValue, SPC_RULE3_POINT_SIZE, &(intSPCRulesAlarm[2]));

						// Display The SPC Result
						if (intSPCRulesAlarm[2] == 1)
							fprintf(stderr, "SPC Rule 3 Result:%d Six (or more) points in a row are continuously increasing\n", intSPCRulesAlarm[2]);
						else if (intSPCRulesAlarm[2] == -1)
							fprintf(stderr, "SPC Rule 3 Result:%d Six (or more) points in a row are continuously decreasing\n", intSPCRulesAlarm[2]);
						else
							fprintf(stderr, "SPC Rule 3 Result:%d(Pass)\n", intSPCRulesAlarm[2]);
					}
				}
			}

			// SPC Rule 4
			//  1: Fourteen (or more) points in a row altinative in direction increasing then decreasing
			//  0: Pass
			if (intSPCRulesAlarm[0] == 0 && boolSPCEnable[3] == 1 && boolXCLIsNULL == false)
			{
				intStartShotSN = intShotSN - (SPC_RULE4_POINT_SIZE * intSPCSampleSize) + 1;
				// Check The Required Shot For Such SPC Rule Has Enough Data
				if (intStartShotSN < intThisRoundFirstShotSN)
					intSPCRulesAlarm[3] = 0;
				else
				{
					intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE4_POINT_SIZE, &doubleXBarValue);
					if (intRetval != EXIT_SUCCESS)
					{
						snprintf(charErrMsg, LONG_STRING_SIZE,
								 "[SPC_InsertSPCAlarm]Fail to select Rule4 XBar Value for MOSN:%d ShotSN:%d PointSize:%d",
								 intMOSN, intShotSN, SPC_RULE4_POINT_SIZE);
						intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
						return intLogSN;
					}
					else if (boolXCLIsNULL == false)
					{
						SPC_Rule4(doubleXBarValue, SPC_RULE4_POINT_SIZE, &(intSPCRulesAlarm[3]));

						// Display The SPC Result
						if (intSPCRulesAlarm[3] == 1)
							fprintf(stderr, "SPC Rule 4 Result:%d Fourteen (or more) points in a row altinative in direction increasing then decreasingn",
									intSPCRulesAlarm[3]);
						else
							fprintf(stderr, "SPC Rule 4 Result:%d(Pass)\n", intSPCRulesAlarm[3]);
					}
				}
			}

			// SPC Rule 5
			//  1: Two (or three) out ou three points in a row more than 2 standard deviations from the mean in the UCL side
			//  0: Pass
			//-1: Two (or three) out ou three points in a row more than 2 standard deviations from the mean in the LCL side
			if (intSPCRulesAlarm[0] == 0 && boolSPCEnable[4] == 1 && boolXCLIsNULL == false)
			{
				intStartShotSN = intShotSN - (SPC_RULE5_POINT_SIZE * intSPCSampleSize) + 1;
				// Check The Required Shot For Such SPC Rule Has Enough Data
				if (intStartShotSN < intThisRoundFirstShotSN)
					intSPCRulesAlarm[4] = 0;
				else
				{
					intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE5_POINT_SIZE, &doubleXBarValue);
					if (intRetval != EXIT_SUCCESS)
					{
						snprintf(charErrMsg, LONG_STRING_SIZE,
								 "[SPC_InsertSPCAlarm]Fail to select Rule5 XBar Value for MOSN:%d ShotSN:%d PointSize:%d",
								 intMOSN, intShotSN, SPC_RULE5_POINT_SIZE);
						intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
						return intLogSN;
					}
					else if (boolXCLIsNULL == false)
					{
						SPC_Rule5(doubleXBarValue, SPC_RULE5_POINT_SIZE, doubleXUCL, doubleXCL, doubleXLCL, &(intSPCRulesAlarm[4]));

						// Display The SPC Result
						if (intSPCRulesAlarm[4] == 1)
							fprintf(stderr, "SPC Rule 5 Result:%d Two (or three) out ou three points in a row more than 2 standard deviations from the mean in the UCL side",
									intSPCRulesAlarm[4]);
						else if (intSPCRulesAlarm[4] == -1)
							fprintf(stderr, "SPC Rule 5 Result:%d Two (or three) out ou three points in a row more than 2 standard deviations from the mean in the LCL side",
									intSPCRulesAlarm[4]);
						else
							fprintf(stderr, "SPC Rule 5 Result:%d(Pass)\n", intSPCRulesAlarm[4]);
					}
				}
			}

			// SPC Rule 6
			//  1: Four (or Five) out of five points in a row are more than 1 standard devation from the mean in the UCL side
			//  0: Pass
			//-1: Four (or Five) out of five points in a row are more than 1 standard devation from the mean in the LCL side
			if (intSPCRulesAlarm[0] == 0 && boolSPCEnable[5] == 1 && boolXCLIsNULL == false)
			{
				intStartShotSN = intShotSN - (SPC_RULE6_POINT_SIZE * intSPCSampleSize) + 1;
				// Check The Required Shot For Such SPC Rule Has Enough Data
				if (intStartShotSN < intThisRoundFirstShotSN)
					intSPCRulesAlarm[5] = 0;
				else
				{
					intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE6_POINT_SIZE, &doubleXBarValue);
					if (intRetval != EXIT_SUCCESS)
					{
						snprintf(charErrMsg, LONG_STRING_SIZE,
								 "[SPC_InsertSPCAlarm]Fail to select Rule6 XBar Value for MOSN:%d ShotSN:%d PointSize:%d",
								 intMOSN, intShotSN, SPC_RULE6_POINT_SIZE);
						intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
						return intLogSN;
					}
					else if (boolXCLIsNULL == false)
					{
						SPC_Rule6(doubleXBarValue, SPC_RULE5_POINT_SIZE, doubleXUCL, doubleXCL, doubleXLCL, &(intSPCRulesAlarm[5]));

						// Display The SPC Result
						if (intSPCRulesAlarm[5] == 1)
							fprintf(stderr,
									"SPC Rule 6 Result:%d Four (or Five) out of five points in a row are more than 1 standard devation from the mean in the UCL side\n",
									intSPCRulesAlarm[5]);
						else if (intSPCRulesAlarm[5] == -1)
							fprintf(stderr,
									"SPC Rule 6 Result:%d Four (or Five) out of five points in a row are more than 1 standard devation from the mean in the LCL side\n",
									intSPCRulesAlarm[5]);
						else
							fprintf(stderr, "SPC Rule 6 Result:%d(Pass)\n", intSPCRulesAlarm[5]);
					}
				}
			}

			// SPC Rule 7
			//  1: Fifteen points in a row are within 1 standard deviation of the mean on either side of the mean
			//  0: Pass
			if (intSPCRulesAlarm[0] == 0 && boolSPCEnable[6] == 1 && boolXCLIsNULL == false)
			{
				intStartShotSN = intShotSN - (SPC_RULE7_POINT_SIZE * intSPCSampleSize) + 1;
				// Check The Required Shot For Such SPC Rule Has Enough Data
				if (intStartShotSN < intThisRoundFirstShotSN)
					intSPCRulesAlarm[6] = 0;
				else if (boolXCLIsNULL == false)
				{
					intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE7_POINT_SIZE, &doubleXBarValue);
					if (intRetval != EXIT_SUCCESS)
					{
						snprintf(charErrMsg, LONG_STRING_SIZE,
								 "[SPC_InsertSPCAlarm]Fail to select Rule7 XBar Value for MOSN:%d ShotSN:%d PointSize:%d",
								 intMOSN, intShotSN, SPC_RULE7_POINT_SIZE);
						intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
						return intLogSN;
					}
					else
					{
						SPC_Rule6(doubleXBarValue, SPC_RULE5_POINT_SIZE, doubleXUCL, doubleXCL, doubleXLCL, &(intSPCRulesAlarm[6]));

						// Display The SPC Result
						if (intSPCRulesAlarm[6] == 1)
							fprintf(stderr, "SPC Rule 7 Result:%d Fifteen points in a row are within 1 standard deviation of the mean on either side of the mean\n",
									intSPCRulesAlarm[6]);
						else
							fprintf(stderr, "SPC Rule 7 Result:%d(Pass)\n", intSPCRulesAlarm[6]);
					}
				}
			}

			// SPC Rule 8
			//  1: Eights points in a row exists with none within 1 standard deviation of the mean and the points are in both directions from the mean
			//  0: Pass
			if (intSPCRulesAlarm[0] == 0 && boolSPCEnable[7] == 1 && boolXCLIsNULL == false)
			{
				intStartShotSN = intShotSN - (SPC_RULE8_POINT_SIZE * intSPCSampleSize) + 1;
				// Check The Required Shot For Such SPC Rule Has Enough Data
				if (intStartShotSN < intThisRoundFirstShotSN)
					intSPCRulesAlarm[7] = 0;
				else if (boolXCLIsNULL == false)
				{
					intRetval = SPC_SelectSPCXBarValue(mysqlCon, intMOSN, intMonitorItemSN, intShotSN, SPC_RULE8_POINT_SIZE, &doubleXBarValue);
					if (intRetval != EXIT_SUCCESS)
					{
						snprintf(charErrMsg, LONG_STRING_SIZE,
								 "[SPC_InsertSPCAlarm]Fail to select Rule8 XBar Value for MOSN:%d ShotSN:%d PointSize:%d",
								 intMOSN, intShotSN, SPC_RULE8_POINT_SIZE);
						intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, 0, charErrMsg);
						return intLogSN;
					}
					else
					{
						SPC_Rule6(doubleXBarValue, SPC_RULE5_POINT_SIZE, doubleXUCL, doubleXCL, doubleXLCL, &(intSPCRulesAlarm[7]));

						// Display The SPC Result
						if (intSPCRulesAlarm[7] == 1)
							fprintf(stderr,
									"SPC Rule 8 Result:%d Eights points in a row exists with none within 1 standard deviation of the mean and the points are in both directions from the mean\n",
									intSPCRulesAlarm[7]);
						else
							fprintf(stderr, "SPC Rule 8 Result:%d(Pass)\n", intSPCRulesAlarm[7]);
					}
				}
			}

			// Prepare Char Alarm Result for Insert Into Databas
			if (intSPCRAlarm != 0)
				intSPCAlarm = 1;
			else
				intSPCAlarm = 0;

			for (int i = 0; i < 8; i++)
			{

				if (boolSPCEnable[i] == 0)
					strcpy(charSPCRulesAlarm[i], "NULL");
				else if (i != 0 && intSPCRulesAlarm[0] != 0)
					strcpy(charSPCRulesAlarm[i], "NULL");
				else if (boolSPCEnable[i] == 1)
				{
					if (intSPCRulesAlarm[i] == 1)
					{
						strcpy(charSPCRulesAlarm[i], "1");
						intSPCAlarm = 1;
					}
					else if (intSPCRulesAlarm[i] == 0)
					{
						strcpy(charSPCRulesAlarm[i], "0");
					}
					else if (intSPCRulesAlarm[i] == -1)
					{
						strcpy(charSPCRulesAlarm[i], "-1");
						intSPCAlarm = 1;
					}
				}
			}

			// Insert Into Database If and Only If the SPC Alarm Is Triggered
			if (intSPCAlarm != 0 && boolRCLIsNULL != true && boolRCLIsNULL != true)
			{
				snprintf(charStatement, MAX_STRING_SIZE, "%s_%s_%s_%d_RawData_Alarm.SPCAlarmLog",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
				intRetval = DB_SelectColumnMax(mysqlCon, charStatement, "SPCAlarmSN", &charSPCAlarmSN);
				if (intRetval == EXIT_FAILURE)
					return EXIT_FAILURE;
				intSPCAlarmSN = atoi(charSPCAlarmSN) + 1;

				// Insert THe SPC Result into Database
				snprintf(charStatement, MAX_STRING_SIZE,
						 "INSERT INTO %s_%s_%s_%d_RawData_Alarm.SPCAlarmLog "
						 "(SPCAlarmSN, 		GroupSN,			ShotSNStart,	ShotSNEnd,"
						 "MonitorItemSN,	SPCAlarm,"
						 "SPCRAlarm,		SPCRUCL,			SPCRLCL,		SPCRValue,			SPCRDiff,"
						 "SPCRule1Alarm,	SPCRule1UCL,		SPCRule1LCL,	SPCRule1XBarValue,	SPCRule1XBarDiff,"
						 "SPCRule2Alarm,	SPCRule3Alarm,		SPCRule4Alarm,"
						 "SPCRule5Alarm,	SPCRule6Alarm,		SPCRule7Alarm,	SPCRule8Alarm,		SPCAlarmTime) "
						 "VALUE "
						 "(%d,%d,%d,%d,"
						 " %d,%d,"
						 " %d,%lf,%lf,%lf,%lf,"
						 " %s,%lf,%lf,%lf,%lf,"
						 " %s,%s,%s,"
						 " %s,%s,%s,%s,NOW())",
						 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
						 intSPCAlarmSN, intGroupSN, intShotSN - intSPCSampleSize + 1, intShotSN,
						 intMonitorItemSN, intSPCAlarm,
						 intSPCRAlarm, doubleRUCL, doubleRLCL, *doubleRValue, doubleSPCAlarmRDiff,
						 charSPCRulesAlarm[0], doubleXUCL, doubleXLCL, *doubleXBarValue, doubleSPCAlarmXBarDiff,
						 charSPCRulesAlarm[1], charSPCRulesAlarm[2], charSPCRulesAlarm[3],
						 charSPCRulesAlarm[4], charSPCRulesAlarm[5], charSPCRulesAlarm[6], charSPCRulesAlarm[7]);

				// fprintf(stderr, "[SPC_InsertSPCAlarm]:%s\n", charStatement);
				intRetval = mysql_query(&mysqlCon, charStatement);
				if (intRetval != EXIT_SUCCESS)
				{
					snprintf(charErrMsg, LONG_STRING_SIZE,
							 "[SPC_InsertSPCAlarm]Fail to insert SPC Alarm for ShotSN:%d MonitorItemSN:%d into  %s_%s_%s_%d_RawData_Alarm.SPCAlarmLog (%d):%s",
							 intShotSN, intMonitorItemSN,
							 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN,
							 mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
					intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_DB, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
					// return intLogSN;
				}
			}

			// DB_SelectMonitorItemDBName(mysqlCon, intMOSN, intMonitorItemSN, charMonitorItemDBName);
			// fprintf(stderr, "intMonitorItemName:%s\n", charMonitorItemDBName);
			// fprintf(stderr, "MonitorItemSN:%d XUCL:%lf XCL:%lf XLCL:%lf\n", intMonitorItemSN, doubleXUCL, doubleXCL, doubleXLCL);
			// fprintf(stderr, "MonitorItemSN:%d RUCL:%lf RCL:%lf RLCL:%lf\n", intMonitorItemSN, doubleRUCL, doubleRCL, doubleRLCL);
		}
	}
	mysql_free_result(mysqlResult);

	return EXIT_SUCCESS;
}

int SPC_Rule1(double *doubleValue, double doubleUCL, double doubleLCL, int *intRule1Alarm)
// Check SPC Rule 1 for Specified Value and Control Lines
{
	if (*doubleValue > doubleUCL)
		*intRule1Alarm = 1;
	else if (*doubleValue < doubleLCL)
		*intRule1Alarm = -1;
	else
		*intRule1Alarm = 0;
	return EXIT_SUCCESS;
}

int SPC_Rule2(double *doubleValue, unsigned int intPointSize, double doubleCL, int *intRule2Alarm)
// Check SPC Rule 2 for Specified Values and Control Lines
{

	unsigned int intSPCUCLSideCount = 0;
	unsigned int intSPCLCLSideCount = 0;

	if (intPointSize < 9)
		intPointSize = 9;

	for (int i = 0; i < intPointSize; i++)
	{
		// fprintf(stderr, "DataPoint[%d]:%lf\n", i, doubleValue[i]);
		if (doubleValue[i] > doubleCL)
			intSPCUCLSideCount++;
		else if (doubleValue[i] < doubleCL)
			intSPCLCLSideCount++;
	}

	fprintf(stderr, "[SPC Rule 2]UCLCount:%d LCLCount:%d\n", intSPCUCLSideCount, intSPCLCLSideCount);

	if (intSPCUCLSideCount == intPointSize)
		*intRule2Alarm = 1;
	else if (intSPCLCLSideCount == intPointSize)
		*intRule2Alarm = -1;
	else
		*intRule2Alarm = 0;

	return EXIT_SUCCESS;
}

int SPC_Rule3(double *doubleValue, unsigned int intPointSize, int *intRule3Alarm)
// Check SPC Rule 3 for Specified Values
{

	unsigned int intSPCIncreaseCount = 0;
	unsigned int intSPCDecreaseCount = 0;

	if (intPointSize < 6)
		intPointSize = 6;

	// Continuously increase check
	for (int i = 0; i < intPointSize - 1; i++)
	{
		if (doubleValue[i] < doubleValue[i + 1])
			intSPCIncreaseCount++;
		else if (doubleValue[i] > doubleValue[i + 1])
			intSPCDecreaseCount++;
	}
	if (intSPCIncreaseCount == intPointSize - 1)
		*intRule3Alarm = 1;
	else if (intSPCDecreaseCount == intPointSize - 1)
		*intRule3Alarm = -1;
	else
		*intRule3Alarm = 0;

	return EXIT_SUCCESS;
}

int SPC_Rule4(double *doubleValue, unsigned int intPointSize, int *intRule4Alarm)
// Check SPC Rule 4 for Specified Values
{
	unsigned int intSPCCompareFlag = 0;
	//-1: Value[0] > Value[1] Decrease
	// 1: Value[0] < Value[1] Increase
	unsigned int intSPCAlternateCount = 0;

	if (intPointSize < 14)
		intPointSize = 14;

	for (int i = 0; i < intPointSize; i++)
	{
		// Decrease
		if (doubleValue[i] > doubleValue[i + 1])
		{
			// Previous State Must Be Increase Or It's The First Then intSPCAlternateCount+=1
			if (intSPCCompareFlag == 0 || intSPCCompareFlag == 1)
				intSPCAlternateCount++;
			intSPCCompareFlag = -1;
		}
		// Increase
		else if (doubleValue[i] < doubleValue[i + 1])
		{
			if (intSPCCompareFlag == 0 || intSPCCompareFlag == -1)
				intSPCAlternateCount++;
			intSPCCompareFlag = 1;
		}
	}
	if (intSPCAlternateCount != intPointSize - 1)
		*intRule4Alarm = 0;
	else
		*intRule4Alarm = 1;
	return EXIT_SUCCESS;
}

int SPC_Rule5(double *doubleValue, unsigned int intPointSize, double doubleUCL, double doubleCL, double doubleLCL, int *intRule5Alarm)
// Check SPC Rule 5 for Specified Values and Control Lines
{
	double doubleUCL2Sig = (doubleUCL - doubleCL) / 3.0 * 2.0 + doubleCL;
	double doubleLCL2Sig = (doubleLCL - doubleCL) / 3.0 * 2.0 + doubleCL;

	unsigned int intSPOutSideCount = 0;

	for (int i = 0; i < intPointSize; i++)
	{
		if (doubleValue[i] > doubleUCL2Sig && doubleValue[i] < doubleUCL)
			intSPOutSideCount++;
		else if (doubleValue[i] < doubleLCL2Sig && doubleValue[i] > doubleLCL)
			intSPOutSideCount++;
	}
	if (intSPOutSideCount >= 2)
		*intRule5Alarm = 1;
	else if (intSPOutSideCount >= 2)
		*intRule5Alarm = -1;
	else
		*intRule5Alarm = 0;
	return EXIT_SUCCESS;
}

int SPC_Rule6(double *doubleValue, unsigned int intPointSize, double doubleUCL, double doubleCL, double doubleLCL, int *intRule6Alarm)
// Check SPC Rule 6 for Specified Values and Control Lines
{
	double doubleUCL1Sig = (doubleUCL - doubleCL) / 3.0 + doubleCL;
	double doubleLCL1Sig = (doubleLCL - doubleCL) / 3.0 + doubleCL;

	unsigned int intSPCUCLSideCount = 0;
	unsigned int intSPCLCLSideCount = 0;

	for (int i = 0; i < intPointSize; i++)
	{
		if (doubleValue[i] > doubleUCL1Sig)
			intSPCUCLSideCount++;
		else if (doubleValue[i] < doubleLCL1Sig)
			intSPCLCLSideCount++;
	}

	if (intSPCUCLSideCount >= 4)
		*intRule6Alarm = 1;
	else if (intSPCLCLSideCount >= 4)
		*intRule6Alarm = -1;
	else
		*intRule6Alarm = 0;
	return EXIT_SUCCESS;
}

int SPC_Rule7(double *doubleValue, unsigned int intPointSize, double doubleUCL, double doubleCL, double doubleLCL, int *intRule7Alarm)
// Check SPC Rule 7 for Specified Values and Control Lines
{
	unsigned int intSPCInSideCount = 0;
	double doubleUCL1Sig;
	double doubleLCL1Sig;

	if (intPointSize != 15)
		intPointSize = 15;

	doubleUCL1Sig = (doubleUCL - doubleCL) / 3.0 + doubleCL;
	doubleLCL1Sig = (doubleLCL - doubleCL) / 3.0 + doubleCL;

	for (int i = 0; i < intPointSize; i++)
	{
		if (doubleValue[i] < doubleUCL1Sig && doubleValue[i] > doubleLCL1Sig)
			intSPCInSideCount++;
	}

	if (intSPCInSideCount == intPointSize)
		*intRule7Alarm = 1;
	else
		*intRule7Alarm = 0;
	return EXIT_SUCCESS;
}

int SPC_Rule8(double *doubleValue, unsigned int intPointSize, double doubleUCL, double doubleCL, double doubleLCL, int *intRule8Alarm)
// Check SPC Rule 8 for Specified Values and Control Lines
{
	unsigned int intSPCOutSideCount = 0;
	double doubleUCL1Sig;
	double doubleLCL1Sig;

	if (intPointSize != 8)
		intPointSize = 8;

	doubleUCL1Sig = (doubleUCL - doubleCL) / 3.0 + doubleCL;
	doubleLCL1Sig = (doubleLCL - doubleCL) / 3.0 + doubleCL;

	for (int i = 0; i < intPointSize; i++)
	{
		if ((doubleValue[i] > doubleLCL && doubleValue[i] < doubleUCL) && (doubleValue[i] > doubleUCL1Sig || doubleValue[i] < doubleLCL1Sig))
			intSPCOutSideCount++;
	}

	if (intSPCOutSideCount == intPointSize)
		*intRule8Alarm = 1;
	else
		*intRule8Alarm = 0;
	return EXIT_SUCCESS;
}

int SPC_UpdateSPCAlarmRead(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intSPCAlarmSN, bool boolSPCAlarmRead)
//[SPC]Update A Specified SPC Alarm as Read
{
	char charStatement[MAX_STRING_SIZE];
	int intRetval;
	unsigned int intLogSN;
	char charErrMsg[LONG_STRING_SIZE];

	if (boolSPCAlarmRead == false || boolSPCAlarmRead == true)
	{
		// Update SPCAlarmRead
		snprintf(charStatement, MAX_STRING_SIZE, "UPDATE %s_%s_%s_%d_RawData_Alarm.SPCAlarmLog SET SPCAlarmRead=%d WHERE SPCAlarmSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, boolSPCAlarmRead, intSPCAlarmSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_UpdateSPCAlarmRead]Fail to set SPCAlarmSN:%d as read in %s_%s_%s_%d_RawData_Alarm.SPCAlarmLog (%d):%s",
					 intSPCAlarmSN, SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
			return intLogSN;
		}
		else
		{
			return EXIT_SUCCESS;
		}
	}
	else
	{
		snprintf(charErrMsg, LONG_STRING_SIZE, "[SPC_UpdateSPCAlarmRead]Parameter boolSPCAlarmRead should be true or false");
		intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, 0, mysql_errno(&mysqlCon), charErrMsg);
		return intLogSN;
	}
}

int DEMO_SetIMMParaValue(char charIMMParaValue[OPCUA_IMMPARA_NODE_NUM + 1][TINY_STRING_SIZE])
{
	char charRandValue[TINY_STRING_SIZE];

	srand((unsigned)time(NULL));
	for (int i = OPCUA_FIRST_IMMPARA; i <= OPCUA_IMMPARA_NODE_NUM; i++)
	{
		if (i >= IMMPARA_INJECTION_PRESSURE_1 && i <= IMMPARA_INJECTION_PRESSURE_5)
		{
			snprintf(charRandValue, TINY_STRING_SIZE, "%lf", (double)rand() / RAND_MAX * 140.0);
			strcpy(charIMMParaValue[i], charRandValue);
		}
		else if (i >= IMMPARA_INJECTION_SPEED_1 && i <= IMMPARA_INJECTION_SPEED_5)
		{
			snprintf(charRandValue, TINY_STRING_SIZE, "%lf", (double)rand() / RAND_MAX * 100.0);
			strcpy(charIMMParaValue[i], charRandValue);
		}
		else if (i >= IMMPARA_HOLDING_PRESSURE_1 && i <= IMMPARA_HOLDING_PRESSURE_5)
		{
			snprintf(charRandValue, TINY_STRING_SIZE, "%lf", (double)rand() / RAND_MAX * 140.0);
			strcpy(charIMMParaValue[i], charRandValue);
		}
		else if (i >= IMMPARA_BACK_PRESSURE_1 && i <= IMMPARA_BACK_PRESSURE_5)
		{
			snprintf(charRandValue, TINY_STRING_SIZE, "%lf", (double)rand() / RAND_MAX * 40.0);
			strcpy(charIMMParaValue[i], charRandValue);
		}
		else if (i == IMMPARA_INJECTION_STAGE || i == IMMPARA_HOLDING_STAGE || i == IMMPARA_PLASTIFICATION_STAGE)
		{
			snprintf(charRandValue, TINY_STRING_SIZE, "%d", rand() % 5 + 1);
			strcpy(charIMMParaValue[i], charRandValue);
			// fprintf(stderr,"[SET-NODE ID:%d]:%s\n",i,charIMMParaValue[i]);
		}
		else
		{
			snprintf(charRandValue, TINY_STRING_SIZE, "%lf", ((double)rand() / RAND_MAX) * 100.0);
			strcpy(charIMMParaValue[i], charRandValue);
			// fprintf(stderr,"[SET-NODE ID:%d]:%s\n",i,charIMMParaValue[i]);
		}
	}
	// strcpy(varUAIMMNodeValue->charIMMParaMeltTemperatureValue,"9527.9527");
	return EXIT_SUCCESS;
}

int NN_AcceptCriteriaInference(MYSQL mysqlCon, unsigned int intMOSN, unsigned int intIMMSN, unsigned int intExpectedProdVolume, unsigned int intCountAcceptCriteriaSN, unsigned int intShotSN, int *intMOAcceptCriteriaSNTHFlag, double *doubleMOAcceptCriteriaSNTH)
{

	char charStatement[MAX_STRING_SIZE];
	int intExitStatus = EXIT_SUCCESS;
	int intRetval;
	bool boolAccept;
	double doublePredictValue, doubleActualValue;
	char charPredictValue[TINY_STRING_SIZE];
	int intPredictValue;
	char charErrMsg[LONG_STRING_SIZE];
	unsigned int intLogSN;

	srand((unsigned)time(NULL));

	/*
		intMOAcceptCriteriaSNTHFlag[N*4]
			[0]:MOAcceptCriteriaSN
			[1]:MOAcceptCriteriaClass
			[2]:MOAcceptCriteria
	*/

	// Assume this shot is accepted
	boolAccept = true;
	for (int i = intCountAcceptCriteriaSN; i >= 1; i--)
	{

		double doubleErrRatio = 1.2;
		double doubleAcceptRatio = 0.8;

		// doublePredictValue has range 0~2*MAX_TH
		doublePredictValue = doubleErrRatio * (double)rand() / RAND_MAX * (*(doubleMOAcceptCriteriaSNTH + (i - 1) * 2 + 1));

		// doubleActualValue has range 0~2*MAX_TH
		doubleActualValue = doubleErrRatio * (double)rand() / RAND_MAX * (*(doubleMOAcceptCriteriaSNTH + (i - 1) * 2 + 1));

		// If this is the only one accept crateria then generate a random num between 0~1 if rand < 0.2 then reject
		if (i == 1 && intCountAcceptCriteriaSN == 1)
		{
			if ((double)rand() / RAND_MAX < 1 - doubleAcceptRatio)
			{
				boolAccept = false;
				doublePredictValue = 0.0;
				fprintf(stderr, "[NN_AcceptCriteriaInference]---ALARM--- MOSN:%d ShotSN:%d is rejected\n", intMOSN, intShotSN);
			}
			else
			{
				doublePredictValue = 1.0;
			}

			if ((double)rand() / RAND_MAX < 1 - doubleAcceptRatio)
				doubleActualValue = 0.0;
			else
				doubleActualValue = 1.0;

			// If there is more then 1 accept criteria except quality, then the predict quality depends accept criteria(s)
		}
		else if (i == 1)
		{
			if (boolAccept == false)
				doublePredictValue = 0.0;
			else
				doublePredictValue = 1.0;

			if ((double)rand() / RAND_MAX < 1 - doubleAcceptRatio)
				doubleActualValue = 0.0;
			else
				doubleActualValue = 1.0;
			// If the accept crateria has minimal threshold and predict value is <threshold
		}
		else if ((*(intMOAcceptCriteriaSNTHFlag + (i - 1) * ACCEPTCRATERIA_META_NUM + ACCEPTCRATERIA_META_HASMIN) == true) &&
				 doublePredictValue < *(doubleMOAcceptCriteriaSNTH + (i - 1) * 2))
		{
			fprintf(stderr, "[NN_AcceptCriteriaInference]---ALARM--- MOSN:%d ShotSN:%d AcceptCriteriaSN:%d is too low %lf where min_th:%lf\n",
					intMOSN, intShotSN, i, doublePredictValue, *(doubleMOAcceptCriteriaSNTH + (i - 1) * 2));
			boolAccept = false;

			// If the accept crateria has maxmal threshold and predict value is >threshold
		}
		else if ((*(intMOAcceptCriteriaSNTHFlag + (i - 1) * ACCEPTCRATERIA_META_NUM + ACCEPTCRATERIA_META_HASMAX) == true) &&
				 doublePredictValue > *(doubleMOAcceptCriteriaSNTH + (i - 1) * 2 + 1))
		{
			fprintf(stderr, "[NN_AcceptCriteriaInference]---ALARM--- MOSN:%d ShotSN:%d AcceptCriteriaSN:%d is too high %lf where max_th:%lf\n",
					intMOSN, intShotSN, i, doublePredictValue, *(doubleMOAcceptCriteriaSNTH + (i - 1) * 2 + 1));
			boolAccept = false;
		}

#ifdef DEBUG_MODE
		fprintf(stderr, "[NN_AcceptCriteriaInference]IMMSN:%d ShotSN:%d AcceptCriteriaSN:%d Predict:%lf Actual:%f\n",
				intIMMSN, intShotSN, i, doublePredictValue, doubleActualValue);
#endif

		snprintf(charStatement, MAX_STRING_SIZE, "INSERT INTO %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d ("
												 "ShotSN,ActualValue,PredictValue,PredictBool) VALUE (%d,%lf,%lf,%d)",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i,
				 intShotSN, doubleActualValue, doublePredictValue, !boolAccept);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, MAX_STRING_SIZE,
					 "[NN_AcceptCriteriaInference]Fail to insert accept criteria into table %s_%s_%s_%d_RawData_AcceptCriteria.MOAcceptCriteriaSN%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, i, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_MYSQL, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return EXIT_FAILURE;
		}
	}

	// Update AcceptProdShot, RejectProdShot, Yield INJPRO.Data.IMMSNList
	if (boolAccept == true)
	{
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s.MOSNList SET ProdShot=ProdShot+1, AcceptProdShot=AcceptProdShot+1,"
				 "YieldRate=ROUND(AcceptProdShot/(AcceptProdShot+RejectProdShot)*100.0,2),MOProgress=ROUND(AcceptProdShot/ExpectedProdVolume*100.0,2) WHERE MOSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[NN_AcceptCriteriaInference]Fail to increase accept part in table %s_%s_%s.MOSNList where MOSN=%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return EXIT_FAILURE;
		}
	}
	else
	{
		snprintf(charStatement, MAX_STRING_SIZE,
				 "UPDATE %s_%s_%s.MOSNList SET ProdShot=ProdShot+1, RejectProdShot=RejectProdShot+1,"
				 "YieldRate=ROUND(AcceptProdShot/(AcceptProdShot+RejectProdShot)*100.0,2),MOProgress=ROUND(AcceptProdShot/ExpectedProdVolume*100.0,2) WHERE MOSN=%d",
				 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN);
		intRetval = mysql_query(&mysqlCon, charStatement);
		if (intRetval != EXIT_SUCCESS)
		{
			snprintf(charErrMsg, LONG_STRING_SIZE, "[NN_AcceptCriteriaInference]Fail to increase rejectpart in table %s_%s_%s.MOSNList where MOSN=%d (%d):%s",
					 SYS_NAME, DATA_DATABASE_NAME, MO_DATABASE_NAME, intMOSN, mysql_errno(&mysqlCon), mysql_error(&mysqlCon));
			intLogSN = SYS_InsertSysErrMsg(mysqlCon, ERRCLASS_IMM, intMOSN, intIMMSN, mysql_errno(&mysqlCon), charErrMsg);
			return EXIT_FAILURE;
		}
	}
	return EXIT_SUCCESS;
}

int DEMO_SetLocalhostOPCUAVersion(char charOPCUAIMMNodeList[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1][OPCUA_META_NUM][MEDIUM_STRING_SIZE])
{
	unsigned int intLogSN;

	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_ID], "'APPL.Mold1.sv_bMoldClosed'");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_ID], "'APPL.Mold1.sv_bMoldOpen'");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_ID], "'APPL.OperationMode1.do_AlarmLamp'");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_ID], "'APPL.OperationMode1.do_StoppedLamp'");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_ID], "'APPL.OperationMode1.do_RunningLamp'");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_ID], "'APPL.Motor1.sv_bMotorStarted'");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_ID], "'APPL.system.sv_OperationMode'");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_ID], "'APPL.HeatingNozzle1.sv_bHeatingOn'");

	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.iNoOfPoints'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.iNoOfPoints'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.iNoOfPoints'");

	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.sv_ZoneRetain1.rSetValVis'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[1].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[2].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[3].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[4].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[5].rStartPos'");
	// strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME][OPCUA_META_IDENTIFIER_TYPE],OPCUA_IDENTIFIER_TYPE_NUMERIC);
	// strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME][OPCUA_META_NS],"1");
	// strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME][OPCUA_META_ID],"'2018'");

	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[1].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[2].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[3].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[4].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[5].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[1].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[2].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[3].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[4].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[5].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_CutOffParams.rPositionThreshold'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_ID], "'APPL.Injection1.sv_CutOffParams.dTimeThreshold'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[1].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[2].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[3].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[4].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[5].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_ID], "NULL");
	// Start from 2
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[1].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[2].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[3].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[4].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[5].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_ID], "'APPL.CoolingTime1.sv_dCoolingTime'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[1].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[2].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[3].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[4].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[5].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[1].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[2].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[3].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[4].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[5].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_rCutOffPosition'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_ID], "'APPL.Mold1.sv_rMoldIntegralPressure'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_ScrewDecPositionAbs'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_InTemp5'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_InTemp4'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_InTemp3'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_InTemp2'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_InTemp1'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_ID], "'APPL.Mold1.sv_dActOpenTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_ID], "'APPL.Mold1.sv_MoldBwdProfVis.Profile.Points[2].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_ID], "'APPL.Mold1.sv_MoldBwdProfVis.Profile.Points[3].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_ID], "'APPL.Mold1.sv_MoldBwdProfVis.Profile.Points[4].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_ID], "'APPL.Mold1.sv_MoldBwdProfVis.Profile.Points[5].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_ID], "'APPL.Mold1.sv_dActCloseTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_ID], "'APPL.Injection1.sv_rInjPeakPressure'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_ID], "'APPL.Injection1.sv_InjectTimesAct.dActMoveTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_ID], "'APPL.OilMaintenance1.ti_OilTemp'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_ID], "'APPL.Injection1.sv_dActHoldTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_HopperTemp'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_rCushion'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID], "'APPL.Injection1.sv_PlastTimesAct.dActDelayTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_ID], "'APPL.system.sv_dCycleTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_ID], "'APPL.Injection1.sv_rActPressure'");

	return EXIT_SUCCESS;
}

int DEMO_SetFCSOPCUAVersion(char charOPCUAIMMNodeList[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1][OPCUA_META_NUM][MEDIUM_STRING_SIZE])
{
	unsigned int intLogSN;

	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_ID], "'APPL.Mold1.sv_bMoldClosed'");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_ID], "'APPL.Mold1.sv_bMoldOpen'");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_ID], "'APPL.OperationMode1.do_AlarmLamp'");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_ID], "'APPL.OperationMode1.do_StoppedLamp'");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_ID], "'APPL.OperationMode1.do_RunningLamp'");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_ID], "'APPL.Motor1.sv_bMotorStarted'");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_ID], "'APPL.system.sv_OperationMode'");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_ID], "'APPL.HeatingNozzle1.sv_bHeatingOn'");

	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.iNoOfPoints'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.iNoOfPoints'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.iNoOfPoints'");

	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.sv_ZoneRetain1.rSetValVis'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[1].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[2].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[3].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[4].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[5].rStartPos'");
	// strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME][OPCUA_META_IDENTIFIER_TYPE],OPCUA_IDENTIFIER_TYPE_NUMERIC);
	// strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME][OPCUA_META_NS],"4");
	// strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME][OPCUA_META_ID],"'2018'");

	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[1].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[2].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[3].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[4].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[5].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[1].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[2].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[3].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[4].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[5].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_CutOffParams.rPositionThreshold'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_ID], "'APPL.Injection1.sv_CutOffParams.dTimeThreshold'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[1].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[2].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[3].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[4].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[5].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_ID], "NULL");
	// Start from 2
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[1].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[2].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[3].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[4].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[5].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_ID], "'APPL.CoolingTime1.sv_dCoolingTime'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[1].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[2].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[3].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[4].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[5].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[1].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[2].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[3].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[4].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[5].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_rCutOffPosition'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_ID], "'APPL.Mold1.sv_rMoldIntegralPressure'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_ScrewDecPositionAbs'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_InTemp5'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_InTemp4'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_InTemp3'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_InTemp2'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_InTemp1'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_ID], "'APPL.Mold1.sv_dActOpenTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_ID], "'APPL.Mold1.sv_MoldBwdProfVis.Profile.Points[2].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_ID], "'APPL.Mold1.sv_MoldBwdProfVis.Profile.Points[3].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_ID], "'APPL.Mold1.sv_MoldBwdProfVis.Profile.Points[4].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_ID], "'APPL.Mold1.sv_MoldBwdProfVis.Profile.Points[5].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_ID], "'APPL.Mold1.sv_dActCloseTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_ID], "'APPL.Injection1.sv_rInjPeakPressure'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_ID], "'APPL.Injection1.sv_InjectTimesAct.dActMoveTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_ID], "'APPL.OilMaintenance1.ti_OilTemp'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_ID], "'APPL.Injection1.sv_dActHoldTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.ti_HopperTemp'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_rCushion'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID], "'APPL.Injection1.sv_PlastTimesAct.dActDelayTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_ID], "'APPL.system.sv_dCycleTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_ID], "'APPL.Injection1.sv_rActPressure'");

	return EXIT_SUCCESS;
}

int DEMO_SetCYCUOPCUAVersion(char charOPCUAIMMNodeList[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1][OPCUA_META_NUM][MEDIUM_STRING_SIZE])
{

	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_ID], "'APPL.Mold1.sv_bMoldClosed'");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_ID], "'APPL.Mold1.sv_bMoldOpen'");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_ID], "'APPL.OperationMode1.do_AlarmLamp'");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_ID], "'APPL.OperationMode1.do_StoppedLamp'");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_ID], "'APPL.OperationMode1.do_RunningLamp'");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_ID], "'APPL.Motor1.sv_bMotorStarted'");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_ID], "'APPL.system.sv_OperationMode'");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_ID], "'APPL.HeatingNozzle1.sv_bHeatingOn'");

	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.iNoOfPoints'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.iNoOfPoints'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.iNoOfPoints'");

	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_ID], "'APPL.HeatingNozzle1.sv_ZoneRetain1.rSetValVis'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[1].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[2].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[3].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[4].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[5].rStartPos'");
	// strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME][OPCUA_META_IDENTIFIER_TYPE],OPCUA_IDENTIFIER_TYPE_NUMERIC);
	// strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME][OPCUA_META_NS],"4");
	// strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME][OPCUA_META_ID],"'2018'");

	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[1].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[2].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[3].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[4].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[5].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[1].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[2].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[3].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[4].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_ID], "'APPL.Injection1.sv_InjectProfVis.Profile.Points[5].rVelocity'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_CutOffParams.rPositionThreshold'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_ID], "'APPL.Injection1.sv_CutOffParams.dTimeThreshold'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[1].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[2].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[3].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[4].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[5].rPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_ID], "NULL");
	// Start from 2
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[1].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[2].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[3].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[4].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_ID], "'APPL.Injection1.sv_HoldProfVis.Profile.Points[5].rStartPos'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_ID], "'APPL.CoolingTime1.sv_dCoolingTime'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[1].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[2].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[3].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[4].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[5].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[1].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[2].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[3].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[4].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[5].rBackPressure'");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");

	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_rCutOffPositionAbs'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_PlastProfVis.Profile.Points[1].rRotation'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_ID], "'APPL.Injection1.sv_rCutOffPressure'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_ID], "'APPL.Injection1.sv_rInjPeakPressure'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_ID], "'APPL.Injection1.sv_InjectTimesAct.dActMoveTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_IDENTIFIER_TYPE], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID], "'APPL.Injection1.sv_PlastTimesAct.dActMoveTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_ID], "'APPL.Injection1.sv_rScrewZeroPosition'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_ID], "'APPL.system.sv_dLastCycleTime'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_ID], "'APPL.Injection1.sv_rPeakBackPressure'");

	return EXIT_SUCCESS;
}

int DEMO_SetFCSCT80EOPCUAVersion(char charOPCUAIMMNodeList[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1][OPCUA_META_NUM][MEDIUM_STRING_SIZE])
{
	unsigned int intLogSN;

	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_ID], "'IMM.MoldClamped'");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_STRING);
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_ID], "'IMM.MoldReleased'");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC);
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");

	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); ////54
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_ID], "'20010'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 55
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_ID], "'20049'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 56
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_ID], "'20050'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 57
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_ID], "'20059'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 58
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 59
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_ID], "'20060'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 60
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_ID], "'20061'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 61
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_ID], "20077");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 62
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_ID], "20069");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 63
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_ID], "'2069'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 64
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_ID], "'20067'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 65
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_ID], "20051");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 66
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_ID], "20053");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 67
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_ID], "20054");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 68
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_ID], "20055");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 69
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_ID], "20056");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 70
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 71
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_ID], "20057");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 72
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_ID], "'20063'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 73
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_ID], "'20064'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 74
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_ID], "'NULL'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 75
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 76
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 77
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 78
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 79
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 80
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 81
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_ID], "'20065'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 82
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 83
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 84
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 85
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 86
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 87
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 88
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 89
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 90
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_ID], "20077");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 91
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_ID], "20077");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 92
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 93
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_NS], "2");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_ID], "20058");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 94
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 95
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");
	return EXIT_SUCCESS;
}

int OPCUA_SetMX1OPCUAVersion(char charOPCUAIMMNodeList[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1][OPCUA_META_NUM][MEDIUM_STRING_SIZE])
{
	unsigned int intLogSN;

	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 1
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_ID], "1727");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 2
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_ID], "1726");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 3
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_ID], "1728");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 4
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_ID], "1729");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 5
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_ID], "1730");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 6
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_ID], "1731");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 7
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_ID], "1720");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 8
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_ID], "1732");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 9
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 10
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 11
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 12
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 13
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_ID], "1520");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 14
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_ID], "1521");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 15
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_ID], "1522");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 16
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 17
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 18
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_ID], "1474");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 19
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_ID], "1473");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 20
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_ID], "1472");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 21
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_ID], "1471");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 22
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_ID], "1470");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 23
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_ID], "1481");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 24
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_ID], "1480");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 25
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_ID], "1479");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 26
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_ID], "1478");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 27
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_ID], "1477");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 28
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 29
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 30
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 31
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_ID], "1499");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 32
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_ID], "1498");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 33
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_ID], "1497");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 34
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_ID], "1496");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 35
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 36
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 37
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_ID], "1507");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 38
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_ID], "1506");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 39
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_ID], "1505");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 40
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_ID], "1504");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 41
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 42
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_ID], "1527");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 43
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 44
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 45
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 46
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 47
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 48
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_ID], "1517");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 49
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_ID], "1518");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 50
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_ID], "1519");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 51
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 52
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 53
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");

	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 54
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_ID], "1676");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_RATIO], "'0.1'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 55
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_ID], "1677");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 56
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_ID], "1678");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 57
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_ID], "1670");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 58
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 59
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 60
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 61
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_ID], "1671");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 62
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_ID], "1669");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 63
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_ID], "1669");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 64
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_ID], "1695");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 65
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_ID], "1683");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 66
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_ID], "1684");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 67
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_ID], "1685");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 68
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_ID], "1686");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 69
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_ID], "1687");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 70
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_ID], "1689");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 71
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 72
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_ID], "1672");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 73
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_ID], "1672");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 74
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_ID], "'NULL'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 75
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 76
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 77
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 78
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 79
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "1682");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 80
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 81
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_ID], "1733");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 82
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 83
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 84
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 85
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 86
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 87
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 88
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 89
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 90
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_ID], "1675");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 91
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_NS], "1");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_ID], "1378");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 92
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 93
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 94
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 95
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");
	return EXIT_SUCCESS;
}

int OPCUA_SetMJ9000S_1_OPCUAVersion(char charOPCUAIMMNodeList[OPCUA_IMMPARA_NODE_NUM + OPCUA_IMMSENSOR_NODE_NUM + 1][OPCUA_META_NUM][MEDIUM_STRING_SIZE])
{
	unsigned int intLogSN;

	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 1
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_CLAMPED][OPCUA_META_ID], "8464");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 2
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_MOLD_RELEASED][OPCUA_META_ID], "8453");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 3
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_ALARM_LAMP][OPCUA_META_ID], "8475");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 4
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_STOPPED_LAMP][OPCUA_META_ID], "8486");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 5
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_RUNNING_LAMP][OPCUA_META_ID], "8497");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 6
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_MOTOR_START][OPCUA_META_ID], "8508");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 7
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_OPERATION_MODE][OPCUA_META_ID], "8387");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 8
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[DO_SHOT_COMPLETE][OPCUA_META_ID], "8519");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 9
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 10
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 11
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_STAGE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 12
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MELT_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 13
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_1][OPCUA_META_ID], "4856");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 14
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_2][OPCUA_META_ID], "4911");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 15
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_3][OPCUA_META_ID], "4966");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 16
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 17
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PLASTIFICATION_VOLUME_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 18
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_1][OPCUA_META_ID], "4262");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 19
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_2][OPCUA_META_ID], "4317");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 20
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_3][OPCUA_META_ID], "4372");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 21
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_4][OPCUA_META_ID], "4427");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 22
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_PRESSURE_5][OPCUA_META_ID], "4482");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 23
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_1][OPCUA_META_ID], "4273");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 24
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_2][OPCUA_META_ID], "4328");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 25
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_3][OPCUA_META_ID], "4383");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 26
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_4][OPCUA_META_ID], "4438");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 27
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_INJECTION_SPEED_5][OPCUA_META_ID], "4493");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 28
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_POSITION][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 29
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_VPCHANGEOVER_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 30
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 31
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_1][OPCUA_META_ID], "4537");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 32
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_2][OPCUA_META_ID], "4581");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 33
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_3][OPCUA_META_ID], "4625");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 34
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_4][OPCUA_META_ID], "4669");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 35
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_PRESSURE_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 36
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_PACKING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 37
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_1][OPCUA_META_ID], "4559");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 38
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_2][OPCUA_META_ID], "4603");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 39
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_3][OPCUA_META_ID], "4647");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 40
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_4][OPCUA_META_ID], "4691");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 41
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_HOLDING_TIME_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 42
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_COOLING_TIME][OPCUA_META_ID], "4999");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 43
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_1][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 44
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 45
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 46
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 47
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_SCREW_RPM_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 48
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_1][OPCUA_META_ID], "4845");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 49
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_2][OPCUA_META_ID], "4900");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 50
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_3][OPCUA_META_ID], "4955");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 51
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 52
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_BACK_PRESSURE_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 53
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMPARA_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");

	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 54
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CYCLE_TIME][OPCUA_META_ID], "8101");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 55
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_CLAMPING_TIME][OPCUA_META_ID], "8112");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 56
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_TIME][OPCUA_META_ID], "8123");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 57
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_INJECTION_TIME][OPCUA_META_ID], "8035");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 58
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_DELAY_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 59
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_HOLDING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 60
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PLASTIFICATION_TIME][OPCUA_META_ID], "8134");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 61
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_VPCHANGEOVER_POSITION][OPCUA_META_ID], "8046");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 62
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_CUSION_VOLUME][OPCUA_META_ID], "8024");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 63
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_HOLDING_POSITION][OPCUA_META_ID], "8024");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 64
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_END_PLASTIFICATION_POSITION][OPCUA_META_ID], "8090");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 65
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE1_TEMPERATURE][OPCUA_META_ID], "8178");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 66
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE2_TEMPERATURE][OPCUA_META_ID], "8189");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 67
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE3_TEMPERATURE][OPCUA_META_ID], "8200");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 68
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE4_TEMPERATURE][OPCUA_META_ID], "8211");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 69
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_NOZZLE5_TEMPERATURE][OPCUA_META_ID], "8222");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 70
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IMM_OIL_TEMPERATURE][OPCUA_META_ID], "8244");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 71
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_FALL_MATERIAL_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 72
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_INJECTION_PRESSURE][OPCUA_META_ID], "8057");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 73
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_VPCHANGEOVER_PRESSURE][OPCUA_META_ID], "8057");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 74
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_INJECTION_PRESSURE][OPCUA_META_ID], "'NULL'");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 75
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_HOLDING_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 76
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYNEARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 77
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_CAVITYFARGATE_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 78
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_CAVITY_PRESSURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 79
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SUM_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "8167");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 80
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_MOLD_CLAMPING_FORCE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 81
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MAX_BACK_PRESSURE][OPCUA_META_ID], "8530");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 82
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_DELAY_PLASTIFICATION_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 83
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_IN_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 84
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_OUT_MOLD_COOLING_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 85
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_COOLING_VOLUME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 86
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_2][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 87
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_3][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 88
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_4][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 89
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_RELEASING_POSITION_5][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 90
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_SUCK_BACK_POSITION][OPCUA_META_ID], "8145");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 91
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_NS], "4");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_SCREW_RPM][OPCUA_META_ID], "8277");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 92
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_PART_WEIGHT][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 93
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_GATE_CLOSING_TIME][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 94
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MELT_TEMPERATURE][OPCUA_META_ID], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_IDENTIFIER_TYPE], OPCUA_IDENTIFIER_TYPE_NUMERIC); // 95
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_NS], "NULL");
	strcpy(charOPCUAIMMNodeList[IMMSENSOR_MOLD_TEMPERATURE][OPCUA_META_ID], "NULL");
	return EXIT_SUCCESS;
}

/*
int DB_GetIMMSysPressureSensorFeatureValue(MYSQL mysqlCon, unsigned int intMOSN, double *doubleSensorData,
										   unsigned int intSensorDataSize, char charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_SINGLE_FEATURE_NUM + 1][TINY_STRING_SIZE])
{
	double doubleSkpiElapsedTime = 0;
	double doubleMinIdealPressure = 0.5;
	double doubleMinIdealStage2EndTime = 8;
	double doubleMinIdealStage3MaxPressure = 0.5;

	bool boolIsReadyForStage3EndIndex = false;

	unsigned int intStage1StartIndex = 0;
	unsigned int intStage1EndIndex = 0;
	unsigned int intStage2StartIndex = 0;
	unsigned int intStage2EndIndex = 0;
	unsigned int intStage3StartIndex = 0;
	unsigned int intStage3EndIndex = 0;

	double doubleStage1StartTime = 0;		 //1
	double doubleStage1EndTime = 0;			 //2
	double doubleStage1Period = 0;			 //3
	double doubleAvgStage1PressureSlope = 0; //4
	double doubleSumStage1Pressure = 0;		 //5
	double doubleStage1EndPressure = 0;		 //6

	double doubleStage2StartTime = 0;		 //7
	double doubleStage2EndTime = 0;			 //8
	double doubleStage2Period = 0;			 //9
	double doubleAvgStage2PressureSlope = 0; //10
	double doubleSumStage2Pressure = 0;		 //11

	double doubleStage3StartTime = 0;		//12
	double doubleStage3EndTime = 0;			//13
	double doubleStage3Period = 0;			//14
	double doubleMaxStage3Pressure = 0;		//15
	double doubleMaxStage3PressureTime = 0; //16
	double doubleSumStage3Pressure = 0;		//17

	double doubleCycleTime = 0;	  //18
	double doubleSumPressure = 0; //19

	//doubleSensorData[X][0]: The ElapsedTime of the X-th row
	//doubleSensorData[X][1]: The SensorValue of the X-th row

	for (int i = 1; i <= IMM_SYSPRESSURE_SENSOR_SINGLE_FEATURE_NUM; i++)
	{
		snprintf(charIMMSysPressureSensorFeatureValue[i], TINY_STRING_SIZE, "NULL");
		//fprintf(stderr,"%d:%s\n",i,charIMMSysPressureSensorFeatureValue[i]);
	}

	if (intSensorDataSize == 0)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Empty IMM system presure sensor Data\n");
		return EXIT_FAILURE;
	}

	for (int i = 1; i < intSensorDataSize; i++)
	{
		if (*(doubleSensorData + i * 2) < doubleSkpiElapsedTime)
			continue;

		if (intStage1StartIndex == 0 && *(doubleSensorData + i * 2 + 1) > doubleMinIdealPressure)
		{
			intStage1StartIndex = i;
			doubleStage1StartTime = *(doubleSensorData + intStage1StartIndex * 2);
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage1StartIndex:%d ElapsedTime:%lf SensorValue:%lf\n", i, *(doubleSensorData + i * 2), *(doubleSensorData + i * 2 + 1));
		}

		if (intStage2EndIndex == 0 &&									 //If Stage2EndIndex Hasn't Found
			intStage1StartIndex != 0 &&									 //Stage1StartIndex Found
			*(doubleSensorData + i * 2) > doubleMinIdealStage2EndTime && //ElapsedTime > Minimal Stage 2 End
			*(doubleSensorData + i * 2 + 1) < doubleMinIdealPressure)	 //SensorValue < Ideal Minimal Sensor Value
		{
			intStage2EndIndex = i;
			doubleStage1EndTime = *(doubleSensorData + intStage1EndIndex * 2);
			doubleStage2StartTime = *(doubleSensorData + intStage2StartIndex * 2);
			doubleStage2EndTime = *(doubleSensorData + intStage2EndIndex * 2);
			doubleStage2Period = doubleStage2EndTime - doubleStage2StartTime;
			//Once The Stage2 End Is Found, Stage1End and Stage2Start Can Be Confirmed As Well.
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage1EndIndex:%d ElapsedTime:%lf SensorValue:%lf\n", intStage1EndIndex, *(doubleSensorData + intStage1EndIndex * 2), *(doubleSensorData + intStage1EndIndex * 2 + 1));
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage2StartIndex:%d ElapsedTime:%lf SensorValue:%lf\n", intStage2StartIndex, *(doubleSensorData + intStage1EndIndex * 2), *(doubleSensorData + intStage1EndIndex * 2 + 1));
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage2EndIndex:%d ElapsedTime:%lf SensorValue:%lf\n", i, *(doubleSensorData + i * 2), *(doubleSensorData + i * 2 + 1));
		}

		//Before Stage2 End
		if (intStage1StartIndex != 0 && intStage2EndIndex == 0)
		{
			//Find The Max Pressure, and Let It Be The Stage1 End
			if (*(doubleSensorData + i * 2 + 1) > doubleStage1EndPressure)
			{
				doubleStage1EndPressure = *(doubleSensorData + i * 2 + 1);
				intStage1EndIndex = i;
				intStage2StartIndex = i;
			}
		}

		if (intStage3StartIndex == 0 &&								   //If Stage3StartIndex Hasn't Found
			intStage2EndIndex != 0 &&								   //If Stage2EndIndex Has Found
			*(doubleSensorData + i * 2 + 1) >= doubleMinIdealPressure) //SensorValue >= Ideal Minimal Sensor Value
		{
			intStage3StartIndex = i;
			doubleStage3StartTime = *(doubleSensorData + intStage3StartIndex * 2);
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage3StartIndex:%d ElapsedTime:%lf SensorValue:%lf\n", i, *(doubleSensorData + i * 2), *(doubleSensorData + i * 2 + 1));
		}

		if (intStage3StartIndex != 0 &&										   //If Stage3StartIndex Has Found
			intStage3EndIndex == 0 &&										   //If Stage3EndtIndex Has't Found
			*(doubleSensorData + i * 2 + 1) > doubleMinIdealStage3MaxPressure) //SensorValue Has >= MinIdealStage3MaxPressure
		{
			boolIsReadyForStage3EndIndex = true;
		}

		if (boolIsReadyForStage3EndIndex == true &&					  //If Stage3 Pressure Has Exceed THreshold(doubleMinIdealStage3MaxPressure)
			intStage3EndIndex == 0 &&								  //If Stage3EndIndex Hasn't Found
			intStage3StartIndex != 0 &&								  //If Stage2StartIndex Has Found
			*(doubleSensorData + i * 2 + 1) < doubleMinIdealPressure) // SensorValue < Ideal Minimal Sensor Value
		{
			intStage3EndIndex = i;
			doubleStage3EndTime = *(doubleSensorData + intStage3EndIndex * 2);
			doubleStage3Period = doubleStage3EndTime - doubleStage3StartTime;
			fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Stage3EndIndex:%d ElapsedTime:%lf SensorValue:%lf\n", i, *(doubleSensorData + i * 2), *(doubleSensorData + i * 2 + 1));
		}
		doubleSumPressure += *(doubleSensorData + i * 2 + 1);
	}
	doubleCycleTime = *(doubleSensorData + (intSensorDataSize - 1) * 2) - *(doubleSensorData + 0 * 2);

	//Check If Stage1, Stage2, Stage 3
	if (intStage1StartIndex == 0)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage1StartIndex!\n");
		return EXIT_FAILURE;
	}
	else if (intStage1EndIndex == 0)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage1EndIndex!\n");
		return EXIT_FAILURE;
	}
	else if (intStage2StartIndex == 0)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage2StartIndex!\n");
		return EXIT_FAILURE;
	}
	else if (intStage2EndIndex == 0)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage2EndIndex!\n");
		return EXIT_FAILURE;
	}
	else if (intStage3StartIndex == 0)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage3StartIndex!\n");
		return EXIT_FAILURE;
	}
	else if (intStage3EndIndex == 0)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]Fail to find Stage3EndIndex!\n");
		return EXIT_FAILURE;
	}

	if (intStage1StartIndex != 0 && intStage1EndIndex != 0)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage1StartTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_START_TIME, doubleStage1StartTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_START_TIME], TINY_STRING_SIZE, "%lf", doubleStage1StartTime);

		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage1EndTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME, doubleStage1EndTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_TIME], TINY_STRING_SIZE, "%lf", doubleStage1EndTime);

		doubleStage1Period = doubleStage1EndTime - doubleStage1StartTime;
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage1Period:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_PERIOD, doubleStage1Period);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_PERIOD], TINY_STRING_SIZE, "%lf", doubleStage1Period);
		if (intStage1StartIndex != intStage1EndIndex)
		{
			doubleAvgStage1PressureSlope =
				(*(doubleSensorData + intStage1EndIndex * 2 + 1) - *(doubleSensorData + intStage1StartIndex * 2 + 1)) /
				(*(doubleSensorData + intStage1EndIndex * 2) - *(doubleSensorData + intStage1StartIndex * 2));
		}
		else
			doubleAvgStage1PressureSlope = 0;
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:AvgStage1PressureSlope:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE, doubleAvgStage1PressureSlope);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE1_PRESSURESLOPE], TINY_STRING_SIZE, "%lf", doubleAvgStage1PressureSlope);
		for (int i = intStage1StartIndex; i <= intStage1EndIndex; i++)
			doubleSumStage1Pressure += *(doubleSensorData + i * 2 + 1);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:SumStage1Pressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE1_PRESSURE, doubleSumStage1Pressure);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE1_PRESSURE], TINY_STRING_SIZE, "%lf", doubleSumStage1Pressure);
		doubleStage1EndPressure = *(doubleSensorData + intStage1EndIndex * 2 + 1);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage1EndPressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE, doubleStage1EndPressure);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE1_END_PRESSURE], TINY_STRING_SIZE, "%lf", doubleStage1EndPressure);
	}

	if (intStage2StartIndex != 0 && intStage2EndIndex != 0)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage2StartTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_START_TIME, doubleStage2StartTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_START_TIME], TINY_STRING_SIZE, "%lf", doubleStage2StartTime);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage2EndTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_END_TIME, doubleStage2EndTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_END_TIME], TINY_STRING_SIZE, "%lf", doubleStage2EndTime);
		doubleStage2Period = doubleStage2EndTime - doubleStage2StartTime;
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage2Period:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_PERIOD, doubleStage2Period);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE2_PERIOD], TINY_STRING_SIZE, "%lf", doubleStage2Period);
		if (intStage2StartIndex != intStage2EndIndex)
		{
			doubleAvgStage2PressureSlope =
				(*(doubleSensorData + intStage2EndIndex * 2 + 1) - *(doubleSensorData + intStage2StartIndex * 2 + 1)) /
				(*(doubleSensorData + intStage2EndIndex * 2) - *(doubleSensorData + intStage2StartIndex * 2));
		}
		else
			doubleAvgStage2PressureSlope = 0;
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:AvgStage2PressureSlope:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE, doubleAvgStage2PressureSlope);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_AVG_STAGE2_PRESSURESLOPE], TINY_STRING_SIZE, "%lf", doubleAvgStage2PressureSlope);
		for (int i = intStage2StartIndex; i <= intStage2EndIndex; i++)
			doubleSumStage2Pressure += *(doubleSensorData + i * 2 + 1);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:SumStage2Pressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE2_PRESSURE, doubleSumStage2Pressure);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE2_PRESSURE], TINY_STRING_SIZE, "%lf", doubleSumStage2Pressure);
	}

	if (intStage3StartIndex != 0 && intStage3EndIndex != 0)
	{
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage3StartTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_START_TIME, doubleStage3StartTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_START_TIME], TINY_STRING_SIZE, "%lf", doubleStage3StartTime);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage3EndTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_END_TIME, doubleStage3EndTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_END_TIME], TINY_STRING_SIZE, "%lf", doubleStage3EndTime);
		doubleStage3Period = doubleStage3EndTime - doubleStage3StartTime;
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:Stage3Period:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_PERIOD, doubleStage3Period);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_STAGE3_PERIOD], TINY_STRING_SIZE, "%lf", doubleStage3Period);
		for (int i = intStage3StartIndex; i <= intStage3EndIndex; i++)
		{

			if (*(doubleSensorData + i * 2 + 1) > doubleMaxStage3Pressure)
			{
				doubleMaxStage3Pressure = *(doubleSensorData + i * 2 + 1);
				doubleMaxStage3PressureTime = *(doubleSensorData + i * 2);
			}
			doubleSumStage3Pressure += *(doubleSensorData + i * 2 + 1);
		}
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:MaxStage3Pressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE, doubleMaxStage3Pressure);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE], TINY_STRING_SIZE, "%lf", doubleMaxStage3Pressure);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:MaxStage3PressureTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE_TIME, doubleMaxStage3PressureTime);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_MAX_STAGE3_PRESSURE_TIME], TINY_STRING_SIZE, "%lf", doubleMaxStage3PressureTime);
		fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:SumStage3Pressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE3_PRESSURE, doubleSumStage3Pressure);
		snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_STAGE3_PRESSURE], TINY_STRING_SIZE, "%lf", doubleSumStage3Pressure);
	}

	fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:CycleTime:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_CYCLE_TIME, doubleCycleTime);
	snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_CYCLE_TIME], TINY_STRING_SIZE, "%lf", doubleCycleTime);
	fprintf(stderr, "[DB_GetIMMSysPressureSensorFeatureValue]%d:SumPressure:%lf\n", IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_PRESSURE, doubleSumPressure);
	snprintf(charIMMSysPressureSensorFeatureValue[IMM_SYSPRESSURE_SENSOR_FEATURE_SUM_PRESSURE], TINY_STRING_SIZE, "%lf", doubleSumPressure);

	//for (int i = 1; i <= IMM_SYSPRESSURE_SENSOR_SINGLE_FEATURE_NUM; i++)
	//	fprintf(stderr, "Index:%d Value:%s\n", i, charIMMSysPressureSensorFeatureValue[i]);
	return EXIT_SUCCESS;
}
*/
